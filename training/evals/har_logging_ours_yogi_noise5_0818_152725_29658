2021-08-18:15:27:30,680 INFO     [param_server.py:13] End up with cuda device tensor([0.7636], device='cuda:0')
2021-08-18:15:27:31,82 INFO     [param_server.py:608] ====Start to initialize dataset
2021-08-18:15:27:31,85 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:28:02,620 INFO     [learner.py:14] End up with cuda device tensor([0.0067], device='cuda:3')
2021-08-18:15:28:02,624 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:28:02,698 INFO     [learner.py:14] End up with cuda device tensor([0.7616], device='cuda:2')
2021-08-18:15:28:02,701 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:28:03,30 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:28:03,30 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:28:03,106 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:28:03,106 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:28:05,403 INFO     [learner.py:14] End up with cuda device tensor([0.2599], device='cuda:1')
2021-08-18:15:28:05,406 INFO     [learner.py:42] ===== Experiment start on : dev-amd20-v100=====
2021-08-18:15:28:05,813 INFO     [learner.py:709] ====Start to initialize dataset
2021-08-18:15:28:05,813 INFO     [flLibs.py:59] ====Initialize the model
2021-08-18:15:29:20,879 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:29:20,882 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:20,883 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.00038504600524902344 s

2021-08-18:15:29:20,883 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:29:21,0 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:29:21,2 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:21,2 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0003497600555419922 s

2021-08-18:15:29:21,3 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:29:23,225 INFO     [learner.py:732] ==== Starting training data partitioner =====
2021-08-18:15:29:23,229 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:23,229 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.00045800209045410156 s

2021-08-18:15:29:23,229 INFO     [learner.py:735] ==== Finished training data partitioner =====
2021-08-18:15:29:24,490 INFO     [param_server.py:91] ====Info of all feasible clients {'total_feasible_clients': 120, 'total_length': 30423}
2021-08-18:15:29:24,822 INFO     [param_server.py:189] ====PS: get in run()
2021-08-18:15:29:24,851 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:29:24,852 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:24,852 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.0003972053527832031 s

2021-08-18:15:29:24,853 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:29:24,853 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:29:24,854 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:29:24,855 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:24,855 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.00036454200744628906 s

2021-08-18:15:29:24,855 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:29:24,855 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:29:24,856 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:29:24,857 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:29:24,859 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:29:24,860 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:29:24,860 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:29:24,863 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:29:24,867 INFO     [learner.py:748] ==== Starting testing data partitioner =====
2021-08-18:15:29:24,868 INFO     [divide_data.py:58] ====Warning: skip_partition is True
2021-08-18:15:29:24,868 INFO     [divide_data.py:95] ====Initiating DataPartitioner takes 0.00030422210693359375 s

2021-08-18:15:29:24,869 INFO     [learner.py:750] ==== Finished testing data partitioner =====
2021-08-18:15:29:24,869 INFO     [divide_data.py:367] ========= Start of Random Partition =========

2021-08-18:15:29:24,871 INFO     [divide_data.py:490] Raw class per worker is : array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])

2021-08-18:15:29:24,872 INFO     [divide_data.py:491] ========= End of Class/Worker =========

2021-08-18:15:29:24,875 INFO     [learner.py:445] ====Worker: Start running
2021-08-18:15:29:24,877 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=2, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=6325, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=5.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='20998', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=2, threads=4, time_stamp='0818_152725_29658', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:29:24,886 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=1, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=6325, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=5.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='20998', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=1, threads=4, time_stamp='0818_152725_29658', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:29:24,894 INFO     [learner.py:526] ====Start train round 1
2021-08-18:15:29:24,897 INFO     [learner.py:526] ====Start train round 1
2021-08-18:15:29:24,904 INFO     [learner.py:483] 
Namespace(adam_epsilon=1e-08, adaptive_epoch_beta=0.7, backend='nccl', batch_size=16, bidirectional=True, blacklist_max_len=0.3, blacklist_rounds=-1, block_size=64, cache_dir=None, capacity_bin=True, clf_block_size=100, client_path='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_device_capacity', clip_bound=0.98, clock_factor=2.5, conf_path='~/dataset/', config_name=None, cut_off_util=0.7, data_dir='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/HARBox', data_mapfile='.', data_set='har', decay_epoch=5, decay_factor=0.95, display_step=20, do_eval=False, do_train=False, dropout_high=0.6, dropout_low=0.1, dump_epoch=1000, duplicate_data=1, enable_adapt_local_epoch=True, enable_dropout=True, enable_importance=False, enable_obs_client=False, enable_obs_importance=False, enable_obs_local_epoch=False, enforce_random=False, epochs=500, eval_all_checkpoints=False, eval_data_file='', eval_interval=1, eval_interval_prior=9999999, evaluate_during_training=False, exploration_alpha=0.3, exploration_decay=0.95, exploration_factor=0.9, exploration_min=0.4, filter_class=0, filter_less=30, filter_more=100000.0, finetune=False, fixed_clients=False, force_read=False, forward_pass=False, fp16=False, fp16_opt_level='O1', full_gradient_interval=20, gpu_device=3, gradient_accumulation_steps=1, gradient_policy='yogi', hetero_allocation='1.0-1.0-1.0-1.0-1.0-1.0', heterogeneity=1.0, hidden_layers=7, hidden_size=256, input_dim=0, is_even_avg=True, job_name='har', labels_path='labels.json', learners='1-2-3', learning_rate=4e-05, line_by_line=False, load_epoch=1, load_model=False, load_time_stamp='0615_194942', local_rank=-1, log_path='/mnt/home/lichenni/projects/Oort/training/evals', logging_steps=500, loss_decay=0.2, malicious_clients=0, manager_port=6325, max_grad_norm=1.0, max_iter_store=100, max_steps=-1, min_learning_rate=2e-05, mlm=True, mlm_probability=0.1, model='mobilenet_v2', model_avg=True, model_name_or_path=None, model_path=None, model_size=65536, model_type='', no_cuda=False, noise_dir=None, noise_factor=5.0, noise_max=0.5, noise_min=0.0, noise_prob=0.4, num_class=5, num_loaders=4, num_train_epochs=1.0, output_dim=0, output_dir=None, overcommit=1.3, overwrite_cache=False, overwrite_output_dir=False, pacer_delta=0.3, pacer_step=20, per_gpu_eval_batch_size=4, per_gpu_train_batch_size=4, proxy_avg=False, proxy_mu=0.1, ps_ip='dev-amd20-v100', ps_port='20998', read_models_path=False, release_cache=False, resampling_interval=1, rnn_type='lstm', round_penalty=2.0, round_threshold=10, run_all=False, sample_mode='oort', sample_rate=16000, sample_seed=233, sample_window=5.0, sampler_path=None, save_path='./', save_steps=500, save_total_limit=None, score_mode='loss', seed=42, sequential='0', server_ip='', server_port='', should_continue=False, single_sim=0, skip_partition=True, sleep_up=0, spec_augment=False, speed_volume_perturb=False, stale_threshold=0, task='har', test_bsz=128, test_interval=20, test_manifest='data/test_manifest.csv', test_only=False, test_ratio=1.0, test_train_data=False, this_rank=3, threads=4, time_stamp='0818_152725_29658', timeout=9999999, to_device='cuda', tokenizer_name=None, total_worker=20, train_data_file='', train_manifest='data/train_manifest.csv', upload_epoch=5, user_trace='/mnt/ufs18/nodr/home/lichenni/projects/FedScale/dataset/data/device_info/client_behave_trace', validate_interval=999999, vocab_tag_size=500, vocab_token_size=10000, warmup_steps=0, weight_decay=0.0, window='hamming', window_size=0.02, window_stride=0.01, yogi_beta=0.999, yogi_beta2=-1, yogi_eta=0.005, yogi_tau=0.001, zipf_alpha='5')

2021-08-18:15:29:24,912 INFO     [learner.py:165] Start to run client 1 on rank 1...
2021-08-18:15:29:24,913 INFO     [learner.py:165] Start to run client 2 on rank 2...
2021-08-18:15:29:24,914 INFO     [learner.py:526] ====Start train round 1
====Worker: init_myprocesses
Begin!
====Worker: init_myprocesses
Begin!
2021-08-18:15:29:24,938 INFO     [learner.py:165] Start to run client 3 on rank 3...
====Worker: init_myprocesses
Begin!
2021-08-18:15:29:25,409 INFO     [learner.py:439] Completed to run client 2
2021-08-18:15:29:25,413 INFO     [learner.py:606] ====Pushing takes 0.003007173538208008 s
2021-08-18:15:29:25,422 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:25,427 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.3333333333333333, now collected 1 clients
2021-08-18:15:29:25,427 INFO     [param_server.py:410] Lock worker 2 with localStep 1 , while globalStep is 0

2021-08-18:15:29:25,442 INFO     [learner.py:439] Completed to run client 1
2021-08-18:15:29:25,446 INFO     [learner.py:606] ====Pushing takes 0.0033316612243652344 s
2021-08-18:15:29:25,450 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:25,452 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.3333333333333333, now collected 2 clients
2021-08-18:15:29:25,453 INFO     [param_server.py:410] Lock worker 1 with localStep 1 , while globalStep is 0

2021-08-18:15:29:25,570 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:29:25,574 INFO     [learner.py:606] ====Pushing takes 0.0030107498168945312 s
2021-08-18:15:29:25,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:25,580 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.3333333333333333, now collected 3 clients
2021-08-18:15:29:25,581 INFO     [param_server.py:381] ====After aggregation in epoch: 0, virtual_clock: 0.0, top_1: : 0.0 % (0.0), top_5: : 0.0 % (0.0), test loss: 0.0, test len: 3.0
2021-08-18:15:29:25,583 INFO     [param_server.py:410] Lock worker 3 with localStep 1 , while globalStep is 1

2021-08-18:15:29:25,583 INFO     [param_server.py:441] ====Epoch 2 completes 3 clients with loss 49.30390782795177, sampled rewards are: 
 {1: 0, 2: 0, 3: 0} 
==========
2021-08-18:15:29:25,583 INFO     [param_server.py:450] ====Start to sample for epoch 2, global virtualClock: 0.0, round_duration: 0.0
2021-08-18:15:29:25,584 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 55, 6, 51, 84, 98, 37, 112, 118, 93, 11, 85, 27, 31, 57, 79, 119, 107, 70]
2021-08-18:15:29:25,933 INFO     [param_server.py:567] ====Error: argument of type 'NoneType' is not iterable, <class 'TypeError'>, param_server.py, 551
2021-08-18:15:29:26,487 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2641, Top-1 Accuracy: 252.0/1033 (0.2439), Top-5 Accuracy: 1.0
2021-08-18:15:29:26,488 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.6237, eval_time 0.5232, test_loss 4.2641, test_accuracy 0.2439, test_5_accuracy 1.0 

2021-08-18:15:29:26,529 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2447, Top-1 Accuracy: 257.0/1033 (0.2488), Top-5 Accuracy: 1.0
2021-08-18:15:29:26,530 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.6694, eval_time 0.5674, test_loss 3.2447, test_accuracy 0.2488, test_5_accuracy 1.0 

2021-08-18:15:29:26,544 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:29:26,560 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:29:26,595 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2835, Top-1 Accuracy: 226.0/1033 (0.2188), Top-5 Accuracy: 1.0
2021-08-18:15:29:26,596 INFO     [learner.py:656] After aggregation epoch 1, CumulTime 1.7205, eval_time 0.6094, test_loss 3.2835, test_accuracy 0.2188, test_5_accuracy 1.0 

2021-08-18:15:29:26,608 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:29:26,625 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:29:26,650 INFO     [learner.py:526] ====Start train round 2
2021-08-18:15:29:26,672 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:29:28,183 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:29:28,196 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:29:29,414 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:29:29,428 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:29,543 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:29:29,552 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:29:30,899 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:29:30,910 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:29:31,307 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:31,328 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:29:31,554 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:29:31,563 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:29:31,833 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:29:31,843 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:29:32,850 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:29:32,866 INFO     [learner.py:606] ====Pushing takes 0.014407634735107422 s
2021-08-18:15:29:32,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:32,902 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 4 clients
2021-08-18:15:29:32,903 INFO     [param_server.py:410] Lock worker 2 with localStep 2 , while globalStep is 1

2021-08-18:15:29:33,76 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:29:33,86 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:29:34,543 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:29:34,564 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:29:35,757 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:29:35,779 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:29:35,784 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:29:35,799 INFO     [learner.py:165] Start to run client 112 on rank 1...
2021-08-18:15:29:37,85 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:29:37,112 INFO     [learner.py:165] Start to run client 57 on rank 3...
2021-08-18:15:29:37,490 INFO     [learner.py:439] Completed to run client 112
2021-08-18:15:29:37,511 INFO     [learner.py:165] Start to run client 118 on rank 1...
2021-08-18:15:29:38,255 INFO     [learner.py:439] Completed to run client 57
2021-08-18:15:29:38,284 INFO     [learner.py:606] ====Pushing takes 0.024502038955688477 s
2021-08-18:15:29:38,328 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:38,337 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 10 clients
2021-08-18:15:29:38,338 INFO     [param_server.py:410] Lock worker 3 with localStep 2 , while globalStep is 1

2021-08-18:15:29:38,902 INFO     [learner.py:439] Completed to run client 118
2021-08-18:15:29:38,928 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:29:40,156 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:29:40,169 INFO     [learner.py:165] Start to run client 31 on rank 1...
2021-08-18:15:29:43,130 INFO     [learner.py:439] Completed to run client 31
2021-08-18:15:29:43,158 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:29:43,800 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:29:43,820 INFO     [learner.py:165] Start to run client 70 on rank 1...
2021-08-18:15:29:44,420 INFO     [learner.py:439] Completed to run client 70
2021-08-18:15:29:44,460 INFO     [learner.py:606] ====Pushing takes 0.039238691329956055 s
2021-08-18:15:29:44,508 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:44,523 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:29:44,524 INFO     [param_server.py:381] ====After aggregation in epoch: 1, virtual_clock: 57.1231349992849, top_1: : 23.7173 % (735.0), top_5: : 100.0 % (3099.0), test loss: 3.597442741747255, test len: 3099.0
2021-08-18:15:29:44,528 INFO     [param_server.py:410] Lock worker 1 with localStep 2 , while globalStep is 2

2021-08-18:15:29:44,528 INFO     [param_server.py:441] ====Epoch 3 completes 20 clients with loss 8.808181675037519, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 31: 0, 37: 0, 51: 0, 55: 0, 57: 0, 70: 0, 79: 0, 82: 0, 84: 0, 85: 0, 93: 0, 98: 0, 107: 0, 112: 0, 118: 0, 119: 0} 
==========
2021-08-18:15:29:44,529 INFO     [param_server.py:450] ====Start to sample for epoch 3, global virtualClock: 57.1231349992849, round_duration: 57.1231349992849
2021-08-18:15:29:44,531 INFO     [oort.py:208] Training selector: Pacer 1: lastExploitationUtil 0.0, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:29:44,532 INFO     [oort.py:321] scores are 3,{6: 0.22471547200103487, 7: 0.37072176593519157, 11: 0.07350973406003976, 27: 0.08498120066103705, 31: 0.02997947037910039, 37: 0.09443134167714805, 51: 0.1733720241924614, 55: 0.40316460423258027, 57: 0.02283525862763746, 58: 0.0038714315681045615, 59: 0.004006224058033408, 60: 0.001727576557348298, 67: 0.002114527629457154, 70: 0.0017356735040886496, 76: 0.0018684904852953137, 82: 0.9823343229484626, 84: 0.14754299902258544, 85: 0.0597376451292838, 98: 0.15807203683615625, 104: 0.003589769852848754, 107: 0.008571814672920753, 112: 0.13249243864018118, 118: 0.15392792151044926, 119: 0.028186521425124997},[82, 55, 7, 6, 51, 98, 118, 84, 112, 37, 27, 11, 85, 31, 119, 57, 107, 59, 58, 104, 67, 76, 70, 60]
2021-08-18:15:29:44,533 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:29:44,535 INFO     [oort.py:365] exploration poss is [211.         194.         127.31276875 102.62196006  93.54348818
  63.22281215  48.9297034   43.80212094  40.07746457  38.76346588
  35.52193436  20.51602366  19.67074705  17.89651406  17.81815999
  16.97776986  10.82015629  10.17914992   9.55281742   9.51833915
   9.20736151   4.08207853   3.2544298    2.43794015   2.21488525
   1.67907336   1.37027356   0.86146108   0.70455354]
2021-08-18:15:29:44,536 INFO     [oort.py:398] At round 1, UCB exploited 24, augment_factor 2.0, exploreLen 23, un-explored 91, exploration 0.855, round_threshold 10, sampled score is [({'reward': 1109.982368021038, 'duration': 6.342067858842259, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 83.08739610115947}, [0.9823343229484626, -0.0001500750375187595]), ({'reward': 551.5595342007693, 'duration': 8.010998429338052, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.493968292123032}, [0.40316460423258027, -0.0001500750375187595]), ({'reward': 547.3663461617839, 'duration': 11.90395711384456, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.28996491366406}, [0.39881562817003685, -0.0001500750375187595])]
2021-08-18:15:29:44,536 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [82, 16, 55, 53, 6, 83, 97, 81, 99, 38, 87, 110, 71, 5, 73, 65, 106, 49, 50, 105]
2021-08-18:15:29:44,932 INFO     [param_server.py:553] For epoch: 3, median_reward: 334.6626847160031, dev: 1673.3134235800158
2021-08-18:15:29:45,539 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 5.5084, Top-1 Accuracy: 341.0/1033 (0.3301), Top-5 Accuracy: 1.0
2021-08-18:15:29:45,542 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 20.678, eval_time 0.5743, test_loss 5.5084, test_accuracy 0.3301, test_5_accuracy 1.0 

2021-08-18:15:29:45,582 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 5.4795, Top-1 Accuracy: 355.0/1033 (0.3437), Top-5 Accuracy: 1.0
2021-08-18:15:29:45,583 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 20.708, eval_time 0.6116, test_loss 5.4795, test_accuracy 0.3437, test_5_accuracy 1.0 

2021-08-18:15:29:45,613 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:45,620 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:29:45,621 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.5646, Top-1 Accuracy: 353.0/1033 (0.3417), Top-5 Accuracy: 1.0
2021-08-18:15:29:45,621 INFO     [learner.py:656] After aggregation epoch 2, CumulTime 20.7605, eval_time 0.6535, test_loss 5.5646, test_accuracy 0.3417, test_5_accuracy 1.0 

2021-08-18:15:29:45,648 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:45,662 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:29:45,699 INFO     [learner.py:526] ====Start train round 3
2021-08-18:15:29:45,724 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:29:46,669 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:29:46,679 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:29:48,404 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:29:48,432 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:29:48,447 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:29:48,460 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:29:49,54 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:29:49,68 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:29:49,403 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:29:49,414 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:29:49,907 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:29:49,917 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:29:50,504 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:29:50,524 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:29:52,52 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:29:52,73 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:29:52,399 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:29:52,408 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:29:52,671 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:29:52,698 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:29:53,318 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:29:53,336 INFO     [learner.py:606] ====Pushing takes 0.016360044479370117 s
2021-08-18:15:29:53,370 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:53,377 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:29:53,378 INFO     [param_server.py:410] Lock worker 3 with localStep 3 , while globalStep is 2

2021-08-18:15:29:53,714 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:29:53,728 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:29:54,764 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:29:54,773 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:29:54,955 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:29:54,975 INFO     [learner.py:165] Start to run client 73 on rank 1...
2021-08-18:15:29:55,424 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:29:55,435 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:29:55,643 INFO     [learner.py:439] Completed to run client 73
2021-08-18:15:29:55,657 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:29:55,991 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:29:56,5 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:29:56,261 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:29:56,281 INFO     [learner.py:165] Start to run client 49 on rank 1...
2021-08-18:15:29:56,693 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:29:56,730 INFO     [learner.py:606] ====Pushing takes 0.035101890563964844 s
2021-08-18:15:29:56,764 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:56,773 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:29:56,774 INFO     [param_server.py:410] Lock worker 2 with localStep 3 , while globalStep is 2

2021-08-18:15:29:56,862 INFO     [learner.py:439] Completed to run client 49
2021-08-18:15:29:56,893 INFO     [learner.py:606] ====Pushing takes 0.029608964920043945 s
2021-08-18:15:29:56,922 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:29:56,930 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:29:56,931 INFO     [param_server.py:381] ====After aggregation in epoch: 2, virtual_clock: 94.09040263304013, top_1: : 33.8496 % (1049.0), top_5: : 100.0 % (3099.0), test loss: 5.51751744305646, test len: 3099.0
2021-08-18:15:29:56,932 INFO     [param_server.py:410] Lock worker 1 with localStep 3 , while globalStep is 3

2021-08-18:15:29:56,932 INFO     [param_server.py:441] ====Epoch 4 completes 20 clients with loss 52.192955836575756, sampled rewards are: 
 {5: 0, 6: 0, 16: 0, 38: 0, 49: 0, 50: 0, 53: 0, 55: 0, 65: 0, 71: 0, 73: 0, 81: 0, 82: 0, 83: 0, 87: 0, 97: 0, 99: 0, 105: 0, 106: 0, 110: 0} 
==========
2021-08-18:15:29:56,933 INFO     [param_server.py:450] ====Start to sample for epoch 4, global virtualClock: 94.09040263304013, round_duration: 36.96726763375522
2021-08-18:15:29:56,933 INFO     [oort.py:208] Training selector: Pacer 2: lastExploitationUtil 2116.1323080411566, lastExplorationUtil 1482.3750937288855, last_util_record 0
2021-08-18:15:29:56,934 INFO     [oort.py:321] scores are 4,{5: 0.013879201601952494, 6: 0.30926944192320094, 7: 0.3028388602454242, 11: 0.05346638584219434, 14: 0.010164282210300992, 16: 1.0079739346375614, 17: 0.012147929106071879, 27: 0.037969325993659854, 31: 0.02470968704960885, 37: 0.11464528177979548, 38: 0.05356298460654365, 49: 0.0068270556621557845, 50: 0.0093957335195116, 51: 0.16035546259711128, 53: 0.6329069671468417, 55: 0.3541073592986307, 57: 0.01600475485652361, 58: 0.002698127901694459, 59: 0.0027920692181346587, 60: 0.0012040048828699348, 65: 0.013547057244432215, 67: 0.0014736838028976105, 70: 0.004343246638671625, 71: 0.015025187038463476, 73: 0.027799968161744685, 76: 0.0013022124306575746, 81: 0.06269842632414002, 82: 0.9767369520146618, 83: 0.4533144126708524, 84: 0.13243867135198012, 85: 0.037241464554777746, 86: 0.001845693143313502, 87: 0.07351668729152129, 97: 0.2003280294095769, 98: 0.13302958957570313, 99: 0.0781840683389468, 104: 0.0025018285949904824, 105: 0.02429960163772236, 106: 0.03836542874183111, 107: 0.0072503148248836465, 110: 0.01582993292481339, 112: 0.0953148033516046, 118: 0.09722847929938414, 119: 0.013536251181629577},[16, 82, 53, 83, 55, 6, 7, 97, 51, 98, 84, 37, 118, 112, 99, 87, 81, 38, 11, 106, 27, 85, 73, 31, 105, 57, 110, 71, 5, 65, 119, 17, 14, 50, 107, 49, 70, 59, 58, 104, 86, 67, 76, 60]
2021-08-18:15:29:56,935 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:29:56,936 INFO     [oort.py:365] exploration poss is [102.23853772  18.16687676   3.2544298    2.43794015   2.21488525
   1.67907336   1.37027356   0.86146108]
2021-08-18:15:29:56,936 INFO     [oort.py:398] At round 2, UCB exploited 44, augment_factor 1.75, exploreLen 8, un-explored 71, exploration 0.8122499999999999, round_threshold 10, sampled score is [({'reward': 3677.6369332490326, 'duration': 6.342067858842259, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 83.05965649139578}, [0.824733971719324, -0.00010003334444814946]), ({'reward': 4459.177514750167, 'duration': 7.864087706209871, 'time_stamp': 3, 'count': 1, 'status': True, 'gradient': 21.302627228948477}, [1.0, -0.00010003334444814946]), ({'reward': 901.2272734612832, 'duration': 8.010998429338052, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 20.486925875342866}, [0.2021043790032929, -0.00010003334444814946])]
2021-08-18:15:29:56,937 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [82, 16, 55, 51, 83, 97, 38, 85, 110, 5, 106, 50, 105, 119, 17, 14, 111, 96, 25, 35]
2021-08-18:15:29:57,258 INFO     [param_server.py:553] For epoch: 4, median_reward: 575.690604724818, dev: 2878.45302362409
2021-08-18:15:29:57,896 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.433, Top-1 Accuracy: 425.0/1033 (0.4114), Top-5 Accuracy: 1.0
2021-08-18:15:29:57,899 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 33.0238, eval_time 0.5996, test_loss 2.433, test_accuracy 0.4114, test_5_accuracy 1.0 

2021-08-18:15:29:57,900 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.54, Top-1 Accuracy: 423.0/1033 (0.4095), Top-5 Accuracy: 1.0
2021-08-18:15:29:57,900 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 33.0365, eval_time 0.6053, test_loss 2.54, test_accuracy 0.4095, test_5_accuracy 1.0 

2021-08-18:15:29:57,939 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5042, Top-1 Accuracy: 408.0/1033 (0.395), Top-5 Accuracy: 1.0
2021-08-18:15:29:57,939 INFO     [learner.py:656] After aggregation epoch 3, CumulTime 33.0787, eval_time 0.6461, test_loss 2.5042, test_accuracy 0.395, test_5_accuracy 1.0 

2021-08-18:15:29:57,964 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:57,964 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:57,976 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:29:57,978 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:29:58,4 INFO     [learner.py:526] ====Start train round 4
2021-08-18:15:29:58,27 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:00,116 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:00,143 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:00,706 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:00,722 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:30:00,849 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:00,863 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:02,2 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:30:02,9 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:02,16 INFO     [learner.py:165] Start to run client 111 on rank 3...
2021-08-18:15:30:02,23 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:02,698 INFO     [learner.py:439] Completed to run client 111
2021-08-18:15:30:02,711 INFO     [learner.py:165] Start to run client 96 on rank 3...
2021-08-18:15:30:03,50 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:03,70 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:04,906 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:04,925 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:30:04,959 INFO     [learner.py:439] Completed to run client 96
2021-08-18:15:30:04,973 INFO     [learner.py:606] ====Pushing takes 0.01236867904663086 s
2021-08-18:15:30:04,988 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:04,996 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 4 clients
2021-08-18:15:30:04,997 INFO     [param_server.py:410] Lock worker 3 with localStep 4 , while globalStep is 3

2021-08-18:15:30:06,153 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:06,173 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:06,499 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:30:06,509 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:30:08,867 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:08,885 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:08,913 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:30:08,923 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:30:10,157 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:10,171 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:30:10,202 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:30:10,213 INFO     [learner.py:165] Start to run client 17 on rank 2...
2021-08-18:15:30:12,120 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:30:12,129 INFO     [learner.py:439] Completed to run client 17
2021-08-18:15:30:12,141 INFO     [learner.py:165] Start to run client 25 on rank 1...
2021-08-18:15:30:12,143 INFO     [learner.py:165] Start to run client 14 on rank 2...
2021-08-18:15:30:12,932 INFO     [learner.py:439] Completed to run client 25
2021-08-18:15:30:12,958 INFO     [learner.py:606] ====Pushing takes 0.024482250213623047 s
2021-08-18:15:30:12,995 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:13,4 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 11 clients
2021-08-18:15:30:13,4 INFO     [param_server.py:410] Lock worker 1 with localStep 4 , while globalStep is 3

2021-08-18:15:30:13,274 INFO     [learner.py:439] Completed to run client 14
2021-08-18:15:30:13,289 INFO     [learner.py:165] Start to run client 35 on rank 2...
2021-08-18:15:30:13,803 INFO     [learner.py:439] Completed to run client 35
2021-08-18:15:30:13,845 INFO     [learner.py:606] ====Pushing takes 0.040401458740234375 s
2021-08-18:15:30:13,883 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:13,893 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:13,893 INFO     [param_server.py:381] ====After aggregation in epoch: 3, virtual_clock: 178.02657935498743, top_1: : 40.5292 % (1256.0), top_5: : 100.0 % (3099.0), test loss: 2.492394032301726, test len: 3099.0
2021-08-18:15:30:13,896 INFO     [param_server.py:410] Lock worker 2 with localStep 4 , while globalStep is 4

2021-08-18:15:30:13,896 INFO     [param_server.py:441] ====Epoch 5 completes 20 clients with loss 7.797950829528338, sampled rewards are: 
 {5: 0, 14: 0, 16: 0, 17: 0, 25: 0, 35: 0, 38: 0, 50: 0, 51: 0, 55: 0, 82: 0, 83: 0, 85: 0, 96: 0, 97: 0, 105: 0, 106: 0, 110: 0, 111: 0, 119: 0} 
==========
2021-08-18:15:30:13,897 INFO     [param_server.py:450] ====Start to sample for epoch 5, global virtualClock: 178.02657935498743, round_duration: 83.9361767219473
2021-08-18:15:30:13,898 INFO     [oort.py:208] Training selector: Pacer 3: lastExploitationUtil 1876.4611598963866, lastExplorationUtil 583.1983005423458, last_util_record 0
2021-08-18:15:30:13,898 INFO     [oort.py:321] scores are 5,{5: 0.03892576295329564, 6: 0.3225028935195682, 7: 0.34637971695935055, 11: 0.06071805591718773, 14: 0.0033490545554463185, 16: 0.6359002100236666, 17: 0.020082419698184115, 25: 0.006167619421765804, 27: 0.04126517287217629, 31: 0.02827687681914086, 35: 0.0014825707216711032, 37: 0.13360963419172098, 38: 0.031034481337161246, 49: 0.008594941755336467, 50: 0.006942205628199951, 51: 0.09144309330030534, 53: 0.6372583956124193, 55: 0.5334286023326187, 57: 0.01813059608355579, 58: 0.003055330403955378, 59: 0.0031617085189910225, 60: 0.0013634019064971, 65: 0.015423662457909508, 67: 0.0016687833538143128, 70: 0.005161228353037316, 71: 0.01891600330351652, 73: 0.03010435774396597, 76: 0.0015829950574663251, 81: 0.0718779834468703, 82: 0.16572660598189126, 83: 0.4244492755513816, 84: 0.1522681828670957, 85: 0.08268226508202953, 86: 0.0019386147625635784, 87: 0.07588381253231191, 88: 0.0016904145386191555, 96: 0.0025683124066372743, 97: 0.051869812271604226, 98: 0.15241415164496006, 99: 0.084542018908453, 104: 0.003041272074555448, 105: 0.00688839319505725, 106: 0.007611326967026403, 107: 0.008309145689520753, 110: 0.12140139383568874, 111: 0.0031859627797156615, 112: 0.10816423597510431, 118: 0.10932125287054907, 119: 0.005538351573496729},[53, 16, 55, 83, 7, 6, 82, 98, 84, 37, 110, 118, 112, 51, 99, 85, 87, 81, 11, 97, 27, 5, 38, 73, 31, 17, 71, 57, 65, 49, 107, 106, 50, 105, 25, 119, 70, 14, 111, 59, 58, 104, 96, 86, 88, 67, 76, 35, 60]
2021-08-18:15:30:13,900 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:30:13,900 INFO     [oort.py:398] At round 3, UCB exploited 49, augment_factor 1.2, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 520.2788558197093, 'duration': 5.8943907365129, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.583597307805267}, [0.11200690617830991, 0.3]), ({'reward': 1707.9752240058187, 'duration': 8.010998429338052, 'time_stamp': 4, 'count': 3, 'status': True, 'gradient': 20.490061874394993}, [0.3677019985035932, -0.0001500750375187595]), ({'reward': 1769.744330643958, 'duration': 11.90395711384456, 'time_stamp': 3, 'count': 2, 'status': True, 'gradient': 20.292275860250673}, [0.38100005838468093, 0.1499249624812406])]
2021-08-18:15:30:13,901 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 84, 83, 37, 118, 81, 99, 11, 85, 71, 73, 57, 49, 17, 111, 25]
2021-08-18:15:30:14,226 INFO     [param_server.py:553] For epoch: 5, median_reward: 534.7878857133499, dev: 2673.9394285667495
2021-08-18:15:30:14,870 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1297, Top-1 Accuracy: 362.0/1033 (0.3504), Top-5 Accuracy: 1.0
2021-08-18:15:30:14,871 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 50.0105, eval_time 0.6117, test_loss 3.1297, test_accuracy 0.3504, test_5_accuracy 1.0 

2021-08-18:15:30:14,896 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0935, Top-1 Accuracy: 367.0/1033 (0.3553), Top-5 Accuracy: 1.0
2021-08-18:15:30:14,897 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 50.0216, eval_time 0.6168, test_loss 3.0935, test_accuracy 0.3553, test_5_accuracy 1.0 

2021-08-18:15:30:14,906 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8149, Top-1 Accuracy: 374.0/1033 (0.3621), Top-5 Accuracy: 1.0
2021-08-18:15:30:14,907 INFO     [learner.py:656] After aggregation epoch 4, CumulTime 50.0428, eval_time 0.6315, test_loss 2.8149, test_accuracy 0.3621, test_5_accuracy 1.0 

2021-08-18:15:30:14,939 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:30:14,953 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:14,956 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:30:14,973 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:14,982 INFO     [learner.py:526] ====Start train round 5
2021-08-18:15:30:15,3 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:16,177 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:16,197 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:17,821 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:17,835 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:17,841 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:17,846 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:18,861 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:18,872 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:18,890 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:18,900 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:19,480 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:19,490 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:20,464 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:20,490 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:21,450 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:21,459 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:30:22,259 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:22,273 INFO     [learner.py:165] Start to run client 57 on rank 3...
2021-08-18:15:30:23,315 INFO     [learner.py:439] Completed to run client 57
2021-08-18:15:30:23,325 INFO     [learner.py:165] Start to run client 111 on rank 3...
2021-08-18:15:30:23,527 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:23,545 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:23,979 INFO     [learner.py:439] Completed to run client 111
2021-08-18:15:30:24,2 INFO     [learner.py:606] ====Pushing takes 0.021402359008789062 s
2021-08-18:15:30:24,34 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:24,44 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:30:24,45 INFO     [param_server.py:410] Lock worker 3 with localStep 5 , while globalStep is 4

2021-08-18:15:30:24,560 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:30:24,578 INFO     [learner.py:165] Start to run client 17 on rank 2...
2021-08-18:15:30:24,679 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:24,697 INFO     [learner.py:165] Start to run client 118 on rank 1...
2021-08-18:15:30:25,219 INFO     [learner.py:439] Completed to run client 17
2021-08-18:15:30:25,237 INFO     [learner.py:606] ====Pushing takes 0.016472816467285156 s
2021-08-18:15:30:25,258 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:25,264 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:30:25,265 INFO     [param_server.py:410] Lock worker 2 with localStep 5 , while globalStep is 4

2021-08-18:15:30:25,893 INFO     [learner.py:439] Completed to run client 118
2021-08-18:15:30:25,913 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:26,690 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:26,711 INFO     [learner.py:165] Start to run client 73 on rank 1...
2021-08-18:15:30:27,340 INFO     [learner.py:439] Completed to run client 73
2021-08-18:15:30:27,355 INFO     [learner.py:165] Start to run client 49 on rank 1...
2021-08-18:15:30:28,601 INFO     [learner.py:439] Completed to run client 49
2021-08-18:15:30:28,619 INFO     [learner.py:165] Start to run client 25 on rank 1...
2021-08-18:15:30:29,299 INFO     [learner.py:439] Completed to run client 25
2021-08-18:15:30:29,339 INFO     [learner.py:606] ====Pushing takes 0.03896069526672363 s
2021-08-18:15:30:29,377 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:29,386 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:29,387 INFO     [param_server.py:381] ====After aggregation in epoch: 4, virtual_clock: 229.89873777325184, top_1: : 35.5921 % (1103.0), top_5: : 100.0 % (3099.0), test loss: 3.0126765833960643, test len: 3099.0
2021-08-18:15:30:29,388 INFO     [param_server.py:410] Lock worker 1 with localStep 5 , while globalStep is 5

2021-08-18:15:30:29,389 INFO     [param_server.py:441] ====Epoch 6 completes 20 clients with loss 7.137732204758429, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 17: 0, 25: 0, 37: 0, 49: 0, 53: 0, 55: 0, 57: 0, 71: 0, 73: 0, 81: 0, 83: 0, 84: 0, 85: 0, 99: 0, 111: 0, 118: 0} 
==========
2021-08-18:15:30:29,389 INFO     [param_server.py:450] ====Start to sample for epoch 6, global virtualClock: 229.89873777325184, round_duration: 51.872158418264405
2021-08-18:15:30:29,390 INFO     [oort.py:208] Training selector: Pacer 4: lastExploitationUtil 1065.707135250035, lastExplorationUtil 0.009999500024998751, last_util_record 0
2021-08-18:15:30:29,390 INFO     [oort.py:321] scores are 26,{5: 0.040791955441887795, 6: 0.5432544832194978, 7: 0.16651092438440537, 11: 0.028094667938390563, 14: 0.0037620773762037257, 16: 0.16651092438440537, 17: 0.015889318457524542, 25: 0.0018720943685286186, 27: 0.04376564837678347, 35: 0.0016473119955060774, 37: 0.07045905360088055, 38: 0.034861814935466647, 49: 0.027426134266331125, 50: 0.00779835452137765, 51: 0.10272033101273839, 53: 0.22278679266547122, 55: 0.16651092438440537, 57: 0.017349827988736487, 58: 0.0033090583393322066, 59: 0.003424270556061838, 60: 0.0014766247351563186, 65: 0.0166797022257401, 67: 0.001800722460486205, 70: 0.005676272389552366, 71: 0.033990922013171145, 73: 0.082494141491517, 76: 0.0016654346939080484, 81: 0.2764964166042411, 82: 0.18616487270581752, 83: 0.08414108643872864, 84: 0.07517695135454436, 85: 0.03677305509635093, 86: 0.0014529293346010747, 87: 0.07864043507292641, 88: 0.00177844839528995, 96: 0.0028850500462348494, 97: 0.058266667211376966, 98: 0.16524506015387166, 99: 0.09546802005580299, 104: 0.0030683114653808313, 105: 0.0077379056591889445, 106: 0.00854999538271879, 107: 0.009009666413298461, 110: 0.12352988096098912, 111: 0.003201040679990341, 112: 0.11681764779785261, 118: 0.04781588423796405, 119: 0.006221369885489261},[6, 81, 53, 82, 7, 16, 55, 98, 110, 112, 51, 99, 83, 73, 87, 84, 37, 97, 118, 27, 5, 85, 38, 71, 11, 49, 57, 65, 17, 107, 106, 50, 105, 119, 70, 14, 59, 58, 111, 104, 96, 25, 67, 88, 76, 35, 60, 86]
2021-08-18:15:30:29,391 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:30:29,392 INFO     [oort.py:398] At round 4, UCB exploited 48, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3704.9990355203013, 'duration': 11.90395711384456, 'time_stamp': 5, 'count': 3, 'status': True, 'gradient': 20.288407210137677}, [0.7976344303429151, -0.00010003334444814946]), ({'reward': 589.5345040703205, 'duration': 16.330805291863395, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 19.37282713490919}, [0.1269167180189676, 0.3]), ({'reward': 0.01, 'duration': 7.864087706209871, 'time_stamp': 5, 'count': 3, 'status': True, 'gradient': 21.30108709265601}, [2.152865826438277e-09, -0.00010003334444814946])]
2021-08-18:15:30:29,393 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 5]
2021-08-18:15:30:29,674 INFO     [param_server.py:553] For epoch: 6, median_reward: 501.7983498951198, dev: 2508.991749475599
2021-08-18:15:30:30,355 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5807, Top-1 Accuracy: 448.0/1033 (0.4337), Top-5 Accuracy: 1.0
2021-08-18:15:30:30,356 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5555, Top-1 Accuracy: 447.0/1033 (0.4327), Top-5 Accuracy: 1.0
2021-08-18:15:30:30,356 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 65.4919, eval_time 0.6471, test_loss 2.5807, test_accuracy 0.4337, test_5_accuracy 1.0 

2021-08-18:15:30:30,357 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 65.4812, eval_time 0.6454, test_loss 2.5555, test_accuracy 0.4327, test_5_accuracy 1.0 

2021-08-18:15:30:30,410 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:30,419 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:30,421 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:30,430 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:30,437 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6068, Top-1 Accuracy: 445.0/1033 (0.4308), Top-5 Accuracy: 1.0
2021-08-18:15:30:30,438 INFO     [learner.py:656] After aggregation epoch 5, CumulTime 65.5769, eval_time 0.7299, test_loss 2.6068, test_accuracy 0.4308, test_5_accuracy 1.0 

2021-08-18:15:30:30,505 INFO     [learner.py:526] ====Start train round 6
2021-08-18:15:30:30,524 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:31,39 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:31,50 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:32,113 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:32,124 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:32,790 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:32,809 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:33,431 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:33,432 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:33,442 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:33,444 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:33,701 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:33,728 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:33,951 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:33,972 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:33,985 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:34,6 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:34,634 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:34,648 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:35,134 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:35,154 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:35,312 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:35,332 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:36,512 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:36,526 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:36,579 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:36,593 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:30:37,2 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:37,22 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:37,104 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:30:37,130 INFO     [learner.py:606] ====Pushing takes 0.024497032165527344 s
2021-08-18:15:30:37,165 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:37,173 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:30:37,174 INFO     [param_server.py:410] Lock worker 2 with localStep 6 , while globalStep is 5

2021-08-18:15:30:37,597 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:37,642 INFO     [learner.py:606] ====Pushing takes 0.023549556732177734 s
2021-08-18:15:30:37,667 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:37,674 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:30:37,675 INFO     [param_server.py:410] Lock worker 3 with localStep 6 , while globalStep is 5

2021-08-18:15:30:46,184 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:46,202 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:46,793 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:47,796 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:48,473 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:48,499 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:48,986 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:49,14 INFO     [learner.py:606] ====Pushing takes 0.026428937911987305 s
2021-08-18:15:30:49,51 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:49,61 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:49,62 INFO     [param_server.py:381] ====After aggregation in epoch: 5, virtual_clock: 253.3059711013821, top_1: : 43.2398 % (1340.0), top_5: : 100.0 % (3099.0), test loss: 2.580989634549176, test len: 3099.0
2021-08-18:15:30:49,78 INFO     [param_server.py:410] Lock worker 1 with localStep 6 , while globalStep is 6

2021-08-18:15:30:49,79 INFO     [param_server.py:441] ====Epoch 7 completes 20 clients with loss 7.011088289988821, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:30:49,92 INFO     [param_server.py:450] ====Start to sample for epoch 7, global virtualClock: 253.3059711013821, round_duration: 23.40723332813029
2021-08-18:15:30:49,93 INFO     [oort.py:208] Training selector: Pacer 5: lastExploitationUtil 1211.2302654958798, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:49,94 INFO     [oort.py:321] scores are 26,{5: 0.014954567917283335, 6: 0.09228312692385117, 7: 0.6383718721815557, 11: 0.10986397003671428, 14: 0.0040535646987992216, 16: 0.1637802368742169, 17: 0.017516031599081154, 25: 0.0020171450203043204, 27: 0.03922657614503148, 35: 0.0017798379740600482, 37: 0.06930356390337909, 38: 0.12466410716273793, 49: 0.02036564611105962, 50: 0.008402574278915076, 51: 0.44609783494690125, 53: 0.2738741858820123, 55: 0.6082309439512003, 58: 0.0036293625569796552, 59: 0.0037557268765611397, 60: 0.0016195563737228858, 65: 0.024132750218631826, 67: 0.0019602083001631085, 70: 0.006148903951906903, 71: 0.03720895801340636, 73: 0.034090342684830015, 76: 0.0018249581897725534, 81: 0.04212393214986846, 82: 0.4062129260557643, 83: 0.2340482995612327, 84: 0.07394409073067332, 85: 0.04709446816227591, 86: 0.0015935673488315348, 87: 0.019130457980889182, 88: 0.00194879689725705, 96: 0.0031085849258867954, 97: 0.12089460560414775, 98: 0.5166177514307265, 99: 0.10354690418204938, 104: 0.0033653123044823383, 105: 0.008337441813697687, 106: 0.009212452587367628, 107: 0.009795370738811255, 110: 0.07570970419621977, 111: 0.0034490586457502953, 118: 0.0515206788736102, 119: 0.00670340421637999},[7, 55, 98, 51, 82, 53, 83, 16, 38, 97, 11, 99, 6, 110, 84, 37, 118, 85, 81, 27, 71, 73, 65, 49, 87, 17, 5, 107, 106, 50, 105, 119, 70, 14, 59, 58, 111, 104, 96, 25, 67, 88, 76, 35, 60, 86]
2021-08-18:15:30:49,95 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:30:49,95 INFO     [oort.py:398] At round 5, UCB exploited 46, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2695.8967118598066, 'duration': 12.029357192292537, 'time_stamp': 6, 'count': 3, 'status': True, 'gradient': 26.358297751414785}, [0.644703790426872, -7.501875468867222e-05]), ({'reward': 1858.5204935348615, 'duration': 8.010998429338052, 'time_stamp': 6, 'count': 5, 'status': True, 'gradient': 20.49582746907316}, [0.44445070946841836, -7.501875468867222e-05]), ({'reward': 1013.7640331142711, 'duration': 6.342067858842259, 'time_stamp': 6, 'count': 4, 'status': True, 'gradient': 64.62769424710318}, [0.24243269157298244, -7.501875468867222e-05])]
2021-08-18:15:30:49,96 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:30:49,414 INFO     [param_server.py:553] For epoch: 7, median_reward: 515.4248333093677, dev: 2577.1241665468388
2021-08-18:15:30:49,969 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4422, Top-1 Accuracy: 430.0/1033 (0.4163), Top-5 Accuracy: 1.0
2021-08-18:15:30:49,971 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 85.0952, eval_time 0.5332, test_loss 2.4422, test_accuracy 0.4163, test_5_accuracy 1.0 

2021-08-18:15:30:49,971 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2946, Top-1 Accuracy: 425.0/1033 (0.4114), Top-5 Accuracy: 1.0
2021-08-18:15:30:49,974 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 85.1096, eval_time 0.5365, test_loss 2.2946, test_accuracy 0.4114, test_5_accuracy 1.0 

2021-08-18:15:30:50,9 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4165, Top-1 Accuracy: 412.0/1033 (0.3988), Top-5 Accuracy: 1.0
2021-08-18:15:30:50,10 INFO     [learner.py:656] After aggregation epoch 6, CumulTime 85.1497, eval_time 0.5734, test_loss 2.4165, test_accuracy 0.3988, test_5_accuracy 1.0 

2021-08-18:15:30:50,80 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:50,83 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:50,91 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:30:50,94 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:30:50,224 INFO     [learner.py:526] ====Start train round 7
2021-08-18:15:30:50,237 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:30:50,782 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:30:50,792 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:30:51,581 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:30:51,590 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:30:52,87 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:30:52,99 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:30:52,397 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:30:52,418 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:30:52,786 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:30:52,801 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:30:52,997 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:30:53,15 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:30:53,359 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:30:53,372 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:30:53,597 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:30:53,618 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:30:53,667 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:30:53,681 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:30:54,80 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:30:54,101 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:30:54,285 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:30:54,299 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:30:54,757 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:30:54,778 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:30:55,101 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:30:55,128 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:30:55,322 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:30:55,348 INFO     [learner.py:606] ====Pushing takes 0.024312734603881836 s
2021-08-18:15:30:55,377 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:55,385 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:30:55,386 INFO     [param_server.py:410] Lock worker 2 with localStep 7 , while globalStep is 6

2021-08-18:15:30:55,961 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:30:55,975 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:30:56,636 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:30:56,658 INFO     [learner.py:606] ====Pushing takes 0.020897865295410156 s
2021-08-18:15:30:56,681 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:56,688 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:30:56,689 INFO     [param_server.py:410] Lock worker 3 with localStep 7 , while globalStep is 6

2021-08-18:15:30:57,534 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:30:57,561 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:30:58,138 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:30:58,161 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:30:58,886 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:30:58,900 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:30:59,413 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:30:59,444 INFO     [learner.py:606] ====Pushing takes 0.028235912322998047 s
2021-08-18:15:30:59,480 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:30:59,488 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:30:59,489 INFO     [param_server.py:381] ====After aggregation in epoch: 6, virtual_clock: 273.6621414765335, top_1: : 40.8842 % (1267.0), top_5: : 100.0 % (3099.0), test loss: 2.3844366117759987, test len: 3099.0
2021-08-18:15:30:59,490 INFO     [param_server.py:410] Lock worker 1 with localStep 7 , while globalStep is 7

2021-08-18:15:30:59,491 INFO     [param_server.py:441] ====Epoch 8 completes 20 clients with loss 5.152498101838429, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:30:59,491 INFO     [param_server.py:450] ====Start to sample for epoch 8, global virtualClock: 273.6621414765335, round_duration: 20.356170375151418
2021-08-18:15:30:59,492 INFO     [oort.py:208] Training selector: Pacer 6: lastExploitationUtil 1592.9005288747662, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:30:59,493 INFO     [oort.py:321] scores are 26,{5: 0.0417780208192538, 6: 0.37030503242965934, 7: 0.15998926352678705, 11: 0.038783464332848204, 14: 0.004277005889107508, 16: 0.15998926352678705, 17: 0.011050731001710109, 25: 0.002128334384407021, 27: 0.034523183598280036, 35: 0.001833285094875958, 37: 0.15903636264705062, 38: 0.13901532046411352, 49: 0.020550236372935505, 50: 0.00886574221579067, 51: 0.5493108698231037, 53: 0.19956343995159695, 55: 1.1599892616587597, 58: 0.0032458398197565876, 59: 0.003358850943295417, 60: 0.0014484142836765901, 65: 0.02435148478066585, 67: 0.001885971836597457, 70: 0.006188082463767228, 71: 0.015814614743079037, 73: 0.03439933093147416, 76: 0.0016472175026748506, 81: 0.25440471561452466, 82: 0.15998926352678705, 83: 0.34256025427966497, 84: 0.0722325284414137, 85: 0.017476653319149733, 86: 0.001425171576301774, 87: 0.01868765085278999, 88: 0.0017589950149599497, 96: 0.0032799368019824932, 97: 0.10415208661316688, 98: 0.3523444427653428, 99: 0.11005273569237503, 104: 0.0030096923391682005, 105: 0.008797019509233306, 106: 0.009720262755635038, 107: 0.00953521016657784, 110: 0.016661642212761906, 111: 0.0036391781630451107, 119: 0.0070729102508264655},[55, 51, 6, 98, 83, 81, 53, 7, 16, 82, 37, 38, 99, 97, 84, 5, 11, 27, 73, 65, 49, 87, 85, 110, 71, 17, 106, 107, 50, 105, 119, 70, 14, 111, 59, 96, 58, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:30:59,493 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:30:59,494 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:30:59,494 INFO     [oort.py:398] At round 6, UCB exploited 45, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5353.25063127702, 'duration': 8.010998429338052, 'time_stamp': 7, 'count': 6, 'status': True, 'gradient': 20.500055398037265}, [1.0, -4.286326618088302e-05]), ({'reward': 3221.138575861453, 'duration': 13.324368782156236, 'time_stamp': 7, 'count': 5, 'status': True, 'gradient': 21.005457693987147}, [0.6017156338955556, -4.286326618088302e-05]), ({'reward': 3392.540299485481, 'duration': 13.411352670399307, 'time_stamp': 7, 'count': 3, 'status': True, 'gradient': 12.927095806860713}, [0.6337339448794496, -4.286326618088302e-05])]
2021-08-18:15:30:59,495 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:30:59,765 INFO     [param_server.py:553] For epoch: 8, median_reward: 589.2414370431828, dev: 2946.2071852159143
2021-08-18:15:31:00,514 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1137, Top-1 Accuracy: 478.0/1033 (0.4627), Top-5 Accuracy: 1.0
2021-08-18:15:31:00,515 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 95.6514, eval_time 0.723, test_loss 2.1137, test_accuracy 0.4627, test_5_accuracy 1.0 

2021-08-18:15:31:00,557 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1308, Top-1 Accuracy: 485.0/1033 (0.4695), Top-5 Accuracy: 1.0
2021-08-18:15:31:00,558 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 95.6974, eval_time 0.7685, test_loss 2.1308, test_accuracy 0.4695, test_5_accuracy 1.0 

2021-08-18:15:31:00,563 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0581, Top-1 Accuracy: 479.0/1033 (0.4637), Top-5 Accuracy: 1.0
2021-08-18:15:31:00,564 INFO     [learner.py:656] After aggregation epoch 7, CumulTime 95.6885, eval_time 0.7715, test_loss 2.0581, test_accuracy 0.4637, test_5_accuracy 1.0 

2021-08-18:15:31:00,580 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:31:00,588 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:00,627 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:31:00,640 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:00,641 INFO     [learner.py:526] ====Start train round 8
2021-08-18:15:31:00,652 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:01,104 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:01,114 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:01,894 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:01,908 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:02,260 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:02,271 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:02,718 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:02,738 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:02,849 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:02,860 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:03,237 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:03,250 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:03,501 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:03,511 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:03,643 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:03,657 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:03,883 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:03,897 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:04,244 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:04,258 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:04,502 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:04,516 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:04,944 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:04,965 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:04,995 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:05,13 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:05,855 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:05,865 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:06,214 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:06,239 INFO     [learner.py:606] ====Pushing takes 0.02336883544921875 s
2021-08-18:15:31:06,277 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:06,285 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:06,315 INFO     [param_server.py:410] Lock worker 2 with localStep 8 , while globalStep is 7

2021-08-18:15:31:06,452 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:06,474 INFO     [learner.py:606] ====Pushing takes 0.02123284339904785 s
2021-08-18:15:31:06,499 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:06,506 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:06,507 INFO     [param_server.py:410] Lock worker 3 with localStep 8 , while globalStep is 7

2021-08-18:15:31:07,38 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:07,58 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:07,700 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:07,727 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:08,545 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:08,572 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:09,166 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:09,191 INFO     [learner.py:606] ====Pushing takes 0.02378249168395996 s
2021-08-18:15:31:09,220 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:09,230 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:09,231 INFO     [param_server.py:381] ====After aggregation in epoch: 7, virtual_clock: 292.2313841908421, top_1: : 46.5311 % (1442.0), top_5: : 100.0 % (3099.0), test loss: 2.100839270485772, test len: 3099.0
2021-08-18:15:31:09,232 INFO     [param_server.py:410] Lock worker 1 with localStep 8 , while globalStep is 8

2021-08-18:15:31:09,233 INFO     [param_server.py:441] ====Epoch 9 completes 20 clients with loss 4.32807326893598, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:09,233 INFO     [param_server.py:450] ====Start to sample for epoch 9, global virtualClock: 292.2313841908421, round_duration: 18.569242714308594
2021-08-18:15:31:09,233 INFO     [oort.py:208] Training selector: Pacer 7: lastExploitationUtil 1370.4942892140252, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:09,234 INFO     [oort.py:321] scores are 26,{5: 0.03237565791937084, 6: 0.08787740199620439, 7: 0.1559611404011634, 11: 0.026314648525690137, 14: 0.004457192434444375, 16: 0.5189356837683624, 17: 0.008563705978753998, 25: 0.0022179992638730315, 27: 0.03076449413282397, 35: 0.0018766081888818874, 37: 0.06599491529943843, 38: 0.029205769782259163, 49: 0.015925297798352132, 50: 0.014852907115964082, 51: 0.08605479505495907, 53: 0.10182484410935477, 55: 1.1559611389519562, 58: 0.0029394680840134834, 59: 0.0030418121950071693, 60: 0.001311699836012201, 65: 0.018871055297197403, 67: 0.0018270144364042828, 70: 0.006221169916434768, 71: 0.06001190548816241, 73: 0.026657580925408028, 76: 0.0015052711138726978, 81: 0.1671340639267309, 82: 0.5670257926473459, 83: 0.07014013986963981, 84: 0.1231280642290801, 85: 0.01703663559645056, 86: 0.001290650985696642, 87: 0.025367032024783465, 88: 0.0016074163740767006, 96: 0.00341811769221171, 97: 0.32570791509718716, 98: 0.11356571312917758, 99: 0.03255482853758225, 104: 0.002725610339683446, 105: 0.009167630304665374, 106: 0.010129768987591613, 107: 0.009329398259507562, 110: 0.025683798587757174, 111: 0.0037924935789569246, 119: 0.007370885819861765},[55, 82, 16, 97, 81, 7, 84, 98, 53, 6, 51, 83, 37, 71, 99, 5, 27, 38, 73, 11, 110, 87, 65, 85, 49, 50, 106, 107, 105, 17, 119, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:31:09,235 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:31:09,235 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:09,236 INFO     [oort.py:398] At round 7, UCB exploited 45, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6900.334942338934, 'duration': 8.010998429338052, 'time_stamp': 8, 'count': 7, 'status': True, 'gradient': 20.50459134497162}, [1.0, -3.750468808601078e-05]), ({'reward': 2504.6522986605137, 'duration': 7.864087706209871, 'time_stamp': 8, 'count': 6, 'status': True, 'gradient': 21.314873533741626}, [0.3629745448164061, -3.750468808601078e-05]), ({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 8, 'count': 5, 'status': True, 'gradient': 11.313577459145183}, [1.4492071125737335e-09, -3.750468808601078e-05])]
2021-08-18:15:31:09,237 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:09,510 INFO     [param_server.py:553] For epoch: 9, median_reward: 554.3273208521125, dev: 2771.6366042605623
2021-08-18:15:31:10,116 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9494, Top-1 Accuracy: 519.0/1033 (0.5024), Top-5 Accuracy: 1.0
2021-08-18:15:31:10,121 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 105.2566, eval_time 0.565, test_loss 1.9494, test_accuracy 0.5024, test_5_accuracy 1.0 

2021-08-18:15:31:10,160 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1389, Top-1 Accuracy: 502.0/1033 (0.486), Top-5 Accuracy: 1.0
2021-08-18:15:31:10,161 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 105.2853, eval_time 0.6051, test_loss 2.1389, test_accuracy 0.486, test_5_accuracy 1.0 

2021-08-18:15:31:10,189 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:31:10,199 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:10,228 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:31:10,240 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.108, Top-1 Accuracy: 499.0/1033 (0.4831), Top-5 Accuracy: 1.0
2021-08-18:15:31:10,241 INFO     [learner.py:656] After aggregation epoch 8, CumulTime 105.3801, eval_time 0.6853, test_loss 2.108, test_accuracy 0.4831, test_5_accuracy 1.0 

2021-08-18:15:31:10,242 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:10,310 INFO     [learner.py:526] ====Start train round 9
2021-08-18:15:31:10,334 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:10,731 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:10,745 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:11,898 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:11,919 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:12,453 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:12,472 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:12,899 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:12,914 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:13,54 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:13,68 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:13,354 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:13,374 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:13,707 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:13,727 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:13,903 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:13,917 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:13,980 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:14,79 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:14,737 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:14,751 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:14,874 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:14,894 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:15,40 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:15,54 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:15,687 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:15,708 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:16,207 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:16,233 INFO     [learner.py:606] ====Pushing takes 0.024845600128173828 s
2021-08-18:15:31:16,273 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:16,281 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:16,282 INFO     [param_server.py:410] Lock worker 2 with localStep 9 , while globalStep is 8

2021-08-18:15:31:16,490 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:16,504 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:17,43 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:17,65 INFO     [learner.py:606] ====Pushing takes 0.020670175552368164 s
2021-08-18:15:31:17,90 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:17,97 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:17,97 INFO     [param_server.py:410] Lock worker 3 with localStep 9 , while globalStep is 8

2021-08-18:15:31:17,271 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:17,285 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:17,884 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:17,911 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:18,579 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:18,599 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:19,223 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:19,248 INFO     [learner.py:606] ====Pushing takes 0.023973941802978516 s
2021-08-18:15:31:19,286 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:19,293 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:19,294 INFO     [param_server.py:381] ====After aggregation in epoch: 8, virtual_clock: 313.2596155958753, top_1: : 49.0481 % (1520.0), top_5: : 100.0 % (3099.0), test loss: 2.0654206805759006, test len: 3099.0
2021-08-18:15:31:19,295 INFO     [param_server.py:410] Lock worker 1 with localStep 9 , while globalStep is 9

2021-08-18:15:31:19,296 INFO     [param_server.py:441] ====Epoch 10 completes 20 clients with loss 4.405500614488925, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:19,296 INFO     [param_server.py:450] ====Start to sample for epoch 10, global virtualClock: 313.2596155958753, round_duration: 21.0282314050332
2021-08-18:15:31:19,297 INFO     [oort.py:208] Training selector: Pacer 8: lastExploitationUtil 1268.6629284665066, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:19,298 INFO     [oort.py:321] scores are 26,{5: 0.04215965751542405, 6: 0.2347117871543537, 7: 0.35263138291880375, 11: 0.1608741162647776, 14: 0.004607584968335858, 16: 0.1520029827366849, 17: 0.01197481151687109, 25: 0.0022928379744200067, 27: 0.041686049944788806, 35: 0.002004220596080785, 37: 0.48746975633633116, 38: 0.06358916146618054, 49: 0.02073796006498916, 50: 0.01934149040853281, 51: 0.08387079944082228, 53: 0.09924061840986914, 55: 0.6655935934506634, 58: 0.0038787505916327092, 59: 0.004013797909623954, 60: 0.001730842577487742, 65: 0.026387796459736688, 67: 0.002151074447221959, 70: 0.006862607792888494, 71: 0.023902207663128516, 73: 0.03471356427115176, 76: 0.0019567433097525447, 81: 0.06395102787702851, 82: 0.4889693809217345, 83: 0.06836004431828323, 84: 0.49658372157784897, 85: 0.01660426064978394, 86: 0.0017030677426260591, 87: 0.08800660351926475, 88: 0.002089524742070669, 96: 0.0035334502448065835, 97: 0.13205599562162126, 98: 0.06747617533398785, 99: 0.21625131015600005, 104: 0.003596556388927577, 105: 0.009476960263283337, 106: 0.01047156298643411, 107: 0.011190426189735023, 110: 0.015829932945514377, 111: 0.003920458152178292, 119: 0.01543025078409335},[55, 84, 82, 37, 7, 6, 99, 11, 16, 97, 53, 87, 51, 83, 98, 81, 38, 5, 27, 73, 65, 71, 49, 50, 85, 110, 119, 17, 107, 106, 105, 70, 14, 59, 111, 58, 104, 96, 25, 67, 88, 35, 76, 60, 86]
2021-08-18:15:31:19,299 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:31:19,299 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:19,300 INFO     [oort.py:398] At round 8, UCB exploited 45, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 7.864087706209871, 'time_stamp': 9, 'count': 7, 'status': True, 'gradient': 21.316022564962417}, [2.441347128668746e-09, -3.3337037448605424e-05]), ({'reward': 821.8038277852044, 'duration': 5.8943907365129, 'time_stamp': 9, 'count': 6, 'status': True, 'gradient': 20.61123628672176}, [0.20062840262346598, -3.3337037448605424e-05]), ({'reward': 2463.574973934762, 'duration': 26.145070720211294, 'time_stamp': 9, 'count': 5, 'status': True, 'gradient': 11.31568818446167}, [0.6014417299818242, -3.3337037448605424e-05])]
2021-08-18:15:31:19,301 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 71, 5, 27]
2021-08-18:15:31:19,602 INFO     [param_server.py:553] For epoch: 10, median_reward: 550.9066186210792, dev: 2754.5330931053963
2021-08-18:15:31:20,357 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0726, Top-1 Accuracy: 485.0/1033 (0.4695), Top-5 Accuracy: 1.0
2021-08-18:15:31:20,357 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 115.4819, eval_time 0.7084, test_loss 2.0726, test_accuracy 0.4695, test_5_accuracy 1.0 

2021-08-18:15:31:20,366 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9742, Top-1 Accuracy: 481.0/1033 (0.4656), Top-5 Accuracy: 1.0
2021-08-18:15:31:20,366 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 115.5023, eval_time 0.7195, test_loss 1.9742, test_accuracy 0.4656, test_5_accuracy 1.0 

2021-08-18:15:31:20,424 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:31:20,432 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:20,433 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:31:20,442 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:20,492 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.028, Top-1 Accuracy: 495.0/1033 (0.4792), Top-5 Accuracy: 1.0
2021-08-18:15:31:20,493 INFO     [learner.py:656] After aggregation epoch 9, CumulTime 115.6321, eval_time 0.8461, test_loss 2.028, test_accuracy 0.4792, test_5_accuracy 1.0 

2021-08-18:15:31:20,561 INFO     [learner.py:526] ====Start train round 10
2021-08-18:15:31:20,592 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:20,983 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:20,992 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:21,951 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:21,960 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:22,664 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:22,675 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:23,248 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:23,257 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:23,271 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:23,280 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:23,864 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:23,874 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:23,900 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:23,956 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:24,9 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:24,36 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:24,579 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:24,606 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:25,19 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:25,33 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:25,411 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:25,431 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:26,763 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:26,768 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:26,775 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:26,784 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:26,784 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:26,789 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:31:27,362 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:31:27,391 INFO     [learner.py:606] ====Pushing takes 0.02711200714111328 s
2021-08-18:15:31:27,397 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:27,411 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:31:27,429 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:27,439 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:27,439 INFO     [param_server.py:410] Lock worker 2 with localStep 10 , while globalStep is 9

2021-08-18:15:31:27,907 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:31:27,934 INFO     [learner.py:606] ====Pushing takes 0.02552652359008789 s
2021-08-18:15:31:27,962 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:27,973 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:31:27,974 INFO     [param_server.py:410] Lock worker 3 with localStep 10 , while globalStep is 9

2021-08-18:15:31:29,60 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:29,75 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:29,732 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:29,746 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:30,383 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:30,405 INFO     [learner.py:606] ====Pushing takes 0.02131366729736328 s
2021-08-18:15:31:30,432 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:30,439 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:30,440 INFO     [param_server.py:381] ====After aggregation in epoch: 9, virtual_clock: 337.15752455186805, top_1: : 47.1442 % (1461.0), top_5: : 100.0 % (3099.0), test loss: 2.024931240964819, test len: 3099.0
2021-08-18:15:31:30,441 INFO     [param_server.py:410] Lock worker 1 with localStep 10 , while globalStep is 10

2021-08-18:15:31:30,441 INFO     [param_server.py:441] ====Epoch 11 completes 20 clients with loss 4.411716865136943, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:31:30,441 INFO     [param_server.py:450] ====Start to sample for epoch 11, global virtualClock: 337.15752455186805, round_duration: 23.89790895599279
2021-08-18:15:31:30,442 INFO     [oort.py:208] Training selector: Pacer 9: lastExploitationUtil 1246.2943131597353, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:30,443 INFO     [oort.py:321] scores are 26,{5: 0.013534730212551603, 6: 0.08352145197331001, 7: 0.14823038234882108, 11: 0.0926749109410086, 14: 0.004736278344490326, 16: 0.14823038234882108, 17: 0.008432498828326333, 25: 0.002356878693586947, 27: 0.012823328649087924, 35: 0.0019990273912167565, 37: 0.1668666696528583, 38: 0.04624623974880088, 49: 0.015681301455061306, 50: 0.014625341197296709, 51: 0.0817891889039487, 53: 0.09677754045729052, 55: 0.43389534885130276, 58: 0.003187756934058289, 59: 0.0032987457729079022, 60: 0.0014224955427792406, 65: 0.018581926105087, 67: 0.0019614768509670804, 70: 0.006643701680629665, 71: 0.0844328331052239, 76: 0.0016301597778395462, 81: 0.03812454229997373, 82: 0.6016153248527971, 83: 0.15459950647421786, 84: 0.06692358645116309, 85: 0.01706803033079573, 86: 0.0013996687534998133, 87: 0.13411980267152018, 88: 0.0017407797805400046, 96: 0.0036321422156770037, 97: 0.2393904753312953, 98: 0.0658014671101529, 99: 0.034110130625993815, 104: 0.0029558352094790153, 105: 0.009741659019865175, 106: 0.010764041758632444, 107: 0.008461798843373348, 110: 0.016272075062373687, 111: 0.004029959548408831, 119: 0.012056263949144165},[82, 55, 97, 37, 83, 7, 16, 87, 53, 11, 71, 6, 51, 84, 98, 38, 81, 99, 65, 85, 110, 49, 50, 5, 27, 119, 106, 105, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:31:30,444 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:31:30,444 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:30,445 INFO     [oort.py:398] At round 9, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2812.449649681054, 'duration': 6.342067858842259, 'time_stamp': 10, 'count': 8, 'status': True, 'gradient': 66.28721054586929}, [0.453384944116046, -3.0003000300030024e-05]), ({'reward': 1246.2992983369886, 'duration': 42.162959759266826, 'time_stamp': 10, 'count': 7, 'status': True, 'gradient': 18.891557168113064}, [0.20091055339365782, -3.0003000300030024e-05]), ({'reward': 2487.7026440759882, 'duration': 21.753601635627824, 'time_stamp': 10, 'count': 7, 'status': True, 'gradient': 20.614496331812166}, [0.40103345544275537, -3.0003000300030024e-05])]
2021-08-18:15:31:30,445 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:30,732 INFO     [param_server.py:553] For epoch: 11, median_reward: 523.8836239119197, dev: 2619.4181195595984
2021-08-18:15:31:31,307 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9646, Top-1 Accuracy: 521.0/1033 (0.5044), Top-5 Accuracy: 1.0
2021-08-18:15:31:31,308 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 126.4331, eval_time 0.5519, test_loss 1.9646, test_accuracy 0.5044, test_5_accuracy 1.0 

2021-08-18:15:31:31,312 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0047, Top-1 Accuracy: 520.0/1033 (0.5034), Top-5 Accuracy: 1.0
2021-08-18:15:31:31,316 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 126.4516, eval_time 0.5597, test_loss 2.0047, test_accuracy 0.5034, test_5_accuracy 1.0 

2021-08-18:15:31:31,349 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8903, Top-1 Accuracy: 517.0/1033 (0.5005), Top-5 Accuracy: 1.0
2021-08-18:15:31:31,350 INFO     [learner.py:656] After aggregation epoch 10, CumulTime 126.4896, eval_time 0.5946, test_loss 1.8903, test_accuracy 0.5005, test_5_accuracy 1.0 

2021-08-18:15:31:31,377 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:31,382 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:31,385 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:31,391 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:31,418 INFO     [learner.py:526] ====Start train round 11
2021-08-18:15:31:31,440 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:31,890 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:31,902 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:32,877 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:32,889 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:33,14 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:33,25 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:33,581 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:33,595 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:34,7 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:34,33 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:34,39 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:34,53 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:34,73 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:34,88 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:34,678 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:34,685 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:34,692 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:34,698 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:35,229 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:35,243 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:35,401 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:35,422 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:35,446 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:35,473 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:36,33 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:36,59 INFO     [learner.py:606] ====Pushing takes 0.02472972869873047 s
2021-08-18:15:31:36,90 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:36,98 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:36,99 INFO     [param_server.py:410] Lock worker 2 with localStep 11 , while globalStep is 10

2021-08-18:15:31:36,929 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:36,950 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:36,956 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:36,983 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:37,542 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:37,573 INFO     [learner.py:606] ====Pushing takes 0.027162790298461914 s
2021-08-18:15:31:37,606 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:37,612 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:37,613 INFO     [param_server.py:410] Lock worker 3 with localStep 11 , while globalStep is 10

2021-08-18:15:31:38,822 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:38,841 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:39,363 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:39,377 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:40,9 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:40,24 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:40,642 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:40,667 INFO     [learner.py:606] ====Pushing takes 0.024228572845458984 s
2021-08-18:15:31:40,696 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:40,704 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:40,705 INFO     [param_server.py:381] ====After aggregation in epoch: 10, virtual_clock: 357.51369492701946, top_1: : 50.2743 % (1558.0), top_5: : 100.0 % (3099.0), test loss: 1.9531772180839821, test len: 3099.0
2021-08-18:15:31:40,705 INFO     [param_server.py:410] Lock worker 1 with localStep 11 , while globalStep is 11

2021-08-18:15:31:40,706 INFO     [param_server.py:441] ====Epoch 12 completes 20 clients with loss 3.1993245099829903, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:40,706 INFO     [param_server.py:450] ====Start to sample for epoch 12, global virtualClock: 357.51369492701946, round_duration: 20.356170375151418
2021-08-18:15:31:40,707 INFO     [oort.py:208] Training selector: Pacer 10: lastExploitationUtil 1267.671595839012, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:40,707 INFO     [oort.py:321] scores are 26,{5: 0.013855436888672324, 6: 0.2951853001267827, 7: 0.359897373667612, 11: 0.02441139955789005, 14: 0.0048485048916720895, 16: 1.0538682122100735, 17: 0.009437874786958548, 25: 0.002412725149454792, 27: 0.033805100807596966, 35: 0.002066228814691077, 37: 0.20219211652972208, 38: 0.02709341585370013, 49: 0.0175509256084645, 50: 0.016491043150679462, 51: 0.07983074461010126, 53: 0.09446019968864987, 55: 1.1446809999775067, 58: 0.0035224617018384066, 59: 0.0036451040306817034, 60: 0.0015718532416763272, 65: 0.020797381114505933, 67: 0.002088908742732558, 70: 0.006934250384309311, 71: 0.021052597908346463, 76: 0.0017923967901787884, 81: 0.03721164912517267, 82: 0.1446810019187645, 83: 0.44699518156379664, 84: 0.4256288684399429, 85: 0.015804433726755236, 86: 0.0015466297090557413, 87: 0.016899559315972604, 88: 0.0019140259338156437, 96: 0.003718206156621846, 97: 0.04528287032930574, 98: 0.12723574569519136, 99: 0.07767724193805568, 104: 0.0032661889026401386, 105: 0.01624218242623881, 106: 0.017946792176860675, 107: 0.009541239959874045, 110: 0.01506740537342846, 111: 0.004125449807912554, 119: 0.013575640140882942},[55, 16, 83, 84, 7, 6, 37, 82, 98, 53, 51, 99, 97, 81, 27, 38, 11, 71, 65, 106, 49, 87, 50, 105, 85, 110, 5, 119, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:31:40,708 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:31:40,708 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:40,709 INFO     [oort.py:398] At round 10, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 26.145070720211294, 'time_stamp': 11, 'count': 7, 'status': True, 'gradient': 8.086771630611885}, [1.9412576801292453e-09, -2.72752068369852e-05]), ({'reward': 1108.6540195539112, 'duration': 5.8943907365129, 'time_stamp': 11, 'count': 8, 'status': True, 'gradient': 20.620185835712423}, [0.21521637369010516, -2.72752068369852e-05]), ({'reward': 4374.70853729695, 'duration': 13.324368782156236, 'time_stamp': 11, 'count': 9, 'status': True, 'gradient': 21.025487621521133}, [0.8492417153190803, -2.72752068369852e-05])]
2021-08-18:15:31:40,710 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 5]
2021-08-18:15:31:40,981 INFO     [param_server.py:553] For epoch: 12, median_reward: 559.6725772221126, dev: 2798.362886110563
2021-08-18:15:31:41,623 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0561, Top-1 Accuracy: 488.0/1033 (0.4724), Top-5 Accuracy: 1.0
2021-08-18:15:31:41,624 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 136.7596, eval_time 0.6272, test_loss 2.0561, test_accuracy 0.4724, test_5_accuracy 1.0 

2021-08-18:15:31:41,626 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9804, Top-1 Accuracy: 494.0/1033 (0.4782), Top-5 Accuracy: 1.0
2021-08-18:15:31:41,628 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 136.7522, eval_time 0.6312, test_loss 1.9804, test_accuracy 0.4782, test_5_accuracy 1.0 

2021-08-18:15:31:41,691 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:41,693 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:41,699 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:41,701 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:41,710 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8335, Top-1 Accuracy: 507.0/1033 (0.4908), Top-5 Accuracy: 1.0
2021-08-18:15:31:41,712 INFO     [learner.py:656] After aggregation epoch 11, CumulTime 136.8508, eval_time 0.7159, test_loss 1.8335, test_accuracy 0.4908, test_5_accuracy 1.0 

2021-08-18:15:31:41,764 INFO     [learner.py:526] ====Start train round 12
2021-08-18:15:31:41,785 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:42,305 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:42,314 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:43,357 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:43,366 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:43,625 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:43,634 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:44,301 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:44,310 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:44,425 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:44,445 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:44,608 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:44,618 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:44,852 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:44,861 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:45,283 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:45,293 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:45,574 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:45,594 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:45,899 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:45,920 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:45,984 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:45,998 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:46,487 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:46,507 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:31:47,47 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:31:47,73 INFO     [learner.py:606] ====Pushing takes 0.024222373962402344 s
2021-08-18:15:31:47,85 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:47,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:47,110 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:31:47,110 INFO     [param_server.py:410] Lock worker 2 with localStep 12 , while globalStep is 11

2021-08-18:15:31:47,112 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:47,231 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:47,251 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:47,831 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:47,854 INFO     [learner.py:606] ====Pushing takes 0.02134847640991211 s
2021-08-18:15:31:47,879 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:47,888 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:47,889 INFO     [param_server.py:410] Lock worker 3 with localStep 12 , while globalStep is 11

2021-08-18:15:31:49,325 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:49,351 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:49,987 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:50,8 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:50,753 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:50,780 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:31:51,489 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:31:51,510 INFO     [learner.py:606] ====Pushing takes 0.018877267837524414 s
2021-08-18:15:31:51,537 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:51,544 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:31:51,545 INFO     [param_server.py:381] ====After aggregation in epoch: 11, virtual_clock: 377.93023520844935, top_1: : 48.0478 % (1489.0), top_5: : 100.0 % (3099.0), test loss: 1.9566549680851126, test len: 3099.0
2021-08-18:15:31:51,546 INFO     [param_server.py:410] Lock worker 1 with localStep 12 , while globalStep is 12

2021-08-18:15:31:51,546 INFO     [param_server.py:441] ====Epoch 13 completes 20 clients with loss 3.429947319207651, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:31:51,547 INFO     [param_server.py:450] ====Start to sample for epoch 13, global virtualClock: 377.93023520844935, round_duration: 20.416540281429864
2021-08-18:15:31:51,547 INFO     [oort.py:208] Training selector: Pacer 11: lastExploitationUtil 1603.91530334564, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:31:51,548 INFO     [oort.py:321] scores are 26,{5: 0.012907343351799586, 6: 0.33300101104791807, 7: 0.6540144453231259, 11: 0.10482174983127529, 14: 0.004947833757125646, 16: 0.14135933336672496, 17: 0.009232249932324453, 25: 0.002462153428140929, 27: 0.03790824145760201, 35: 0.002099676348126954, 37: 0.059816164515891834, 38: 0.06219381880949333, 49: 0.019681193366551514, 50: 0.016148575048037784, 51: 0.07799794506945276, 53: 0.7451775211789109, 55: 1.0885116410556188, 58: 0.003478562041386459, 59: 0.0035996759060336948, 60: 0.0015522635826734003, 65: 0.023321691879034084, 67: 0.0020954498616020476, 70: 0.007016692159637921, 71: 0.021030702178166046, 76: 0.0017737612104204586, 81: 0.036357322966040745, 82: 0.37496789917991136, 83: 0.07884997426604087, 84: 0.06382142053026986, 85: 0.0971791851516926, 86: 0.001527354405356341, 87: 0.01651156964228544, 88: 0.00189412577379272, 96: 0.0037943791640357477, 97: 0.04424324049315493, 98: 0.13268471650916863, 99: 0.11311210156611724, 104: 0.00322548311335562, 105: 0.018213599678836418, 106: 0.02012510878467629, 107: 0.009343097834112133, 110: 0.0962396586563303, 111: 0.004209965809603526, 119: 0.014643954777828969},[55, 53, 7, 82, 6, 16, 98, 99, 11, 85, 110, 83, 51, 84, 38, 37, 97, 27, 81, 65, 71, 106, 49, 105, 87, 50, 119, 5, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:31:51,549 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:31:51,549 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:31:51,550 INFO     [oort.py:398] At round 11, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5117.773136492849, 'duration': 8.010998429338052, 'time_stamp': 12, 'count': 11, 'status': True, 'gradient': 20.524818178659086}, [0.9471523095396092, -2.5002083506958932e-05]), ({'reward': 5403.325903340787, 'duration': 11.058674649423494, 'time_stamp': 12, 'count': 9, 'status': True, 'gradient': 12.94223056361702}, [1.0, -2.5002083506958932e-05]), ({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 12, 'count': 9, 'status': True, 'gradient': 12.942889793057072}, [1.850715405203237e-09, -2.5002083506958932e-05])]
2021-08-18:15:31:51,551 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:31:51,824 INFO     [param_server.py:553] For epoch: 13, median_reward: 635.4492855827873, dev: 3177.2464279139367
2021-08-18:15:31:52,420 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.27, Top-1 Accuracy: 522.0/1033 (0.5053), Top-5 Accuracy: 1.0
2021-08-18:15:31:52,422 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 147.5584, eval_time 0.5629, test_loss 2.27, test_accuracy 0.5053, test_5_accuracy 1.0 

2021-08-18:15:31:52,469 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0952, Top-1 Accuracy: 523.0/1033 (0.5063), Top-5 Accuracy: 1.0
2021-08-18:15:31:52,474 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 147.5984, eval_time 0.6127, test_loss 2.0952, test_accuracy 0.5063, test_5_accuracy 1.0 

2021-08-18:15:31:52,475 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.963, Top-1 Accuracy: 515.0/1033 (0.4985), Top-5 Accuracy: 1.0
2021-08-18:15:31:52,476 INFO     [learner.py:656] After aggregation epoch 12, CumulTime 147.6151, eval_time 0.6177, test_loss 1.963, test_accuracy 0.4985, test_5_accuracy 1.0 

2021-08-18:15:31:52,492 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:52,503 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:31:52,544 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:52,544 INFO     [learner.py:526] ====Start train round 13
2021-08-18:15:31:52,556 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:31:52,557 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:31:53,116 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:31:53,125 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:31:53,989 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:31:54,3 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:31:54,493 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:31:54,518 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:31:54,946 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:31:54,956 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:31:55,120 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:31:55,134 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:31:55,297 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:31:55,309 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:31:55,730 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:31:55,744 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:31:55,815 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:31:55,825 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:31:55,863 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:31:55,878 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:31:56,316 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:31:56,330 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:31:56,403 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:31:56,417 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:31:56,952 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:31:56,965 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:31:57,545 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:31:57,548 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:31:57,565 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:31:57,569 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:31:58,52 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:31:58,77 INFO     [learner.py:606] ====Pushing takes 0.023198604583740234 s
2021-08-18:15:31:58,112 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:58,119 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:31:58,119 INFO     [param_server.py:410] Lock worker 3 with localStep 13 , while globalStep is 12

2021-08-18:15:31:58,654 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:31:58,680 INFO     [learner.py:606] ====Pushing takes 0.024254560470581055 s
2021-08-18:15:31:58,686 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:31:58,707 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:31:58,709 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:31:58,717 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:31:58,717 INFO     [param_server.py:410] Lock worker 2 with localStep 13 , while globalStep is 12

2021-08-18:15:31:59,293 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:31:59,314 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:31:59,935 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:31:59,962 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:00,572 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:00,595 INFO     [learner.py:606] ====Pushing takes 0.021167993545532227 s
2021-08-18:15:32:00,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:00,632 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:00,633 INFO     [param_server.py:381] ====After aggregation in epoch: 12, virtual_clock: 396.90264380724307, top_1: : 50.3388 % (1560.0), top_5: : 100.0 % (3099.0), test loss: 2.109420553953559, test len: 3099.0
2021-08-18:15:32:00,634 INFO     [param_server.py:410] Lock worker 1 with localStep 13 , while globalStep is 13

2021-08-18:15:32:00,634 INFO     [param_server.py:441] ====Epoch 14 completes 20 clients with loss 3.6614253478795993, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:00,635 INFO     [param_server.py:450] ====Start to sample for epoch 14, global virtualClock: 396.90264380724307, round_duration: 18.972408598793734
2021-08-18:15:32:00,635 INFO     [oort.py:208] Training selector: Pacer 12: lastExploitationUtil 1655.9536485176493, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:00,636 INFO     [oort.py:321] scores are 26,{5: 0.037856625198907916, 6: 0.3643138671910294, 7: 0.6300700237932716, 11: 0.02332730350039416, 14: 0.005036803780262529, 16: 0.2795411532534313, 17: 0.008739393848498263, 25: 0.002506426913661526, 27: 0.03586683582512442, 35: 0.002122763731394834, 37: 0.14223980212866102, 38: 0.025890213012280106, 49: 0.018621336790579913, 50: 0.017367398037240304, 51: 0.21670965392601507, 53: 0.7304528283918766, 55: 0.13825580276528163, 58: 0.003349446074352027, 59: 0.0034660644797925117, 60: 0.0014946472425924496, 65: 0.02190406064402538, 67: 0.0020732605997226365, 70: 0.0070444123515421096, 71: 0.015393369288205689, 76: 0.0017142420119880596, 81: 0.051944287989676034, 82: 0.13825580276528163, 83: 0.14766251247557186, 84: 0.5139038252559992, 85: 0.0644600790166994, 86: 0.0014706626348185117, 87: 0.08082861433045514, 88: 0.0018305676989380068, 96: 0.0038626082150882805, 97: 0.04327188439301471, 98: 0.06137361662495786, 99: 0.02885907311123995, 104: 0.0031057608354777898, 105: 0.01723277483594167, 106: 0.018901784895093764, 107: 0.008861094984035771, 110: 0.0847672794843139, 111: 0.004285667777719472, 119: 0.013855359722618033},[53, 7, 84, 6, 16, 51, 83, 37, 55, 82, 110, 87, 85, 98, 81, 97, 5, 27, 99, 38, 11, 65, 106, 49, 50, 105, 71, 119, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:32:00,656 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:32:00,657 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:00,657 INFO     [oort.py:398] At round 12, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1185.8315083273935, 'duration': 13.73645665746006, 'time_stamp': 13, 'count': 10, 'status': True, 'gradient': 9.7089266530671}, [0.19788951630815124, -2.3078698361412436e-05]), ({'reward': 4049.0401320265637, 'duration': 27.689063957948644, 'time_stamp': 13, 'count': 9, 'status': True, 'gradient': 19.92430617871526}, [0.6757008571179778, -2.3078698361412436e-05]), ({'reward': 2947.1286609312697, 'duration': 5.8943907365129, 'time_stamp': 13, 'count': 10, 'status': True, 'gradient': 20.630976507162067}, [0.49181422269678676, -2.3078698361412436e-05])]
2021-08-18:15:32:00,658 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 11, 87, 85, 110, 71, 27]
2021-08-18:15:32:00,926 INFO     [param_server.py:553] For epoch: 14, median_reward: 660.1385314518951, dev: 3300.6926572594757
2021-08-18:15:32:01,622 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0076, Top-1 Accuracy: 482.0/1033 (0.4666), Top-5 Accuracy: 1.0
2021-08-18:15:32:01,622 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 156.7584, eval_time 0.6603, test_loss 2.0076, test_accuracy 0.4666, test_5_accuracy 1.0 

2021-08-18:15:32:01,623 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1093, Top-1 Accuracy: 513.0/1033 (0.4966), Top-5 Accuracy: 1.0
2021-08-18:15:32:01,624 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 156.7485, eval_time 0.6617, test_loss 2.1093, test_accuracy 0.4966, test_5_accuracy 1.0 

2021-08-18:15:32:01,676 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:32:01,684 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:01,692 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:32:01,699 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:01,743 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0039, Top-1 Accuracy: 517.0/1033 (0.5005), Top-5 Accuracy: 1.0
2021-08-18:15:32:01,744 INFO     [learner.py:656] After aggregation epoch 13, CumulTime 156.8829, eval_time 0.7836, test_loss 2.0039, test_accuracy 0.5005, test_5_accuracy 1.0 

2021-08-18:15:32:01,800 INFO     [learner.py:526] ====Start train round 14
2021-08-18:15:32:01,827 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:02,198 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:02,208 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:03,709 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:03,736 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:04,20 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:04,31 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:04,616 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:04,630 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:04,960 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:04,988 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:05,475 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:05,509 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:06,204 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:06,231 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:06,258 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:06,279 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:06,537 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:06,551 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:06,916 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:06,936 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:07,530 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:07,549 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:07,838 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:07,858 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:08,72 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:08,93 INFO     [learner.py:606] ====Pushing takes 0.019701719284057617 s
2021-08-18:15:32:08,119 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:08,129 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:32:08,129 INFO     [param_server.py:410] Lock worker 2 with localStep 14 , while globalStep is 13

2021-08-18:15:32:08,888 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:08,906 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:09,463 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:09,477 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:32:09,990 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:10,0 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:10,79 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:32:10,106 INFO     [learner.py:606] ====Pushing takes 0.025871992111206055 s
2021-08-18:15:32:10,135 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:10,143 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:10,143 INFO     [param_server.py:410] Lock worker 3 with localStep 14 , while globalStep is 13

2021-08-18:15:32:10,545 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:10,559 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:11,80 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:11,89 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:11,672 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:11,695 INFO     [learner.py:606] ====Pushing takes 0.022187232971191406 s
2021-08-18:15:32:11,725 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:11,733 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:11,734 INFO     [param_server.py:381] ====After aggregation in epoch: 13, virtual_clock: 420.3019184540767, top_1: : 48.7899 % (1512.0), top_5: : 100.0 % (3099.0), test loss: 2.040251859912166, test len: 3099.0
2021-08-18:15:32:11,735 INFO     [param_server.py:410] Lock worker 1 with localStep 14 , while globalStep is 14

2021-08-18:15:32:11,735 INFO     [param_server.py:441] ====Epoch 15 completes 20 clients with loss 3.5247295415317423, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:11,736 INFO     [param_server.py:450] ====Start to sample for epoch 15, global virtualClock: 420.3019184540767, round_duration: 23.399274646833632
2021-08-18:15:32:11,736 INFO     [oort.py:208] Training selector: Pacer 13: lastExploitationUtil 1325.3607150343203, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:11,737 INFO     [oort.py:321] scores are 26,{5: 0.02926454307291461, 6: 0.07626691682292783, 7: 0.13535533655282908, 11: 0.03902019360951134, 14: 0.005117282460033002, 16: 0.27451582121224194, 17: 0.007016751927231925, 25: 0.002546474915155383, 27: 0.02143664517408847, 35: 0.0021152220365623867, 37: 0.05727557485251822, 38: 0.0263038900181021, 49: 0.012551161083203307, 50: 0.011705980768887837, 51: 0.07468511525811995, 53: 0.08837160339049598, 55: 0.30657404087884, 58: 0.0028612214065559293, 59: 0.002960841185659041, 60: 0.0012767832623137936, 65: 0.01487279282586917, 67: 0.0019371687230339389, 70: 0.0068786973219169, 71: 0.031320216549477586, 76: 0.0014832507465328364, 81: 0.1723814394336896, 82: 0.13535533655282908, 83: 0.06087312655894623, 84: 0.512594312595235, 85: 0.014785731490254427, 86: 0.0012562947183374841, 87: 0.08741146617988098, 88: 0.0015839017402681688, 96: 0.003924325451491062, 97: 0.052936863723204185, 98: 0.06008606053113575, 99: 0.028253639091056684, 104: 0.0026530564125685136, 105: 0.011615241983373232, 106: 0.012834256412659839, 107: 0.00716544035593621, 110: 0.014096209580048575, 111: 0.004354144711408933, 119: 0.009338795259440143},[84, 55, 16, 81, 7, 82, 53, 87, 6, 51, 83, 98, 37, 97, 11, 71, 5, 99, 38, 27, 65, 85, 110, 106, 49, 50, 105, 119, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:32:11,738 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:32:11,739 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:11,739 INFO     [oort.py:398] At round 13, UCB exploited 44, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 14, 'count': 11, 'status': True, 'gradient': 20.633189942593276}, [1.0872074360612502e-09, -2.14301021501536e-05]), ({'reward': 9197.886741310429, 'duration': 13.298442137908651, 'time_stamp': 14, 'count': 11, 'status': True, 'gradient': 14.565910510490973}, [1.0, -2.14301021501536e-05]), ({'reward': 0.01, 'duration': 6.342067858842259, 'time_stamp': 14, 'count': 12, 'status': True, 'gradient': 64.73203131585495}, [1.0872074360612502e-09, -2.14301021501536e-05])]
2021-08-18:15:32:11,740 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:32:12,7 INFO     [param_server.py:553] For epoch: 15, median_reward: 575.5775126453025, dev: 2877.8875632265126
2021-08-18:15:32:12,621 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2491, Top-1 Accuracy: 556.0/1033 (0.5382), Top-5 Accuracy: 1.0
2021-08-18:15:32:12,622 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 167.7577, eval_time 0.5908, test_loss 2.2491, test_accuracy 0.5382, test_5_accuracy 1.0 

2021-08-18:15:32:12,617 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1878, Top-1 Accuracy: 551.0/1033 (0.5334), Top-5 Accuracy: 1.0
2021-08-18:15:32:12,628 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 167.7523, eval_time 0.5945, test_loss 2.1878, test_accuracy 0.5334, test_5_accuracy 1.0 

2021-08-18:15:32:12,691 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:32:12,696 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:32:12,700 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2362, Top-1 Accuracy: 539.0/1033 (0.5218), Top-5 Accuracy: 1.0
2021-08-18:15:32:12,700 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:12,700 INFO     [learner.py:656] After aggregation epoch 14, CumulTime 167.8397, eval_time 0.6695, test_loss 2.2362, test_accuracy 0.5218, test_5_accuracy 1.0 

2021-08-18:15:32:12,704 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:12,771 INFO     [learner.py:526] ====Start train round 15
2021-08-18:15:32:12,791 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:13,252 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:13,262 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:14,330 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:14,339 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:14,465 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:14,474 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:14,982 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:14,992 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:15,345 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:15,373 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:15,479 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:15,493 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:15,517 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:15,530 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:16,60 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:16,80 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:16,84 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:16,98 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:16,596 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:16,608 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:16,616 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:16,635 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:16,711 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:16,738 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:17,355 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:17,378 INFO     [learner.py:606] ====Pushing takes 0.021623849868774414 s
2021-08-18:15:32:17,417 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:17,425 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:17,425 INFO     [param_server.py:410] Lock worker 2 with localStep 15 , while globalStep is 14

2021-08-18:15:32:18,57 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:18,91 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:18,131 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:18,165 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:18,798 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:18,822 INFO     [learner.py:606] ====Pushing takes 0.022214651107788086 s
2021-08-18:15:32:18,848 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:18,855 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:18,856 INFO     [param_server.py:410] Lock worker 3 with localStep 15 , while globalStep is 14

2021-08-18:15:32:20,102 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:20,123 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:20,745 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:20,766 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:21,470 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:21,483 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:22,144 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:22,169 INFO     [learner.py:606] ====Pushing takes 0.023273468017578125 s
2021-08-18:15:32:22,201 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:22,208 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:22,209 INFO     [param_server.py:381] ====After aggregation in epoch: 14, virtual_clock: 440.0573202194594, top_1: : 53.1139 % (1646.0), top_5: : 100.0 % (3099.0), test loss: 2.2243600068268954, test len: 3099.0
2021-08-18:15:32:22,210 INFO     [param_server.py:410] Lock worker 1 with localStep 15 , while globalStep is 15

2021-08-18:15:32:22,211 INFO     [param_server.py:441] ====Epoch 16 completes 20 clients with loss 4.579724530911175, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:22,211 INFO     [param_server.py:450] ====Start to sample for epoch 16, global virtualClock: 440.0573202194594, round_duration: 19.755401765382704
2021-08-18:15:32:22,212 INFO     [oort.py:208] Training selector: Pacer 14: lastExploitationUtil 796.0943654973987, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:22,214 INFO     [oort.py:321] scores are 26,{5: 0.03550391036236783, 6: 0.21830675751014236, 7: 0.13264130723302514, 11: 0.06510708756465103, 14: 0.005190681818444925, 16: 0.13264130723302514, 17: 0.013593905118212745, 25: 0.0025830000902444844, 27: 0.03363778248658351, 35: 0.0022897464003821854, 37: 0.05612713406387086, 38: 0.024838825060532463, 49: 0.017464057315370086, 50: 0.02361794214433357, 51: 0.40967655179693324, 53: 0.08659965166145364, 55: 0.9878486850044449, 58: 0.004786294885498234, 59: 0.004952940374072858, 60: 0.0021358225491742646, 65: 0.030007290070015246, 67: 0.0025534511270847576, 70: 0.007945114391251298, 71: 0.08738795717142232, 76: 0.0024031069775482185, 81: 0.03411506499679144, 82: 0.13264130723302514, 83: 0.509380857830291, 84: 0.06294682087067163, 85: 0.014489260661683611, 86: 0.002101548999766162, 87: 0.015907876688224715, 88: 0.0025661779255372443, 96: 0.003980613720233055, 97: 0.041514635896115384, 98: 0.24493273014243985, 99: 0.2301409046296469, 104: 0.004438073303002443, 105: 0.016161791756540173, 106: 0.017857964542483822, 107: 0.013657634393051813, 110: 0.013813564454465209, 111: 0.004416598064866685, 119: 0.01299427635309613},[55, 83, 51, 98, 99, 6, 7, 16, 82, 71, 53, 11, 84, 37, 97, 5, 81, 27, 65, 38, 50, 106, 49, 105, 87, 85, 110, 107, 17, 119, 70, 14, 59, 58, 104, 111, 96, 25, 88, 67, 76, 35, 60, 86]
2021-08-18:15:32:22,246 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000004
2021-08-18:15:32:22,247 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:22,247 INFO     [oort.py:398] At round 14, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 796.0974273988046, 'duration': 43.8287324306519, 'time_stamp': 15, 'count': 7, 'status': True, 'gradient': 16.879690412765886}, [0.2561923206857837, -2.0001333422228165e-05]), ({'reward': 2657.466117311248, 'duration': 8.010998429338052, 'time_stamp': 15, 'count': 14, 'status': True, 'gradient': 20.54004733115448}, [0.8552073809895627, -2.0001333422228165e-05]), ({'reward': 1894.9995018717893, 'duration': 12.029357192292537, 'time_stamp': 15, 'count': 12, 'status': True, 'gradient': 26.41296489445836}, [0.6098347215576638, -2.0001333422228165e-05])]
2021-08-18:15:32:22,248 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 99, 38, 11, 87, 85, 110, 71, 27]
2021-08-18:15:32:22,567 INFO     [param_server.py:553] For epoch: 16, median_reward: 469.192375920186, dev: 2345.96187960093
2021-08-18:15:32:23,181 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4404, Top-1 Accuracy: 483.0/1033 (0.4676), Top-5 Accuracy: 1.0
2021-08-18:15:32:23,182 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 178.3182, eval_time 0.5897, test_loss 2.4404, test_accuracy 0.4676, test_5_accuracy 1.0 

2021-08-18:15:32:23,224 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1245, Top-1 Accuracy: 519.0/1033 (0.5024), Top-5 Accuracy: 1.0
2021-08-18:15:32:23,225 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 178.3642, eval_time 0.6346, test_loss 2.1245, test_accuracy 0.5024, test_5_accuracy 1.0 

2021-08-18:15:32:23,231 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1168, Top-1 Accuracy: 507.0/1033 (0.4908), Top-5 Accuracy: 1.0
2021-08-18:15:32:23,232 INFO     [learner.py:656] After aggregation epoch 15, CumulTime 178.357, eval_time 0.6351, test_loss 2.1168, test_accuracy 0.4908, test_5_accuracy 1.0 

2021-08-18:15:32:23,250 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:32:23,258 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:23,293 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:32:23,301 INFO     [learner.py:526] ====Start train round 16
2021-08-18:15:32:23,305 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:23,317 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:23,868 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:23,878 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:25,179 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:25,192 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:25,608 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:25,636 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:26,291 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:26,298 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:26,304 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:26,312 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:26,597 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:26,611 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:26,802 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:26,816 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:27,309 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:27,331 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:27,661 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:27,688 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:28,577 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:28,598 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:29,70 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:29,97 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:29,229 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:29,246 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:29,893 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:29,907 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:32:30,450 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:32:30,474 INFO     [learner.py:606] ====Pushing takes 0.022500038146972656 s
2021-08-18:15:32:30,476 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:30,494 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:30,508 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:30,518 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:32:30,519 INFO     [param_server.py:410] Lock worker 3 with localStep 16 , while globalStep is 15

2021-08-18:15:32:31,155 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:31,184 INFO     [learner.py:606] ====Pushing takes 0.027801036834716797 s
2021-08-18:15:32:31,213 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:31,221 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:31,221 INFO     [param_server.py:410] Lock worker 2 with localStep 16 , while globalStep is 15

2021-08-18:15:32:31,722 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:31,742 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:32,322 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:32,342 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:32,962 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:32,983 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:33,556 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:33,581 INFO     [learner.py:606] ====Pushing takes 0.023334264755249023 s
2021-08-18:15:32:33,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:33,618 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:33,619 INFO     [param_server.py:381] ====After aggregation in epoch: 15, virtual_clock: 463.95522917545225, top_1: : 48.6931 % (1509.0), top_5: : 100.0 % (3099.0), test loss: 2.2272428848125316, test len: 3099.0
2021-08-18:15:32:33,620 INFO     [param_server.py:410] Lock worker 1 with localStep 16 , while globalStep is 16

2021-08-18:15:32:33,620 INFO     [param_server.py:441] ====Epoch 17 completes 20 clients with loss 4.347186962568132, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:33,620 INFO     [param_server.py:450] ====Start to sample for epoch 17, global virtualClock: 463.95522917545225, round_duration: 23.89790895599279
2021-08-18:15:32:33,621 INFO     [oort.py:208] Training selector: Pacer 15: lastExploitationUtil 1298.0925667078704, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:33,622 INFO     [oort.py:321] scores are 26,{5: 0.028517902258050967, 6: 0.07330425400833336, 7: 0.6977462062589843, 11: 0.033615099712073694, 14: 0.005258094043906965, 16: 0.13009732640810232, 17: 0.010633738599841057, 25: 0.0026165459295446614, 27: 0.011254647977449744, 35: 0.0022496518868973764, 37: 0.1657611448761799, 38: 0.2116255510599479, 49: 0.014027702145074619, 50: 0.017605153899330792, 51: 0.2958419492767282, 53: 0.46105289595585497, 55: 0.14143967730128548, 58: 0.003935977142948978, 59: 0.004073016930445692, 60: 0.0017563791901780907, 65: 0.022367865775775264, 67: 0.0023015915502108495, 70: 0.007579595263150303, 71: 0.0792290401478235, 76: 0.001999114223268725, 81: 0.03455812274377139, 82: 0.560954401894739, 83: 0.2509690416924766, 84: 0.0587368091006416, 85: 0.023618519792369442, 86: 0.0017281945692332443, 87: 0.06482437617612813, 88: 0.0021347708771640816, 96: 0.004032310595320273, 97: 0.040718410045537556, 98: 0.09839016695011688, 99: 0.15087660017235102, 104: 0.003649619485894114, 105: 0.01746868773599412, 106: 0.01930201866800236, 107: 0.010185832172606159, 110: 0.03293791753203395, 111: 0.004473957137170654, 119: 0.014045036552063715},[7, 82, 53, 51, 83, 38, 37, 99, 55, 16, 98, 71, 6, 87, 84, 97, 81, 11, 110, 5, 85, 65, 106, 50, 105, 119, 49, 27, 17, 107, 70, 14, 111, 59, 96, 58, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:32:33,623 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:33,623 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:33,624 INFO     [oort.py:398] At round 15, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2577.048143534934, 'duration': 11.058674649423494, 'time_stamp': 16, 'count': 13, 'status': True, 'gradient': 14.577331898198747}, [0.5760794057549523, -1.875117194824678e-05]), ({'reward': 2651.4460645905287, 'duration': 19.55790138125729, 'time_stamp': 16, 'count': 13, 'status': True, 'gradient': 19.436384069667405}, [0.5927105565558518, -1.875117194824678e-05]), ({'reward': 3003.576084514798, 'duration': 28.420902733732795, 'time_stamp': 16, 'count': 11, 'status': True, 'gradient': 19.436551961199974}, [0.6714268349113723, -1.875117194824678e-05])]
2021-08-18:15:32:33,625 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 87, 85, 110, 71, 5]
2021-08-18:15:32:33,948 INFO     [param_server.py:553] For epoch: 17, median_reward: 558.7521872752021, dev: 2793.7609363760107
2021-08-18:15:32:34,522 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.559, Top-1 Accuracy: 564.0/1033 (0.546), Top-5 Accuracy: 1.0
2021-08-18:15:32:34,523 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 189.6594, eval_time 0.531, test_loss 2.559, test_accuracy 0.546, test_5_accuracy 1.0 

2021-08-18:15:32:34,592 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:34,598 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2094, Top-1 Accuracy: 568.0/1033 (0.5499), Top-5 Accuracy: 1.0
2021-08-18:15:32:34,598 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 189.723, eval_time 0.6061, test_loss 2.2094, test_accuracy 0.5499, test_5_accuracy 1.0 

2021-08-18:15:32:34,607 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:34,642 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2787, Top-1 Accuracy: 563.0/1033 (0.545), Top-5 Accuracy: 1.0
2021-08-18:15:32:34,643 INFO     [learner.py:656] After aggregation epoch 16, CumulTime 189.7825, eval_time 0.6512, test_loss 2.2787, test_accuracy 0.545, test_5_accuracy 1.0 

2021-08-18:15:32:34,666 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:34,686 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:34,711 INFO     [learner.py:526] ====Start train round 17
2021-08-18:15:32:34,739 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:35,196 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:35,209 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:36,399 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:36,426 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:36,848 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:36,862 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:37,323 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:37,338 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:37,550 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:37,564 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:37,892 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:37,913 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:38,177 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:38,192 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:38,299 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:38,317 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:38,454 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:38,474 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:38,837 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:38,851 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:39,12 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:39,32 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:39,457 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:39,475 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:32:39,507 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:39,520 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:40,45 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:32:40,76 INFO     [learner.py:606] ====Pushing takes 0.02923274040222168 s
2021-08-18:15:32:40,107 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:40,115 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:32:40,116 INFO     [param_server.py:410] Lock worker 2 with localStep 17 , while globalStep is 16

2021-08-18:15:32:40,682 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:40,703 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:41,235 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:41,269 INFO     [learner.py:606] ====Pushing takes 0.031117916107177734 s
2021-08-18:15:32:41,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:41,304 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:41,304 INFO     [param_server.py:410] Lock worker 3 with localStep 17 , while globalStep is 16

2021-08-18:15:32:41,766 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:41,775 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:42,309 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:42,323 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:42,937 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:42,957 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:43,510 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:43,534 INFO     [learner.py:606] ====Pushing takes 0.022969484329223633 s
2021-08-18:15:32:43,562 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:43,569 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:43,570 INFO     [param_server.py:381] ====After aggregation in epoch: 16, virtual_clock: 485.54053366045326, top_1: : 54.6951 % (1695.0), top_5: : 100.0 % (3099.0), test loss: 2.3490023833734015, test len: 3099.0
2021-08-18:15:32:43,571 INFO     [param_server.py:410] Lock worker 1 with localStep 17 , while globalStep is 17

2021-08-18:15:32:43,571 INFO     [param_server.py:441] ====Epoch 18 completes 20 clients with loss 4.571363683828668, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:43,571 INFO     [param_server.py:450] ====Start to sample for epoch 18, global virtualClock: 485.54053366045326, round_duration: 21.58530448500103
2021-08-18:15:32:43,572 INFO     [oort.py:208] Training selector: Pacer 16: lastExploitationUtil 1006.8204498068983, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:43,573 INFO     [oort.py:321] scores are 26,{5: 0.011660861791765682, 6: 0.5428735112211025, 7: 0.12770804994009005, 11: 0.03435715756070466, 14: 0.0053203808336389794, 16: 0.4388841778683926, 17: 0.01096146691501941, 25: 0.002647541237956432, 27: 0.031322951158911067, 35: 0.0022807927901517255, 37: 0.11607935048370331, 38: 0.2111781276762161, 49: 0.01626224364058312, 50: 0.015167163424457415, 51: 0.07046556620575306, 53: 0.08337879707221196, 55: 0.4617251193530102, 58: 0.004041295461449044, 59: 0.004182002140155383, 60: 0.0018033761355972077, 65: 0.01927032717904313, 67: 0.0023471893445690902, 70: 0.00769953063833099, 71: 0.012623682145110136, 76: 0.0020507889488209784, 81: 0.10927846173683647, 82: 0.5824415339182799, 83: 0.05743392528572485, 84: 0.05765808996270894, 85: 0.060772062400128765, 86: 0.001774437354560047, 87: 0.014917022528649165, 88: 0.0021899521659120677, 93: 0.09095829922426613, 96: 0.004080076892401994, 97: 0.18644131215909576, 98: 0.23925775901156315, 99: 0.026657368995729718, 104: 0.003747275486795445, 105: 0.015049595318374872, 106: 0.01662904358766485, 107: 0.010513814347660478, 110: 0.01329980392987463, 111: 0.00452695512957042, 119: 0.014497284494009203},[82, 6, 55, 16, 98, 38, 97, 7, 37, 81, 93, 53, 51, 85, 84, 83, 11, 27, 99, 65, 106, 49, 50, 105, 87, 119, 110, 71, 5, 17, 107, 70, 14, 111, 59, 96, 58, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:32:43,574 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:32:43,574 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:43,575 INFO     [oort.py:398] At round 16, UCB exploited 45, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1336.785193235833, 'duration': 7.864087706209871, 'time_stamp': 17, 'count': 15, 'status': True, 'gradient': 21.3698294808611}, [0.31117613025611457, -1.7648096946879243e-05]), ({'reward': 1276.628607748289, 'duration': 17.619275735353515, 'time_stamp': 17, 'count': 13, 'status': True, 'gradient': 11.343420768308661}, [0.2971728083541802, -1.7648096946879243e-05]), ({'reward': 691.2613000517531, 'duration': 21.635252629006885, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 20.998479924414934}, [0.16091030651652968, 0.26470380610624156])]
2021-08-18:15:32:43,575 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27]
2021-08-18:15:32:43,902 INFO     [param_server.py:553] For epoch: 18, median_reward: 506.5867844453635, dev: 2532.9339222268172
2021-08-18:15:32:44,482 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1488, Top-1 Accuracy: 522.0/1033 (0.5053), Top-5 Accuracy: 1.0
2021-08-18:15:32:44,485 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 199.6097, eval_time 0.5461, test_loss 2.1488, test_accuracy 0.5053, test_5_accuracy 1.0 

2021-08-18:15:32:44,490 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.982, Top-1 Accuracy: 535.0/1033 (0.5179), Top-5 Accuracy: 1.0
2021-08-18:15:32:44,492 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 199.6285, eval_time 0.5559, test_loss 1.982, test_accuracy 0.5179, test_5_accuracy 1.0 

2021-08-18:15:32:44,560 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:44,561 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:44,569 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:44,570 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8823, Top-1 Accuracy: 538.0/1033 (0.5208), Top-5 Accuracy: 1.0
2021-08-18:15:32:44,570 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:44,570 INFO     [learner.py:656] After aggregation epoch 17, CumulTime 199.7097, eval_time 0.634, test_loss 1.8823, test_accuracy 0.5208, test_5_accuracy 1.0 

2021-08-18:15:32:44,639 INFO     [learner.py:526] ====Start train round 18
2021-08-18:15:32:44,658 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:45,185 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:45,195 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:45,767 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:45,783 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:46,365 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:46,379 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:46,708 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:46,728 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:47,695 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:32:47,709 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:32:47,862 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:47,889 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:48,384 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:48,405 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:32:49,105 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:32:49,126 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:32:49,489 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:32:49,515 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:32:49,516 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:32:49,535 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:32:49,732 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:32:49,752 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:32:50,951 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:32:50,971 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:32:51,306 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:32:51,328 INFO     [learner.py:606] ====Pushing takes 0.020121097564697266 s
2021-08-18:15:32:51,362 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:51,371 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:32:51,372 INFO     [param_server.py:410] Lock worker 2 with localStep 18 , while globalStep is 17

2021-08-18:15:32:51,680 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:32:51,701 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:32:52,266 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:32:52,282 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:32:52,850 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:32:52,879 INFO     [learner.py:606] ====Pushing takes 0.02784872055053711 s
2021-08-18:15:32:52,909 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:52,917 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:32:52,917 INFO     [param_server.py:410] Lock worker 3 with localStep 18 , while globalStep is 17

2021-08-18:15:32:53,551 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:32:53,572 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:32:54,215 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:32:54,236 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:32:54,898 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:32:54,911 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:32:55,466 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:32:55,491 INFO     [learner.py:606] ====Pushing takes 0.024023056030273438 s
2021-08-18:15:32:55,520 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:32:55,528 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:32:55,529 INFO     [param_server.py:381] ====After aggregation in epoch: 17, virtual_clock: 509.9370769256052, top_1: : 51.4682 % (1595.0), top_5: : 100.0 % (3099.0), test loss: 2.004361311594645, test len: 3099.0
2021-08-18:15:32:55,530 INFO     [param_server.py:410] Lock worker 1 with localStep 18 , while globalStep is 18

2021-08-18:15:32:55,531 INFO     [param_server.py:441] ====Epoch 19 completes 20 clients with loss 2.88578495364826, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:32:55,531 INFO     [param_server.py:450] ====Start to sample for epoch 19, global virtualClock: 509.9370769256052, round_duration: 24.39654326515194
2021-08-18:15:32:55,532 INFO     [oort.py:208] Training selector: Pacer 17: lastExploitationUtil 1269.8845043724689, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:32:55,532 INFO     [oort.py:321] scores are 26,{5: 0.011787658878882156, 6: 0.07069101216094072, 7: 0.12545945399260916, 11: 0.021168230929503224, 14: 0.005378233240405846, 16: 0.5725697896828811, 17: 0.009519240116866001, 25: 0.002676329896926345, 27: 0.07330512948842152, 35: 0.002270832062116144, 37: 0.053088134765230735, 38: 0.023493928813877445, 49: 0.01614727258659335, 50: 0.013181220287532712, 51: 0.3015671754198992, 53: 0.724202582629782, 55: 0.3229228404334423, 58: 0.003631018508726155, 59: 0.003757440483946177, 60: 0.0016202953208970842, 65: 0.019134089530938207, 67: 0.002230831613433959, 70: 0.007549938117593994, 71: 0.01240141298880325, 76: 0.0018564500782094955, 81: 0.032267907461893404, 82: 0.3510256428619285, 83: 0.058058446402426335, 84: 0.5081264835839026, 85: 0.019847748047651985, 86: 0.001594294438118712, 87: 0.03879260616175878, 88: 0.0019824257742464602, 96: 0.004124442563845458, 97: 0.0392668291716882, 98: 0.2427278766166236, 99: 0.02618800428518547, 104: 0.003366847779293861, 105: 0.014943197463680634, 106: 0.016511479325907973, 107: 0.008713241875263445, 110: 0.013065630083879518, 111: 0.0045761800351276595, 119: 0.012442587664012806},[53, 16, 84, 82, 55, 51, 98, 7, 27, 6, 83, 37, 97, 87, 81, 99, 38, 11, 85, 65, 106, 49, 105, 50, 110, 119, 71, 5, 17, 107, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:32:55,534 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:32:55,534 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:32:55,535 INFO     [oort.py:398] At round 17, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1071.353932677261, 'duration': 8.010998429338052, 'time_stamp': 18, 'count': 17, 'status': True, 'gradient': 20.56202050326168}, [0.19746338828397036, -1.6667592644035793e-05]), ({'reward': 5337.504021497042, 'duration': 11.058674649423494, 'time_stamp': 18, 'count': 15, 'status': True, 'gradient': 14.586873715174388}, [0.9837733844567758, -1.6667592644035793e-05]), ({'reward': 2425.8214580780464, 'duration': 7.864087706209871, 'time_stamp': 18, 'count': 16, 'status': True, 'gradient': 21.371343536781698}, [0.4471103375334091, -1.6667592644035793e-05])]
2021-08-18:15:32:55,535 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 27]
2021-08-18:15:32:55,855 INFO     [param_server.py:553] For epoch: 19, median_reward: 547.9975212824362, dev: 2739.987606412181
2021-08-18:15:32:56,493 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8598, Top-1 Accuracy: 565.0/1033 (0.547), Top-5 Accuracy: 1.0
2021-08-18:15:32:56,494 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 211.6329, eval_time 0.6128, test_loss 1.8598, test_accuracy 0.547, test_5_accuracy 1.0 

2021-08-18:15:32:56,495 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9716, Top-1 Accuracy: 558.0/1033 (0.5402), Top-5 Accuracy: 1.0
2021-08-18:15:32:56,496 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 211.6208, eval_time 0.6138, test_loss 1.9716, test_accuracy 0.5402, test_5_accuracy 1.0 

2021-08-18:15:32:56,496 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1089, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:32:56,497 INFO     [learner.py:656] After aggregation epoch 18, CumulTime 211.6329, eval_time 0.6162, test_loss 2.1089, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:32:56,562 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:56,563 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:56,568 INFO     [learner.py:526] ====Start train round 19
2021-08-18:15:32:56,578 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:32:56,578 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:32:56,586 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:32:57,175 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:32:57,189 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:32:58,246 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:32:58,261 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:32:58,418 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:32:58,432 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:32:58,946 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:32:58,960 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:32:59,53 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:32:59,73 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:32:59,517 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:32:59,537 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:32:59,594 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:32:59,614 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:00,121 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:00,135 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:00,151 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:00,169 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:00,193 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:00,213 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:00,615 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:00,640 INFO     [learner.py:606] ====Pushing takes 0.023714065551757812 s
2021-08-18:15:33:00,664 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:00,667 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:00,674 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:00,675 INFO     [param_server.py:410] Lock worker 2 with localStep 19 , while globalStep is 18

2021-08-18:15:33:00,682 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:01,307 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:01,327 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:02,287 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:02,297 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:02,963 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:03,48 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:33:03,291 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:03,318 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:03,630 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:33:03,657 INFO     [learner.py:606] ====Pushing takes 0.02573537826538086 s
2021-08-18:15:33:03,696 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:03,704 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:03,704 INFO     [param_server.py:410] Lock worker 3 with localStep 19 , while globalStep is 18

2021-08-18:15:33:03,964 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:03,992 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:04,706 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:04,733 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:05,426 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:05,455 INFO     [learner.py:606] ====Pushing takes 0.02724480628967285 s
2021-08-18:15:33:05,484 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:05,492 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:05,492 INFO     [param_server.py:381] ====After aggregation in epoch: 18, virtual_clock: 529.6924786909879, top_1: : 54.6305 % (1693.0), top_5: : 100.0 % (3099.0), test loss: 1.9800948014965767, test len: 3099.0
2021-08-18:15:33:05,493 INFO     [param_server.py:410] Lock worker 1 with localStep 19 , while globalStep is 19

2021-08-18:15:33:05,493 INFO     [param_server.py:441] ====Epoch 20 completes 20 clients with loss 4.342485571117404, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:05,494 INFO     [param_server.py:450] ====Start to sample for epoch 20, global virtualClock: 529.6924786909879, round_duration: 19.755401765382704
2021-08-18:15:33:05,494 INFO     [oort.py:208] Training selector: Pacer 18: lastExploitationUtil 1248.8398462985863, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:05,495 INFO     [oort.py:321] scores are 26,{5: 0.011905969703931683, 6: 0.0694961692177056, 7: 0.12333889667304618, 11: 0.13023246195881774, 14: 0.0054322136940808076, 16: 0.12333889667304618, 17: 0.009046433309654172, 25: 0.0027031917856767634, 27: 0.010669979947379846, 35: 0.002303849010222323, 37: 0.05219082149647549, 38: 0.02309682663364243, 49: 0.017164932722530096, 50: 0.015690150270503207, 51: 0.4104760620387823, 53: 0.7099993038042349, 55: 0.49271083745066707, 58: 0.0038010701161647065, 59: 0.003933412815845388, 60: 0.001696178664146793, 65: 0.019934797347366567, 67: 0.0022949557968857098, 70: 0.007694344547881785, 71: 0.01252588396497295, 76: 0.001938806534009423, 81: 0.18649171229281333, 82: 1.1233388946613987, 83: 0.3110702605710162, 84: 0.055685488922678515, 85: 0.013473098696778199, 86: 0.0016689600811830162, 87: 0.014406680715848882, 88: 0.0020703708057718067, 96: 0.004165838924099983, 97: 0.03860312819606497, 98: 0.16649151644399723, 99: 0.025745365947424426, 104: 0.0035245274704036418, 105: 0.015568528237442035, 106: 0.017202438283514643, 107: 0.009077866534548827, 110: 0.012844790468949381, 111: 0.0046221104113292845, 119: 0.01321822374150042},[82, 53, 55, 51, 83, 81, 98, 11, 7, 16, 6, 84, 37, 97, 99, 38, 65, 106, 49, 50, 105, 87, 85, 119, 110, 71, 5, 27, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:33:05,495 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999996
2021-08-18:15:33:05,496 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:05,496 INFO     [oort.py:398] At round 18, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4971.059872857017, 'duration': 6.342067858842259, 'time_stamp': 19, 'count': 17, 'status': True, 'gradient': 51.87991981164857}, [1.0, -1.5790304752881743e-05]), ({'reward': 2825.286117227058, 'duration': 13.324368782156236, 'time_stamp': 19, 'count': 16, 'status': True, 'gradient': 21.074472986630052}, [0.5683459618802466, -1.5790304752881743e-05]), ({'reward': 3084.9745531724966, 'duration': 12.029357192292537, 'time_stamp': 19, 'count': 16, 'status': True, 'gradient': 26.448668967586446}, [0.6205861208134712, -1.5790304752881743e-05])]
2021-08-18:15:33:05,497 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 110, 71, 5, 27]
2021-08-18:15:33:05,769 INFO     [param_server.py:553] For epoch: 20, median_reward: 545.6484386174693, dev: 2728.2421930873465
2021-08-18:15:33:06,291 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0005, Top-1 Accuracy: 542.0/1033 (0.5247), Top-5 Accuracy: 1.0
2021-08-18:15:33:06,292 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 221.4169, eval_time 0.4889, test_loss 2.0005, test_accuracy 0.5247, test_5_accuracy 1.0 

2021-08-18:15:33:06,332 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.8263, Top-1 Accuracy: 526.0/1033 (0.5092), Top-5 Accuracy: 1.0
2021-08-18:15:33:06,336 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 221.4715, eval_time 0.5327, test_loss 1.8263, test_accuracy 0.5092, test_5_accuracy 1.0 

2021-08-18:15:33:06,360 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:33:06,368 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:06,373 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9743, Top-1 Accuracy: 542.0/1033 (0.5247), Top-5 Accuracy: 1.0
2021-08-18:15:33:06,374 INFO     [learner.py:656] After aggregation epoch 19, CumulTime 221.5135, eval_time 0.5715, test_loss 1.9743, test_accuracy 0.5247, test_5_accuracy 1.0 

2021-08-18:15:33:06,405 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:33:06,428 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:06,441 INFO     [learner.py:526] ====Start train round 20
2021-08-18:15:33:06,464 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:07,24 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:07,38 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:08,118 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:08,138 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:08,640 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:08,653 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:08,806 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:08,820 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:09,266 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:09,279 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:09,444 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:09,470 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:09,809 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:09,818 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:09,925 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:09,939 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:10,123 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:10,137 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:10,702 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:10,716 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:11,71 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:11,85 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:11,89 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:11,109 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:12,483 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:12,497 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:33:12,786 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:12,800 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:13,101 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:33:13,126 INFO     [learner.py:606] ====Pushing takes 0.023619890213012695 s
2021-08-18:15:33:13,152 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:13,161 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:13,161 INFO     [param_server.py:410] Lock worker 3 with localStep 20 , while globalStep is 19

2021-08-18:15:33:13,341 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:13,351 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:33:13,577 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:13,597 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:13,949 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:33:13,981 INFO     [learner.py:606] ====Pushing takes 0.031239748001098633 s
2021-08-18:15:33:14,17 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:14,25 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 14 clients
2021-08-18:15:33:14,26 INFO     [param_server.py:410] Lock worker 2 with localStep 20 , while globalStep is 19

2021-08-18:15:33:14,233 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:14,254 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:15,0 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:15,22 INFO     [learner.py:606] ====Pushing takes 0.020116329193115234 s
2021-08-18:15:33:15,47 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:15,53 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:15,54 INFO     [param_server.py:381] ====After aggregation in epoch: 19, virtual_clock: 550.7207100960211, top_1: : 51.9522 % (1610.0), top_5: : 100.0 % (3099.0), test loss: 1.9336896980250324, test len: 3099.0
2021-08-18:15:33:15,55 INFO     [param_server.py:410] Lock worker 1 with localStep 20 , while globalStep is 20

2021-08-18:15:33:15,55 INFO     [param_server.py:441] ====Epoch 21 completes 20 clients with loss 3.9052696015964803, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:15,55 INFO     [param_server.py:450] ====Start to sample for epoch 21, global virtualClock: 550.7207100960211, round_duration: 21.0282314050332
2021-08-18:15:33:15,56 INFO     [oort.py:208] Training selector: Pacer 19: lastExploitationUtil 1361.0766842802395, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:15,56 INFO     [oort.py:321] scores are 26,{5: 0.10238769656467733, 6: 0.0683670899202584, 7: 0.41186286359097984, 11: 0.020472338748175074, 14: 0.005482785709853098, 16: 0.259732149754546, 17: 0.008549535743796976, 25: 0.0027283575584628496, 27: 0.01049662861595575, 35: 0.0023034139143522296, 37: 0.1729742893774927, 38: 0.022721580787974593, 49: 0.015493623595979621, 50: 0.014156718507303327, 51: 0.12339725514781798, 53: 0.07921795723593686, 55: 0.12133505392356643, 58: 0.00355051440604025, 59: 0.0036741334520957935, 60: 0.0015843714002171116, 65: 0.018839829646981054, 67: 0.0022270040861439738, 70: 0.007619099035730879, 71: 0.011993724393328726, 76: 0.0018204772446512325, 81: 0.22359217439570317, 82: 0.836336141458033, 83: 0.30471396219239233, 84: 0.14406735201646143, 85: 0.01359852852982035, 86: 0.001558946988677342, 87: 0.014540801870718222, 88: 0.001944011882456082, 96: 0.004204621432233631, 97: 0.037975957038956454, 98: 0.32792504244510917, 99: 0.025327090234911722, 104: 0.0032922006634224592, 105: 0.014713388590647945, 106: 0.016257552114866833, 107: 0.008579242421620255, 110: 0.012636105772198598, 111: 0.004665140647297021, 119: 0.011829742662041318},[82, 7, 98, 83, 16, 81, 37, 84, 51, 55, 5, 53, 6, 97, 99, 38, 11, 65, 106, 49, 105, 87, 50, 85, 110, 71, 119, 27, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:33:15,57 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:33:15,57 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:15,58 INFO     [oort.py:398] At round 19, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1699.6719488099036, 'duration': 5.8943907365129, 'time_stamp': 20, 'count': 17, 'status': True, 'gradient': 20.677030613178673}, [0.29052781137674044, -1.5000750037501888e-05]), ({'reward': 4376.024593307947, 'duration': 17.619275735353515, 'time_stamp': 20, 'count': 16, 'status': True, 'gradient': 11.352672701273129}, [0.7480040008319712, -1.5000750037501888e-05]), ({'reward': 3254.016721788451, 'duration': 13.324368782156236, 'time_stamp': 20, 'count': 17, 'status': True, 'gradient': 21.080843345400325}, [0.5562161635091425, -1.5000750037501888e-05])]
2021-08-18:15:33:15,58 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 5, 27]
2021-08-18:15:33:15,336 INFO     [param_server.py:541] Handle Wight 0.026378154754638672 | Send 0.2811753749847412
2021-08-18:15:33:15,337 INFO     [param_server.py:553] For epoch: 21, median_reward: 569.5560727955021, dev: 2847.7803639775107
2021-08-18:15:33:15,917 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0587, Top-1 Accuracy: 563.0/1033 (0.545), Top-5 Accuracy: 1.0
2021-08-18:15:33:15,919 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0299, Top-1 Accuracy: 554.0/1033 (0.5363), Top-5 Accuracy: 1.0
2021-08-18:15:33:15,927 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 231.0634, eval_time 0.556, test_loss 2.0587, test_accuracy 0.545, test_5_accuracy 1.0 

2021-08-18:15:33:15,928 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 231.0522, eval_time 0.5557, test_loss 2.0299, test_accuracy 0.5363, test_5_accuracy 1.0 

2021-08-18:15:33:15,980 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:33:15,988 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0083, Top-1 Accuracy: 576.0/1033 (0.5576), Top-5 Accuracy: 1.0
2021-08-18:15:33:15,988 INFO     [learner.py:656] After aggregation epoch 20, CumulTime 231.1277, eval_time 0.6173, test_loss 2.0083, test_accuracy 0.5576, test_5_accuracy 1.0 

2021-08-18:15:33:15,993 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:33:15,996 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:16,1 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:16,58 INFO     [learner.py:526] ====Start train round 21
2021-08-18:15:33:16,80 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:16,594 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:16,614 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:17,766 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:17,780 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:18,10 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:18,31 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:18,596 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:18,616 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:18,715 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:18,736 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:19,170 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:19,183 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:19,354 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:19,368 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:19,600 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:19,614 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:19,815 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:19,825 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:19,934 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:19,944 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:33:20,373 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:20,382 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:20,549 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:33:20,573 INFO     [learner.py:606] ====Pushing takes 0.02206587791442871 s
2021-08-18:15:33:20,607 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:20,614 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:20,615 INFO     [param_server.py:410] Lock worker 2 with localStep 21 , while globalStep is 20

2021-08-18:15:33:20,829 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:20,850 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:21,549 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:21,563 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:22,100 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:22,114 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:33:22,628 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:33:22,660 INFO     [learner.py:606] ====Pushing takes 0.026508569717407227 s
2021-08-18:15:33:22,689 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:22,697 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:22,697 INFO     [param_server.py:410] Lock worker 3 with localStep 21 , while globalStep is 20

2021-08-18:15:33:22,817 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:22,837 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:23,415 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:23,435 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:24,21 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:24,41 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:24,652 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:24,677 INFO     [learner.py:606] ====Pushing takes 0.024333953857421875 s
2021-08-18:15:33:24,707 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:24,715 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:24,716 INFO     [param_server.py:381] ====After aggregation in epoch: 20, virtual_clock: 571.1281788878998, top_1: : 54.6305 % (1693.0), top_5: : 100.0 % (3099.0), test loss: 2.0323206981023154, test len: 3099.0
2021-08-18:15:33:24,717 INFO     [param_server.py:410] Lock worker 1 with localStep 21 , while globalStep is 21

2021-08-18:15:33:24,717 INFO     [param_server.py:441] ====Epoch 22 completes 20 clients with loss 4.055246001182506, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:33:24,718 INFO     [param_server.py:450] ====Start to sample for epoch 22, global virtualClock: 571.1281788878998, round_duration: 20.407468791878713
2021-08-18:15:33:24,719 INFO     [oort.py:208] Training selector: Pacer 20: lastExploitationUtil 1600.5207543441447, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:24,720 INFO     [oort.py:321] scores are 26,{5: 0.023051120934979588, 6: 0.06729807851706993, 7: 0.2243438469255402, 11: 0.14192902298566645, 14: 0.005530335667696338, 16: 0.1194378171623986, 17: 0.008318622196608649, 25: 0.0027520194874799037, 27: 0.0862348139815037, 35: 0.002317065080147808, 37: 0.05054008073362043, 38: 0.02236629831231059, 49: 0.0170914824196991, 50: 0.015940562246829174, 51: 0.12657062164289554, 53: 0.07797927792808146, 55: 1.1194378155310476, 58: 0.0034986538442868978, 59: 0.003620467249683458, 60: 0.0015612292913718636, 65: 0.020252953127607644, 67: 0.002220500578513528, 70: 0.0076427209595843594, 71: 0.012097741054140285, 76: 0.0017968446598277518, 81: 0.030719155145325774, 82: 0.1194378171623986, 83: 0.09557391682174535, 84: 0.22864943401316534, 85: 0.01304695876291563, 86: 0.0015361762413064928, 87: 0.09761649074106278, 88: 0.0019187756286962615, 96: 0.0042410863941033244, 97: 0.10476923673614898, 98: 0.19071787665076723, 99: 0.14039404571694003, 104: 0.00324411315939223, 105: 0.015816999147994983, 106: 0.017476986104531925, 107: 0.00922274765171781, 110: 0.012745693543684898, 111: 0.004705599503764905, 119: 0.011510234337580662},[55, 84, 7, 98, 11, 99, 51, 16, 82, 97, 87, 83, 27, 53, 6, 37, 81, 5, 38, 65, 106, 49, 50, 105, 85, 110, 71, 119, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:33:24,720 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:33:24,721 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:24,721 INFO     [oort.py:398] At round 20, UCB exploited 44, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 21, 'count': 17, 'status': True, 'gradient': 9.733997382558188}, [1.6313511145602611e-09, -1.4286394590218595e-05]), ({'reward': 6129.898222365687, 'duration': 8.010998429338052, 'time_stamp': 21, 'count': 20, 'status': True, 'gradient': 20.579629855545832}, [1.0, -1.4286394590218595e-05]), ({'reward': 2372.291216944691, 'duration': 13.298442137908651, 'time_stamp': 21, 'count': 18, 'status': True, 'gradient': 11.356965283258633}, [0.38700236236267627, -1.4286394590218595e-05])]
2021-08-18:15:33:24,722 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 27]
2021-08-18:15:33:25,39 INFO     [param_server.py:553] For epoch: 22, median_reward: 623.1310675539223, dev: 3115.655337769612
2021-08-18:15:33:25,671 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1341, Top-1 Accuracy: 540.0/1033 (0.5227), Top-5 Accuracy: 1.0
2021-08-18:15:33:25,672 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 240.7969, eval_time 0.5959, test_loss 2.1341, test_accuracy 0.5227, test_5_accuracy 1.0 

2021-08-18:15:33:25,676 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1414, Top-1 Accuracy: 535.0/1033 (0.5179), Top-5 Accuracy: 1.0
2021-08-18:15:33:25,679 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 240.815, eval_time 0.6039, test_loss 2.1414, test_accuracy 0.5179, test_5_accuracy 1.0 

2021-08-18:15:33:25,718 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9164, Top-1 Accuracy: 557.0/1033 (0.5392), Top-5 Accuracy: 1.0
2021-08-18:15:33:25,719 INFO     [learner.py:656] After aggregation epoch 21, CumulTime 240.8581, eval_time 0.6452, test_loss 1.9164, test_accuracy 0.5392, test_5_accuracy 1.0 

2021-08-18:15:33:25,741 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:25,748 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:25,750 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:25,759 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:25,788 INFO     [learner.py:526] ====Start train round 22
2021-08-18:15:33:25,805 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:26,357 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:26,366 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:27,459 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:27,480 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:27,548 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:27,558 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:28,190 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:28,204 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:28,371 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:28,391 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:28,821 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:28,836 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:28,933 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:28,953 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:29,533 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:29,553 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:29,634 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:29,654 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:30,27 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:30,41 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:30,196 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:30,216 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:30,643 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:30,665 INFO     [learner.py:606] ====Pushing takes 0.020948410034179688 s
2021-08-18:15:33:30,693 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:30,700 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:30,700 INFO     [param_server.py:410] Lock worker 2 with localStep 22 , while globalStep is 21

2021-08-18:15:33:30,796 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:30,816 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:31,396 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:31,409 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:31,907 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:31,922 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:33:32,512 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:33:32,539 INFO     [learner.py:606] ====Pushing takes 0.026319503784179688 s
2021-08-18:15:33:32,576 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:32,587 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:32,587 INFO     [param_server.py:410] Lock worker 3 with localStep 22 , while globalStep is 21

2021-08-18:15:33:32,692 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:32,712 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:33,339 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:33,359 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:33,972 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:33,992 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:34,613 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:34,638 INFO     [learner.py:606] ====Pushing takes 0.023868322372436523 s
2021-08-18:15:33:34,666 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:34,676 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:34,677 INFO     [param_server.py:381] ====After aggregation in epoch: 21, virtual_clock: 591.5447191693297, top_1: : 52.6621 % (1632.0), top_5: : 100.0 % (3099.0), test loss: 2.063959664768643, test len: 3099.0
2021-08-18:15:33:34,678 INFO     [param_server.py:410] Lock worker 1 with localStep 22 , while globalStep is 22

2021-08-18:15:33:34,679 INFO     [param_server.py:441] ====Epoch 23 completes 20 clients with loss 3.329482828436609, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:34,679 INFO     [param_server.py:450] ====Start to sample for epoch 23, global virtualClock: 591.5447191693297, round_duration: 20.416540281429864
2021-08-18:15:33:34,680 INFO     [oort.py:208] Training selector: Pacer 21: lastExploitationUtil 1586.7409975551416, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:34,681 INFO     [oort.py:321] scores are 26,{5: 0.023036932588099707, 6: 0.44133760278291956, 7: 0.6958023224972826, 11: 0.054660039291342194, 14: 0.005575188842096465, 16: 1.1176381670772215, 17: 0.008297276847068297, 25: 0.0027743394364421613, 27: 0.010176813113118783, 35: 0.002334015856451407, 37: 0.04977855996066806, 38: 0.022029290524993313, 49: 0.01681143844087223, 50: 0.015679376097686586, 51: 0.06490930030154508, 53: 0.25306557885025105, 55: 0.11763816869478647, 58: 0.003502966481420647, 59: 0.003624930040858985, 60: 0.00156315375023974, 65: 0.01992110844394742, 67: 0.002230993444124141, 70: 0.007692346296645295, 71: 0.012195858440459936, 76: 0.0017999411228807592, 81: 0.030256289347900353, 82: 0.3141641144554131, 83: 0.4158107508714495, 84: 0.11978048984740135, 85: 0.06339040215639664, 86: 0.0015380698183784457, 87: 0.05303249411733733, 88: 0.001922082212717742, 96: 0.004275483255182095, 97: 0.18173907819669852, 98: 0.05222117062379806, 99: 0.02455541426206051, 104: 0.0032481120353885294, 105: 0.015557837580511491, 106: 0.017420137108156052, 107: 0.009071632910194489, 110: 0.012251103818781498, 111: 0.004743763746873893, 119: 0.012508689879384305},[16, 7, 6, 83, 82, 53, 97, 84, 55, 51, 85, 11, 87, 98, 37, 81, 99, 5, 38, 65, 106, 49, 50, 105, 119, 110, 71, 27, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:33:34,682 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:33:34,682 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:34,683 INFO     [oort.py:398] At round 21, UCB exploited 44, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2079.5875312454436, 'duration': 26.145070720211294, 'time_stamp': 22, 'count': 17, 'status': True, 'gradient': 8.114750663911664}, [0.33638517398679163, -1.3636983499249978e-05]), ({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 22, 'count': 18, 'status': True, 'gradient': 9.73767342941623}, [1.6175649492027084e-09, -1.3636983499249978e-05]), ({'reward': 6182.14196864392, 'duration': 7.864087706209871, 'time_stamp': 22, 'count': 20, 'status': True, 'gradient': 21.39979650485789}, [1.0, -1.3636983499249978e-05])]
2021-08-18:15:33:34,683 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71]
2021-08-18:15:33:34,966 INFO     [param_server.py:553] For epoch: 23, median_reward: 628.9355264822033, dev: 3144.6776324110165
2021-08-18:15:33:35,531 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0454, Top-1 Accuracy: 575.0/1033 (0.5566), Top-5 Accuracy: 1.0
2021-08-18:15:33:35,532 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 250.6683, eval_time 0.5312, test_loss 2.0454, test_accuracy 0.5566, test_5_accuracy 1.0 

2021-08-18:15:33:35,534 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0369, Top-1 Accuracy: 568.0/1033 (0.5499), Top-5 Accuracy: 1.0
2021-08-18:15:33:35,535 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 250.6597, eval_time 0.5319, test_loss 2.0369, test_accuracy 0.5499, test_5_accuracy 1.0 

2021-08-18:15:33:35,602 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:35,604 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:35,611 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:35,612 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:35,615 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0187, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:33:35,616 INFO     [learner.py:656] After aggregation epoch 22, CumulTime 250.7554, eval_time 0.6163, test_loss 2.0187, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:33:35,686 INFO     [learner.py:526] ====Start train round 23
2021-08-18:15:33:35,706 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:36,210 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:36,220 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:36,894 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:36,904 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:37,510 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:37,528 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:37,984 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:37,999 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:38,22 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:38,41 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:38,41 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:38,55 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:38,547 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:38,559 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:38,562 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:38,575 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:38,926 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:38,940 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:39,129 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:39,143 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:39,222 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:33:39,239 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:33:40,290 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:40,304 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:40,407 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:40,428 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:40,569 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:33:40,588 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:41,64 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:41,86 INFO     [learner.py:606] ====Pushing takes 0.0212247371673584 s
2021-08-18:15:33:41,114 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:41,123 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:41,125 INFO     [param_server.py:410] Lock worker 3 with localStep 23 , while globalStep is 22

2021-08-18:15:33:41,972 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:41,997 INFO     [learner.py:606] ====Pushing takes 0.02353072166442871 s
2021-08-18:15:33:42,26 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:42,33 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:42,34 INFO     [param_server.py:410] Lock worker 2 with localStep 23 , while globalStep is 22

2021-08-18:15:33:42,300 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:42,320 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:42,910 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:42,931 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:43,576 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:43,603 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:44,286 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:44,310 INFO     [learner.py:606] ====Pushing takes 0.022048473358154297 s
2021-08-18:15:33:44,338 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:44,345 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:44,346 INFO     [param_server.py:381] ====After aggregation in epoch: 22, virtual_clock: 610.5171277681235, top_1: : 55.6954 % (1726.0), top_5: : 100.0 % (3099.0), test loss: 2.0336933621653803, test len: 3099.0
2021-08-18:15:33:44,347 INFO     [param_server.py:410] Lock worker 1 with localStep 23 , while globalStep is 23

2021-08-18:15:33:44,347 INFO     [param_server.py:441] ====Epoch 24 completes 20 clients with loss 3.2091805422382933, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:33:44,347 INFO     [param_server.py:450] ====Start to sample for epoch 24, global virtualClock: 610.5171277681235, round_duration: 18.972408598793734
2021-08-18:15:33:44,348 INFO     [oort.py:208] Training selector: Pacer 22: lastExploitationUtil 1856.5706925813965, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:44,349 INFO     [oort.py:321] scores are 26,{5: 0.026354475727922346, 6: 0.4333151165641928, 7: 0.11592806170360366, 11: 0.019560040341767677, 14: 0.005617621552982835, 16: 0.5621678098652425, 17: 0.00974784489868483, 25: 0.0027954549088206565, 27: 0.04298509942411089, 35: 0.00238054803354332, 37: 0.24102195226682402, 38: 0.021709050553939957, 49: 0.022316995490085298, 50: 0.020814195459247568, 51: 0.4532305698821555, 53: 0.5731842332379674, 55: 0.8907205003169519, 58: 0.0039055331541791713, 59: 0.004041512966579475, 60: 0.0017427939516466387, 65: 0.02644504745175206, 67: 0.0023653913929484183, 70: 0.007943980398854756, 71: 0.11030722909370787, 76: 0.001992926937400917, 81: 0.235694363689257, 82: 0.11592806170360366, 83: 0.06618753688077753, 84: 0.22536296153091867, 85: 0.08227392962250628, 86: 0.001714827333056065, 87: 0.013541053276958892, 88: 0.0021281637320967593, 96: 0.004308023918826851, 97: 0.34039251749242566, 98: 0.05146203105232779, 99: 0.024198452010209332, 104: 0.0036213904158036857, 105: 0.020652854444366067, 106: 0.022820362242281678, 107: 0.010763747936761594, 110: 0.012073009425417034, 111: 0.004779868489880999, 119: 0.014841912830214696},[55, 53, 16, 51, 6, 97, 37, 81, 84, 7, 82, 71, 85, 83, 98, 27, 65, 5, 99, 106, 49, 38, 50, 105, 11, 119, 87, 110, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:33:44,349 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:33:44,350 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:44,350 INFO     [oort.py:398] At round 22, UCB exploited 44, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1867.677685647931, 'duration': 13.298442137908651, 'time_stamp': 23, 'count': 20, 'status': True, 'gradient': 11.36543684038781}, [0.3832328449924369, -1.304404539327798e-05]), ({'reward': 3775.925418885849, 'duration': 8.010998429338052, 'time_stamp': 23, 'count': 22, 'status': True, 'gradient': 20.594735446903286}, [0.774792440665281, -1.304404539327798e-05]), ({'reward': 2174.738948850949, 'duration': 7.864087706209871, 'time_stamp': 23, 'count': 21, 'status': True, 'gradient': 21.410057905526468}, [0.44623975021357154, -1.304404539327798e-05])]
2021-08-18:15:33:44,351 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 87, 85, 71, 5, 27]
2021-08-18:15:33:44,615 INFO     [param_server.py:553] For epoch: 24, median_reward: 700.5068293511132, dev: 3502.534146755566
2021-08-18:15:33:45,215 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0783, Top-1 Accuracy: 528.0/1033 (0.5111), Top-5 Accuracy: 1.0
2021-08-18:15:33:45,218 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 260.354, eval_time 0.546, test_loss 2.0783, test_accuracy 0.5111, test_5_accuracy 1.0 

2021-08-18:15:33:45,258 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0331, Top-1 Accuracy: 529.0/1033 (0.5121), Top-5 Accuracy: 1.0
2021-08-18:15:33:45,259 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 260.3838, eval_time 0.5807, test_loss 2.0331, test_accuracy 0.5121, test_5_accuracy 1.0 

2021-08-18:15:33:45,282 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:45,298 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:45,322 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:45,335 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:45,337 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8973, Top-1 Accuracy: 542.0/1033 (0.5247), Top-5 Accuracy: 1.0
2021-08-18:15:33:45,338 INFO     [learner.py:656] After aggregation epoch 23, CumulTime 260.4774, eval_time 0.6678, test_loss 1.8973, test_accuracy 0.5247, test_5_accuracy 1.0 

2021-08-18:15:33:45,413 INFO     [learner.py:526] ====Start train round 24
2021-08-18:15:33:45,441 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:45,954 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:45,968 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:47,122 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:47,131 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:47,855 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:47,875 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:48,530 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:48,544 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:48,579 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:48,593 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:48,615 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:48,629 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:49,71 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:49,84 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:33:49,208 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:49,228 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:33:49,530 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:33:49,544 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:33:49,667 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:33:49,680 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:33:49,909 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:33:49,929 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:33:50,233 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:33:50,255 INFO     [learner.py:606] ====Pushing takes 0.020812034606933594 s
2021-08-18:15:33:50,283 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:50,291 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:33:50,292 INFO     [param_server.py:410] Lock worker 2 with localStep 24 , while globalStep is 23

2021-08-18:15:33:50,872 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:33:50,885 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:33:51,877 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:33:51,887 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:33:52,463 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:33:52,477 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:33:53,9 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:33:53,35 INFO     [learner.py:606] ====Pushing takes 0.022002696990966797 s
2021-08-18:15:33:53,65 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:53,73 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:33:53,74 INFO     [param_server.py:410] Lock worker 3 with localStep 24 , while globalStep is 23

2021-08-18:15:33:53,91 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:33:53,105 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:33:53,609 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:33:53,623 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:33:54,325 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:33:54,352 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:33:54,887 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:33:54,911 INFO     [learner.py:606] ====Pushing takes 0.022130727767944336 s
2021-08-18:15:33:54,941 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:33:54,949 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:33:54,963 INFO     [param_server.py:381] ====After aggregation in epoch: 23, virtual_clock: 634.4150367241162, top_1: : 51.5973 % (1599.0), top_5: : 100.0 % (3099.0), test loss: 2.0029114528938576, test len: 3099.0
2021-08-18:15:33:54,965 INFO     [param_server.py:410] Lock worker 1 with localStep 24 , while globalStep is 24

2021-08-18:15:33:54,965 INFO     [param_server.py:441] ====Epoch 25 completes 20 clients with loss 2.8658951697612225, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:33:54,965 INFO     [param_server.py:450] ====Start to sample for epoch 25, global virtualClock: 634.4150367241162, round_duration: 23.89790895599279
2021-08-18:15:33:54,966 INFO     [oort.py:208] Training selector: Pacer 23: lastExploitationUtil 1930.625747747433, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:33:54,967 INFO     [oort.py:321] scores are 26,{5: 0.022175870392603395, 6: 0.1376089782253092, 7: 0.11430030428757133, 11: 0.019700183018738444, 14: 0.005657870389895029, 16: 0.11430030428757133, 17: 0.009434501336919343, 25: 0.0028154836351104054, 27: 0.027498544175273396, 35: 0.0023542978912678546, 37: 0.22354091311359658, 38: 0.05966535189565761, 50: 0.016363216157859094, 51: 0.06306756436177635, 53: 0.07462506773031359, 55: 1.0013976167468006, 58: 0.003367642484326495, 59: 0.0034848944382012154, 60: 0.0015027671565691753, 65: 0.020356663030391752, 67: 0.0022055827927406416, 70: 0.0077102307103700555, 71: 0.053441277985863185, 76: 0.0017373152835805257, 81: 0.10186376365954085, 82: 0.11430030428757133, 83: 0.09033641331333903, 84: 0.33155837066576954, 85: 0.04294734523498114, 86: 0.0014786522485167905, 87: 0.07801081141383336, 88: 0.0018552066853766886, 96: 0.004338889820078356, 97: 0.1334072354617245, 98: 0.05073944756858351, 99: 0.23259547349777956, 104: 0.0031226333858011836, 105: 0.016236376861725674, 106: 0.0179403773209594, 107: 0.008397563460655467, 110: 0.012159509444354025, 111: 0.004814115036796403, 119: 0.013054243681174894},[55, 84, 99, 37, 6, 97, 7, 16, 82, 81, 83, 87, 53, 51, 38, 71, 98, 85, 27, 5, 65, 11, 106, 50, 105, 119, 110, 17, 107, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:33:54,967 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:33:54,968 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:33:54,968 INFO     [oort.py:398] At round 23, UCB exploited 43, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6986.724764214386, 'duration': 19.55790138125729, 'time_stamp': 24, 'count': 21, 'status': True, 'gradient': 19.48601486510041}, [1.0, -1.2500520855035638e-05]), ({'reward': 1427.5176374157634, 'duration': 20.64883858350112, 'time_stamp': 24, 'count': 20, 'status': True, 'gradient': 8.119914918840493}, [0.20431743581178008, -1.2500520855035638e-05]), ({'reward': 6197.905899124772, 'duration': 8.010998429338052, 'time_stamp': 24, 'count': 23, 'status': True, 'gradient': 20.598232104912974}, [0.887097313890517, -1.2500520855035638e-05])]
2021-08-18:15:33:54,969 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 71, 5]
2021-08-18:15:33:55,234 INFO     [param_server.py:553] For epoch: 25, median_reward: 700.6637670059786, dev: 3503.318835029893
2021-08-18:15:33:55,868 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4358, Top-1 Accuracy: 555.0/1033 (0.5373), Top-5 Accuracy: 1.0
2021-08-18:15:33:55,869 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 271.0045, eval_time 0.5985, test_loss 2.4358, test_accuracy 0.5373, test_5_accuracy 1.0 

2021-08-18:15:33:55,906 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4336, Top-1 Accuracy: 552.0/1033 (0.5344), Top-5 Accuracy: 1.0
2021-08-18:15:33:55,907 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 271.0317, eval_time 0.637, test_loss 2.4336, test_accuracy 0.5344, test_5_accuracy 1.0 

2021-08-18:15:33:55,937 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:55,944 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:33:55,947 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4522, Top-1 Accuracy: 564.0/1033 (0.546), Top-5 Accuracy: 1.0
2021-08-18:15:33:55,948 INFO     [learner.py:656] After aggregation epoch 24, CumulTime 271.0868, eval_time 0.6788, test_loss 2.4522, test_accuracy 0.546, test_5_accuracy 1.0 

2021-08-18:15:33:55,975 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:55,991 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:33:56,15 INFO     [learner.py:526] ====Start train round 25
2021-08-18:15:33:56,35 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:33:56,500 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:33:56,509 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:33:57,670 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:33:57,689 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:33:57,766 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:33:57,778 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:33:58,393 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:33:58,403 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:33:58,643 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:33:58,671 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:33:58,951 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:33:58,965 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:33:59,117 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:33:59,137 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:33:59,867 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:33:59,888 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:00,8 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:00,35 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:00,180 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:00,194 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:00,523 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:00,543 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:00,848 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:00,862 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:34:01,386 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:34:01,420 INFO     [learner.py:606] ====Pushing takes 0.032494306564331055 s
2021-08-18:15:34:01,462 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:01,470 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:34:01,470 INFO     [param_server.py:410] Lock worker 2 with localStep 25 , while globalStep is 24

2021-08-18:15:34:01,502 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:01,528 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:01,832 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:01,853 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:02,390 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:02,418 INFO     [learner.py:606] ====Pushing takes 0.026108264923095703 s
2021-08-18:15:34:02,444 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:02,450 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:02,451 INFO     [param_server.py:410] Lock worker 3 with localStep 25 , while globalStep is 24

2021-08-18:15:34:03,444 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:03,457 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:03,962 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:03,976 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:04,516 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:04,534 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:05,22 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:05,47 INFO     [learner.py:606] ====Pushing takes 0.023362159729003906 s
2021-08-18:15:34:05,75 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:05,83 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:05,84 INFO     [param_server.py:381] ====After aggregation in epoch: 24, virtual_clock: 654.9355858158344, top_1: : 53.9206 % (1671.0), top_5: : 100.0 % (3099.0), test loss: 2.440551532639398, test len: 3099.0
2021-08-18:15:34:05,84 INFO     [param_server.py:410] Lock worker 1 with localStep 25 , while globalStep is 25

2021-08-18:15:34:05,85 INFO     [param_server.py:441] ====Epoch 26 completes 20 clients with loss 4.219288848912437, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:34:05,85 INFO     [param_server.py:450] ====Start to sample for epoch 26, global virtualClock: 654.9355858158344, round_duration: 20.520549091718188
2021-08-18:15:34:05,86 INFO     [oort.py:208] Training selector: Pacer 24: lastExploitationUtil 1267.5937940603806, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:05,86 INFO     [oort.py:321] scores are 26,{5: 0.010294920567124565, 6: 0.06352891414996555, 7: 0.3646321034642602, 11: 0.01902356019978028, 14: 0.005696139501977251, 16: 0.6843410265577335, 17: 0.00692850021451259, 25: 0.0028345272064403443, 27: 0.02481688446648005, 35: 0.002365632580902738, 37: 0.27665210040064975, 38: 0.20837674869688666, 50: 0.012016803285213406, 51: 0.0987008305796347, 53: 0.08286162168062966, 55: 0.11274846176840984, 58: 0.0033304509858747477, 59: 0.00344640803511476, 60: 0.0014861709286034695, 65: 0.015267701973782003, 67: 0.0022017689060893865, 70: 0.0077315776304088596, 71: 0.014232974844652427, 76: 0.0017204639378900362, 81: 0.028998667019770386, 82: 0.11274846176840984, 83: 0.1600281651372783, 84: 0.28567753731670137, 85: 0.012316237572179279, 86: 0.001462322340259803, 87: 0.013169658021235953, 88: 0.0018372118346561223, 96: 0.004368237516189167, 97: 0.04254936811742193, 98: 0.14774031997918607, 99: 0.023534752511461823, 104: 0.00308814771362134, 105: 0.011923655162267038, 106: 0.013175037416157892, 107: 0.008195428194585332, 110: 0.01224175480782032, 111: 0.004846677095389284, 119: 0.012708120551536403},[16, 7, 84, 37, 38, 83, 98, 55, 82, 51, 53, 6, 97, 81, 27, 99, 11, 65, 71, 106, 87, 119, 85, 110, 50, 105, 5, 107, 70, 17, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:34:05,87 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:34:05,88 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:05,88 INFO     [oort.py:398] At round 24, UCB exploited 43, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3785.6142084751823, 'duration': 13.298442137908651, 'time_stamp': 25, 'count': 22, 'status': True, 'gradient': 11.374530885490124}, [0.5200043974608937, -1.2000480019200778e-05]), ({'reward': 0.01, 'duration': 6.342067858842259, 'time_stamp': 25, 'count': 23, 'status': True, 'gradient': 55.244858131743115}, [1.3736364592026132e-09, -1.2000480019200778e-05]), ({'reward': 1833.7094479751718, 'duration': 5.8943907365129, 'time_stamp': 25, 'count': 22, 'status': True, 'gradient': 20.716816021397918}, [0.25188364306948685, -1.2000480019200778e-05])]
2021-08-18:15:34:05,89 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 81, 99, 38, 11, 87, 85, 110, 71, 27]
2021-08-18:15:34:05,393 INFO     [param_server.py:553] For epoch: 26, median_reward: 573.711945457358, dev: 2868.55972728679
2021-08-18:15:34:06,17 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3168, Top-1 Accuracy: 529.0/1033 (0.5121), Top-5 Accuracy: 1.0
2021-08-18:15:34:06,20 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 281.1563, eval_time 0.6141, test_loss 2.3168, test_accuracy 0.5121, test_5_accuracy 1.0 

2021-08-18:15:34:06,23 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2037, Top-1 Accuracy: 536.0/1033 (0.5189), Top-5 Accuracy: 1.0
2021-08-18:15:34:06,23 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3769, Top-1 Accuracy: 526.0/1033 (0.5092), Top-5 Accuracy: 1.0
2021-08-18:15:34:06,23 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 281.1627, eval_time 0.6176, test_loss 2.2037, test_accuracy 0.5189, test_5_accuracy 1.0 

2021-08-18:15:34:06,24 INFO     [learner.py:656] After aggregation epoch 25, CumulTime 281.1484, eval_time 0.6171, test_loss 2.3769, test_accuracy 0.5092, test_5_accuracy 1.0 

2021-08-18:15:34:06,79 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:34:06,86 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:34:06,86 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:06,92 INFO     [learner.py:526] ====Start train round 26
2021-08-18:15:34:06,94 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:06,100 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:06,718 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:06,728 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:07,773 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:07,782 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:08,431 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:08,445 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:08,747 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:08,762 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:09,59 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:09,73 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:09,147 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:09,161 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:09,656 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:09,670 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:09,755 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:09,769 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:10,107 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:10,127 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:10,453 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:10,467 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:10,892 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:10,903 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:11,667 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:11,694 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:12,19 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:12,30 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:12,66 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:12,80 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:12,624 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:12,642 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:34:13,259 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:34:13,286 INFO     [learner.py:606] ====Pushing takes 0.025890827178955078 s
2021-08-18:15:34:13,303 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:13,317 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:13,326 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 7 clients
2021-08-18:15:34:13,327 INFO     [param_server.py:410] Lock worker 3 with localStep 26 , while globalStep is 25

2021-08-18:15:34:13,327 INFO     [learner.py:606] ====Pushing takes 0.02261972427368164 s
2021-08-18:15:34:13,356 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:13,363 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 14 clients
2021-08-18:15:34:13,364 INFO     [param_server.py:410] Lock worker 2 with localStep 26 , while globalStep is 25

2021-08-18:15:34:14,392 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:14,414 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:15,44 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:15,64 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:15,736 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:15,758 INFO     [learner.py:606] ====Pushing takes 0.019792795181274414 s
2021-08-18:15:34:15,783 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:15,789 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:15,790 INFO     [param_server.py:381] ====After aggregation in epoch: 25, virtual_clock: 678.3348604626681, top_1: : 51.3391 % (1591.0), top_5: : 100.0 % (3099.0), test loss: 2.2991230708581427, test len: 3099.0
2021-08-18:15:34:15,791 INFO     [param_server.py:410] Lock worker 1 with localStep 26 , while globalStep is 26

2021-08-18:15:34:15,791 INFO     [param_server.py:441] ====Epoch 27 completes 20 clients with loss 3.841150932526388, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:15,791 INFO     [param_server.py:450] ====Start to sample for epoch 27, global virtualClock: 678.3348604626681, round_duration: 23.399274646833632
2021-08-18:15:34:15,792 INFO     [oort.py:208] Training selector: Pacer 25: lastExploitationUtil 1054.7418146669913, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:15,792 INFO     [oort.py:321] scores are 26,{5: 0.010360828645848003, 6: 0.084280280235852, 7: 0.2850618458393907, 11: 0.01877355929329903, 14: 0.005732606153773987, 16: 0.6572761335173335, 17: 0.01018205196588134, 25: 0.0028526738342918995, 27: 0.03776025699390179, 35: 0.0024522272177740978, 37: 0.047082500616365784, 38: 0.20238893485306567, 50: 0.015400203363692917, 51: 0.06139374409123332, 53: 0.10224491957462349, 55: 0.1280907323002881, 58: 0.004285393372717044, 59: 0.0044345988624361656, 60: 0.0019123016898233262, 65: 0.01956641127526979, 67: 0.00250749042082695, 70: 0.008260638937535434, 71: 0.010998494056557912, 76: 0.00217676456053138, 81: 0.028617576784001883, 82: 0.9248755220376579, 83: 0.050039812365247474, 84: 0.19526884500641536, 85: 0.012154381929747068, 86: 0.0018816149801644656, 87: 0.12980224257979403, 88: 0.002324476278632637, 96: 0.004396202947234705, 97: 0.04836266122568217, 98: 0.4389662764005203, 99: 0.023225467109576566, 104: 0.003973614324922507, 105: 0.015280828850998223, 106: 0.016884544975680822, 107: 0.00891011165159673, 110: 0.011587571106008344, 111: 0.004877705495951767, 119: 0.012285971505225151},[82, 16, 98, 7, 38, 84, 87, 55, 53, 6, 51, 83, 97, 37, 27, 81, 99, 65, 11, 106, 50, 105, 119, 85, 110, 71, 5, 17, 107, 70, 14, 111, 59, 96, 58, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:34:15,793 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:34:15,794 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:15,794 INFO     [oort.py:398] At round 25, UCB exploited 43, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 157.62205820218918, 'duration': 11.90395711384456, 'time_stamp': 26, 'count': 24, 'status': True, 'gradient': 20.415949545562754}, [0.03831036014445621, -1.1538905342513184e-05]), ({'reward': 3347.2653899345764, 'duration': 6.342067858842259, 'time_stamp': 26, 'count': 24, 'status': True, 'gradient': 65.00345159286937}, [0.8136087631466554, -1.1538905342513184e-05]), ({'reward': 2246.338828156149, 'duration': 7.864087706209871, 'time_stamp': 26, 'count': 24, 'status': True, 'gradient': 21.43429907142298}, [0.546009374626331, -1.1538905342513184e-05])]
2021-08-18:15:34:15,795 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 71, 27]
2021-08-18:15:34:16,65 INFO     [param_server.py:553] For epoch: 27, median_reward: 510.25313004123933, dev: 2551.265650206197
2021-08-18:15:34:16,634 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.018, Top-1 Accuracy: 485.0/1033 (0.4695), Top-5 Accuracy: 1.0
2021-08-18:15:34:16,635 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 291.7714, eval_time 0.5325, test_loss 3.018, test_accuracy 0.4695, test_5_accuracy 1.0 

2021-08-18:15:34:16,668 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2356, Top-1 Accuracy: 517.0/1033 (0.5005), Top-5 Accuracy: 1.0
2021-08-18:15:34:16,669 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 291.7934, eval_time 0.5606, test_loss 3.2356, test_accuracy 0.5005, test_5_accuracy 1.0 

2021-08-18:15:34:16,674 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8346, Top-1 Accuracy: 529.0/1033 (0.5121), Top-5 Accuracy: 1.0
2021-08-18:15:34:16,675 INFO     [learner.py:656] After aggregation epoch 26, CumulTime 291.814, eval_time 0.576, test_loss 2.8346, test_accuracy 0.5121, test_5_accuracy 1.0 

2021-08-18:15:34:16,714 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:34:16,724 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:16,738 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:34:16,743 INFO     [learner.py:526] ====Start train round 27
2021-08-18:15:34:16,750 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:16,757 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:17,212 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:17,226 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:18,359 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:18,369 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:18,434 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:18,444 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:18,984 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:18,997 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:19,107 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:19,125 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:19,487 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:19,501 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:19,605 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:19,618 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:20,16 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:20,30 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:20,104 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:20,118 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:20,155 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:20,168 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:20,659 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:20,672 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:20,681 INFO     [learner.py:606] ====Pushing takes 0.02102494239807129 s
2021-08-18:15:34:20,686 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:20,713 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:20,721 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:34:20,721 INFO     [param_server.py:410] Lock worker 2 with localStep 27 , while globalStep is 26

2021-08-18:15:34:21,237 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:21,251 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:22,225 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:22,234 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:22,986 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:23,7 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:34:23,161 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:23,182 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:23,582 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:34:23,610 INFO     [learner.py:606] ====Pushing takes 0.02591729164123535 s
2021-08-18:15:34:23,637 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:23,644 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:23,645 INFO     [param_server.py:410] Lock worker 3 with localStep 27 , while globalStep is 26

2021-08-18:15:34:23,731 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:23,758 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:24,391 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:24,418 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:24,927 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:24,955 INFO     [learner.py:606] ====Pushing takes 0.025981426239013672 s
2021-08-18:15:34:24,984 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:24,992 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:24,992 INFO     [param_server.py:381] ====After aggregation in epoch: 26, virtual_clock: 698.6910308378195, top_1: : 49.403 % (1531.0), top_5: : 100.0 % (3099.0), test loss: 3.029407969227544, test len: 3099.0
2021-08-18:15:34:24,994 INFO     [param_server.py:410] Lock worker 1 with localStep 27 , while globalStep is 27

2021-08-18:15:34:24,994 INFO     [param_server.py:441] ====Epoch 28 completes 20 clients with loss 9.912952114648867, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0} 
==========
2021-08-18:15:34:24,994 INFO     [param_server.py:450] ====Start to sample for epoch 28, global virtualClock: 698.6910308378195, round_duration: 20.356170375151418
2021-08-18:15:34:24,995 INFO     [oort.py:208] Training selector: Pacer 26: lastExploitationUtil 1218.0482050338317, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:24,996 INFO     [oort.py:321] scores are 26,{5: 0.010423758830401085, 6: 0.6253527964758159, 7: 0.10985001051896376, 11: 0.13262452441333422, 14: 0.005767425171771356, 16: 0.2604588121080651, 17: 0.011064094983058614, 25: 0.002870000561566612, 27: 0.009503063843386499, 35: 0.002485382681479948, 37: 0.3784257956387425, 38: 0.16767176741428427, 50: 0.018445923970655975, 51: 0.16111094503370602, 53: 0.07171953326151126, 55: 1.106072650598044, 58: 0.004550034872322082, 59: 0.00470845444371687, 60: 0.0020303945561898113, 65: 0.023436088877443553, 67: 0.0025972535965206687, 70: 0.00843337865559981, 71: 0.06459592966129422, 76: 0.0023037911270305383, 81: 0.04704432519828836, 82: 0.10985001051896376, 83: 0.049402659423129276, 84: 0.0495954780601395, 85: 0.1023098564793872, 86: 0.0019978128100300386, 87: 0.0128311025221389, 88: 0.0024601226622320495, 96: 0.00442290484606288, 97: 0.21946715976233508, 98: 0.04876390210748878, 99: 0.022929739088197867, 104: 0.004219002125373792, 105: 0.01830294058704744, 106: 0.020223825981077494, 107: 0.010672277385822613, 110: 0.011657952348548136, 111: 0.004907331971940285, 119: 0.014715785950289214},[55, 6, 37, 16, 97, 38, 51, 11, 7, 82, 85, 53, 71, 84, 83, 98, 81, 65, 99, 106, 50, 105, 119, 87, 110, 17, 107, 5, 27, 70, 14, 111, 59, 58, 96, 104, 25, 67, 35, 88, 76, 60, 86]
2021-08-18:15:34:24,997 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:34:24,998 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:24,998 INFO     [oort.py:398] At round 26, UCB exploited 43, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2179.4536637526885, 'duration': 15.972045438625893, 'time_stamp': 27, 'count': 23, 'status': True, 'gradient': 14.634890296006485}, [0.591358381410177, -1.1111522648987009e-05]), ({'reward': 3685.497069012052, 'duration': 11.90395711384456, 'time_stamp': 27, 'count': 25, 'status': True, 'gradient': 20.42649597882972}, [1.0, -1.1111522648987009e-05]), ({'reward': 3671.5756678307243, 'duration': 8.010998429338052, 'time_stamp': 27, 'count': 26, 'status': True, 'gradient': 20.62437630768053}, [0.9962226427924258, -1.1111522648987009e-05])]
2021-08-18:15:34:24,999 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 38, 11, 87, 85, 110, 71, 5]
2021-08-18:15:34:25,270 INFO     [param_server.py:553] For epoch: 28, median_reward: 544.2289298451559, dev: 2721.1446492257796
2021-08-18:15:34:25,924 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3585, Top-1 Accuracy: 561.0/1033 (0.5431), Top-5 Accuracy: 1.0
2021-08-18:15:34:25,927 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 301.0628, eval_time 0.6112, test_loss 2.3585, test_accuracy 0.5431, test_5_accuracy 1.0 

2021-08-18:15:34:25,962 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.108, Top-1 Accuracy: 550.0/1033 (0.5324), Top-5 Accuracy: 1.0
2021-08-18:15:34:25,964 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 301.0882, eval_time 0.6426, test_loss 2.108, test_accuracy 0.5324, test_5_accuracy 1.0 

2021-08-18:15:34:25,972 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1912, Top-1 Accuracy: 552.0/1033 (0.5344), Top-5 Accuracy: 1.0
2021-08-18:15:34:25,974 INFO     [learner.py:656] After aggregation epoch 27, CumulTime 301.1128, eval_time 0.658, test_loss 2.1912, test_accuracy 0.5344, test_5_accuracy 1.0 

2021-08-18:15:34:25,992 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:26,5 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:26,28 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:26,38 INFO     [learner.py:526] ====Start train round 28
2021-08-18:15:34:26,49 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:26,71 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:26,565 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:26,575 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:27,644 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:27,666 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:27,692 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:27,712 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:28,277 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:28,298 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:28,821 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:28,842 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:28,870 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:28,898 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:28,919 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:28,940 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:29,499 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:29,519 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:30,74 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:30,88 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:30,103 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:30,110 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:30,124 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:30,124 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:30,684 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:30,701 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:30,704 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:30,721 INFO     [learner.py:606] ====Pushing takes 0.018213272094726562 s
2021-08-18:15:34:30,745 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:30,752 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:34:30,753 INFO     [param_server.py:410] Lock worker 3 with localStep 28 , while globalStep is 27

2021-08-18:15:34:31,322 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:31,332 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:31,981 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:31,993 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:34:32,644 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:34:32,675 INFO     [learner.py:606] ====Pushing takes 0.02922368049621582 s
2021-08-18:15:34:32,711 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:32,722 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:32,723 INFO     [param_server.py:410] Lock worker 2 with localStep 28 , while globalStep is 27

2021-08-18:15:34:32,997 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:33,6 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:33,542 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:33,552 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:34,130 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:34,139 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:34,723 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:34,746 INFO     [learner.py:606] ====Pushing takes 0.021457910537719727 s
2021-08-18:15:34:34,775 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:34,783 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:34,784 INFO     [param_server.py:381] ====After aggregation in epoch: 27, virtual_clock: 719.1075711192494, top_1: : 53.6625 % (1663.0), top_5: : 100.0 % (3099.0), test loss: 2.2191943713912257, test len: 3099.0
2021-08-18:15:34:34,785 INFO     [param_server.py:410] Lock worker 1 with localStep 28 , while globalStep is 28

2021-08-18:15:34:34,786 INFO     [param_server.py:441] ====Epoch 29 completes 20 clients with loss 4.256405797790673, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 110: 0} 
==========
2021-08-18:15:34:34,786 INFO     [param_server.py:450] ====Start to sample for epoch 29, global virtualClock: 719.1075711192494, round_duration: 20.416540281429864
2021-08-18:15:34:34,787 INFO     [oort.py:208] Training selector: Pacer 27: lastExploitationUtil 1517.1159160256182, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:34,788 INFO     [oort.py:321] scores are 26,{5: 0.02220944378707955, 6: 0.06113144364194233, 7: 0.156108117891805, 11: 0.018305644190246186, 14: 0.005800732607922231, 16: 0.16475383591811799, 17: 0.008215407807256547, 25: 0.002886575090251005, 27: 0.009557944902230964, 35: 0.002434889939375672, 37: 0.15930839186641663, 38: 0.059075021300007045, 50: 0.013698310730813215, 51: 0.16262215267073418, 53: 0.7015636106249876, 55: 0.5965301073730789, 58: 0.0037289814643259155, 59: 0.0038588142374571983, 60: 0.001664010030199193, 65: 0.02012764374454088, 67: 0.0023475809021841214, 70: 0.00673888865133799, 71: 0.10957234084515821, 76: 0.0019129654109587512, 81: 0.10593296244903662, 82: 0.10849353130829444, 83: 0.048792612322153504, 84: 0.13666808957859503, 85: 0.09173299357939572, 86: 0.001637307657379101, 87: 0.012672658078310254, 88: 0.002042776145957127, 96: 0.004448447547766696, 97: 0.03395676311780356, 98: 0.2703320797270429, 99: 0.023062160418931468, 104: 0.0034576835485749784, 105: 0.01571913596761261, 106: 0.017368852227322682, 107: 0.009165684525607978, 110: 0.04363977016633714, 111: 0.0049356722850475284, 119: 0.012638375736551253},[53, 55, 98, 16, 51, 37, 7, 84, 71, 82, 81, 85, 6, 38, 83, 110, 97, 99, 5, 65, 11, 106, 105, 50, 87, 119, 27, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:34:34,788 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:34:34,789 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:34,789 INFO     [oort.py:398] At round 27, UCB exploited 43, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2815.4089424889726, 'duration': 13.411352670399307, 'time_stamp': 28, 'count': 24, 'status': True, 'gradient': 13.013548150142803}, [0.5004811529336787, -1.0714668381013617e-05]), ({'reward': 5434.4919372877785, 'duration': 11.058674649423494, 'time_stamp': 28, 'count': 25, 'status': True, 'gradient': 13.01286237128927}, [0.9660640770542817, -1.0714668381013617e-05]), ({'reward': 2745.4034218601373, 'duration': 8.010998429338052, 'time_stamp': 28, 'count': 27, 'status': True, 'gradient': 20.634462691463337}, [0.48803657784244064, -1.0714668381013617e-05])]
2021-08-18:15:34:34,790 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 85, 110, 71, 5]
2021-08-18:15:34:35,61 INFO     [param_server.py:553] For epoch: 29, median_reward: 617.0380146937672, dev: 3085.190073468836
2021-08-18:15:34:35,710 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5901, Top-1 Accuracy: 506.0/1033 (0.4898), Top-5 Accuracy: 1.0
2021-08-18:15:34:35,711 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 310.8358, eval_time 0.6232, test_loss 2.5901, test_accuracy 0.4898, test_5_accuracy 1.0 

2021-08-18:15:34:35,716 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9089, Top-1 Accuracy: 493.0/1033 (0.4773), Top-5 Accuracy: 1.0
2021-08-18:15:34:35,716 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 310.8525, eval_time 0.6289, test_loss 2.9089, test_accuracy 0.4773, test_5_accuracy 1.0 

2021-08-18:15:34:35,753 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7529, Top-1 Accuracy: 529.0/1033 (0.5121), Top-5 Accuracy: 1.0
2021-08-18:15:34:35,754 INFO     [learner.py:656] After aggregation epoch 28, CumulTime 310.8931, eval_time 0.6706, test_loss 2.7529, test_accuracy 0.5121, test_5_accuracy 1.0 

2021-08-18:15:34:35,773 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:35,777 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:35,781 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:35,787 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:35,846 INFO     [learner.py:526] ====Start train round 29
2021-08-18:15:34:35,864 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:36,437 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:36,447 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:37,476 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:37,488 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:37,697 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:37,706 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:38,318 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:38,329 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:38,627 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:38,654 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:38,826 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:38,840 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:39,18 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:39,27 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:39,433 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:39,447 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:39,662 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:39,672 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:39,995 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:40,22 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:40,32 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:40,46 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:41,370 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:41,391 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:41,431 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:41,451 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:34:41,835 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:41,854 INFO     [learner.py:606] ====Pushing takes 0.016970157623291016 s
2021-08-18:15:34:41,877 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:41,882 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 5 clients
2021-08-18:15:34:41,883 INFO     [param_server.py:410] Lock worker 3 with localStep 29 , while globalStep is 28

2021-08-18:15:34:41,983 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:34:42,3 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:34:42,538 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:34:42,577 INFO     [learner.py:606] ====Pushing takes 0.03100752830505371 s
2021-08-18:15:34:42,609 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:42,618 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:42,619 INFO     [param_server.py:410] Lock worker 2 with localStep 29 , while globalStep is 28

2021-08-18:15:34:43,466 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:43,486 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:44,79 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:44,100 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:44,746 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:44,767 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:45,325 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:45,350 INFO     [learner.py:606] ====Pushing takes 0.023652076721191406 s
2021-08-18:15:34:45,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:45,386 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:45,386 INFO     [param_server.py:381] ====After aggregation in epoch: 28, virtual_clock: 739.4637414944009, top_1: : 49.3062 % (1528.0), top_5: : 100.0 % (3099.0), test loss: 2.750643961959415, test len: 3099.0
2021-08-18:15:34:45,387 INFO     [param_server.py:410] Lock worker 1 with localStep 29 , while globalStep is 29

2021-08-18:15:34:45,388 INFO     [param_server.py:441] ====Epoch 30 completes 20 clients with loss 5.802391593815274, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:45,388 INFO     [param_server.py:450] ====Start to sample for epoch 30, global virtualClock: 739.4637414944009, round_duration: 20.356170375151418
2021-08-18:15:34:45,388 INFO     [oort.py:208] Training selector: Pacer 28: lastExploitationUtil 2438.8797280892436, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:45,389 INFO     [oort.py:321] scores are 26,{5: 0.05905260069767804, 6: 0.06712174698679482, 7: 0.10719310008242272, 11: 0.12255046327224033, 14: 0.0058326486566197735, 16: 0.10719310008242272, 17: 0.011528599415022432, 25: 0.002902457234028203, 27: 0.00961053338928869, 35: 0.0024298986112548555, 37: 0.21184889074191132, 38: 0.14730085494242634, 50: 0.012397201094378868, 51: 0.05914601698327793, 53: 0.5786015871644569, 55: 1.0781160085260337, 58: 0.003509222849819625, 59: 0.003631404238621488, 60: 0.0015659455741917, 65: 0.025404519678731433, 67: 0.002285444933726529, 70: 0.008505626964017042, 71: 0.060971710523073416, 76: 0.001808892263460659, 81: 0.10994831347700901, 82: 0.10719310008242272, 83: 0.1667388577601508, 84: 0.048395926574976204, 85: 0.0978137308818734, 86: 0.0015408168419249635, 87: 0.012742383936402982, 88: 0.0019316407632022296, 96: 0.0044729232266437205, 97: 0.033549748666753566, 98: 0.49149795814701824, 99: 0.0649613809440685, 104: 0.0032539132286349757, 105: 0.01984023088297058, 106: 0.021922454203099385, 107: 0.00822418441575939, 110: 0.04486646266559417, 111: 0.004962828708981555, 119: 0.01595178597065048},[55, 53, 98, 37, 83, 38, 11, 81, 7, 16, 82, 85, 6, 99, 71, 51, 5, 84, 110, 97, 65, 106, 105, 119, 87, 50, 17, 27, 70, 107, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:34:45,390 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:34:45,390 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:45,391 INFO     [oort.py:398] At round 28, UCB exploited 43, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6397.5008625381, 'duration': 8.010998429338052, 'time_stamp': 29, 'count': 28, 'status': True, 'gradient': 20.643970596583223}, [0.9709229099612731, -1.0345184316700584e-05]), ({'reward': 0.01, 'duration': 7.864087706209871, 'time_stamp': 29, 'count': 27, 'status': True, 'gradient': 21.458343087463714}, [1.517662047989817e-09, -1.0345184316700584e-05]), ({'reward': 5133.091994886203, 'duration': 11.058674649423494, 'time_stamp': 29, 'count': 26, 'status': True, 'gradient': 13.017477680653837}, [0.7790283748035589, -1.0345184316700584e-05])]
2021-08-18:15:34:45,391 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 83, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 5]
2021-08-18:15:34:45,653 INFO     [param_server.py:553] For epoch: 30, median_reward: 818.8336344579437, dev: 4094.1681722897188
2021-08-18:15:34:46,303 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.8671, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:34:46,306 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 321.4305, eval_time 0.6158, test_loss 1.8671, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:34:46,307 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9442, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:34:46,308 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 321.4468, eval_time 0.6199, test_loss 1.9442, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:34:46,309 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0142, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:34:46,310 INFO     [learner.py:656] After aggregation epoch 29, CumulTime 321.4461, eval_time 0.62, test_loss 2.0142, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:34:46,377 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:46,385 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:46,392 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:46,400 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:46,401 INFO     [learner.py:526] ====Start train round 30
2021-08-18:15:34:46,416 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:46,951 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:46,964 INFO     [learner.py:165] Start to run client 83 on rank 2...
2021-08-18:15:34:47,945 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:47,955 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:48,36 INFO     [learner.py:439] Completed to run client 83
2021-08-18:15:34:48,47 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:48,637 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:48,646 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:48,648 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:48,662 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:49,103 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:49,119 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:49,126 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:49,135 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:49,589 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:49,604 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:49,758 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:49,767 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:50,261 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:50,272 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:50,318 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:34:50,332 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:34:50,845 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:50,856 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:34:50,974 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:34:50,995 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:34:51,497 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:34:51,522 INFO     [learner.py:606] ====Pushing takes 0.023482084274291992 s
2021-08-18:15:34:51,566 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:51,577 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:34:51,578 INFO     [param_server.py:410] Lock worker 2 with localStep 30 , while globalStep is 29

2021-08-18:15:34:51,650 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:34:51,663 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:34:52,161 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:34:52,185 INFO     [learner.py:606] ====Pushing takes 0.02225494384765625 s
2021-08-18:15:34:52,211 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:52,219 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:34:52,220 INFO     [param_server.py:410] Lock worker 3 with localStep 30 , while globalStep is 29

2021-08-18:15:34:53,56 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:34:53,83 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:34:53,743 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:34:53,770 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:34:54,421 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:34:54,448 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:34:54,957 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:34:54,983 INFO     [learner.py:606] ====Pushing takes 0.02485179901123047 s
2021-08-18:15:34:55,13 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:34:55,22 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:34:55,23 INFO     [param_server.py:381] ====After aggregation in epoch: 29, virtual_clock: 759.8802817758308, top_1: : 57.5992 % (1785.0), top_5: : 100.0 % (3099.0), test loss: 1.9418456819322376, test len: 3099.0
2021-08-18:15:34:55,24 INFO     [param_server.py:410] Lock worker 1 with localStep 30 , while globalStep is 30

2021-08-18:15:34:55,24 INFO     [param_server.py:441] ====Epoch 31 completes 20 clients with loss 2.78260760111817, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 82: 0, 83: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:34:55,25 INFO     [param_server.py:450] ====Start to sample for epoch 31, global virtualClock: 759.8802817758308, round_duration: 20.416540281429864
2021-08-18:15:34:55,25 INFO     [oort.py:208] Training selector: Pacer 29: lastExploitationUtil 3163.2567877539373, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:34:55,26 INFO     [oort.py:321] scores are 26,{5: 0.05507462460921526, 6: 0.16603039207489853, 7: 0.6331066146848394, 11: 0.1357627156617506, 14: 0.005863279914348257, 16: 0.10594488966056924, 17: 0.01019917950337506, 25: 0.0029177000365998755, 27: 0.009661004895351462, 35: 0.002406835708551456, 37: 0.04483055203093053, 38: 0.019839570607617544, 50: 0.01768947535080082, 51: 0.254151463228302, 53: 0.17059826713165774, 55: 0.8741806250343978, 58: 0.0030595476397038655, 59: 0.0031660725871701383, 60: 0.0013652837937235, 65: 0.022474998659661714, 67: 0.0021512302447138274, 70: 0.006266221667095457, 71: 0.04384646052440262, 76: 0.0015951316635251017, 81: 0.284446697236174, 82: 0.7460702934499466, 84: 0.04783238004185335, 85: 0.04257749799177315, 86: 0.0013433750815140728, 87: 0.019703586975185098, 88: 0.0017033747151114851, 96: 0.00449641362906999, 97: 0.033159078503242984, 98: 0.14504961711905226, 99: 0.11341089003762131, 104: 0.0028369536403147037, 105: 0.017552355570629275, 106: 0.019394467404303912, 107: 0.006334899167099604, 110: 0.011033339405924525, 111: 0.004988891941652531, 119: 0.01411230650464644},[55, 82, 7, 81, 51, 53, 6, 98, 11, 99, 16, 5, 84, 37, 71, 85, 97, 65, 38, 87, 106, 50, 105, 119, 110, 17, 27, 107, 70, 14, 111, 96, 59, 58, 25, 104, 35, 67, 88, 76, 60, 86]
2021-08-18:15:34:55,41 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:34:55,42 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:34:55,42 INFO     [oort.py:398] At round 29, UCB exploited 42, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6400.896509358817, 'duration': 6.342067858842259, 'time_stamp': 30, 'count': 28, 'status': True, 'gradient': 55.33409267337958}, [0.6401254047894347, -1.0000333344444823e-05]), ({'reward': 2207.9542088732933, 'duration': 13.411352670399307, 'time_stamp': 30, 'count': 26, 'status': True, 'gradient': 13.021560407499823}, [0.22080709954538247, -1.0000333344444823e-05]), ({'reward': 0.01, 'duration': 13.73645665746006, 'time_stamp': 30, 'count': 27, 'status': True, 'gradient': 11.393297186898595}, [1.0000574183801192e-09, -1.0000333344444823e-05])]
2021-08-18:15:34:55,43 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 82, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5]
2021-08-18:15:34:55,321 INFO     [param_server.py:553] For epoch: 31, median_reward: 1013.939517052871, dev: 5069.697585264355
2021-08-18:15:34:56,111 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4406, Top-1 Accuracy: 519.0/1033 (0.5024), Top-5 Accuracy: 1.0
2021-08-18:15:34:56,113 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 331.2486, eval_time 0.7452, test_loss 2.4406, test_accuracy 0.5024, test_5_accuracy 1.0 

2021-08-18:15:34:56,113 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2116, Top-1 Accuracy: 543.0/1033 (0.5257), Top-5 Accuracy: 1.0
2021-08-18:15:34:56,114 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 331.2383, eval_time 0.7367, test_loss 2.2116, test_accuracy 0.5257, test_5_accuracy 1.0 

2021-08-18:15:34:56,117 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0459, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:34:56,118 INFO     [learner.py:656] After aggregation epoch 30, CumulTime 331.2575, eval_time 0.7513, test_loss 2.0459, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:34:56,182 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:56,168 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:56,200 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:34:56,204 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:34:56,224 INFO     [learner.py:526] ====Start train round 31
2021-08-18:15:34:56,242 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:34:56,871 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:34:56,892 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:34:57,553 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:34:57,574 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:34:57,600 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:34:57,621 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:34:58,125 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:34:58,143 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:34:58,689 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:34:58,710 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:34:58,724 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:34:58,745 INFO     [learner.py:165] Start to run client 82 on rank 1...
2021-08-18:15:34:58,912 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:34:58,924 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:34:59,460 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:34:59,474 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:34:59,688 INFO     [learner.py:439] Completed to run client 82
2021-08-18:15:34:59,707 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:34:59,878 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:34:59,889 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:00,96 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:00,106 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:00,950 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:00,959 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:01,30 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:01,41 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:01,386 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:01,397 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:01,617 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:01,642 INFO     [learner.py:606] ====Pushing takes 0.02407383918762207 s
2021-08-18:15:35:01,680 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:01,687 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:35:01,688 INFO     [param_server.py:410] Lock worker 2 with localStep 31 , while globalStep is 30

2021-08-18:15:35:01,953 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:01,977 INFO     [learner.py:606] ====Pushing takes 0.02254033088684082 s
2021-08-18:15:35:02,3 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:02,9 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:35:02,9 INFO     [param_server.py:410] Lock worker 3 with localStep 31 , while globalStep is 30

2021-08-18:15:35:02,674 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:02,688 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:03,282 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:03,296 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:04,6 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:04,19 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:04,554 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:04,580 INFO     [learner.py:606] ====Pushing takes 0.024891138076782227 s
2021-08-18:15:35:04,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:04,617 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:04,618 INFO     [param_server.py:381] ====After aggregation in epoch: 30, virtual_clock: 778.8036977776247, top_1: : 52.3072 % (1621.0), top_5: : 100.0 % (3099.0), test loss: 2.2327010653637074, test len: 3099.0
2021-08-18:15:35:04,619 INFO     [param_server.py:410] Lock worker 1 with localStep 31 , while globalStep is 31

2021-08-18:15:35:04,620 INFO     [param_server.py:441] ====Epoch 32 completes 20 clients with loss 4.892260561340776, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 82: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:04,620 INFO     [param_server.py:450] ====Start to sample for epoch 32, global virtualClock: 778.8036977776247, round_duration: 18.923416001793925
2021-08-18:15:35:04,621 INFO     [oort.py:208] Training selector: Pacer 30: lastExploitationUtil 1764.4371102505354, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:04,621 INFO     [oort.py:321] scores are 26,{5: 0.06724820256845083, 6: 0.06664900337976455, 7: 0.10474542825330646, 11: 0.0176732429762234, 14: 0.005892721421366831, 16: 0.5187380617067426, 17: 0.008286516190502111, 25: 0.0029323507934743576, 27: 0.02968110104096665, 35: 0.0024424905364901165, 37: 0.0443230002537786, 38: 0.043532923897117125, 50: 0.014372148646603597, 51: 0.35129436671219894, 53: 0.6084529204303749, 55: 0.10474542825330646, 58: 0.003382885803569993, 59: 0.0035006684874652415, 60: 0.0015095692917788486, 65: 0.018260237523339072, 67: 0.002258231410490649, 70: 0.007800423567742548, 71: 0.02842428471121223, 76: 0.0017500287015120215, 81: 0.026940303646891362, 84: 0.04729084288926823, 85: 0.12067842807875306, 86: 0.0014853452298469528, 87: 0.11540337623898074, 88: 0.0018687828152613513, 96: 0.004518991639220029, 97: 0.03278366601197074, 98: 0.04649790915285757, 99: 0.0412138324698674, 104: 0.0031367676942385277, 105: 0.014260743089121881, 106: 0.024515398800459644, 107: 0.007638122656795069, 110: 0.010908424793685671, 111: 0.005013942852299051, 112: 0.14730281216330868, 119: 0.011465810195553788},[53, 16, 51, 112, 85, 87, 7, 55, 5, 6, 84, 98, 37, 38, 99, 97, 27, 71, 81, 106, 65, 11, 50, 105, 119, 110, 17, 70, 107, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:35:04,628 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:04,628 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:04,629 INFO     [oort.py:398] At round 30, UCB exploited 42, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 31, 'count': 28, 'status': True, 'gradient': 20.75622425854306}, [1.3508650613971689e-09, -9.677731539727095e-06]), ({'reward': 3163.2689541261984, 'duration': 41.695355953560366, 'time_stamp': 30, 'count': 20, 'status': True, 'gradient': 17.10925417175668}, [0.42731360147896563, 0.00966805380818736]), ({'reward': 3937.6484866623605, 'duration': 12.029357192292537, 'time_stamp': 31, 'count': 28, 'status': True, 'gradient': 26.55793337327847}, [0.5319218269553873, -9.677731539727095e-06])]
2021-08-18:15:35:04,629 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 87, 85, 110, 71, 5, 27, 106]
2021-08-18:15:35:04,927 INFO     [param_server.py:553] For epoch: 32, median_reward: 750.231556029676, dev: 3751.15778014838
2021-08-18:15:35:05,595 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0368, Top-1 Accuracy: 578.0/1033 (0.5595), Top-5 Accuracy: 1.0
2021-08-18:15:35:05,599 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 340.7231, eval_time 0.6349, test_loss 2.0368, test_accuracy 0.5595, test_5_accuracy 1.0 

2021-08-18:15:35:05,600 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0438, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:35:05,601 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 340.7366, eval_time 0.6371, test_loss 2.0438, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:35:05,666 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:35:05,673 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:05,679 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8843, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:15:35:05,680 INFO     [learner.py:656] After aggregation epoch 31, CumulTime 340.8194, eval_time 0.717, test_loss 1.8843, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:15:35:05,701 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:35:05,710 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:05,748 INFO     [learner.py:526] ====Start train round 32
2021-08-18:15:35:05,766 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:06,772 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:06,782 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:07,943 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:07,961 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:08,565 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:08,579 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:08,630 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:08,650 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:09,176 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:09,210 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:10,317 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:10,338 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:11,162 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:11,171 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:11,218 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:11,238 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:11,748 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:11,757 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:12,181 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:12,199 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:12,250 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:12,259 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:12,827 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:12,849 INFO     [learner.py:606] ====Pushing takes 0.02147674560546875 s
2021-08-18:15:35:12,877 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:12,886 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:35:12,887 INFO     [param_server.py:410] Lock worker 2 with localStep 32 , while globalStep is 31

2021-08-18:15:35:13,972 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:13,982 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:14,488 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:14,497 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:14,936 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:14,945 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:15,469 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:15,479 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:15,539 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:15,552 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:15,992 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:16,18 INFO     [learner.py:606] ====Pushing takes 0.025246858596801758 s
2021-08-18:15:35:16,54 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:16,61 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:15:35:16,62 INFO     [param_server.py:410] Lock worker 3 with localStep 32 , while globalStep is 31

2021-08-18:15:35:16,166 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:16,180 INFO     [learner.py:165] Start to run client 106 on rank 1...
2021-08-18:15:35:16,772 INFO     [learner.py:439] Completed to run client 106
2021-08-18:15:35:16,799 INFO     [learner.py:606] ====Pushing takes 0.025490283966064453 s
2021-08-18:15:35:16,828 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:16,835 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:16,836 INFO     [param_server.py:381] ====After aggregation in epoch: 31, virtual_clock: 810.990446945117, top_1: : 57.4379 % (1780.0), top_5: : 100.0 % (3099.0), test loss: 1.9882978554125186, test len: 3099.0
2021-08-18:15:35:16,837 INFO     [param_server.py:410] Lock worker 1 with localStep 32 , while globalStep is 32

2021-08-18:15:35:16,837 INFO     [param_server.py:441] ====Epoch 33 completes 20 clients with loss 3.5272228038605284, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 106: 0, 110: 0} 
==========
2021-08-18:15:35:16,837 INFO     [param_server.py:450] ====Start to sample for epoch 33, global virtualClock: 810.990446945117, round_duration: 32.18674916749226
2021-08-18:15:35:16,838 INFO     [oort.py:208] Training selector: Pacer 31: lastExploitationUtil 1773.3326978948423, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:16,839 INFO     [oort.py:321] scores are 26,{5: 0.009458814925287292, 6: 0.05836939075255309, 7: 0.7147515474511891, 11: 0.017758229614129033, 14: 0.005921058184077368, 16: 0.10359155527472802, 17: 0.008922828513455532, 25: 0.0029464518044769188, 27: 0.06449129211186279, 35: 0.0024637762352580773, 37: 0.07409931420582534, 38: 0.0913604954010141, 50: 0.015462132197566479, 51: 0.22854732243577724, 53: 0.06763347549115577, 55: 0.10359155527472802, 58: 0.0035238146808256507, 59: 0.0036465041166378566, 60: 0.0015724569911524137, 65: 0.019662420767664945, 67: 0.002308029950669263, 70: 0.006577327209016109, 71: 0.010239815480067551, 76: 0.001817900854996696, 81: 0.28384142445824884, 84: 0.04676988816452202, 85: 0.011315969949601256, 86: 0.0015472237701625825, 87: 0.05410687288965494, 88: 0.001941260663171704, 96: 0.004540722446535502, 97: 0.206105339841085, 98: 0.045985689366022306, 99: 0.021623369201044188, 104: 0.003267443447139894, 105: 0.015342277644174217, 106: 0.030363333518447833, 107: 0.008945941881317431, 110: 0.09607619560647328, 111: 0.005038053768183952, 119: 0.012335377079317516},[7, 81, 51, 97, 16, 55, 110, 38, 37, 53, 27, 6, 87, 84, 98, 106, 99, 65, 11, 50, 105, 119, 85, 71, 5, 107, 17, 70, 14, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:35:16,839 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:35:16,840 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:16,840 INFO     [oort.py:398] At round 31, UCB exploited 41, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2566.454582653396, 'duration': 20.64883858350112, 'time_stamp': 32, 'count': 28, 'status': True, 'gradient': 11.400953579490762}, [0.3842807795521823, -9.375292977905568e-06]), ({'reward': 4081.682414101, 'duration': 5.8943907365129, 'time_stamp': 32, 'count': 29, 'status': True, 'gradient': 20.762900186913942}, [0.6111599936737885, -9.375292977905568e-06]), ({'reward': 2074.475981385962, 'duration': 12.029357192292537, 'time_stamp': 32, 'count': 29, 'status': True, 'gradient': 26.565849023293545}, [0.31061547582451504, -9.375292977905568e-06])]
2021-08-18:15:35:16,841 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:35:17,130 INFO     [param_server.py:553] For epoch: 33, median_reward: 711.2948828882257, dev: 3556.474414441129
2021-08-18:15:35:17,796 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5189, Top-1 Accuracy: 549.0/1033 (0.5315), Top-5 Accuracy: 1.0
2021-08-18:15:35:17,799 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 352.924, eval_time 0.6346, test_loss 2.5189, test_accuracy 0.5315, test_5_accuracy 1.0 

2021-08-18:15:35:17,797 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3499, Top-1 Accuracy: 519.0/1033 (0.5024), Top-5 Accuracy: 1.0
2021-08-18:15:35:17,800 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 352.9361, eval_time 0.6352, test_loss 2.3499, test_accuracy 0.5024, test_5_accuracy 1.0 

2021-08-18:15:35:17,857 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:35:17,865 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:17,886 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.481, Top-1 Accuracy: 555.0/1033 (0.5373), Top-5 Accuracy: 1.0
2021-08-18:15:35:17,889 INFO     [learner.py:656] After aggregation epoch 32, CumulTime 353.0286, eval_time 0.7245, test_loss 2.481, test_accuracy 0.5373, test_5_accuracy 1.0 

2021-08-18:15:35:17,895 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:35:17,904 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:17,959 INFO     [learner.py:526] ====Start train round 33
2021-08-18:15:35:17,982 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:18,402 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:18,413 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:18,975 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:18,984 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:19,575 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:19,589 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:20,24 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:20,55 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:21,213 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:21,229 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:21,234 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:21,241 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:21,992 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:22,6 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:22,475 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:22,490 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:22,685 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:22,688 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:22,705 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:22,707 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:23,347 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:23,367 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:23,564 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:23,591 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:23,946 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:23,960 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:24,191 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:24,201 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:35:24,460 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:24,481 INFO     [learner.py:606] ====Pushing takes 0.019272327423095703 s
2021-08-18:15:35:24,508 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:24,515 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 6 clients
2021-08-18:15:35:24,515 INFO     [param_server.py:410] Lock worker 3 with localStep 33 , while globalStep is 32

2021-08-18:15:35:24,847 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:35:24,880 INFO     [learner.py:606] ====Pushing takes 0.030565977096557617 s
2021-08-18:15:35:24,917 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:24,926 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 14 clients
2021-08-18:15:35:24,927 INFO     [param_server.py:410] Lock worker 2 with localStep 33 , while globalStep is 32

2021-08-18:15:35:24,998 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:25,26 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:25,521 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:25,530 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:26,133 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:26,142 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:26,704 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:26,725 INFO     [learner.py:606] ====Pushing takes 0.019658803939819336 s
2021-08-18:15:35:26,752 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:26,759 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:26,760 INFO     [param_server.py:381] ====After aggregation in epoch: 32, virtual_clock: 836.6300137206521, top_1: : 52.3717 % (1623.0), top_5: : 100.0 % (3099.0), test loss: 2.4499247350074627, test len: 3099.0
2021-08-18:15:35:26,761 INFO     [param_server.py:410] Lock worker 1 with localStep 33 , while globalStep is 33

2021-08-18:15:35:26,762 INFO     [param_server.py:441] ====Epoch 34 completes 20 clients with loss 4.7789362182147945, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 110: 0} 
==========
2021-08-18:15:35:26,762 INFO     [param_server.py:450] ====Start to sample for epoch 34, global virtualClock: 836.6300137206521, round_duration: 25.639566775535034
2021-08-18:15:35:26,763 INFO     [oort.py:208] Training selector: Pacer 32: lastExploitationUtil 1518.2152992787312, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:26,764 INFO     [oort.py:321] scores are 26,{5: 0.01388282755511899, 6: 0.13447277878998173, 7: 0.3082814133981784, 11: 0.17172951880902573, 14: 0.005948366586727386, 16: 0.8154214118347562, 17: 0.008684188526550986, 25: 0.0029600410804294527, 27: 0.016764040914950495, 35: 0.002488027717588953, 37: 0.04336454995948061, 38: 0.06347012084279897, 50: 0.015061872264459727, 51: 0.09703561293137065, 53: 0.2709034678213006, 55: 0.10248039010243824, 58: 0.003708476179366365, 59: 0.0038375950154519384, 60: 0.0016548598104485157, 65: 0.005454195856028503, 67: 0.002371279124648926, 70: 0.006407063463042165, 71: 0.012610637085529794, 76: 0.0019066072488110929, 81: 0.13005320981147844, 84: 0.05145709066763134, 85: 0.03454312707976372, 86: 0.0016283042712260188, 87: 0.12877594481324928, 88: 0.002035986529222314, 96: 0.004561664628327504, 97: 0.11373126659621699, 98: 0.045492428150745175, 99: 0.0217230979666648, 104: 0.0034386701029084426, 105: 0.014945120321684834, 107: 0.009799862397830338, 110: 0.06210155606392356, 111: 0.00506128968292572, 119: 0.01201605778094861},[16, 7, 53, 11, 6, 81, 87, 97, 55, 51, 38, 110, 84, 98, 37, 85, 99, 27, 50, 105, 5, 71, 119, 107, 17, 70, 14, 65, 111, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:35:26,764 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:35:26,765 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:26,766 INFO     [oort.py:398] At round 32, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 804.2076099168252, 'duration': 11.90395711384456, 'time_stamp': 33, 'count': 31, 'status': True, 'gradient': 20.466762180627413}, [0.13617627936429472, -9.091184581350956e-06]), ({'reward': 4210.328239672292, 'duration': 7.864087706209871, 'time_stamp': 33, 'count': 31, 'status': True, 'gradient': 21.48656750843565}, [0.7129410234256366, -9.091184581350956e-06]), ({'reward': 0.01, 'duration': 19.55790138125729, 'time_stamp': 32, 'count': 28, 'status': True, 'gradient': 19.541959810075667}, [1.693318607164907e-09, 0.009082093396769597])]
2021-08-18:15:35:26,767 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27]
2021-08-18:15:35:27,34 INFO     [param_server.py:553] For epoch: 34, median_reward: 674.5449027924308, dev: 3372.7245139621537
2021-08-18:15:35:27,641 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1839, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:35:27,641 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 362.766, eval_time 0.5925, test_loss 2.1839, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:35:27,650 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0438, Top-1 Accuracy: 586.0/1033 (0.5673), Top-5 Accuracy: 1.0
2021-08-18:15:35:27,651 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 362.7869, eval_time 0.6019, test_loss 2.0438, test_accuracy 0.5673, test_5_accuracy 1.0 

2021-08-18:15:35:27,694 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8561, Top-1 Accuracy: 574.0/1033 (0.5557), Top-5 Accuracy: 1.0
2021-08-18:15:35:27,695 INFO     [learner.py:656] After aggregation epoch 33, CumulTime 362.8337, eval_time 0.6489, test_loss 1.8561, test_accuracy 0.5557, test_5_accuracy 1.0 

2021-08-18:15:35:27,719 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:27,727 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:27,747 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:27,755 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:27,764 INFO     [learner.py:526] ====Start train round 34
2021-08-18:15:35:27,779 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:28,355 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:28,370 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:29,19 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:29,33 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:29,282 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:29,291 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:29,626 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:29,641 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:30,288 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:30,314 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:30,424 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:30,442 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:30,556 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:30,567 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:31,99 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:31,108 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:31,122 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:31,136 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:31,679 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:31,693 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:31,693 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:31,707 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:31,828 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:31,863 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:32,226 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:32,251 INFO     [learner.py:606] ====Pushing takes 0.023906946182250977 s
2021-08-18:15:35:32,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:32,305 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:35:32,306 INFO     [param_server.py:410] Lock worker 2 with localStep 34 , while globalStep is 33

2021-08-18:15:35:33,539 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:33,560 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:34,185 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:34,226 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:34,508 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:34,535 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:34,754 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:34,783 INFO     [learner.py:606] ====Pushing takes 0.0278623104095459 s
2021-08-18:15:35:34,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:34,821 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:35:34,822 INFO     [param_server.py:410] Lock worker 3 with localStep 34 , while globalStep is 33

2021-08-18:15:35:35,117 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:35,138 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:35,685 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:35,699 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:36,271 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:36,295 INFO     [learner.py:606] ====Pushing takes 0.022442102432250977 s
2021-08-18:15:35:36,320 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:36,327 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:36,327 INFO     [param_server.py:381] ====After aggregation in epoch: 33, virtual_clock: 858.3303061555671, top_1: : 55.4695 % (1719.0), top_5: : 100.0 % (3099.0), test loss: 2.027954814610658, test len: 3099.0
2021-08-18:15:35:36,328 INFO     [param_server.py:410] Lock worker 1 with localStep 34 , while globalStep is 34

2021-08-18:15:35:36,329 INFO     [param_server.py:441] ====Epoch 35 completes 20 clients with loss 5.02554829645316, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:36,330 INFO     [param_server.py:450] ====Start to sample for epoch 35, global virtualClock: 858.3303061555671, round_duration: 21.70029243491498
2021-08-18:15:35:36,330 INFO     [oort.py:208] Training selector: Pacer 33: lastExploitationUtil 1669.932787414115, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:36,331 INFO     [oort.py:321] scores are 26,{5: 0.029234184099940986, 6: 0.15266950915834673, 7: 0.1014092994834221, 11: 0.017110352401108735, 14: 0.005974715469616221, 16: 0.3167477673840202, 17: 0.00747441113859597, 25: 0.0029731528769916743, 27: 0.08045687003276994, 35: 0.0024680432688291825, 37: 0.06999452107239325, 38: 0.07591772522590023, 50: 0.012963632177881707, 51: 0.08915455583525464, 53: 0.33295364493397495, 55: 0.1014092994834221, 58: 0.0033197618160337172, 59: 0.0034353466980811035, 60: 0.001481401024006158, 65: 0.016470675927030748, 67: 0.002255232969089982, 70: 0.005204846878024325, 71: 0.010024103913868748, 76: 0.0017218223940939934, 81: 0.2832801529272539, 84: 0.07335173024443686, 85: 0.011077588153987985, 86: 0.0014576289783326452, 87: 0.011845179733919527, 88: 0.0018386624734982435, 93: 0.08601273739212874, 96: 0.004795976832246147, 97: 0.06861957039044665, 98: 0.2161774796846018, 99: 0.021167852122056605, 104: 0.0030782362224914326, 105: 0.012140829148441867, 107: 0.007888257935161371, 110: 0.04469791188781396, 111: 0.005949355553641895, 119: 0.010342124177214886},[53, 16, 81, 98, 6, 7, 55, 51, 93, 27, 38, 84, 37, 97, 110, 5, 99, 11, 65, 50, 105, 87, 85, 119, 71, 107, 17, 14, 111, 70, 96, 59, 58, 104, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:35:36,332 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:35:36,332 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:36,332 INFO     [oort.py:398] At round 33, UCB exploited 41, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1728.3345473438621, 'duration': 7.864087706209871, 'time_stamp': 34, 'count': 32, 'status': True, 'gradient': 21.493844514653393}, [0.21533846914653582, -8.823788934968683e-06]), ({'reward': 2439.918623039032, 'duration': 20.64883858350112, 'time_stamp': 34, 'count': 30, 'status': True, 'gradient': 8.150658736509776}, [0.3039974104768267, -8.823788934968683e-06]), ({'reward': 3094.6414631023836, 'duration': 13.411352670399307, 'time_stamp': 34, 'count': 30, 'status': True, 'gradient': 13.041237816627126}, [0.3855717961993713, -8.823788934968683e-06])]
2021-08-18:15:35:36,333 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 81, 99, 38, 93, 11, 87, 85, 110, 71, 5]
2021-08-18:15:35:36,603 INFO     [param_server.py:553] For epoch: 35, median_reward: 745.3723853493253, dev: 3726.8619267466265
2021-08-18:15:35:37,270 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6228, Top-1 Accuracy: 541.0/1033 (0.5237), Top-5 Accuracy: 1.0
2021-08-18:15:35:37,271 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 372.3955, eval_time 0.644, test_loss 2.6228, test_accuracy 0.5237, test_5_accuracy 1.0 

2021-08-18:15:35:37,299 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.356, Top-1 Accuracy: 554.0/1033 (0.5363), Top-5 Accuracy: 1.0
2021-08-18:15:35:37,300 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 372.4388, eval_time 0.6742, test_loss 2.356, test_accuracy 0.5363, test_5_accuracy 1.0 

2021-08-18:15:35:37,301 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6512, Top-1 Accuracy: 528.0/1033 (0.5111), Top-5 Accuracy: 1.0
2021-08-18:15:35:37,302 INFO     [learner.py:656] After aggregation epoch 34, CumulTime 372.4382, eval_time 0.6753, test_loss 2.6512, test_accuracy 0.5111, test_5_accuracy 1.0 

2021-08-18:15:35:37,337 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:37,352 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:37,366 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:37,372 INFO     [learner.py:526] ====Start train round 35
2021-08-18:15:35:37,382 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:37,387 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:37,955 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:37,971 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:38,546 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:38,556 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:38,588 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:38,602 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:39,137 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:39,151 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:39,505 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:39,517 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:39,776 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:39,786 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:39,886 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:39,906 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:40,470 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:40,479 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:40,647 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:40,668 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:35:40,725 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:40,739 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:41,23 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:41,32 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:42,10 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:35:42,11 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:42,24 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:42,25 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:35:42,554 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:35:42,562 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:42,563 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:42,589 INFO     [learner.py:606] ====Pushing takes 0.025400161743164062 s
2021-08-18:15:35:42,625 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:42,633 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:35:42,634 INFO     [param_server.py:410] Lock worker 2 with localStep 35 , while globalStep is 34

2021-08-18:15:35:42,739 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:42,759 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:43,155 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:43,186 INFO     [learner.py:606] ====Pushing takes 0.029855966567993164 s
2021-08-18:15:35:43,216 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:43,223 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:35:43,224 INFO     [param_server.py:410] Lock worker 3 with localStep 35 , while globalStep is 34

2021-08-18:15:35:43,342 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:43,363 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:44,112 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:44,139 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:44,806 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:44,830 INFO     [learner.py:606] ====Pushing takes 0.023089170455932617 s
2021-08-18:15:35:44,860 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:44,869 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:44,869 INFO     [param_server.py:381] ====After aggregation in epoch: 34, virtual_clock: 877.3027147543609, top_1: : 52.3717 % (1623.0), top_5: : 100.0 % (3099.0), test loss: 2.5433762779942266, test len: 3099.0
2021-08-18:15:35:44,870 INFO     [param_server.py:410] Lock worker 1 with localStep 35 , while globalStep is 35

2021-08-18:15:35:44,871 INFO     [param_server.py:441] ====Epoch 36 completes 20 clients with loss 6.417859922861376, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:44,871 INFO     [param_server.py:450] ====Start to sample for epoch 36, global virtualClock: 877.3027147543609, round_duration: 18.972408598793734
2021-08-18:15:35:44,872 INFO     [oort.py:208] Training selector: Pacer 34: lastExploitationUtil 1482.059526457503, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:44,872 INFO     [oort.py:321] scores are 26,{3: 0.63430174220557, 5: 0.04701822447549821, 6: 0.6200145282846816, 7: 0.10037587361929333, 11: 0.016935986925696353, 14: 0.005313834779805157, 16: 0.10037587361929333, 17: 0.006884024919320132, 25: 0.0029858181955597727, 27: 0.022747915440016708, 35: 0.002468041274947254, 37: 0.042474024366411886, 38: 0.01879669928725626, 50: 0.01101496948017672, 51: 0.05538447084031661, 53: 0.20360359052991742, 55: 0.6477481123153886, 58: 0.0031964984723540165, 59: 0.003307791667277594, 60: 0.0014263963418426357, 65: 0.013994842661740059, 67: 0.0022219201436912838, 70: 0.004809657451630954, 71: 0.00992195185974673, 76: 0.001663622400804368, 81: 0.02581646339338341, 84: 0.19861843772126392, 85: 0.010964700419146968, 86: 0.0014035069564315766, 87: 0.01172446974810321, 88: 0.001776513122911018, 96: 0.004417153861817979, 97: 0.08842747194522446, 98: 0.19462066074558548, 99: 0.06653736239503612, 104: 0.002963940766839258, 105: 0.010929587061322242, 107: 0.00725881104264821, 110: 0.010453369533500335, 111: 0.005479429900996817, 119: 0.008787520396219255},[55, 3, 6, 53, 84, 98, 7, 16, 97, 99, 51, 5, 37, 81, 27, 38, 11, 65, 87, 50, 85, 105, 110, 71, 119, 107, 17, 111, 14, 70, 96, 59, 58, 25, 104, 35, 67, 88, 76, 60, 86]
2021-08-18:15:35:44,873 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:35:44,873 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:44,874 INFO     [oort.py:398] At round 34, UCB exploited 41, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 368.9357949668844, 'duration': 1.0, 'time_stamp': 1, 'count': 1, 'status': True, 'gradient': 8.072485915952484}, [0.040470072065271666, 0.29142832652361494]), ({'reward': 1660.5310273098169, 'duration': 15.972045438625893, 'time_stamp': 35, 'count': 31, 'status': True, 'gradient': 13.045984344657827}, [0.18215425741731486, -8.571673476385045e-06]), ({'reward': 9116.025508130702, 'duration': 11.90395711384456, 'time_stamp': 35, 'count': 33, 'status': True, 'gradient': 20.48495312236743}, [1.0, -8.571673476385045e-06])]
2021-08-18:15:35:44,875 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 37, 97, 3, 81, 99, 38, 11, 87, 85, 110, 5, 27]
2021-08-18:15:35:45,145 INFO     [param_server.py:553] For epoch: 36, median_reward: 728.0023969018912, dev: 3640.011984509456
2021-08-18:15:35:45,777 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1919, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:35:45,778 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 380.9137, eval_time 0.5867, test_loss 2.1919, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:35:45,841 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:45,850 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:45,851 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1103, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:35:45,851 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 380.976, eval_time 0.6603, test_loss 2.1103, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:35:45,896 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0054, Top-1 Accuracy: 566.0/1033 (0.5479), Top-5 Accuracy: 1.0
2021-08-18:15:35:45,897 INFO     [learner.py:656] After aggregation epoch 35, CumulTime 381.0361, eval_time 0.7065, test_loss 2.0054, test_accuracy 0.5479, test_5_accuracy 1.0 

2021-08-18:15:35:45,918 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:45,936 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:45,965 INFO     [learner.py:526] ====Start train round 36
2021-08-18:15:35:45,992 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:46,433 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:46,442 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:47,81 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:47,91 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:47,621 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:47,630 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:47,736 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:47,750 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:48,967 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:48,980 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:49,42 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:49,56 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:49,456 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:49,468 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:35:50,86 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:35:50,95 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:35:50,218 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:35:50,232 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:35:50,642 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:35:50,655 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:35:50,868 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:35:50,888 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:35:51,223 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:35:51,250 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:35:51,624 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:35:51,666 INFO     [learner.py:606] ====Pushing takes 0.0222775936126709 s
2021-08-18:15:35:51,694 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:51,702 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:35:51,703 INFO     [param_server.py:410] Lock worker 2 with localStep 36 , while globalStep is 35

2021-08-18:15:35:52,481 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:35:52,490 INFO     [learner.py:165] Start to run client 37 on rank 1...
2021-08-18:15:35:53,76 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:35:53,88 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:35:53,107 INFO     [learner.py:439] Completed to run client 37
2021-08-18:15:35:53,127 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:35:53,735 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:35:53,745 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:35:53,964 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:35:53,985 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:35:54,379 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:35:54,411 INFO     [learner.py:606] ====Pushing takes 0.030498743057250977 s
2021-08-18:15:35:54,446 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:54,457 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:15:35:54,458 INFO     [param_server.py:410] Lock worker 3 with localStep 36 , while globalStep is 35

2021-08-18:15:35:54,669 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:35:54,693 INFO     [learner.py:606] ====Pushing takes 0.02114582061767578 s
2021-08-18:15:35:54,719 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:35:54,725 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:35:54,727 INFO     [param_server.py:381] ====After aggregation in epoch: 35, virtual_clock: 902.197892328672, top_1: : 55.2436 % (1712.0), top_5: : 100.0 % (3099.0), test loss: 2.102543852947376, test len: 3099.0
2021-08-18:15:35:54,728 INFO     [param_server.py:410] Lock worker 1 with localStep 36 , while globalStep is 36

2021-08-18:15:35:54,728 INFO     [param_server.py:441] ====Epoch 37 completes 20 clients with loss 5.24943808057898, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 37: 0, 38: 0, 51: 0, 53: 0, 55: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:35:54,729 INFO     [param_server.py:450] ====Start to sample for epoch 37, global virtualClock: 902.197892328672, round_duration: 24.89517757431109
2021-08-18:15:35:54,729 INFO     [oort.py:208] Training selector: Pacer 35: lastExploitationUtil 1313.0605269541413, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:35:54,730 INFO     [oort.py:321] scores are 26,{5: 0.03553026998123457, 6: 0.28623348335153515, 7: 0.09937789996317134, 11: 0.05477300603784135, 14: 0.0042735369517232225, 16: 0.09937789996317134, 17: 0.005901726531842196, 25: 0.003055912717524575, 27: 0.008763008620211631, 35: 0.0025066485921504656, 38: 0.018968891402635076, 50: 0.008858551506820614, 51: 0.05589183487521374, 53: 0.06613434346708692, 55: 0.09937789996317134, 58: 0.003018932002292861, 59: 0.0031240428261202764, 60: 0.001347159587775734, 65: 0.012086252666179742, 67: 0.0021951772509245376, 70: 0.004155287011811701, 71: 0.010154877769814356, 76: 0.0015821975917922415, 81: 0.02605296190705173, 84: 0.08614598585094922, 85: 0.011065145445734585, 86: 0.0013255417147412531, 87: 0.011831874841772476, 88: 0.001689562958215817, 96: 0.003786859351475872, 97: 0.35072709795352464, 98: 0.07628523917837299, 99: 0.04334539076068264, 104: 0.0027992929486125796, 105: 0.008789884538967403, 107: 0.005125301343959967, 110: 0.010549130378811628, 111: 0.0040654248655902355, 119: 0.0070671736483010235},[97, 6, 7, 16, 55, 84, 98, 53, 51, 11, 99, 5, 81, 38, 65, 87, 85, 110, 71, 50, 105, 27, 119, 17, 107, 14, 70, 111, 96, 59, 25, 58, 104, 35, 67, 88, 76, 60, 86]
2021-08-18:15:35:54,731 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:35:54,732 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:35:54,732 INFO     [oort.py:398] At round 35, UCB exploited 39, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1066.75740647861, 'duration': 13.298442137908651, 'time_stamp': 36, 'count': 33, 'status': True, 'gradient': 14.681996995896803}, [0.08781664532531669, -8.33356482124504e-06]), ({'reward': 12147.44983499573, 'duration': 15.972045438625893, 'time_stamp': 36, 'count': 32, 'status': True, 'gradient': 19.576175505760244}, [1.0, -8.33356482124504e-06]), ({'reward': 4846.8520680809825, 'duration': 11.90395711384456, 'time_stamp': 36, 'count': 34, 'status': True, 'gradient': 20.49346045894702}, [0.39900111792508214, -8.33356482124504e-06])]
2021-08-18:15:35:54,733 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:35:55,8 INFO     [param_server.py:553] For epoch: 37, median_reward: 671.9680597625083, dev: 3359.8402988125417
2021-08-18:15:35:55,633 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6923, Top-1 Accuracy: 512.0/1033 (0.4956), Top-5 Accuracy: 1.0
2021-08-18:15:35:55,634 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 390.7699, eval_time 0.5907, test_loss 2.6923, test_accuracy 0.4956, test_5_accuracy 1.0 

2021-08-18:15:35:55,637 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.683, Top-1 Accuracy: 525.0/1033 (0.5082), Top-5 Accuracy: 1.0
2021-08-18:15:35:55,638 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 390.7625, eval_time 0.5948, test_loss 2.683, test_accuracy 0.5082, test_5_accuracy 1.0 

2021-08-18:15:35:55,702 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:55,704 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6567, Top-1 Accuracy: 539.0/1033 (0.5218), Top-5 Accuracy: 1.0
2021-08-18:15:35:55,705 INFO     [learner.py:656] After aggregation epoch 36, CumulTime 390.8438, eval_time 0.6624, test_loss 2.6567, test_accuracy 0.5218, test_5_accuracy 1.0 

2021-08-18:15:35:55,708 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:55,710 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:35:55,715 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:35:55,788 INFO     [learner.py:526] ====Start train round 37
2021-08-18:15:35:55,805 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:35:56,387 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:35:56,397 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:35:56,978 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:35:56,987 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:35:57,560 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:35:57,575 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:35:57,624 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:35:57,651 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:35:58,854 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:35:58,868 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:35:59,18 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:35:59,46 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:35:59,724 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:35:59,744 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:00,115 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:00,130 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:00,423 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:00,443 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:00,543 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:00,570 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:00,793 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:00,808 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:01,69 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:01,96 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:01,498 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:01,518 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:02,158 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:02,190 INFO     [learner.py:606] ====Pushing takes 0.030473709106445312 s
2021-08-18:15:36:02,230 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:02,239 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:02,240 INFO     [param_server.py:410] Lock worker 2 with localStep 37 , while globalStep is 36

2021-08-18:15:36:03,215 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:03,231 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:03,231 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:03,246 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:03,785 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:03,796 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:03,888 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:03,903 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:04,397 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:04,421 INFO     [learner.py:606] ====Pushing takes 0.022230863571166992 s
2021-08-18:15:36:04,449 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:04,457 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 15 clients
2021-08-18:15:36:04,458 INFO     [param_server.py:410] Lock worker 3 with localStep 37 , while globalStep is 36

2021-08-18:15:36:04,462 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:04,480 INFO     [learner.py:606] ====Pushing takes 0.0172271728515625 s
2021-08-18:15:36:04,503 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:04,509 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:04,509 INFO     [param_server.py:381] ====After aggregation in epoch: 36, virtual_clock: 927.0191438218931, top_1: : 50.8551 % (1576.0), top_5: : 100.0 % (3099.0), test loss: 2.6773525344000917, test len: 3099.0
2021-08-18:15:36:04,510 INFO     [param_server.py:410] Lock worker 1 with localStep 37 , while globalStep is 37

2021-08-18:15:36:04,511 INFO     [param_server.py:441] ====Epoch 38 completes 20 clients with loss 6.4298899192813295, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:04,511 INFO     [param_server.py:450] ====Start to sample for epoch 38, global virtualClock: 927.0191438218931, round_duration: 24.821251493221073
2021-08-18:15:36:04,512 INFO     [oort.py:208] Training selector: Pacer 36: lastExploitationUtil 1482.1175638759516, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:04,513 INFO     [oort.py:321] scores are 26,{5: 0.009159383704120724, 6: 0.056521630954963584, 7: 0.9509589717204101, 11: 0.016925248344766452, 14: 0.007941110641995427, 16: 0.6898341346426645, 17: 0.009490886528580236, 25: 0.003067995637812752, 27: 0.0433587092375078, 35: 0.0025937272744971655, 38: 0.20966113642365336, 50: 0.01646101073610978, 51: 0.05534935327527669, 53: 0.06549244891245454, 55: 0.316349302186302, 58: 0.004039200977851895, 59: 0.003398502630688002, 60: 0.0018024414992234184, 65: 0.024176004012810743, 67: 0.002518819527592381, 70: 0.0072344768667929205, 71: 0.009915660659623822, 76: 0.002069373011530323, 79: 0.022467226527862073, 81: 0.030970657626900506, 84: 0.29688672961999285, 85: 0.01095774804469488, 86: 0.0017735177162983191, 87: 0.013885735603016865, 88: 0.002209797313022488, 96: 0.0060898539115013415, 97: 0.03139614442301153, 98: 0.141418211679807, 99: 0.21356625805899512, 104: 0.003745333385032295, 105: 0.016333413386342432, 107: 0.008748369135269633, 110: 0.07792002426590507, 111: 0.006939267572588822, 119: 0.012062948043288842},[7, 16, 55, 84, 99, 38, 98, 110, 53, 6, 51, 27, 97, 81, 65, 79, 11, 50, 105, 87, 119, 85, 71, 17, 5, 107, 14, 70, 111, 96, 58, 104, 59, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:36:04,513 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:36:04,514 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:04,514 INFO     [oort.py:398] At round 36, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2822.2661907980905, 'duration': 13.298442137908651, 'time_stamp': 37, 'count': 34, 'status': True, 'gradient': 14.68663969849296}, [0.5467191661367355, -8.1083272520879e-06]), ({'reward': 3053.02348658507, 'duration': 7.864087706209871, 'time_stamp': 37, 'count': 35, 'status': True, 'gradient': 21.5169323010012}, [0.5914207904247606, -8.1083272520879e-06]), ({'reward': 4400.993772376629, 'duration': 5.8943907365129, 'time_stamp': 37, 'count': 34, 'status': True, 'gradient': 20.800851370516128}, [0.8525456275025062, -8.1083272520879e-06])]
2021-08-18:15:36:04,515 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 110, 71, 27, 65, 79, 50]
2021-08-18:15:36:04,792 INFO     [param_server.py:553] For epoch: 38, median_reward: 692.3601560291876, dev: 3461.800780145938
2021-08-18:15:36:05,505 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2226, Top-1 Accuracy: 548.0/1033 (0.5305), Top-5 Accuracy: 1.0
2021-08-18:15:36:05,506 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 400.6449, eval_time 0.69, test_loss 2.2226, test_accuracy 0.5305, test_5_accuracy 1.0 

2021-08-18:15:36:05,511 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.351, Top-1 Accuracy: 561.0/1033 (0.5431), Top-5 Accuracy: 1.0
2021-08-18:15:36:05,512 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4898, Top-1 Accuracy: 560.0/1033 (0.5421), Top-5 Accuracy: 1.0
2021-08-18:15:36:05,512 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 400.6481, eval_time 0.6959, test_loss 2.351, test_accuracy 0.5431, test_5_accuracy 1.0 

2021-08-18:15:36:05,512 INFO     [learner.py:656] After aggregation epoch 37, CumulTime 400.637, eval_time 0.6938, test_loss 2.4898, test_accuracy 0.5421, test_5_accuracy 1.0 

2021-08-18:15:36:05,575 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:36:05,580 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:36:05,582 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:05,584 INFO     [learner.py:526] ====Start train round 38
2021-08-18:15:36:05,589 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:05,594 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:06,173 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:06,184 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:07,322 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:07,334 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:07,858 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:07,876 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:07,898 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:07,912 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:08,397 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:08,417 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:09,500 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:09,511 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:09,722 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:09,736 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:10,238 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:10,258 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:10,378 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:10,392 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:10,945 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:10,958 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:11,205 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:11,214 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:12,883 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:12,901 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:13,582 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:13,596 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:13,606 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:13,627 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:14,134 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:14,154 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:14,231 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:14,270 INFO     [learner.py:606] ====Pushing takes 0.03788113594055176 s
2021-08-18:15:36:14,313 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:14,323 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:14,324 INFO     [param_server.py:410] Lock worker 2 with localStep 38 , while globalStep is 37

2021-08-18:15:36:14,819 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:14,833 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:14,849 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:14,870 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:36:15,317 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:36:15,347 INFO     [learner.py:606] ====Pushing takes 0.027523517608642578 s
2021-08-18:15:36:15,369 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:15,375 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:15,404 INFO     [param_server.py:410] Lock worker 1 with localStep 38 , while globalStep is 37

2021-08-18:15:36:15,455 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:15,486 INFO     [learner.py:606] ====Pushing takes 0.030148744583129883 s
2021-08-18:15:36:15,515 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:15,522 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:15,523 INFO     [param_server.py:381] ====After aggregation in epoch: 37, virtual_clock: 957.7051894274904, top_1: : 53.8561 % (1669.0), top_5: : 100.0 % (3099.0), test loss: 2.354460778059783, test len: 3099.0
2021-08-18:15:36:15,524 INFO     [param_server.py:410] Lock worker 3 with localStep 38 , while globalStep is 38

2021-08-18:15:36:15,525 INFO     [param_server.py:441] ====Epoch 39 completes 20 clients with loss 5.843937562115569, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:15,526 INFO     [param_server.py:450] ====Start to sample for epoch 39, global virtualClock: 957.7051894274904, round_duration: 30.68604560559735
2021-08-18:15:36:15,526 INFO     [oort.py:208] Training selector: Pacer 37: lastExploitationUtil 1223.7220564449308, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:15,527 INFO     [oort.py:321] scores are 26,{5: 0.009194332520765593, 6: 0.0559857760274203, 7: 0.0974803356318071, 11: 0.016764788047138744, 14: 0.005567262355802523, 16: 0.0974803356318071, 17: 0.006653761378708221, 25: 0.003079701983635714, 27: 0.01621099577158195, 35: 0.002566628769503685, 38: 0.019278366646614784, 50: 0.0041621922155248535, 51: 0.05482461215956962, 53: 0.08098921525818237, 55: 0.45804939331331174, 58: 0.0035712041453572364, 59: 0.002715766571506911, 60: 0.0015936039303530304, 65: 0.007986593359281964, 67: 0.0023774328065067018, 70: 0.004909044902811876, 71: 0.03202042041358036, 76: 0.0018467092836843813, 79: 0.004350768633119651, 81: 0.21762603649658466, 84: 0.04485995913006671, 85: 0.010999558753758463, 86: 0.0015680313643807228, 87: 0.13066536886578092, 88: 0.001972023985178774, 96: 0.004866443688721766, 97: 0.031098492384125098, 98: 0.10726482906102947, 99: 0.10630925948086263, 104: 0.003311385143673981, 105: 0.013052141749924839, 107: 0.006676880896716396, 110: 0.056718008653328676, 111: 0.005296148616526553, 119: 0.009206615096247341},[55, 81, 87, 98, 99, 7, 16, 53, 110, 6, 51, 84, 71, 97, 38, 11, 27, 105, 85, 119, 5, 65, 107, 17, 14, 111, 70, 96, 79, 50, 58, 104, 25, 59, 35, 67, 88, 76, 60, 86]
2021-08-18:15:36:15,528 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:36:15,528 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:15,529 INFO     [oort.py:398] At round 37, UCB exploited 40, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2553.473977985878, 'duration': 8.010998429338052, 'time_stamp': 38, 'count': 37, 'status': True, 'gradient': 20.71176659543323}, [0.3605690590935828, -7.89494460380537e-06]), ({'reward': 7081.771232644913, 'duration': 26.145070720211294, 'time_stamp': 38, 'count': 32, 'status': True, 'gradient': 16.326808583357007}, [1.0, -7.89494460380537e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 38, 'count': 35, 'status': True, 'gradient': 20.815794644697654}, [1.412078105624579e-09, -7.89494460380537e-06])]
2021-08-18:15:36:15,530 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:36:15,805 INFO     [param_server.py:553] For epoch: 39, median_reward: 624.5034625437474, dev: 3122.5173127187372
2021-08-18:15:36:16,342 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4346, Top-1 Accuracy: 545.0/1033 (0.5276), Top-5 Accuracy: 1.0
2021-08-18:15:36:16,343 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 411.482, eval_time 0.513, test_loss 2.4346, test_accuracy 0.5276, test_5_accuracy 1.0 

2021-08-18:15:36:16,411 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:16,423 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:16,531 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8731, Top-1 Accuracy: 532.0/1033 (0.515), Top-5 Accuracy: 1.0
2021-08-18:15:36:16,532 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 411.6678, eval_time 0.6994, test_loss 2.8731, test_accuracy 0.515, test_5_accuracy 1.0 

2021-08-18:15:36:16,535 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7216, Top-1 Accuracy: 542.0/1033 (0.5247), Top-5 Accuracy: 1.0
2021-08-18:15:36:16,549 INFO     [learner.py:656] After aggregation epoch 38, CumulTime 411.674, eval_time 0.7153, test_loss 2.7216, test_accuracy 0.5247, test_5_accuracy 1.0 

2021-08-18:15:36:16,601 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:16,609 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:16,617 INFO     [learner.py:526] ====Start train round 39
2021-08-18:15:36:16,626 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:17,127 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:17,139 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:17,763 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:17,772 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:18,163 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:18,172 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:18,346 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:18,359 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:19,89 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:19,108 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:19,589 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:19,603 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:19,966 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:19,975 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:20,295 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:20,315 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:20,553 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:20,562 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:20,816 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:20,826 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:21,95 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:21,113 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:21,853 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:21,868 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:22,448 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:22,458 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:22,681 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:22,701 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:23,33 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:23,65 INFO     [learner.py:606] ====Pushing takes 0.0314178466796875 s
2021-08-18:15:36:23,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:23,111 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:23,111 INFO     [param_server.py:410] Lock worker 2 with localStep 39 , while globalStep is 38

2021-08-18:15:36:23,267 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:23,300 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:23,314 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:23,334 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:23,842 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:23,857 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:23,863 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:23,877 INFO     [learner.py:606] ====Pushing takes 0.018265962600708008 s
2021-08-18:15:36:23,899 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:23,907 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:23,907 INFO     [param_server.py:410] Lock worker 1 with localStep 39 , while globalStep is 38

2021-08-18:15:36:24,513 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:24,540 INFO     [learner.py:606] ====Pushing takes 0.02482438087463379 s
2021-08-18:15:36:24,568 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:24,576 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:24,577 INFO     [param_server.py:381] ====After aggregation in epoch: 38, virtual_clock: 982.5264409207115, top_1: : 52.2427 % (1619.0), top_5: : 100.0 % (3099.0), test loss: 2.676414754655626, test len: 3099.0
2021-08-18:15:36:24,578 INFO     [param_server.py:410] Lock worker 3 with localStep 39 , while globalStep is 39

2021-08-18:15:36:24,578 INFO     [param_server.py:441] ====Epoch 40 completes 20 clients with loss 5.12521533399576, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:24,579 INFO     [param_server.py:450] ====Start to sample for epoch 40, global virtualClock: 982.5264409207115, round_duration: 24.821251493221073
2021-08-18:15:36:24,579 INFO     [oort.py:208] Training selector: Pacer 38: lastExploitationUtil 1675.914678731304, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:24,580 INFO     [oort.py:321] scores are 26,{5: 0.008988487175407326, 6: 0.25520402592588, 7: 0.5402207662175698, 11: 0.01660945567976089, 14: 0.006455738677566847, 16: 0.6118498260013007, 17: 0.009645622299214736, 25: 0.0030910535567175994, 27: 0.09539343609763312, 35: 0.0026000127507941934, 38: 0.08476211966910334, 50: 0.016729384736157562, 51: 0.21201598388363005, 53: 0.06427048545534522, 55: 0.09657714191030575, 58: 0.0038969716524700298, 59: 0.0031756647374025873, 60: 0.001738973491595048, 65: 0.054414327042348935, 67: 0.0024838409360476293, 70: 0.005692476665117872, 71: 0.009730653453749549, 76: 0.0020026113236251567, 79: 0.01748734286945628, 81: 0.10324059302816825, 84: 0.044444313931776454, 85: 0.010753297487337849, 86: 0.0017110681799357972, 87: 0.13055783510615826, 88: 0.0021385052850876195, 96: 0.006189140551923187, 97: 0.03954170925159156, 98: 0.09388231184985349, 99: 0.1573224229920804, 104: 0.003613451796667604, 105: 0.015262440718466195, 107: 0.009679137498476365, 110: 0.010251825224746842, 111: 0.006141358046512259, 119: 0.013346365584557665},[16, 7, 6, 51, 99, 87, 81, 55, 27, 98, 38, 53, 65, 84, 97, 79, 50, 11, 105, 119, 85, 110, 71, 107, 17, 5, 14, 96, 111, 70, 58, 104, 59, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:36:24,580 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:36:24,581 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:24,581 INFO     [oort.py:398] At round 38, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5592.82608316619, 'duration': 30.380154975061778, 'time_stamp': 39, 'count': 29, 'status': True, 'gradient': 9.79963207984989}, [0.985243015521187, -7.692504936024006e-06]), ({'reward': 2924.9993828768615, 'duration': 7.864087706209871, 'time_stamp': 39, 'count': 37, 'status': True, 'gradient': 21.53449431244332}, [0.5152726858526173, -7.692504936024006e-06]), ({'reward': 1687.2594794826814, 'duration': 17.619275735353515, 'time_stamp': 39, 'count': 35, 'status': True, 'gradient': 11.432698970061551}, [0.29722965090622433, -7.692504936024006e-06])]
2021-08-18:15:36:24,582 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27, 65, 50]
2021-08-18:15:36:24,844 INFO     [param_server.py:553] For epoch: 40, median_reward: 740.7208827402849, dev: 3703.604413701424
2021-08-18:15:36:25,446 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1703, Top-1 Accuracy: 562.0/1033 (0.544), Top-5 Accuracy: 1.0
2021-08-18:15:36:25,447 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 420.5862, eval_time 0.5677, test_loss 2.1703, test_accuracy 0.544, test_5_accuracy 1.0 

2021-08-18:15:36:25,511 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:25,520 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0998, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:36:25,521 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 420.6569, eval_time 0.6409, test_loss 2.0998, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:36:25,533 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:25,602 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0539, Top-1 Accuracy: 550.0/1033 (0.5324), Top-5 Accuracy: 1.0
2021-08-18:15:36:25,603 INFO     [learner.py:656] After aggregation epoch 39, CumulTime 420.7279, eval_time 0.7189, test_loss 2.0539, test_accuracy 0.5324, test_5_accuracy 1.0 

2021-08-18:15:36:25,612 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:25,620 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:25,670 INFO     [learner.py:526] ====Start train round 40
2021-08-18:15:36:25,688 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:26,215 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:26,229 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:27,310 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:27,329 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:27,902 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:27,912 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:27,955 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:27,964 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:28,394 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:28,409 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:29,444 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:29,455 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:29,599 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:29,608 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:29,965 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:29,979 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:30,137 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:30,147 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:30,780 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:30,790 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:31,464 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:31,491 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:32,784 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:32,807 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:36:33,99 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:33,113 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:33,439 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:33,451 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:33,511 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:36:33,521 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:34,61 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:34,77 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:34,90 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:34,94 INFO     [learner.py:606] ====Pushing takes 0.0312647819519043 s
2021-08-18:15:36:34,98 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:34,107 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:34,138 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:34,149 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:36:34,150 INFO     [param_server.py:410] Lock worker 2 with localStep 40 , while globalStep is 39

2021-08-18:15:36:34,619 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:34,640 INFO     [learner.py:606] ====Pushing takes 0.019002199172973633 s
2021-08-18:15:36:34,661 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:34,667 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:34,668 INFO     [param_server.py:410] Lock worker 1 with localStep 40 , while globalStep is 39

2021-08-18:15:36:34,715 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:34,742 INFO     [learner.py:606] ====Pushing takes 0.025775432586669922 s
2021-08-18:15:36:34,773 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:34,781 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:34,782 INFO     [param_server.py:381] ====After aggregation in epoch: 39, virtual_clock: 1011.44994190798, top_1: : 54.5983 % (1692.0), top_5: : 100.0 % (3099.0), test loss: 2.1079874259454234, test len: 3099.0
2021-08-18:15:36:34,783 INFO     [param_server.py:410] Lock worker 3 with localStep 40 , while globalStep is 40

2021-08-18:15:36:34,784 INFO     [param_server.py:441] ====Epoch 41 completes 20 clients with loss 2.853500717090296, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:34,784 INFO     [param_server.py:450] ====Start to sample for epoch 41, global virtualClock: 1011.44994190798, round_duration: 28.923500987268568
2021-08-18:15:36:34,785 INFO     [oort.py:208] Training selector: Pacer 39: lastExploitationUtil 1594.1070186234092, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:34,785 INFO     [oort.py:321] scores are 26,{5: 0.009020522798138206, 6: 0.05496452113911434, 7: 0.09570216488306314, 11: 0.016458976054175237, 14: 0.0052882131315453475, 16: 0.5112319063649629, 17: 0.007440393380621854, 25: 0.003102070306352723, 27: 0.008438887279304454, 35: 0.002576464564763703, 38: 0.01826728048526544, 50: 0.013734892258518223, 51: 0.05382453844191647, 53: 0.06368820276204099, 55: 0.09570216488306314, 58: 0.0034820760873522398, 59: 0.0025698926963076715, 60: 0.0015538316805010727, 65: 0.005191724051614408, 67: 0.0023587583590003575, 70: 0.005489410142800769, 71: 0.04197914972737745, 76: 0.0018052418852205095, 79: 0.01401677116424677, 81: 0.28724984870879455, 84: 0.044041653913964175, 85: 0.10672516808169008, 86: 0.00152889733991453, 87: 0.030173862791574406, 88: 0.001927742676205999, 96: 0.004960831812315495, 97: 0.11606218812154115, 98: 0.043303199890687934, 99: 0.020362010263019252, 104: 0.003228741498799758, 105: 0.012804601601414589, 107: 0.007466246172593271, 110: 0.103519352357065, 111: 0.005922278673126091, 119: 0.010295054800019127},[16, 81, 97, 85, 110, 7, 55, 53, 6, 51, 84, 98, 71, 87, 99, 38, 11, 79, 50, 105, 119, 5, 27, 107, 17, 111, 70, 14, 65, 96, 58, 104, 25, 35, 59, 67, 88, 76, 60, 86]
2021-08-18:15:36:34,786 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:36:34,787 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:34,787 INFO     [oort.py:398] At round 39, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7718.521287037174, 'duration': 17.619275735353515, 'time_stamp': 40, 'count': 36, 'status': True, 'gradient': 14.703242263177964}, [1.0, -7.500187504687623e-06]), ({'reward': 6659.65121106842, 'duration': 27.035726288496562, 'time_stamp': 40, 'count': 35, 'status': True, 'gradient': 11.43585677891552}, [0.8628142092147728, -7.500187504687623e-06]), ({'reward': 0.01, 'duration': 8.010998429338052, 'time_stamp': 40, 'count': 39, 'status': True, 'gradient': 20.721567813765898}, [1.2955866248246847e-09, -7.500187504687623e-06])]
2021-08-18:15:36:34,788 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 79, 105]
2021-08-18:15:36:35,70 INFO     [param_server.py:541] Handle Wight 0.03426647186279297 | Send 0.2856299877166748
2021-08-18:15:36:35,71 INFO     [param_server.py:553] For epoch: 41, median_reward: 718.1814503659363, dev: 3590.907251829681
2021-08-18:15:36:35,661 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0091, Top-1 Accuracy: 575.0/1033 (0.5566), Top-5 Accuracy: 1.0
2021-08-18:15:36:35,662 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 430.8013, eval_time 0.5577, test_loss 2.0091, test_accuracy 0.5566, test_5_accuracy 1.0 

2021-08-18:15:36:35,699 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2933, Top-1 Accuracy: 562.0/1033 (0.544), Top-5 Accuracy: 1.0
2021-08-18:15:36:35,701 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 430.8365, eval_time 0.5953, test_loss 2.2933, test_accuracy 0.544, test_5_accuracy 1.0 

2021-08-18:15:36:35,728 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:35,745 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2005, Top-1 Accuracy: 555.0/1033 (0.5373), Top-5 Accuracy: 1.0
2021-08-18:15:36:35,746 INFO     [learner.py:656] After aggregation epoch 40, CumulTime 430.8705, eval_time 0.6406, test_loss 2.2005, test_accuracy 0.5373, test_5_accuracy 1.0 

2021-08-18:15:36:35,749 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:35,807 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:35,813 INFO     [learner.py:526] ====Start train round 41
2021-08-18:15:36:35,818 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:35,827 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:36,550 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:36,560 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:37,663 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:37,673 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:38,287 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:38,297 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:38,453 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:38,539 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:38,646 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:38,706 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:40,51 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:36:40,63 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:40,272 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:40,292 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:40,565 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:40,575 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:41,207 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:41,217 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:41,882 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:41,891 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:41,925 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:41,944 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:43,150 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:43,177 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:43,832 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:43,851 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:44,204 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:44,223 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:44,448 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:44,473 INFO     [learner.py:606] ====Pushing takes 0.023434877395629883 s
2021-08-18:15:36:44,504 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:44,511 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:36:44,511 INFO     [param_server.py:410] Lock worker 2 with localStep 41 , while globalStep is 40

2021-08-18:15:36:44,660 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:44,673 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:44,743 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:44,764 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:36:44,888 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:36:44,915 INFO     [learner.py:606] ====Pushing takes 0.025765180587768555 s
2021-08-18:15:36:44,944 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:44,950 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:44,951 INFO     [param_server.py:410] Lock worker 1 with localStep 41 , while globalStep is 40

2021-08-18:15:36:45,427 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:45,441 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:36:46,19 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:36:46,44 INFO     [learner.py:606] ====Pushing takes 0.024209260940551758 s
2021-08-18:15:36:46,75 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:46,83 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:46,83 INFO     [param_server.py:381] ====After aggregation in epoch: 40, virtual_clock: 1042.3181297222716, top_1: : 54.5983 % (1692.0), top_5: : 100.0 % (3099.0), test loss: 2.167614570370427, test len: 3099.0
2021-08-18:15:36:46,84 INFO     [param_server.py:410] Lock worker 3 with localStep 41 , while globalStep is 41

2021-08-18:15:36:46,85 INFO     [param_server.py:441] ====Epoch 42 completes 20 clients with loss 4.904832829913717, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:36:46,85 INFO     [param_server.py:450] ====Start to sample for epoch 42, global virtualClock: 1042.3181297222716, round_duration: 30.86818781429151
2021-08-18:15:36:46,86 INFO     [oort.py:208] Training selector: Pacer 40: lastExploitationUtil 1489.5713682640574, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:46,86 INFO     [oort.py:321] scores are 26,{5: 0.026763968610931423, 6: 0.5542357617884365, 7: 0.09485392587370886, 11: 0.01631309486580047, 14: 0.006682986054494316, 16: 0.18398725233258434, 17: 0.008412894723144137, 25: 0.0031127706066858833, 27: 0.00846799644257657, 35: 0.0026021144666816065, 38: 0.09442002575708935, 50: 0.015579079051116022, 51: 0.10577419157578494, 53: 0.20584586419282697, 55: 0.09485392587370886, 58: 0.0037131210349988252, 59: 0.002893982370725883, 60: 0.001656932517549686, 65: 0.005209632424848973, 67: 0.002435312086773134, 70: 0.005892856583664455, 71: 0.009557030402306993, 76: 0.001915936097659451, 79: 0.020119362221720408, 81: 0.09578103091307281, 84: 0.043651298597217135, 85: 0.12190555363980048, 86: 0.0016303437175915216, 87: 0.01129325312372673, 88: 0.0020459484186467107, 96: 0.0051250272914273995, 97: 0.0697128372034626, 98: 0.4292349372732163, 99: 0.020181535229512233, 104: 0.0034429770272145868, 105: 0.00946064182243631, 107: 0.008014980985002093, 110: 0.010068902958854159, 111: 0.006357538963452397, 119: 0.011051694058066103},[6, 98, 53, 16, 85, 51, 81, 7, 55, 38, 97, 84, 5, 99, 79, 11, 50, 87, 119, 110, 71, 105, 27, 17, 107, 14, 111, 70, 65, 96, 58, 104, 25, 59, 35, 67, 88, 76, 60, 86]
2021-08-18:15:36:46,87 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:36:46,88 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:46,88 INFO     [oort.py:398] At round 40, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5645.5443567441625, 'duration': 11.90395711384456, 'time_stamp': 41, 'count': 39, 'status': True, 'gradient': 20.531721121884114}, [0.8701606188584815, -7.3172516402839146e-06]), ({'reward': 578.3000844282487, 'duration': 7.864087706209871, 'time_stamp': 41, 'count': 39, 'status': True, 'gradient': 21.54917495231052}, [0.08913332800020102, -7.3172516402839146e-06]), ({'reward': 5539.24245034018, 'duration': 13.411352670399307, 'time_stamp': 41, 'count': 37, 'status': True, 'gradient': 17.77360018452986}, [0.8537760347512251, -7.3172516402839146e-06])]
2021-08-18:15:36:46,89 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 87, 85, 110, 71, 5, 27, 79, 50]
2021-08-18:15:36:46,399 INFO     [param_server.py:553] For epoch: 42, median_reward: 685.2215906803737, dev: 3426.107953401868
2021-08-18:15:36:47,30 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9186, Top-1 Accuracy: 565.0/1033 (0.547), Top-5 Accuracy: 1.0
2021-08-18:15:36:47,32 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 442.1709, eval_time 0.587, test_loss 1.9186, test_accuracy 0.547, test_5_accuracy 1.0 

2021-08-18:15:36:47,65 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1843, Top-1 Accuracy: 555.0/1033 (0.5373), Top-5 Accuracy: 1.0
2021-08-18:15:36:47,65 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 442.1901, eval_time 0.6165, test_loss 2.1843, test_accuracy 0.5373, test_5_accuracy 1.0 

2021-08-18:15:36:47,68 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0153, Top-1 Accuracy: 565.0/1033 (0.547), Top-5 Accuracy: 1.0
2021-08-18:15:36:47,69 INFO     [learner.py:656] After aggregation epoch 41, CumulTime 442.2047, eval_time 0.6239, test_loss 2.0153, test_accuracy 0.547, test_5_accuracy 1.0 

2021-08-18:15:36:47,100 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:47,128 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:47,132 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:47,148 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:47,150 INFO     [learner.py:526] ====Start train round 42
2021-08-18:15:36:47,162 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:47,680 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:47,689 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:48,643 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:48,661 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:49,147 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:49,156 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:49,289 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:49,309 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:36:50,74 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:50,94 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:50,956 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:50,969 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:36:51,255 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:36:51,276 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:36:51,400 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:36:51,420 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:36:51,706 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:36:51,733 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:36:52,344 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:36:52,358 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:36:52,482 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:36:52,498 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:36:53,21 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:36:53,32 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:36:54,145 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:36:54,165 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:36:54,354 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:36:54,380 INFO     [learner.py:606] ====Pushing takes 0.024492263793945312 s
2021-08-18:15:36:54,421 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:54,431 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 7 clients
2021-08-18:15:36:54,431 INFO     [param_server.py:410] Lock worker 2 with localStep 42 , while globalStep is 41

2021-08-18:15:36:54,712 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:36:54,725 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:36:55,194 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:36:55,207 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:36:55,310 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:36:55,319 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:36:55,685 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:36:55,699 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:36:55,780 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:36:55,804 INFO     [learner.py:606] ====Pushing takes 0.02305436134338379 s
2021-08-18:15:36:55,826 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:36:55,834 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:55,848 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:36:55,848 INFO     [param_server.py:410] Lock worker 1 with localStep 42 , while globalStep is 41

2021-08-18:15:36:55,854 INFO     [learner.py:606] ====Pushing takes 0.026059865951538086 s
2021-08-18:15:36:55,884 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:36:55,892 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:36:55,893 INFO     [param_server.py:381] ====After aggregation in epoch: 41, virtual_clock: 1070.3339852177603, top_1: : 54.3724 % (1685.0), top_5: : 100.0 % (3099.0), test loss: 2.0393836454108913, test len: 3099.0
2021-08-18:15:36:55,893 INFO     [param_server.py:410] Lock worker 3 with localStep 42 , while globalStep is 42

2021-08-18:15:36:55,894 INFO     [param_server.py:441] ====Epoch 43 completes 20 clients with loss 4.116257313235522, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 16: 0, 27: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:36:55,894 INFO     [param_server.py:450] ====Start to sample for epoch 43, global virtualClock: 1070.3339852177603, round_duration: 28.015855495488744
2021-08-18:15:36:55,894 INFO     [oort.py:208] Training selector: Pacer 41: lastExploitationUtil 2372.5556485672905, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:36:55,895 INFO     [oort.py:321] scores are 26,{5: 0.00875152108220935, 6: 0.05400475194424726, 7: 0.5413752996940049, 11: 0.016367602039350525, 14: 0.008315616937977726, 16: 0.5202215887884903, 17: 0.00993848094196241, 25: 0.0031231713560912755, 27: 0.010482881842248697, 35: 0.002594048431519344, 38: 0.08745251634520176, 50: 0.0056368835308409256, 51: 0.05288467518369319, 53: 0.20327174777625517, 55: 0.17458969184374076, 58: 0.003506521437544152, 59: 0.0025884666516852663, 60: 0.0015647401036992625, 65: 0.005227039443180038, 67: 0.0023750404253601977, 70: 0.007332461510560732, 71: 0.06995392137375338, 76: 0.0018178837829442031, 79: 0.030691614173070172, 81: 0.056244963570971196, 84: 0.19699784157377692, 85: 0.06597425219239651, 86: 0.0015396307156203184, 87: 0.048330982074834404, 88: 0.0019412424326373753, 96: 0.004574523284720904, 97: 0.02999809034034255, 98: 0.4950258468794001, 99: 0.11407370064712238, 104: 0.003251408354617183, 105: 0.017103704397743044, 107: 0.007154053053301043, 110: 0.08429164317276389, 111: 0.007910664223634746, 119: 0.01375158552677187},[7, 16, 98, 53, 84, 55, 99, 38, 110, 71, 85, 81, 6, 51, 87, 79, 97, 105, 11, 119, 27, 17, 5, 14, 111, 70, 107, 50, 65, 96, 58, 104, 25, 35, 59, 67, 88, 76, 60, 86]
2021-08-18:15:36:55,910 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:36:55,910 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:36:55,911 INFO     [oort.py:398] At round 41, UCB exploited 40, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2559.268944577664, 'duration': 13.298442137908651, 'time_stamp': 42, 'count': 39, 'status': True, 'gradient': 17.984593148055346}, [0.3340436989297724, -7.1430272149336945e-06]), ({'reward': 3427.3154053506164, 'duration': 5.8943907365129, 'time_stamp': 42, 'count': 39, 'status': True, 'gradient': 20.841366606214923}, [0.4473442502791553, -7.1430272149336945e-06]), ({'reward': 0.01, 'duration': 15.972045438625893, 'time_stamp': 42, 'count': 38, 'status': True, 'gradient': 20.64112195243234}, [1.3052360267501091e-09, -7.1430272149336945e-06])]
2021-08-18:15:36:55,912 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:36:56,187 INFO     [param_server.py:553] For epoch: 43, median_reward: 873.5425954158621, dev: 4367.712977079311
2021-08-18:15:36:56,772 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9134, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:15:36:56,773 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 451.9125, eval_time 0.5513, test_loss 1.9134, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:15:36:56,849 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:56,866 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:36:56,906 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1936, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:36:56,907 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 452.0434, eval_time 0.6836, test_loss 2.1936, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:36:56,912 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1322, Top-1 Accuracy: 584.0/1033 (0.5653), Top-5 Accuracy: 1.0
2021-08-18:15:36:56,913 INFO     [learner.py:656] After aggregation epoch 42, CumulTime 452.0374, eval_time 0.689, test_loss 2.1322, test_accuracy 0.5653, test_5_accuracy 1.0 

2021-08-18:15:36:56,983 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:56,991 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:36:56,999 INFO     [learner.py:526] ====Start train round 43
2021-08-18:15:36:57,7 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:36:57,590 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:36:57,602 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:36:58,175 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:36:58,193 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:36:58,550 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:36:58,559 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:36:58,829 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:36:58,843 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:36:59,733 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:36:59,754 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:36:59,826 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:36:59,835 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:00,119 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:00,134 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:00,455 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:00,466 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:00,899 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:00,920 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:01,10 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:01,29 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:01,234 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:01,243 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:01,844 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:01,854 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:02,353 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:02,362 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:02,869 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:02,879 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:02,883 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:02,911 INFO     [learner.py:606] ====Pushing takes 0.0301816463470459 s
2021-08-18:15:37:02,945 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:02,953 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:37:02,954 INFO     [param_server.py:410] Lock worker 2 with localStep 43 , while globalStep is 42

2021-08-18:15:37:03,311 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:03,338 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:03,439 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:03,454 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:03,973 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:03,999 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:04,10 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:04,35 INFO     [learner.py:606] ====Pushing takes 0.023591041564941406 s
2021-08-18:15:37:04,66 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:04,74 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 15 clients
2021-08-18:15:37:04,74 INFO     [param_server.py:410] Lock worker 3 with localStep 43 , while globalStep is 42

2021-08-18:15:37:04,502 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:04,522 INFO     [learner.py:606] ====Pushing takes 0.017763614654541016 s
2021-08-18:15:37:04,544 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:04,550 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:04,551 INFO     [param_server.py:381] ====After aggregation in epoch: 42, virtual_clock: 1093.5186061463535, top_1: : 56.4376 % (1749.0), top_5: : 100.0 % (3099.0), test loss: 2.0797325902514987, test len: 3099.0
2021-08-18:15:37:04,552 INFO     [param_server.py:410] Lock worker 1 with localStep 43 , while globalStep is 43

2021-08-18:15:37:04,553 INFO     [param_server.py:441] ====Epoch 44 completes 20 clients with loss 3.7287866032834933, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:04,553 INFO     [param_server.py:450] ====Start to sample for epoch 44, global virtualClock: 1093.5186061463535, round_duration: 23.184620928593155
2021-08-18:15:37:04,554 INFO     [oort.py:208] Training selector: Pacer 42: lastExploitationUtil 867.381891627476, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:04,554 INFO     [oort.py:321] scores are 26,{5: 0.07561709451739865, 6: 0.19752934831772093, 7: 0.09323226533747546, 11: 0.016034199691731213, 14: 0.011737884192248213, 16: 0.44133287732423304, 17: 0.014028633018296587, 25: 0.003133288184637074, 27: 0.008221094882634141, 35: 0.0026507210237479797, 38: 0.01779583506054794, 50: 0.01140345599932257, 51: 0.0962069178387319, 53: 0.06204452559702108, 55: 0.2998164598816072, 58: 0.004148610896587284, 59: 0.0035045749297135617, 60: 0.0018512642686366412, 65: 0.0050577350567827094, 67: 0.002579748930715013, 70: 0.004850835606810225, 71: 0.009393639600036575, 76: 0.002124596629917233, 79: 0.01192011231147729, 81: 0.024441819139321183, 84: 0.042905018592057455, 85: 0.07534750083752215, 86: 0.001821557026617353, 87: 0.011100179165556293, 88: 0.002268768316725937, 96: 0.006224092118302985, 97: 0.10997825424131755, 98: 0.04218562272967816, 99: 0.028220373101764094, 104: 0.003846783306326196, 105: 0.011315062231343901, 107: 0.00659770937879809, 110: 0.11604843415386808, 111: 0.005233349214893142, 119: 0.019411009378733985},[16, 55, 6, 110, 97, 51, 7, 5, 85, 53, 84, 98, 99, 81, 119, 38, 11, 17, 79, 14, 50, 105, 87, 71, 27, 107, 96, 111, 65, 70, 58, 104, 59, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:37:04,555 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:37:04,556 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:04,556 INFO     [oort.py:398] At round 42, UCB exploited 40, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1030.7530669840776, 'duration': 8.010998429338052, 'time_stamp': 43, 'count': 42, 'status': True, 'gradient': 20.751657981079315}, [0.20658419654835766, -6.976906439684649e-06]), ({'reward': 3588.6198528662044, 'duration': 29.570969934622333, 'time_stamp': 43, 'count': 29, 'status': True, 'gradient': 9.814031192459339}, [0.7192384812468441, -6.976906439684649e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 43, 'count': 40, 'status': True, 'gradient': 20.851019325086625}, [2.0042258945149382e-09, -6.976906439684649e-06])]
2021-08-18:15:37:04,557 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 85, 110, 71, 5, 65, 79, 50]
2021-08-18:15:37:04,857 INFO     [param_server.py:553] For epoch: 44, median_reward: 594.3211706337653, dev: 2971.6058531688263
2021-08-18:15:37:05,438 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9234, Top-1 Accuracy: 582.0/1033 (0.5634), Top-5 Accuracy: 1.0
2021-08-18:15:37:05,439 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 460.5784, eval_time 0.5476, test_loss 1.9234, test_accuracy 0.5634, test_5_accuracy 1.0 

2021-08-18:15:37:05,507 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:37:05,509 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4622, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:37:05,510 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 460.6461, eval_time 0.6158, test_loss 2.4622, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:37:05,529 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:05,579 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:37:05,593 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1601, Top-1 Accuracy: 570.0/1033 (0.5518), Top-5 Accuracy: 1.0
2021-08-18:15:37:05,594 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:05,594 INFO     [learner.py:656] After aggregation epoch 43, CumulTime 460.7189, eval_time 0.6894, test_loss 2.1601, test_accuracy 0.5518, test_5_accuracy 1.0 

2021-08-18:15:37:05,663 INFO     [learner.py:526] ====Start train round 44
2021-08-18:15:37:05,675 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:06,777 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:06,787 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:07,994 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:08,10 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:08,277 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:08,290 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:08,454 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:08,464 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:08,712 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:08,722 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:09,889 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:09,903 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:10,499 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:10,513 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:10,775 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:10,784 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:11,886 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:11,896 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:12,544 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:12,557 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:12,737 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:12,764 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:12,785 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:12,799 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:13,849 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:13,870 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:14,425 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:14,446 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:14,572 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:14,594 INFO     [learner.py:606] ====Pushing takes 0.0204927921295166 s
2021-08-18:15:37:14,619 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:14,628 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:15:37:14,629 INFO     [param_server.py:410] Lock worker 1 with localStep 44 , while globalStep is 43

2021-08-18:15:37:14,987 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:14,996 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:15,473 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:15,492 INFO     [learner.py:606] ====Pushing takes 0.017761945724487305 s
2021-08-18:15:37:15,513 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:15,518 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:37:15,519 INFO     [param_server.py:410] Lock worker 3 with localStep 44 , while globalStep is 43

2021-08-18:15:37:15,606 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:15,620 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:16,400 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:16,414 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:37:17,130 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:37:17,168 INFO     [learner.py:606] ====Pushing takes 0.035692453384399414 s
2021-08-18:15:37:17,211 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:17,220 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:17,221 INFO     [param_server.py:381] ====After aggregation in epoch: 43, virtual_clock: 1127.5423893895866, top_1: : 56.0503 % (1737.0), top_5: : 100.0 % (3099.0), test loss: 2.181868202156491, test len: 3099.0
2021-08-18:15:37:17,222 INFO     [param_server.py:410] Lock worker 2 with localStep 44 , while globalStep is 44

2021-08-18:15:37:17,222 INFO     [param_server.py:441] ====Epoch 45 completes 20 clients with loss 2.6433698031175763, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 38: 0, 50: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:17,222 INFO     [param_server.py:450] ====Start to sample for epoch 45, global virtualClock: 1127.5423893895866, round_duration: 34.02378324323311
2021-08-18:15:37:17,223 INFO     [oort.py:208] Training selector: Pacer 43: lastExploitationUtil 1874.6527666624563, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:17,224 INFO     [oort.py:321] scores are 26,{5: 0.013592059441526437, 6: 0.05310037341752934, 7: 0.15661809086151407, 11: 0.10112441878728698, 14: 0.007197370672249606, 16: 0.7211890418203669, 17: 0.008601999321506442, 25: 0.0031431355103333173, 27: 0.008246932174841067, 35: 0.0026145996970874767, 38: 0.017647737030861928, 50: 0.003947680581790219, 51: 0.05199905377248922, 53: 0.727011593533583, 55: 0.09245638071319874, 58: 0.0035808035109262163, 59: 0.002679658450514618, 60: 0.0015978875238069385, 65: 0.00501564427576373, 67: 0.002406423638444476, 70: 0.0038581172664544977, 71: 0.02835220658018183, 76: 0.0018542421272656057, 79: 0.008586349118129855, 81: 0.07638891731201787, 84: 0.3612919757623347, 85: 0.05039281163069355, 86: 0.0015722462190005252, 87: 0.011135064856178297, 88: 0.001980067995326997, 96: 0.004738196754135376, 97: 0.27357419092855817, 98: 0.30950509961827705, 99: 0.01967142305781779, 104: 0.0033202861180344472, 105: 0.01480367618389592, 107: 0.008631888292105276, 110: 0.009814399528044259, 111: 0.006846874153278297, 119: 0.011902334980739237},[53, 16, 84, 98, 97, 7, 11, 55, 81, 6, 51, 85, 71, 99, 38, 105, 5, 119, 87, 110, 107, 17, 79, 27, 14, 111, 65, 96, 50, 70, 58, 104, 25, 59, 35, 67, 88, 76, 60, 86]
2021-08-18:15:37:17,224 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:17,225 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:17,225 INFO     [oort.py:398] At round 43, UCB exploited 40, augment_factor 1.1923076923076923, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7295.486382878782, 'duration': 11.058674649423494, 'time_stamp': 44, 'count': 41, 'status': True, 'gradient': 19.939950744162044}, [1.0, -6.818336780381378e-06]), ({'reward': 1874.659976865405, 'duration': 43.8287324306519, 'time_stamp': 44, 'count': 33, 'status': True, 'gradient': 19.084968384445045}, [0.25696059940585614, -6.818336780381378e-06]), ({'reward': 468.10024171376557, 'duration': 5.8943907365129, 'time_stamp': 44, 'count': 41, 'status': True, 'gradient': 20.85430496786619}, [0.06416171151902775, -6.818336780381378e-06])]
2021-08-18:15:37:17,226 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27, 79, 105]
2021-08-18:15:37:17,498 INFO     [param_server.py:553] For epoch: 45, median_reward: 760.4782905034709, dev: 3802.3914525173545
2021-08-18:15:37:18,85 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8911, Top-1 Accuracy: 560.0/1033 (0.5421), Top-5 Accuracy: 1.0
2021-08-18:15:37:18,89 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 473.2286, eval_time 0.5576, test_loss 1.8911, test_accuracy 0.5421, test_5_accuracy 1.0 

2021-08-18:15:37:18,154 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:18,174 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:18,187 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2091, Top-1 Accuracy: 552.0/1033 (0.5344), Top-5 Accuracy: 1.0
2021-08-18:15:37:18,188 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 473.324, eval_time 0.652, test_loss 2.2091, test_accuracy 0.5344, test_5_accuracy 1.0 

2021-08-18:15:37:18,225 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3348, Top-1 Accuracy: 556.0/1033 (0.5382), Top-5 Accuracy: 1.0
2021-08-18:15:37:18,226 INFO     [learner.py:656] After aggregation epoch 44, CumulTime 473.3508, eval_time 0.6864, test_loss 2.3348, test_accuracy 0.5382, test_5_accuracy 1.0 

2021-08-18:15:37:18,257 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:18,269 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:18,292 INFO     [learner.py:526] ====Start train round 45
2021-08-18:15:37:18,312 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:18,811 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:18,821 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:20,17 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:20,27 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:20,605 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:20,619 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:20,966 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:20,981 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:20,985 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:20,994 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:22,569 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:22,597 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:22,630 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:22,657 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:22,886 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:22,906 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:23,527 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:23,545 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:24,151 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:24,161 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:25,123 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:25,137 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:25,361 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:25,375 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:26,341 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:26,355 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:26,837 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:26,847 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:26,872 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:26,889 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:26,893 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:37:26,912 INFO     [learner.py:606] ====Pushing takes 0.021317243576049805 s
2021-08-18:15:37:26,938 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:26,944 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 6 clients
2021-08-18:15:37:26,945 INFO     [param_server.py:410] Lock worker 2 with localStep 45 , while globalStep is 44

2021-08-18:15:37:27,18 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:37:27,41 INFO     [learner.py:606] ====Pushing takes 0.0217287540435791 s
2021-08-18:15:37:27,66 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:27,73 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 12 clients
2021-08-18:15:37:27,74 INFO     [param_server.py:410] Lock worker 1 with localStep 45 , while globalStep is 44

2021-08-18:15:37:27,572 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:27,586 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:28,255 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:28,269 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:37:28,877 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:37:28,915 INFO     [learner.py:606] ====Pushing takes 0.03589057922363281 s
2021-08-18:15:37:28,948 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:28,956 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:28,957 INFO     [param_server.py:381] ====After aggregation in epoch: 44, virtual_clock: 1159.172962181311, top_1: : 53.8238 % (1668.0), top_5: : 100.0 % (3099.0), test loss: 2.1449804526788214, test len: 3099.0
2021-08-18:15:37:28,958 INFO     [param_server.py:410] Lock worker 3 with localStep 45 , while globalStep is 45

2021-08-18:15:37:28,958 INFO     [param_server.py:441] ====Epoch 46 completes 20 clients with loss 4.580321951637318, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:37:28,959 INFO     [param_server.py:450] ====Start to sample for epoch 46, global virtualClock: 1159.172962181311, round_duration: 31.630572791724475
2021-08-18:15:37:28,959 INFO     [oort.py:208] Training selector: Pacer 44: lastExploitationUtil 636.7651266925911, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:28,960 INFO     [oort.py:321] scores are 26,{5: 0.016074322370643247, 6: 0.05266727944580211, 7: 0.0917022937161121, 11: 0.01577107329004159, 14: 0.009809804329348476, 16: 0.0917022937161121, 17: 0.005464416316839766, 25: 0.0031527267505967464, 27: 0.031540947910329804, 35: 0.002669186891253755, 38: 0.01750379965282137, 50: 0.00395972690066542, 51: 0.051574942315733424, 53: 0.11157613528693376, 55: 0.39193002922550835, 58: 0.004200757628590835, 59: 0.003564324045262677, 60: 0.0018745340772763856, 65: 0.005030949478162611, 67: 0.0026040025849485716, 70: 0.004031564034271422, 71: 0.009239486936713975, 76: 0.002150373144126663, 79: 0.0056142637744031965, 81: 0.06524311383963613, 84: 0.5023958921470194, 85: 0.010210511774270663, 86: 0.0018444534245837998, 87: 0.010918021636144385, 88: 0.0022962939834480335, 96: 0.003506258027737316, 97: 0.029255162738758497, 98: 0.04149334301972667, 99: 0.12493376214167376, 104: 0.003895136160607069, 105: 0.015594150362916394, 107: 0.005483403272375262, 110: 0.009734351931423869, 111: 0.004349473819299273, 119: 0.007560953104778212},[84, 55, 99, 53, 7, 16, 81, 6, 51, 98, 27, 97, 38, 5, 11, 105, 87, 85, 14, 110, 71, 119, 79, 107, 17, 65, 111, 58, 70, 50, 104, 59, 96, 25, 35, 67, 88, 76, 60, 86]
2021-08-18:15:37:28,960 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:28,961 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:28,961 INFO     [oort.py:398] At round 44, UCB exploited 40, augment_factor 1.3076923076923077, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4888.192487092498, 'duration': 13.298442137908651, 'time_stamp': 45, 'count': 42, 'status': True, 'gradient': 19.64323827568678}, [1.0, -6.666814818107074e-06]), ({'reward': 0.01, 'duration': 28.420902733732795, 'time_stamp': 45, 'count': 35, 'status': True, 'gradient': 20.357882644055326}, [2.0457501343183512e-09, -6.666814818107074e-06]), ({'reward': 2422.059384808783, 'duration': 19.55790138125729, 'time_stamp': 45, 'count': 40, 'status': True, 'gradient': 19.638680464989495}, [0.4954907874755951, -6.666814818107074e-06])]
2021-08-18:15:37:28,969 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 27, 105, 107]
2021-08-18:15:37:29,239 INFO     [param_server.py:553] For epoch: 46, median_reward: 491.5068418723352, dev: 2457.534209361676
2021-08-18:15:37:29,781 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0586, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:37:29,782 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 484.9217, eval_time 0.5207, test_loss 2.0586, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:37:29,801 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3044, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:37:29,805 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 484.9406, eval_time 0.5425, test_loss 2.3044, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:37:29,843 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9266, Top-1 Accuracy: 591.0/1033 (0.5721), Top-5 Accuracy: 1.0
2021-08-18:15:37:29,844 INFO     [learner.py:656] After aggregation epoch 45, CumulTime 484.9682, eval_time 0.5748, test_loss 1.9266, test_accuracy 0.5721, test_5_accuracy 1.0 

2021-08-18:15:37:29,874 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:29,874 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:29,889 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:29,892 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:29,919 INFO     [learner.py:526] ====Start train round 46
2021-08-18:15:37:29,934 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:30,974 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:31,9 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:32,263 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:32,281 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:32,638 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:32,653 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:32,816 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:32,827 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:32,854 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:32,874 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:34,692 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:34,712 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:34,909 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:34,918 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:35,57 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:35,66 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:36,144 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:36,153 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:36,741 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:36,752 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:37,391 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:37,412 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:37,659 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:37,670 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:38,471 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:38,499 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:39,89 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:39,109 INFO     [learner.py:606] ====Pushing takes 0.019023895263671875 s
2021-08-18:15:37:39,138 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:39,147 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:37:39,148 INFO     [param_server.py:410] Lock worker 1 with localStep 46 , while globalStep is 45

2021-08-18:15:37:39,415 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:39,428 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:39,967 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:39,981 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:39,986 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:37:39,990 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:40,633 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:37:40,634 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:40,644 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:37:40,659 INFO     [learner.py:606] ====Pushing takes 0.023812294006347656 s
2021-08-18:15:37:40,690 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:40,697 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:37:40,698 INFO     [param_server.py:410] Lock worker 2 with localStep 46 , while globalStep is 45

2021-08-18:15:37:41,172 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:37:41,206 INFO     [learner.py:606] ====Pushing takes 0.03216981887817383 s
2021-08-18:15:37:41,240 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:41,249 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:41,250 INFO     [param_server.py:381] ====After aggregation in epoch: 45, virtual_clock: 1195.9541365343848, top_1: : 57.6638 % (1787.0), top_5: : 100.0 % (3099.0), test loss: 2.096512716125559, test len: 3099.0
2021-08-18:15:37:41,251 INFO     [param_server.py:410] Lock worker 3 with localStep 46 , while globalStep is 46

2021-08-18:15:37:41,251 INFO     [param_server.py:441] ====Epoch 47 completes 20 clients with loss 5.561850308531007, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 105: 0, 107: 0, 110: 0} 
==========
2021-08-18:15:37:41,251 INFO     [param_server.py:450] ====Start to sample for epoch 47, global virtualClock: 1195.9541365343848, round_duration: 36.78117435307379
2021-08-18:15:37:41,252 INFO     [oort.py:208] Training selector: Pacer 45: lastExploitationUtil 1166.8440702742712, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:41,253 INFO     [oort.py:321] scores are 26,{5: 0.016895040669976942, 6: 0.10325596944424797, 7: 0.18357920344867656, 11: 0.047818588646755075, 14: 0.0073159845688385095, 16: 0.09096897081198531, 17: 0.005813692158141175, 25: 0.004070312933769418, 27: 0.02906974927488636, 35: 0.0026918629862743354, 38: 0.18046951814078757, 50: 0.0039714671576207014, 51: 0.0511625089408799, 53: 0.06053834064471866, 55: 0.09096897081198531, 58: 0.0030256277630721323, 59: 0.003130971714684846, 60: 0.0019661685788958157, 65: 0.005045865819891315, 67: 0.0026719757384978957, 70: 0.004289254487960173, 71: 0.03825176135272111, 76: 0.0022487489475829575, 79: 0.005788924251382678, 81: 0.0238484726701476, 84: 0.5020584205421171, 85: 0.03587475408656031, 86: 0.0019346174671428767, 87: 0.046261225193693495, 88: 0.0024013454096205363, 97: 0.3181995254566731, 98: 0.04116152995843778, 99: 0.019354955235895147, 105: 0.003854063392989308, 107: 0.02222139715984111, 110: 0.04043230172046288, 111: 0.004627484505046729, 119: 0.008044235875267997},[84, 97, 7, 38, 6, 16, 55, 53, 51, 11, 87, 98, 110, 71, 85, 27, 81, 107, 99, 5, 119, 14, 17, 79, 65, 111, 70, 25, 50, 105, 59, 58, 35, 67, 88, 76, 60, 86]
2021-08-18:15:37:41,254 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:41,254 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:41,254 INFO     [oort.py:398] At round 45, UCB exploited 38, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3773.8585156287304, 'duration': 20.64883858350112, 'time_stamp': 46, 'count': 42, 'status': True, 'gradient': 13.102240395058532}, [0.8545096753811513, -6.52188091045458e-06]), ({'reward': 4416.400622376886, 'duration': 13.298442137908651, 'time_stamp': 46, 'count': 43, 'status': True, 'gradient': 20.677743243313884}, [1.0, -6.52188091045458e-06]), ({'reward': 826.2125557491403, 'duration': 21.753601635627824, 'time_stamp': 46, 'count': 39, 'status': True, 'gradient': 20.879357605265167}, [0.18707642383175713, -6.52188091045458e-06])]
2021-08-18:15:37:41,255 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:37:41,526 INFO     [param_server.py:553] For epoch: 47, median_reward: 577.9767114193306, dev: 2889.883557096653
2021-08-18:15:37:42,160 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0741, Top-1 Accuracy: 577.0/1033 (0.5586), Top-5 Accuracy: 1.0
2021-08-18:15:37:42,161 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 497.3, eval_time 0.5962, test_loss 2.0741, test_accuracy 0.5586, test_5_accuracy 1.0 

2021-08-18:15:37:42,214 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9498, Top-1 Accuracy: 565.0/1033 (0.547), Top-5 Accuracy: 1.0
2021-08-18:15:37:42,215 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 497.3507, eval_time 0.6483, test_loss 1.9498, test_accuracy 0.547, test_5_accuracy 1.0 

2021-08-18:15:37:42,237 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:42,255 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1974, Top-1 Accuracy: 579.0/1033 (0.5605), Top-5 Accuracy: 1.0
2021-08-18:15:37:42,256 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:42,256 INFO     [learner.py:656] After aggregation epoch 46, CumulTime 497.3809, eval_time 0.69, test_loss 2.1974, test_accuracy 0.5605, test_5_accuracy 1.0 

2021-08-18:15:37:42,291 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:42,299 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:42,325 INFO     [learner.py:526] ====Start train round 47
2021-08-18:15:37:42,337 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:42,812 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:42,824 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:43,434 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:43,444 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:44,6 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:44,15 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:44,211 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:44,229 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:45,138 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:45,159 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:45,184 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:45,194 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:45,746 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:45,764 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:46,246 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:46,259 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:46,302 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:46,311 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:46,492 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:46,506 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:46,952 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:46,962 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:47,160 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:47,174 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:47,882 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:47,895 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:48,501 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:48,511 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:48,529 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:48,532 INFO     [learner.py:606] ====Pushing takes 0.029509544372558594 s
2021-08-18:15:37:48,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:48,576 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:37:48,577 INFO     [param_server.py:410] Lock worker 2 with localStep 47 , while globalStep is 46

2021-08-18:15:37:49,34 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:49,43 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:49,76 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:49,90 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:49,570 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:49,589 INFO     [learner.py:606] ====Pushing takes 0.01788806915283203 s
2021-08-18:15:37:49,612 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:49,618 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:49,619 INFO     [param_server.py:410] Lock worker 1 with localStep 47 , while globalStep is 46

2021-08-18:15:37:49,652 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:49,661 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:50,271 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:50,296 INFO     [learner.py:606] ====Pushing takes 0.024046659469604492 s
2021-08-18:15:37:50,324 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:50,332 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:50,332 INFO     [param_server.py:381] ====After aggregation in epoch: 46, virtual_clock: 1219.957072745292, top_1: : 55.534 % (1721.0), top_5: : 100.0 % (3099.0), test loss: 2.0737759978682906, test len: 3099.0
2021-08-18:15:37:50,333 INFO     [param_server.py:410] Lock worker 3 with localStep 47 , while globalStep is 47

2021-08-18:15:37:50,333 INFO     [param_server.py:441] ====Epoch 48 completes 20 clients with loss 4.536276976858131, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:50,334 INFO     [param_server.py:450] ====Start to sample for epoch 48, global virtualClock: 1219.957072745292, round_duration: 24.002936210907112
2021-08-18:15:37:50,334 INFO     [oort.py:208] Training selector: Pacer 46: lastExploitationUtil 1000.1069124437503, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:50,335 INFO     [oort.py:321] scores are 26,{5: 0.008400123696747447, 6: 0.4722335202406704, 7: 0.09025544816312618, 11: 0.02222802927445261, 14: 0.006408948304846062, 16: 0.8839844154473881, 17: 0.0057329648968937885, 25: 0.003998887191715014, 27: 0.007958603176034546, 35: 0.0026953022343110095, 38: 0.03275891217368765, 50: 0.003982915881017756, 51: 0.3274411665270739, 53: 0.06006350316124716, 55: 0.09025544816312618, 58: 0.002650510227404002, 59: 0.0030760295071171314, 60: 0.001946642985478246, 65: 0.011642557829106857, 67: 0.0026620432125724364, 70: 0.005651218318371156, 71: 0.024238427645216106, 76: 0.002228304238380468, 79: 0.013886918154284384, 81: 0.023661415201661803, 84: 0.04153510233239886, 85: 0.04009938816521048, 86: 0.0019154052009682366, 87: 0.010745761047978922, 88: 0.002379513355559013, 97: 0.028793585384526896, 98: 0.49331746638924656, 99: 0.1756137118489754, 105: 0.0038651736713221857, 107: 0.007686324403244537, 110: 0.009580766854841362, 111: 0.004563228582924327, 119: 0.010598516190451567},[16, 98, 6, 51, 99, 7, 55, 53, 84, 85, 38, 97, 71, 81, 11, 79, 65, 87, 119, 110, 5, 27, 107, 14, 17, 70, 111, 25, 50, 105, 59, 35, 67, 58, 88, 76, 60, 86]
2021-08-18:15:37:50,336 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:50,336 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:50,337 INFO     [oort.py:398] At round 46, UCB exploited 38, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3314.1897634227334, 'duration': 11.90395711384456, 'time_stamp': 47, 'count': 45, 'status': True, 'gradient': 20.585529762845564}, [0.7319798665846103, -6.383114534351799e-06]), ({'reward': 3593.770715342225, 'duration': 7.864087706209871, 'time_stamp': 47, 'count': 45, 'status': True, 'gradient': 21.60540820695609}, [0.7937289694928925, -6.383114534351799e-06]), ({'reward': 3328.476054715941, 'duration': 19.55790138125729, 'time_stamp': 47, 'count': 42, 'status': True, 'gradient': 19.65937891829947}, [0.7351351805113473, -6.383114534351799e-06])]
2021-08-18:15:37:50,337 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:37:50,606 INFO     [param_server.py:553] For epoch: 48, median_reward: 565.4859066688208, dev: 2827.429533344104
2021-08-18:15:37:51,191 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1372, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:37:51,191 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 506.3307, eval_time 0.5503, test_loss 2.1372, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:37:51,217 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0951, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:37:51,218 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 506.3425, eval_time 0.5731, test_loss 2.0951, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:37:51,255 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:51,277 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:37:51,283 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:51,290 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:51,306 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5766, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:37:51,306 INFO     [learner.py:656] After aggregation epoch 47, CumulTime 506.4423, eval_time 0.6614, test_loss 2.5766, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:37:51,374 INFO     [learner.py:526] ====Start train round 48
2021-08-18:15:37:51,393 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:52,42 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:37:52,56 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:37:52,635 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:37:52,646 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:37:53,114 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:37:53,123 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:37:53,190 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:37:53,200 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:37:53,768 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:37:53,801 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:37:53,802 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:37:53,810 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:37:54,342 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:37:54,351 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:37:54,375 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:37:54,385 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:37:54,961 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:37:54,970 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:37:54,976 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:37:54,981 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:37:54,985 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:37:55,8 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:37:55,637 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:37:55,646 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:37:55,651 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:37:55,666 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:37:56,225 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:37:56,258 INFO     [learner.py:606] ====Pushing takes 0.031149625778198242 s
2021-08-18:15:37:56,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:56,303 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 8 clients
2021-08-18:15:37:56,304 INFO     [param_server.py:410] Lock worker 2 with localStep 48 , while globalStep is 47

2021-08-18:15:37:57,7 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:37:57,28 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:37:57,359 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:37:57,380 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:37:57,584 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:37:57,603 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:37:58,2 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:37:58,12 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:37:58,57 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:37:58,76 INFO     [learner.py:606] ====Pushing takes 0.01739192008972168 s
2021-08-18:15:37:58,97 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:58,106 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 13 clients
2021-08-18:15:37:58,106 INFO     [param_server.py:410] Lock worker 1 with localStep 48 , while globalStep is 47

2021-08-18:15:37:58,553 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:37:58,577 INFO     [learner.py:606] ====Pushing takes 0.022400856018066406 s
2021-08-18:15:37:58,606 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:37:58,614 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:37:58,615 INFO     [param_server.py:381] ====After aggregation in epoch: 47, virtual_clock: 1241.034751542769, top_1: : 58.051 % (1799.0), top_5: : 100.0 % (3099.0), test loss: 2.269633761158696, test len: 3099.0
2021-08-18:15:37:58,616 INFO     [param_server.py:410] Lock worker 3 with localStep 48 , while globalStep is 48

2021-08-18:15:37:58,616 INFO     [param_server.py:441] ====Epoch 49 completes 20 clients with loss 5.698998678036932, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:37:58,617 INFO     [param_server.py:450] ====Start to sample for epoch 49, global virtualClock: 1241.034751542769, round_duration: 21.077678797477027
2021-08-18:15:37:58,617 INFO     [oort.py:208] Training selector: Pacer 47: lastExploitationUtil 1322.1980120136634, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:37:58,618 INFO     [oort.py:321] scores are 26,{5: 0.016297304757437972, 6: 0.05143737117916902, 7: 0.23577449972888104, 11: 0.015402780611604326, 14: 0.0059977398723767604, 16: 0.08956082352252208, 25: 0.0030874898497112255, 27: 0.014151619231609023, 35: 0.00265492553657544, 38: 0.030405255047458894, 50: 0.003994086583632505, 51: 0.050370542761157586, 53: 0.2331070459013843, 55: 1.0895608219976567, 58: 0.002070129842744064, 59: 0.0023749631898376386, 60: 0.0016725925358536285, 65: 0.004858563880267667, 67: 0.0024738560166284733, 70: 0.0044137749659544645, 71: 0.009023722585821181, 76: 0.0019358089497520988, 79: 0.01299591114745069, 81: 0.023479312044842583, 84: 0.44636212624808885, 85: 0.009972071646550512, 86: 0.0016457524395453627, 87: 0.07068212277624249, 88: 0.0020671698103009637, 97: 0.2817578007640231, 98: 0.04052437317493488, 99: 0.053985926985960796, 105: 0.0038760141470860214, 107: 0.00719315746555543, 110: 0.015546890356095348, 111: 0.005705662801083388, 119: 0.009918498343236182},[55, 84, 97, 7, 53, 16, 87, 99, 6, 51, 98, 38, 81, 5, 110, 11, 27, 79, 85, 119, 71, 107, 14, 111, 65, 70, 50, 105, 25, 35, 67, 59, 58, 88, 76, 60, 86]
2021-08-18:15:37:58,619 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:37:58,619 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:37:58,620 INFO     [oort.py:398] At round 47, UCB exploited 37, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6557.966163934622, 'duration': 8.010998429338052, 'time_stamp': 48, 'count': 47, 'status': True, 'gradient': 20.799001531145}, [1.0, -6.2501302110460685e-06]), ({'reward': 958.8728805911696, 'duration': 5.8943907365129, 'time_stamp': 48, 'count': 45, 'status': True, 'gradient': 20.89645209005648}, [0.1462136777312243, -6.2501302110460685e-06]), ({'reward': 5773.5069909523945, 'duration': 13.298442137908651, 'time_stamp': 48, 'count': 45, 'status': True, 'gradient': 13.115092493299011}, [0.8803805404951996, -6.2501302110460685e-06])]
2021-08-18:15:37:58,620 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 55, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 110, 71, 5, 27, 65, 79]
2021-08-18:15:37:58,890 INFO     [param_server.py:553] For epoch: 49, median_reward: 641.3282997052112, dev: 3206.641498526056
2021-08-18:15:37:59,427 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.166, Top-1 Accuracy: 582.0/1033 (0.5634), Top-5 Accuracy: 1.0
2021-08-18:15:37:59,428 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 514.5528, eval_time 0.5117, test_loss 2.166, test_accuracy 0.5634, test_5_accuracy 1.0 

2021-08-18:15:37:59,436 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9108, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:37:59,437 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 514.5761, eval_time 0.5243, test_loss 1.9108, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:37:59,438 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0851, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:37:59,440 INFO     [learner.py:656] After aggregation epoch 48, CumulTime 514.5761, eval_time 0.5249, test_loss 2.0851, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:37:59,500 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:59,507 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:59,509 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:37:59,512 INFO     [learner.py:526] ====Start train round 49
2021-08-18:15:37:59,522 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:37:59,528 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:00,706 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:00,716 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:01,877 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:01,888 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:02,115 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:02,124 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:02,486 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:02,504 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:02,569 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:02,596 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:38:04,179 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:04,191 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:04,429 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:38:04,456 INFO     [learner.py:165] Start to run client 55 on rank 1...
2021-08-18:15:38:04,686 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:04,695 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:05,193 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:05,204 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:05,717 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:05,726 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:07,532 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:07,559 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:07,720 INFO     [learner.py:439] Completed to run client 55
2021-08-18:15:38:07,741 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:08,593 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:08,607 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:08,783 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:08,797 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:08,883 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:08,903 INFO     [learner.py:606] ====Pushing takes 0.0190889835357666 s
2021-08-18:15:38:08,932 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:08,938 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:38:08,939 INFO     [param_server.py:410] Lock worker 1 with localStep 49 , while globalStep is 48

2021-08-18:15:38:09,343 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:09,357 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:09,936 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:09,964 INFO     [learner.py:606] ====Pushing takes 0.026555299758911133 s
2021-08-18:15:38:09,994 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:10,1 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:10,2 INFO     [param_server.py:410] Lock worker 3 with localStep 49 , while globalStep is 48

2021-08-18:15:38:10,195 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:10,207 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:10,782 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:10,791 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:11,437 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:11,469 INFO     [learner.py:606] ====Pushing takes 0.030765533447265625 s
2021-08-18:15:38:11,504 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:11,513 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:11,513 INFO     [param_server.py:381] ====After aggregation in epoch: 48, virtual_clock: 1275.0585347860022, top_1: : 57.4702 % (1781.0), top_5: : 100.0 % (3099.0), test loss: 2.0539921124776206, test len: 3099.0
2021-08-18:15:38:11,514 INFO     [param_server.py:410] Lock worker 2 with localStep 49 , while globalStep is 49

2021-08-18:15:38:11,515 INFO     [param_server.py:441] ====Epoch 50 completes 20 clients with loss 4.385091639647595, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 55: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:38:11,515 INFO     [param_server.py:450] ====Start to sample for epoch 50, global virtualClock: 1275.0585347860022, round_duration: 34.02378324323311
2021-08-18:15:38:11,516 INFO     [oort.py:208] Training selector: Pacer 48: lastExploitationUtil 1598.5532834461187, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:11,516 INFO     [oort.py:321] scores are 26,{5: 0.00827250581285213, 6: 0.48624894701588345, 7: 0.08888425296167202, 11: 0.10558730047235872, 14: 0.0055022501669506835, 16: 0.08888425296167202, 25: 0.002542281149137995, 27: 0.007837693040332456, 35: 0.002633409129558625, 38: 0.016965902302817155, 50: 0.01140553294799304, 51: 0.049990027877239974, 53: 0.059150995506657984, 55: 0.288742246033729, 58: 0.0017230483462688686, 59: 0.001955577003106776, 60: 0.0015094317618413336, 65: 0.004821860764328007, 67: 0.002363203524851885, 70: 0.0036737539350718963, 71: 0.00895555455418948, 76: 0.0017618244935500454, 79: 0.020448353103851968, 81: 0.12290885401288704, 84: 0.04090408521189044, 85: 0.009999299112404894, 86: 0.0014852099068526647, 87: 0.010582507346569885, 88: 0.0018813790506453825, 97: 0.02835614225045076, 98: 0.04021823934533507, 99: 0.08973566324184298, 105: 0.011317123080568826, 107: 0.006598911041147053, 110: 0.11558688545866044, 111: 0.005234302381871172, 119: 0.009099104050230336},[6, 55, 81, 110, 11, 99, 7, 16, 53, 51, 84, 98, 97, 79, 38, 50, 105, 87, 85, 119, 71, 5, 27, 107, 14, 111, 65, 70, 35, 25, 67, 59, 88, 76, 58, 60, 86]
2021-08-18:15:38:11,517 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:38:11,518 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:11,518 INFO     [oort.py:398] At round 48, UCB exploited 37, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1792.4585399705722, 'duration': 8.010998429338052, 'time_stamp': 49, 'count': 48, 'status': True, 'gradient': 20.797957222522594}, [0.19985799418705685, -6.12257393008021e-06]), ({'reward': 4709.090260433734, 'duration': 21.753601635627824, 'time_stamp': 49, 'count': 42, 'status': True, 'gradient': 20.90730353776369}, [0.5250623998832106, -6.12257393008021e-06]), ({'reward': 6796.012404652891, 'duration': 11.90395711384456, 'time_stamp': 49, 'count': 47, 'status': True, 'gradient': 20.5967920169341}, [0.757754196685434, -6.12257393008021e-06])]
2021-08-18:15:38:11,519 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65, 79]
2021-08-18:15:38:11,789 INFO     [param_server.py:553] For epoch: 50, median_reward: 712.2237812898911, dev: 3561.1189064494556
2021-08-18:15:38:12,370 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9672, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:38:12,371 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 527.5103, eval_time 0.5587, test_loss 1.9672, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:38:12,436 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:38:12,447 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3102, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:38:12,459 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:12,447 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5075, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:38:12,473 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 527.5975, eval_time 0.6601, test_loss 2.3102, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:38:12,473 INFO     [learner.py:656] After aggregation epoch 49, CumulTime 527.6092, eval_time 0.6606, test_loss 2.5075, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:38:12,541 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:38:12,541 INFO     [learner.py:526] ====Start train round 50
2021-08-18:15:38:12,550 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:12,551 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:13,203 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:13,213 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:14,242 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:14,253 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:14,786 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:14,796 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:14,858 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:14,867 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:15,698 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:15,725 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:38:16,174 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:16,188 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:16,586 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:16,595 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:17,134 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:38:17,161 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:17,306 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:17,320 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:17,976 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:17,994 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:18,102 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:18,122 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:18,248 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:18,275 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:18,808 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:18,835 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:18,998 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:19,17 INFO     [learner.py:606] ====Pushing takes 0.018147945404052734 s
2021-08-18:15:38:19,41 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:19,49 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:38:19,50 INFO     [param_server.py:410] Lock worker 1 with localStep 50 , while globalStep is 49

2021-08-18:15:38:19,301 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:19,321 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:19,971 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:19,980 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:20,609 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:20,640 INFO     [learner.py:606] ====Pushing takes 0.0301663875579834 s
2021-08-18:15:38:20,676 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:20,685 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:38:20,685 INFO     [param_server.py:410] Lock worker 2 with localStep 50 , while globalStep is 49

2021-08-18:15:38:20,753 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:20,763 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:21,398 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:21,408 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:22,83 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:22,108 INFO     [learner.py:606] ====Pushing takes 0.0227053165435791 s
2021-08-18:15:38:22,138 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:22,146 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:22,146 INFO     [param_server.py:381] ====After aggregation in epoch: 49, virtual_clock: 1303.0743902814909, top_1: : 57.4702 % (1781.0), top_5: : 100.0 % (3099.0), test loss: 2.2616263098186917, test len: 3099.0
2021-08-18:15:38:22,147 INFO     [param_server.py:410] Lock worker 3 with localStep 50 , while globalStep is 50

2021-08-18:15:38:22,148 INFO     [param_server.py:441] ====Epoch 51 completes 20 clients with loss 3.9897147191132003, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:38:22,148 INFO     [param_server.py:450] ====Start to sample for epoch 51, global virtualClock: 1303.0743902814909, round_duration: 28.015855495488744
2021-08-18:15:38:22,149 INFO     [oort.py:208] Training selector: Pacer 49: lastExploitationUtil 1433.5160323925465, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:22,149 INFO     [oort.py:321] scores are 26,{5: 0.008211143676131539, 6: 0.39065422652826853, 7: 0.5716549965498839, 11: 0.015173034606090466, 14: 0.007690510102920464, 16: 0.08822494515265623, 25: 0.003713857761278181, 27: 0.04835160234900536, 35: 0.0027009332032447647, 38: 0.07675917620236075, 50: 0.015941544587083637, 51: 0.26118181311837846, 53: 0.5797782354160802, 58: 0.00246975681580309, 59: 0.00285677877650463, 60: 0.0018663327724176718, 65: 0.059034856921915596, 67: 0.002616504556998446, 70: 0.0067812610593816405, 71: 0.008889125835323046, 76: 0.0021436810550037946, 79: 0.003937679548813865, 81: 0.023129097477061746, 84: 0.040600675081274, 85: 0.029464823430753722, 86: 0.0018363837260832055, 87: 0.10049682497541745, 88: 0.0022891477799942225, 97: 0.2393259290690496, 98: 0.03991991654481967, 99: 0.0400157579933967, 105: 0.01581797387364939, 107: 0.01005638744300536, 110: 0.009365225562461919, 111: 0.007976796840830346, 119: 0.012717842610308219},[53, 7, 6, 51, 97, 87, 16, 38, 65, 27, 84, 99, 98, 85, 81, 50, 105, 11, 119, 107, 110, 71, 5, 111, 14, 70, 79, 25, 59, 35, 67, 58, 88, 76, 60, 86]
2021-08-18:15:38:22,150 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:38:22,150 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:22,151 INFO     [oort.py:398] At round 49, UCB exploited 36, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2430.464945240009, 'duration': 5.8943907365129, 'time_stamp': 50, 'count': 47, 'status': True, 'gradient': 20.91447944546526}, [0.48343005338627937, -6.000120002400053e-06]), ({'reward': 1891.1960523771684, 'duration': 12.029357192292537, 'time_stamp': 50, 'count': 47, 'status': True, 'gradient': 26.75685112885885}, [0.3761666831665673, -6.000120002400053e-06]), ({'reward': 2976.139584365558, 'duration': 11.90395711384456, 'time_stamp': 50, 'count': 48, 'status': True, 'gradient': 20.607492681613756}, [0.5919675596483335, -6.000120002400053e-06])]
2021-08-18:15:38:22,152 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 53, 6, 51, 84, 98, 97, 81, 99, 38, 11, 87, 85, 110, 71, 5, 27, 65, 79]
2021-08-18:15:38:22,423 INFO     [param_server.py:553] For epoch: 51, median_reward: 697.765077797451, dev: 3488.825388987255
2021-08-18:15:38:23,19 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8335, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:38:23,20 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 538.1589, eval_time 0.5625, test_loss 1.8335, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:38:23,69 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.24, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:38:23,73 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 538.2086, eval_time 0.6129, test_loss 2.24, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:38:23,87 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:23,109 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:23,107 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1146, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:38:23,110 INFO     [learner.py:656] After aggregation epoch 50, CumulTime 538.2348, eval_time 0.6505, test_loss 2.1146, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:38:23,141 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:23,156 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:23,176 INFO     [learner.py:526] ====Start train round 51
2021-08-18:15:38:23,189 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:23,717 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:23,726 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:24,739 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:24,748 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:25,238 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:25,249 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:25,365 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:25,375 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:26,49 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:26,77 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:38:26,677 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:26,696 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:26,996 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:27,20 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:27,515 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:38:27,549 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:27,735 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:27,747 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:28,103 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:28,124 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:28,300 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:28,327 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:28,350 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:28,359 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:28,877 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:28,904 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:29,64 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:29,82 INFO     [learner.py:606] ====Pushing takes 0.016935348510742188 s
2021-08-18:15:38:29,104 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:29,111 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:15:38:29,112 INFO     [param_server.py:410] Lock worker 1 with localStep 51 , while globalStep is 50

2021-08-18:15:38:29,393 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:29,411 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:30,53 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:30,67 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:30,571 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:30,605 INFO     [learner.py:606] ====Pushing takes 0.032121896743774414 s
2021-08-18:15:38:30,642 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:30,642 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:30,651 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:15:38:30,651 INFO     [param_server.py:410] Lock worker 2 with localStep 51 , while globalStep is 50

2021-08-18:15:38:30,660 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:31,182 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:31,195 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:31,743 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:31,770 INFO     [learner.py:606] ====Pushing takes 0.02524423599243164 s
2021-08-18:15:38:31,807 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:31,815 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:31,816 INFO     [param_server.py:381] ====After aggregation in epoch: 50, virtual_clock: 1330.4226982494524, top_1: : 58.3737 % (1809.0), top_5: : 100.0 % (3099.0), test loss: 2.062684765568486, test len: 3099.0
2021-08-18:15:38:31,817 INFO     [param_server.py:410] Lock worker 3 with localStep 51 , while globalStep is 51

2021-08-18:15:38:31,818 INFO     [param_server.py:441] ====Epoch 52 completes 20 clients with loss 5.9852234035489555, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:38:31,818 INFO     [param_server.py:450] ====Start to sample for epoch 52, global virtualClock: 1330.4226982494524, round_duration: 27.34830796796159
2021-08-18:15:38:31,818 INFO     [oort.py:208] Training selector: Pacer 50: lastExploitationUtil 695.6255838234308, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:31,819 INFO     [oort.py:321] scores are 26,{5: 0.03248213024779595, 6: 0.050300964110536237, 7: 0.14248154466770085, 11: 0.01506248661207902, 14: 0.004870526556341593, 16: 0.08758215411173413, 25: 0.0039186149129162035, 27: 0.08431254107002342, 35: 0.0027180728544983217, 38: 0.2075937179175538, 50: 0.01009604242389712, 51: 0.22375561397064656, 53: 0.05828447032750041, 58: 0.0026004800004182406, 59: 0.0030142823543841783, 60: 0.0019302862858313512, 65: 0.004751223512547318, 67: 0.002664667155632221, 70: 0.004294684180007894, 71: 0.057415537247508426, 76: 0.002212421613755251, 79: 0.003908990325696525, 81: 0.022960583043676215, 84: 0.0403048658840852, 85: 0.009751758429753735, 86: 0.001899310977318572, 87: 0.010427480216495791, 88: 0.0023625529617464958, 93: 0.018381719685849323, 97: 0.027940742458218627, 98: 0.03962906723156741, 99: 0.01863436133403573, 105: 0.0167452252799019, 107: 0.005841277748854951, 110: 0.009296992217829638, 111: 0.004633342356542491, 119: 0.008054418932413368},[51, 38, 7, 16, 27, 53, 71, 6, 84, 98, 5, 97, 81, 99, 93, 105, 11, 87, 50, 85, 110, 119, 107, 14, 65, 111, 70, 25, 79, 59, 35, 67, 58, 88, 76, 60, 86]
2021-08-18:15:38:31,820 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:38:31,820 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:31,821 INFO     [oort.py:398] At round 50, UCB exploited 37, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 256.53334857708603, 'duration': 5.8943907365129, 'time_stamp': 51, 'count': 48, 'status': True, 'gradient': 20.9226070252258}, [0.05489939269609903, -5.8824682836918415e-06]), ({'reward': 1449.7531038881957, 'duration': 12.029357192292537, 'time_stamp': 51, 'count': 48, 'status': True, 'gradient': 26.76959923668626}, [0.31026420735831917, -5.8824682836918415e-06]), ({'reward': 0.01, 'duration': 7.864087706209871, 'time_stamp': 51, 'count': 49, 'status': True, 'gradient': 21.639158428694603}, [2.1401323061033977e-09, -5.8824682836918415e-06])]
2021-08-18:15:38:31,822 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 16, 53, 6, 51, 84, 98, 97, 81, 99, 38, 93, 11, 87, 85, 110, 71, 5, 27, 65]
2021-08-18:15:38:32,96 INFO     [param_server.py:553] For epoch: 52, median_reward: 535.137523493713, dev: 2675.6876174685653
2021-08-18:15:38:32,653 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8204, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:38:32,657 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 547.7963, eval_time 0.5281, test_loss 1.8204, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:38:32,721 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:32,721 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9837, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:38:32,722 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 547.8581, eval_time 0.5929, test_loss 1.9837, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:38:32,735 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:32,753 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0314, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:38:32,754 INFO     [learner.py:656] After aggregation epoch 51, CumulTime 547.8788, eval_time 0.6249, test_loss 2.0314, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:38:32,788 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:32,797 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:32,821 INFO     [learner.py:526] ====Start train round 52
2021-08-18:15:38:32,837 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:33,440 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:33,452 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:34,83 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:34,103 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:34,627 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:34,640 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:34,644 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:34,653 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:35,438 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:35,452 INFO     [learner.py:165] Start to run client 16 on rank 1...
2021-08-18:15:38:35,702 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:35,715 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:35,875 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:35,884 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:36,416 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:36,430 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:36,437 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:36,450 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:36,610 INFO     [learner.py:439] Completed to run client 16
2021-08-18:15:38:36,643 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:36,985 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:36,994 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:37,2 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:37,11 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:37,266 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:37,293 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:37,456 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:37,467 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:37,790 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:37,804 INFO     [learner.py:606] ====Pushing takes 0.013175249099731445 s
2021-08-18:15:38:37,821 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:37,828 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:37,829 INFO     [param_server.py:410] Lock worker 1 with localStep 52 , while globalStep is 51

2021-08-18:15:38:37,987 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:38,35 INFO     [learner.py:606] ====Pushing takes 0.04694795608520508 s
2021-08-18:15:38:38,71 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:38,80 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:38,80 INFO     [param_server.py:410] Lock worker 2 with localStep 52 , while globalStep is 51

2021-08-18:15:38:38,517 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:38,526 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:38:40,196 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:38:40,206 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:40,717 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:40,726 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:41,199 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:41,230 INFO     [learner.py:606] ====Pushing takes 0.02976536750793457 s
2021-08-18:15:38:41,263 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:41,272 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:41,273 INFO     [param_server.py:381] ====After aggregation in epoch: 51, virtual_clock: 1353.6073191780456, top_1: : 58.8577 % (1824.0), top_5: : 100.0 % (3099.0), test loss: 1.9451857054675068, test len: 3099.0
2021-08-18:15:38:41,274 INFO     [param_server.py:410] Lock worker 3 with localStep 52 , while globalStep is 52

2021-08-18:15:38:41,275 INFO     [param_server.py:441] ====Epoch 53 completes 20 clients with loss 4.35216383719332, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 16: 0, 27: 0, 38: 0, 51: 0, 53: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:38:41,275 INFO     [param_server.py:450] ====Start to sample for epoch 53, global virtualClock: 1353.6073191780456, round_duration: 23.184620928593155
2021-08-18:15:38:41,276 INFO     [oort.py:208] Training selector: Pacer 51: lastExploitationUtil 1308.9486330383122, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:41,276 INFO     [oort.py:321] scores are 26,{5: 0.008092965968456128, 6: 0.13695541354382668, 7: 0.1752100425694362, 11: 0.014954658881714855, 14: 0.0037713869102380553, 16: 0.35639233528731606, 25: 0.0030513503520057774, 27: 0.0516286858695768, 35: 0.0026710510567637073, 38: 0.016597687939673013, 50: 0.011368739299112116, 51: 0.048905084326945014, 53: 0.7233506359283615, 58: 0.0019461988280846264, 59: 0.0022240233586759655, 60: 0.0016209242257189994, 65: 0.004717210957980132, 67: 0.0024514381237621245, 70: 0.0033254958191325924, 71: 0.008761190366661066, 76: 0.0018821478575361604, 79: 0.003918871440235408, 81: 0.08981082482940883, 84: 0.040016335688318735, 85: 0.0611051811945628, 86: 0.0015949132509034893, 87: 0.06427100707393046, 88: 0.0020098673632641477, 93: 0.015118716109607957, 97: 0.027740723236854253, 98: 0.039345374871462536, 99: 0.018500963646045525, 105: 0.011280614637266146, 107: 0.006577623301507745, 110: 0.05254402683269607, 111: 0.005217416797931051, 119: 0.00906975081955872},[53, 16, 7, 6, 81, 87, 85, 110, 27, 51, 84, 98, 97, 99, 38, 93, 11, 50, 105, 119, 71, 5, 107, 111, 65, 79, 14, 70, 25, 35, 67, 59, 88, 58, 76, 60, 86]
2021-08-18:15:38:41,277 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:38:41,278 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:41,278 INFO     [oort.py:398] At round 51, UCB exploited 37, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1966.9205111811834, 'duration': 7.864087706209871, 'time_stamp': 52, 'count': 50, 'status': True, 'gradient': 21.647959806803033}, [0.26943715637395593, -5.7693417181099685e-06]), ({'reward': 7300.081545280513, 'duration': 11.058674649423494, 'time_stamp': 52, 'count': 49, 'status': True, 'gradient': 14.776868278772708}, [1.0, -5.7693417181099685e-06]), ({'reward': 644.2768097908807, 'duration': 5.8943907365129, 'time_stamp': 52, 'count': 49, 'status': True, 'gradient': 20.9290740342772}, [0.08825486365607606, -5.7693417181099685e-06])]
2021-08-18:15:38:41,279 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 38, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79]
2021-08-18:15:38:41,584 INFO     [param_server.py:553] For epoch: 53, median_reward: 657.9487437597423, dev: 3289.7437187987116
2021-08-18:15:38:42,212 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.8437, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:38:42,213 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 557.3521, eval_time 0.5849, test_loss 1.8437, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:38:42,276 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:42,297 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:42,385 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9971, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:38:42,386 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 557.5106, eval_time 0.7565, test_loss 1.9971, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:38:42,428 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 1.9763, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:38:42,429 INFO     [learner.py:656] After aggregation epoch 52, CumulTime 557.565, eval_time 0.8009, test_loss 1.9763, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:38:42,454 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:42,461 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:42,499 INFO     [learner.py:526] ====Start train round 53
2021-08-18:15:38:42,516 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:43,317 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:43,330 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:44,55 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:44,65 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:44,675 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:44,685 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:44,817 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:44,837 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:45,429 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:45,442 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:45,938 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:45,947 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:46,410 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:46,423 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:46,586 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:46,595 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:46,923 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:46,942 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:47,64 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:47,76 INFO     [learner.py:606] ====Pushing takes 0.010960102081298828 s
2021-08-18:15:38:47,81 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:47,91 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:47,93 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:47,97 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:47,98 INFO     [param_server.py:410] Lock worker 1 with localStep 53 , while globalStep is 52

2021-08-18:15:38:47,210 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:47,220 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:47,941 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:47,952 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:48,770 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:48,789 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:38:49,473 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:38:49,493 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:38:50,110 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:38:50,114 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:38:50,125 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:38:50,153 INFO     [learner.py:606] ====Pushing takes 0.03740191459655762 s
2021-08-18:15:38:50,196 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:50,204 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:38:50,204 INFO     [param_server.py:410] Lock worker 2 with localStep 53 , while globalStep is 52

2021-08-18:15:38:51,319 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:38:51,329 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:38:51,921 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:38:51,930 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:38:52,584 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:38:52,616 INFO     [learner.py:606] ====Pushing takes 0.030812740325927734 s
2021-08-18:15:38:52,648 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:52,659 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:38:52,660 INFO     [param_server.py:381] ====After aggregation in epoch: 52, virtual_clock: 1380.9556271460071, top_1: : 57.3088 % (1776.0), top_5: : 100.0 % (3099.0), test loss: 1.9390563501252067, test len: 3099.0
2021-08-18:15:38:52,661 INFO     [param_server.py:410] Lock worker 3 with localStep 53 , while globalStep is 53

2021-08-18:15:38:52,662 INFO     [param_server.py:441] ====Epoch 54 completes 20 clients with loss 4.1114000521311445, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 38: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:38:52,662 INFO     [param_server.py:450] ====Start to sample for epoch 54, global virtualClock: 1380.9556271460071, round_duration: 27.34830796796159
2021-08-18:15:38:52,663 INFO     [oort.py:208] Training selector: Pacer 52: lastExploitationUtil 1129.1087487328232, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:38:52,663 INFO     [oort.py:321] scores are 26,{5: 0.008036024236813199, 6: 0.0495894932378424, 7: 0.086343367684473, 11: 0.014849438598301677, 14: 0.00443158341956611, 25: 0.003740297697231247, 27: 0.01997158607570804, 35: 0.002709199575629723, 38: 0.01648090738032831, 50: 0.012497050554614489, 51: 0.054224645011417175, 53: 0.5146504651579815, 58: 0.0023380126021257425, 59: 0.0026967670890259065, 60: 0.0018089499619471131, 65: 0.00798607158553582, 67: 0.0025863012730957787, 70: 0.005316032070806663, 71: 0.02037067567428308, 76: 0.002083481947761389, 79: 0.023445825256796875, 81: 0.022635822150033187, 84: 0.3230344822217622, 85: 0.07219529371573033, 86: 0.0017799217377055677, 87: 0.06248059118956165, 88: 0.0022248636588186764, 93: 0.01501234152717991, 97: 0.02754554080011962, 98: 0.49154733311526955, 99: 0.030681363351692487, 105: 0.012400179800063594, 107: 0.007230431516234376, 110: 0.009165492965606328, 111: 0.006395428182138879, 119: 0.009969894772644986},[53, 98, 84, 7, 85, 87, 51, 6, 99, 97, 79, 81, 71, 27, 38, 93, 11, 50, 105, 119, 110, 5, 65, 107, 111, 70, 14, 25, 35, 59, 67, 58, 88, 76, 60, 86]
2021-08-18:15:38:52,717 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:38:52,717 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:38:52,718 INFO     [oort.py:398] At round 52, UCB exploited 36, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5471.984222112562, 'duration': 13.411352670399307, 'time_stamp': 53, 'count': 49, 'status': True, 'gradient': 16.424063811628116}, [1.0, -5.660484160078497e-06]), ({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 53, 'count': 51, 'status': True, 'gradient': 20.631077144440372}, [1.8274939858660295e-09, -5.660484160078497e-06]), ({'reward': 3368.601123085181, 'duration': 13.298442137908651, 'time_stamp': 53, 'count': 50, 'status': True, 'gradient': 16.42301309951972}, [0.6156080036555053, -5.660484160078497e-06])]
2021-08-18:15:38:52,718 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 38, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79]
2021-08-18:15:38:53,7 INFO     [param_server.py:553] For epoch: 54, median_reward: 641.983959277434, dev: 3209.91979638717
2021-08-18:15:38:53,648 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1222, Top-1 Accuracy: 597.0/1033 (0.5779), Top-5 Accuracy: 1.0
2021-08-18:15:38:53,652 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 568.7909, eval_time 0.6, test_loss 2.1222, test_accuracy 0.5779, test_5_accuracy 1.0 

2021-08-18:15:38:53,666 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2639, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:38:53,667 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 568.7917, eval_time 0.6124, test_loss 2.2639, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:38:53,668 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1281, Top-1 Accuracy: 580.0/1033 (0.5615), Top-5 Accuracy: 1.0
2021-08-18:15:38:53,669 INFO     [learner.py:656] After aggregation epoch 53, CumulTime 568.8049, eval_time 0.6142, test_loss 2.1281, test_accuracy 0.5615, test_5_accuracy 1.0 

2021-08-18:15:38:53,719 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:53,735 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:53,748 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:38:53,748 INFO     [learner.py:526] ====Start train round 54
2021-08-18:15:38:53,750 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:38:53,763 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:38:54,475 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:38:54,489 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:38:55,504 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:38:55,524 INFO     [learner.py:165] Start to run client 38 on rank 2...
2021-08-18:15:38:55,994 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:38:56,13 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:38:56,93 INFO     [learner.py:439] Completed to run client 38
2021-08-18:15:38:56,103 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:38:56,722 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:38:56,743 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:38:57,304 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:38:57,318 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:38:57,439 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:38:57,466 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:38:57,755 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:38:57,764 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:38:58,8 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:38:58,36 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:38:58,199 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:38:58,214 INFO     [learner.py:606] ====Pushing takes 0.01346278190612793 s
2021-08-18:15:38:58,230 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:38:58,238 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:38:58,238 INFO     [param_server.py:410] Lock worker 1 with localStep 54 , while globalStep is 53

2021-08-18:15:38:58,369 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:38:58,383 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:38:58,688 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:38:58,702 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:38:59,8 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:38:59,17 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:38:59,898 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:38:59,909 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:00,529 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:00,543 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:01,226 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:39:01,235 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:01,241 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:01,274 INFO     [learner.py:606] ====Pushing takes 0.03198385238647461 s
2021-08-18:15:39:01,317 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:01,326 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:39:01,326 INFO     [param_server.py:410] Lock worker 2 with localStep 54 , while globalStep is 53

2021-08-18:15:39:02,323 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:02,337 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:02,964 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:02,983 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:03,576 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:03,608 INFO     [learner.py:606] ====Pushing takes 0.030078649520874023 s
2021-08-18:15:39:03,638 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:03,647 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:03,648 INFO     [param_server.py:381] ====After aggregation in epoch: 53, virtual_clock: 1408.3039351139687, top_1: : 56.6957 % (1757.0), top_5: : 100.0 % (3099.0), test loss: 2.1714115981702453, test len: 3099.0
2021-08-18:15:39:03,649 INFO     [param_server.py:410] Lock worker 3 with localStep 54 , while globalStep is 54

2021-08-18:15:39:03,650 INFO     [param_server.py:441] ====Epoch 55 completes 20 clients with loss 4.681259679064832, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 38: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:39:03,650 INFO     [param_server.py:450] ====Start to sample for epoch 55, global virtualClock: 1408.3039351139687, round_duration: 27.34830796796159
2021-08-18:15:39:03,650 INFO     [oort.py:208] Training selector: Pacer 53: lastExploitationUtil 1171.9891249472655, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:03,651 INFO     [oort.py:321] scores are 26,{5: 0.007980435711846907, 6: 0.04924646206948311, 7: 0.11710776702152793, 11: 0.014746718849837546, 14: 0.006242876942434927, 25: 0.003783058053590844, 27: 0.007560974492201439, 35: 0.0027172854229056383, 38: 0.10141149384154476, 50: 0.012940767230994169, 51: 0.6106422188267145, 53: 0.057062603231931644, 58: 0.0023628128734946106, 59: 0.0027264061456001463, 60: 0.0018224212112759547, 65: 0.04258510423975052, 67: 0.0025989090215062347, 70: 0.005374979037845672, 71: 0.06521720865897329, 76: 0.002098241475597264, 79: 0.03360991559779116, 81: 0.05468314627785906, 84: 0.365197981238825, 85: 0.009547323994949763, 86: 0.0017931768138651357, 87: 0.010208880049167533, 88: 0.0022406247443124304, 93: 0.01490849491134179, 97: 0.02735499682745924, 98: 0.0890170738964618, 99: 0.018243713313507114, 105: 0.0128404570113423, 107: 0.007487153134439703, 110: 0.009102091435255913, 111: 0.005938862221458249, 119: 0.010323882983946549},[51, 84, 7, 38, 98, 71, 53, 81, 6, 65, 79, 97, 99, 93, 11, 50, 105, 119, 87, 85, 110, 5, 27, 107, 14, 111, 70, 25, 59, 35, 67, 58, 88, 76, 60, 86]
2021-08-18:15:39:03,652 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:39:03,652 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:03,653 INFO     [oort.py:398] At round 53, UCB exploited 36, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5392.599560275815, 'duration': 12.029357192292537, 'time_stamp': 54, 'count': 51, 'status': True, 'gradient': 26.797001116448868}, [1.0, -5.555658438119229e-06]), ({'reward': 3817.0263132420437, 'duration': 13.298442137908651, 'time_stamp': 54, 'count': 51, 'status': True, 'gradient': 16.42755952275113}, [0.7078262258788618, -5.555658438119229e-06]), ({'reward': 0.01, 'duration': 21.635252629006885, 'time_stamp': 54, 'count': 5, 'status': True, 'gradient': 21.354972117701}, [1.8543966437052843e-09, -5.555658438119229e-06])]
2021-08-18:15:39:03,654 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50]
2021-08-18:15:39:03,927 INFO     [param_server.py:553] For epoch: 55, median_reward: 653.3884105836939, dev: 3266.94205291847
2021-08-18:15:39:04,556 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0178, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:39:04,570 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 579.7088, eval_time 0.6093, test_loss 2.0178, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:39:04,635 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:39:04,658 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:04,686 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2041, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:39:04,687 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 579.8234, eval_time 0.7254, test_loss 2.2041, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:39:04,724 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9348, Top-1 Accuracy: 597.0/1033 (0.5779), Top-5 Accuracy: 1.0
2021-08-18:15:39:04,725 INFO     [learner.py:656] After aggregation epoch 54, CumulTime 579.8495, eval_time 0.7606, test_loss 1.9348, test_accuracy 0.5779, test_5_accuracy 1.0 

2021-08-18:15:39:04,762 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:39:04,772 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:04,790 INFO     [learner.py:526] ====Start train round 55
2021-08-18:15:39:04,807 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:05,442 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:05,452 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:06,452 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:06,461 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:06,903 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:06,915 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:07,496 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:07,510 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:07,701 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:07,711 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:08,472 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:08,490 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:08,650 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:08,660 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:08,977 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:08,978 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:08,987 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:08,991 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:09,77 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:09,91 INFO     [learner.py:606] ====Pushing takes 0.013258934020996094 s
2021-08-18:15:39:09,107 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:09,111 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:09,112 INFO     [param_server.py:410] Lock worker 1 with localStep 55 , while globalStep is 54

2021-08-18:15:39:09,358 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:09,367 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:09,974 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:09,986 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:39:10,247 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:10,261 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:10,851 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:10,865 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:11,409 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:11,423 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:12,30 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:12,66 INFO     [learner.py:606] ====Pushing takes 0.03418397903442383 s
2021-08-18:15:39:12,99 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:12,108 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:39:12,108 INFO     [param_server.py:410] Lock worker 2 with localStep 55 , while globalStep is 54

2021-08-18:15:39:12,184 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:39:12,195 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:13,401 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:13,420 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:14,84 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:14,98 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:14,691 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:14,721 INFO     [learner.py:606] ====Pushing takes 0.02953171730041504 s
2021-08-18:15:39:14,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:14,761 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:14,762 INFO     [param_server.py:381] ====After aggregation in epoch: 54, virtual_clock: 1436.1749338155132, top_1: : 58.5027 % (1813.0), top_5: : 100.0 % (3099.0), test loss: 2.052216225200229, test len: 3099.0
2021-08-18:15:39:14,763 INFO     [param_server.py:410] Lock worker 3 with localStep 55 , while globalStep is 55

2021-08-18:15:39:14,763 INFO     [param_server.py:441] ====Epoch 56 completes 20 clients with loss 3.845236578612303, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 110: 0} 
==========
2021-08-18:15:39:14,763 INFO     [param_server.py:450] ====Start to sample for epoch 56, global virtualClock: 1436.1749338155132, round_duration: 27.87099870154445
2021-08-18:15:39:14,764 INFO     [oort.py:208] Training selector: Pacer 54: lastExploitationUtil 1897.7064831591706, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:14,764 INFO     [oort.py:321] scores are 26,{5: 0.007926145936393805, 6: 0.04891144535308466, 7: 0.08516277611156617, 11: 0.03970563941747114, 14: 0.0056223477037992955, 25: 0.0024881218495580214, 27: 0.03689449851510528, 35: 0.0026632858584216944, 50: 0.0045239497876733755, 51: 0.6103141509563458, 53: 0.05667441441266302, 58: 0.0016278568776747072, 59: 0.0018387648886608971, 60: 0.0014745872696064267, 65: 0.00461997524905436, 67: 0.002358541188113002, 70: 0.004957617509870951, 71: 0.07613714880177301, 76: 0.0017268245954374524, 79: 0.022309681833824004, 81: 0.09139141409650235, 84: 0.13235867410963792, 85: 0.02508882553136945, 86: 0.0014509245642655947, 87: 0.03856754923137367, 88: 0.0018440041161244803, 93: 0.014807074529008665, 97: 0.027168904652933177, 98: 0.03962051543407738, 99: 0.08697706628900381, 105: 0.011564141766551642, 107: 0.006742945379441066, 110: 0.009040171194555262, 111: 0.005348551426191149, 119: 0.006878191062838033},[51, 84, 81, 99, 7, 71, 53, 6, 11, 98, 87, 27, 97, 85, 79, 93, 105, 110, 5, 119, 107, 14, 111, 70, 65, 50, 35, 25, 67, 88, 59, 76, 58, 60, 86]
2021-08-18:15:39:14,765 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:39:14,766 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:14,766 INFO     [oort.py:398] At round 54, UCB exploited 35, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2412.913389302008, 'duration': 26.145070720211294, 'time_stamp': 55, 'count': 48, 'status': True, 'gradient': 14.789866833003899}, [0.238772535265881, -5.4546446299023665e-06]), ({'reward': 10105.457823919263, 'duration': 12.029357192292537, 'time_stamp': 55, 'count': 52, 'status': True, 'gradient': 26.802528822846465}, [1.0, -5.4546446299023665e-06]), ({'reward': 2045.8738165194422, 'duration': 13.298442137908651, 'time_stamp': 55, 'count': 52, 'status': True, 'gradient': 18.07616074634805}, [0.20245157464990657, -5.4546446299023665e-06])]
2021-08-18:15:39:14,767 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 93, 11, 87, 85, 110, 71, 27, 65, 79, 105, 119]
2021-08-18:15:39:15,30 INFO     [param_server.py:553] For epoch: 56, median_reward: 815.1931242379679, dev: 4075.9656211898396
2021-08-18:15:39:15,621 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9664, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:39:15,623 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 590.7626, eval_time 0.559, test_loss 1.9664, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:39:15,689 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:15,705 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1564, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:39:15,706 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 590.8421, eval_time 0.6408, test_loss 2.1564, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:39:15,708 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:15,747 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1009, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:15:39:15,748 INFO     [learner.py:656] After aggregation epoch 55, CumulTime 590.873, eval_time 0.683, test_loss 2.1009, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:15:39:15,773 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:15,781 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:15,815 INFO     [learner.py:526] ====Start train round 56
2021-08-18:15:39:15,828 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:16,399 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:16,409 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:17,541 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:17,555 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:18,605 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:18,619 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:18,641 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:18,662 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:19,135 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:19,144 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:19,755 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:19,782 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:20,352 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:20,372 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:20,492 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:20,502 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:20,907 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:20,916 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:20,967 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:20,986 INFO     [learner.py:606] ====Pushing takes 0.017098426818847656 s
2021-08-18:15:39:21,9 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:21,16 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:21,17 INFO     [param_server.py:410] Lock worker 1 with localStep 56 , while globalStep is 55

2021-08-18:15:39:21,94 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:21,104 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:21,676 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:21,685 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:39:22,510 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:22,519 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:23,115 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:23,124 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:39:23,696 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:39:23,721 INFO     [learner.py:606] ====Pushing takes 0.024096250534057617 s
2021-08-18:15:39:23,752 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:23,760 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:39:23,761 INFO     [param_server.py:410] Lock worker 2 with localStep 56 , while globalStep is 55

2021-08-18:15:39:24,312 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:39:24,330 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:25,947 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:25,956 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:26,651 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:26,665 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:27,319 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:27,333 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:27,912 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:27,948 INFO     [learner.py:606] ====Pushing takes 0.03432106971740723 s
2021-08-18:15:39:27,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:27,994 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:27,995 INFO     [param_server.py:381] ====After aggregation in epoch: 55, virtual_clock: 1467.8055066072377, top_1: : 58.7932 % (1822.0), top_5: : 100.0 % (3099.0), test loss: 2.074566620367545, test len: 3099.0
2021-08-18:15:39:27,996 INFO     [param_server.py:410] Lock worker 3 with localStep 56 , while globalStep is 56

2021-08-18:15:39:27,996 INFO     [param_server.py:441] ====Epoch 57 completes 20 clients with loss 5.51832935837348, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:39:27,997 INFO     [param_server.py:450] ====Start to sample for epoch 57, global virtualClock: 1467.8055066072377, round_duration: 31.630572791724475
2021-08-18:15:39:27,997 INFO     [oort.py:208] Training selector: Pacer 55: lastExploitationUtil 2284.0904665424937, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:27,998 INFO     [oort.py:321] scores are 26,{5: 0.007944354992623364, 6: 0.6181127310940242, 7: 0.43410396868733775, 11: 0.1594367897732488, 14: 0.007594233268026572, 27: 0.03443424514986572, 35: 0.002686908514039154, 50: 0.004760348707487712, 51: 0.04757647610508715, 53: 0.05629514612845235, 58: 0.0018462408674419619, 59: 0.002102138467898496, 60: 0.0015800398751994451, 65: 0.03333897733409145, 67: 0.0017154119296998865, 70: 0.006696367035103779, 71: 0.008523174427938015, 76: 0.0018398803917486178, 79: 0.011722660952644416, 81: 0.022176908709563133, 84: 0.49912416794335673, 85: 0.009418918328118175, 86: 0.0015546849716516964, 87: 0.010071576858136155, 88: 0.001964731695694719, 93: 0.014707984775563555, 97: 0.06913525092015765, 98: 0.2632321046560665, 99: 0.01799834653065316, 105: 0.003583928128621079, 107: 0.009107850105114274, 110: 0.008979673873966032, 111: 0.0072244103916028046, 119: 0.032005274994924886},[6, 84, 7, 98, 11, 97, 53, 51, 27, 65, 119, 81, 99, 93, 79, 87, 85, 107, 110, 71, 5, 14, 111, 70, 50, 105, 35, 59, 88, 58, 76, 67, 60, 86]
2021-08-18:15:39:27,999 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:39:27,999 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:28,0 INFO     [oort.py:398] At round 55, UCB exploited 34, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2810.0773020866714, 'duration': 5.8943907365129, 'time_stamp': 56, 'count': 53, 'status': True, 'gradient': 20.952362693653246}, [0.34951110778000966, -5.35723852211647e-06]), ({'reward': 7972.804949945399, 'duration': 11.90395711384456, 'time_stamp': 56, 'count': 54, 'status': True, 'gradient': 20.648295121118423}, [0.9916418679964515, -5.35723852211647e-06]), ({'reward': 2459.5457773705716, 'duration': 30.380154975061778, 'time_stamp': 56, 'count': 44, 'status': True, 'gradient': 13.14991839246484}, [0.3059126284879374, -5.35723852211647e-06])]
2021-08-18:15:39:28,0 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 99, 93, 11, 87, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:39:28,266 INFO     [param_server.py:553] For epoch: 57, median_reward: 882.5954749494678, dev: 4412.977374747339
2021-08-18:15:39:28,868 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9974, Top-1 Accuracy: 571.0/1033 (0.5528), Top-5 Accuracy: 1.0
2021-08-18:15:39:28,869 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 604.0085, eval_time 0.5705, test_loss 1.9974, test_accuracy 0.5528, test_5_accuracy 1.0 

2021-08-18:15:39:28,910 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2628, Top-1 Accuracy: 557.0/1033 (0.5392), Top-5 Accuracy: 1.0
2021-08-18:15:39:28,911 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 604.047, eval_time 0.6111, test_loss 2.2628, test_accuracy 0.5392, test_5_accuracy 1.0 

2021-08-18:15:39:28,943 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:28,956 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.565, Top-1 Accuracy: 559.0/1033 (0.5411), Top-5 Accuracy: 1.0
2021-08-18:15:39:28,957 INFO     [learner.py:656] After aggregation epoch 56, CumulTime 604.0819, eval_time 0.6573, test_loss 2.565, test_accuracy 0.5411, test_5_accuracy 1.0 

2021-08-18:15:39:28,959 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:28,995 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:29,5 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:29,20 INFO     [learner.py:526] ====Start train round 57
2021-08-18:15:39:29,32 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:29,612 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:29,622 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:30,642 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:30,654 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:31,298 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:31,307 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:31,905 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:31,914 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:32,36 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:32,63 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:33,18 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:33,37 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:33,160 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:33,188 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:33,349 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:33,359 INFO     [learner.py:606] ====Pushing takes 0.008899927139282227 s
2021-08-18:15:39:33,371 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:33,376 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:39:33,377 INFO     [param_server.py:410] Lock worker 1 with localStep 57 , while globalStep is 56

2021-08-18:15:39:33,626 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:33,647 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:33,775 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:33,790 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:34,366 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:34,376 INFO     [learner.py:165] Start to run client 99 on rank 3...
2021-08-18:15:39:34,947 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:34,961 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:35,568 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:35,582 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:36,131 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:36,166 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:36,989 INFO     [learner.py:439] Completed to run client 99
2021-08-18:15:39:37,4 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:37,434 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:37,468 INFO     [learner.py:606] ====Pushing takes 0.0320281982421875 s
2021-08-18:15:39:37,502 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:37,513 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:39:37,514 INFO     [param_server.py:410] Lock worker 2 with localStep 57 , while globalStep is 56

2021-08-18:15:39:38,417 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:38,430 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:39,46 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:39,60 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:39,729 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:39,750 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:40,403 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:40,439 INFO     [learner.py:606] ====Pushing takes 0.03458738327026367 s
2021-08-18:15:39:40,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:40,499 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:40,500 INFO     [param_server.py:381] ====After aggregation in epoch: 56, virtual_clock: 1496.4889096302536, top_1: : 54.4369 % (1687.0), top_5: : 100.0 % (3099.0), test loss: 2.2750958303610482, test len: 3099.0
2021-08-18:15:39:40,501 INFO     [param_server.py:410] Lock worker 3 with localStep 57 , while globalStep is 57

2021-08-18:15:39:40,501 INFO     [param_server.py:441] ====Epoch 58 completes 20 clients with loss 5.9709257624111425, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 87: 0, 93: 0, 97: 0, 98: 0, 99: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:39:40,502 INFO     [param_server.py:450] ====Start to sample for epoch 58, global virtualClock: 1496.4889096302536, round_duration: 28.683403023015895
2021-08-18:15:39:40,502 INFO     [oort.py:208] Training selector: Pacer 56: lastExploitationUtil 1466.3305443631943, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:40,503 INFO     [oort.py:321] scores are 26,{5: 0.04570213473328833, 6: 0.05915550773981253, 7: 0.08403583004411691, 11: 0.014613600341506178, 14: 0.005705075293222472, 27: 0.048939055992707044, 50: 0.02985101308297832, 51: 0.04726319169722794, 53: 0.7214078568204583, 58: 0.0019093296435873151, 59: 0.002178023289492231, 60: 0.0016116158407164336, 65: 0.012568191531757021, 67: 0.0017927902549616222, 70: 0.005030564216030126, 71: 0.008467050522337285, 76: 0.00187396863221811, 79: 0.023627954099569814, 81: 0.022030876882870525, 84: 0.03867286542261602, 85: 0.00944007011879778, 86: 0.001585754237576683, 87: 0.01000525694017417, 88: 0.002001133108961166, 93: 0.051032193351970304, 97: 0.026809382668640223, 98: 0.038024430803908466, 105: 0.0035603284656467765, 107: 0.006842161515873958, 110: 0.008920543983678225, 111: 0.0054272503593958115, 119: 0.009434517176124408},[53, 7, 6, 93, 27, 51, 5, 84, 98, 50, 97, 79, 81, 11, 65, 87, 85, 119, 110, 71, 107, 14, 111, 70, 105, 59, 88, 58, 76, 67, 60, 86]
2021-08-18:15:39:40,504 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:39:40,504 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:40,504 INFO     [oort.py:398] At round 56, UCB exploited 32, augment_factor 1.2307692307692308, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7600.17785794314, 'duration': 11.058674649423494, 'time_stamp': 57, 'count': 54, 'status': True, 'gradient': 19.72912343242974}, [1.0, -5.263250232460223e-06]), ({'reward': 3579.408795279142, 'duration': 30.380154975061778, 'time_stamp': 57, 'count': 45, 'status': True, 'gradient': 11.509159747552394}, [0.4709631244300196, -5.263250232460223e-06]), ({'reward': 3093.373269081308, 'duration': 29.570969934622333, 'time_stamp': 57, 'count': 40, 'status': True, 'gradient': 13.15328169862989}, [0.4070124940435658, -5.263250232460223e-06])]
2021-08-18:15:39:40,505 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:39:40,775 INFO     [param_server.py:553] For epoch: 58, median_reward: 741.0260932182988, dev: 3705.130466091494
2021-08-18:15:39:41,334 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7115, Top-1 Accuracy: 595.0/1033 (0.576), Top-5 Accuracy: 1.0
2021-08-18:15:39:41,334 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 616.4702, eval_time 0.5249, test_loss 2.7115, test_accuracy 0.576, test_5_accuracy 1.0 

2021-08-18:15:39:41,356 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1601, Top-1 Accuracy: 585.0/1033 (0.5663), Top-5 Accuracy: 1.0
2021-08-18:15:39:41,358 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.007, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:39:41,358 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 616.4976, eval_time 0.5493, test_loss 2.007, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:39:41,357 INFO     [learner.py:656] After aggregation epoch 57, CumulTime 616.482, eval_time 0.5437, test_loss 2.1601, test_accuracy 0.5663, test_5_accuracy 1.0 

2021-08-18:15:39:41,406 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:41,420 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:41,427 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:41,441 INFO     [learner.py:526] ====Start train round 58
2021-08-18:15:39:41,447 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:41,454 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:42,674 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:42,685 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:43,866 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:43,885 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:39:44,191 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:44,207 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:44,334 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:44,354 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:45,503 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:45,531 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:46,105 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:39:46,115 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:46,117 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:46,152 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:39:46,449 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:46,460 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:46,478 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:39:46,492 INFO     [learner.py:606] ====Pushing takes 0.013211250305175781 s
2021-08-18:15:39:46,509 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:46,514 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:39:46,515 INFO     [param_server.py:410] Lock worker 1 with localStep 58 , while globalStep is 57

2021-08-18:15:39:47,468 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:39:47,477 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:39:48,67 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:39:48,81 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:39:48,975 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:48,984 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:50,417 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:39:50,436 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:39:51,138 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:39:51,151 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:39:51,151 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:39:51,160 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:39:51,785 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:39:51,794 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:39:51,849 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:39:51,869 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:39:52,396 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:39:52,417 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:39:52,485 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:39:52,520 INFO     [learner.py:606] ====Pushing takes 0.031141042709350586 s
2021-08-18:15:39:52,556 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:52,568 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:39:52,569 INFO     [param_server.py:410] Lock worker 3 with localStep 58 , while globalStep is 57

2021-08-18:15:39:53,79 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:39:53,114 INFO     [learner.py:606] ====Pushing takes 0.03108358383178711 s
2021-08-18:15:39:53,151 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:39:53,160 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:39:53,161 INFO     [param_server.py:381] ====After aggregation in epoch: 57, virtual_clock: 1534.8849311890392, top_1: : 57.212 % (1773.0), top_5: : 100.0 % (3099.0), test loss: 2.292867333800704, test len: 3099.0
2021-08-18:15:39:53,162 INFO     [param_server.py:410] Lock worker 2 with localStep 58 , while globalStep is 58

2021-08-18:15:39:53,163 INFO     [param_server.py:441] ====Epoch 59 completes 20 clients with loss 4.910016314222303, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:39:53,163 INFO     [param_server.py:450] ====Start to sample for epoch 59, global virtualClock: 1534.8849311890392, round_duration: 38.39602155878561
2021-08-18:15:39:53,164 INFO     [oort.py:208] Training selector: Pacer 57: lastExploitationUtil 1733.3694725179037, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:39:53,164 INFO     [oort.py:321] scores are 26,{5: 0.00777057016981967, 6: 0.17084256020754646, 7: 0.24648179048902732, 11: 0.014358916948250871, 14: 0.005028637877108385, 27: 0.007362139733379387, 50: 0.004911248882951958, 51: 0.04695687476070899, 53: 0.06860785256356669, 58: 0.0020796635406013096, 59: 0.0017796900928917186, 60: 0.0014563892555782849, 65: 0.008754560911573405, 67: 0.0011358862837214409, 70: 0.0039978556853303, 71: 0.008412174817074543, 76: 0.0010037195465995542, 79: 0.011398095332505328, 81: 0.02188809281617401, 84: 0.038422223152441946, 85: 0.01868827786667618, 86: 0.0014330185738108364, 87: 0.009940411982714835, 88: 0.0018243213013697825, 93: 0.014516438703090604, 97: 0.19799314984575528, 98: 0.49025678197255296, 105: 0.028739932369575043, 107: 0.006030902449419331, 110: 0.04267664952117829, 111: 0.004313107391787547, 119: 0.00831588857038399},[98, 7, 97, 6, 53, 51, 110, 84, 105, 81, 85, 93, 11, 79, 87, 65, 71, 119, 5, 27, 107, 14, 50, 111, 70, 58, 88, 59, 60, 86, 67, 76]
2021-08-18:15:39:53,165 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:39:53,166 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:39:53,166 INFO     [oort.py:398] At round 57, UCB exploited 32, augment_factor 1.1538461538461537, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 10790.491257581687, 'duration': 13.411352670399307, 'time_stamp': 58, 'count': 54, 'status': True, 'gradient': 17.887550284836074}, [1.0, -5.1725029741892145e-06]), ({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 58, 'count': 54, 'status': True, 'gradient': 19.735485211296595}, [9.267427237043661e-10, -5.1725029741892145e-06]), ({'reward': 5795.920447250576, 'duration': 15.972045438625893, 'time_stamp': 58, 'count': 54, 'status': True, 'gradient': 20.762214761738004}, [0.5371317843499236, -5.1725029741892145e-06])]
2021-08-18:15:39:53,167 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 87, 85, 110, 71, 5, 65, 79, 50, 105, 119, 107]
2021-08-18:15:39:53,453 INFO     [param_server.py:553] For epoch: 59, median_reward: 833.8039765938469, dev: 4169.0198829692345
2021-08-18:15:39:54,60 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3376, Top-1 Accuracy: 593.0/1033 (0.5741), Top-5 Accuracy: 1.0
2021-08-18:15:39:54,61 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 629.1969, eval_time 0.5854, test_loss 2.3376, test_accuracy 0.5741, test_5_accuracy 1.0 

2021-08-18:15:39:54,66 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0123, Top-1 Accuracy: 578.0/1033 (0.5595), Top-5 Accuracy: 1.0
2021-08-18:15:39:54,67 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 629.1916, eval_time 0.5917, test_loss 2.0123, test_accuracy 0.5595, test_5_accuracy 1.0 

2021-08-18:15:39:54,105 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9299, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:39:54,108 INFO     [learner.py:656] After aggregation epoch 58, CumulTime 629.2469, eval_time 0.6325, test_loss 1.9299, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:39:54,130 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:54,135 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:54,137 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:39:54,144 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:39:54,175 INFO     [learner.py:526] ====Start train round 59
2021-08-18:15:39:54,191 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:39:55,220 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:39:55,230 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:39:56,506 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:39:56,521 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:39:56,725 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:39:56,736 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:39:57,361 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:39:57,388 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:39:58,766 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:39:58,793 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:39:59,22 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:39:59,32 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:39:59,491 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:39:59,500 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:39:59,574 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:39:59,600 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:00,144 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:00,157 INFO     [learner.py:606] ====Pushing takes 0.011644124984741211 s
2021-08-18:15:40:00,172 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:00,177 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:00,178 INFO     [param_server.py:410] Lock worker 1 with localStep 59 , while globalStep is 58

2021-08-18:15:40:00,220 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:00,238 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:00,943 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:00,962 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:01,558 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:01,568 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:02,251 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:02,261 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:02,771 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:02,791 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:03,403 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:03,418 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:04,155 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:04,165 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:04,616 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:04,626 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:40:04,811 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:04,834 INFO     [learner.py:606] ====Pushing takes 0.02240276336669922 s
2021-08-18:15:40:04,863 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:04,871 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:40:04,872 INFO     [param_server.py:410] Lock worker 3 with localStep 59 , while globalStep is 58

2021-08-18:15:40:05,239 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:40:05,248 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:40:05,819 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:40:05,854 INFO     [learner.py:606] ====Pushing takes 0.033719539642333984 s
2021-08-18:15:40:05,897 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:05,907 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:05,908 INFO     [param_server.py:381] ====After aggregation in epoch: 58, virtual_clock: 1571.666105542113, top_1: : 57.1152 % (1770.0), top_5: : 100.0 % (3099.0), test loss: 2.093264328108894, test len: 3099.0
2021-08-18:15:40:05,909 INFO     [param_server.py:410] Lock worker 2 with localStep 59 , while globalStep is 59

2021-08-18:15:40:05,910 INFO     [param_server.py:441] ====Epoch 60 completes 20 clients with loss 4.087816670334636, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:40:05,910 INFO     [param_server.py:450] ====Start to sample for epoch 60, global virtualClock: 1571.666105542113, round_duration: 36.78117435307379
2021-08-18:15:40:05,911 INFO     [oort.py:208] Training selector: Pacer 58: lastExploitationUtil 1180.0808439281275, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:40:05,911 INFO     [oort.py:321] scores are 26,{5: 0.007720989591985874, 6: 0.23460932857716144, 7: 0.08295846597560755, 11: 0.01438976736807288, 14: 0.005803428386677263, 27: 0.007377957437624184, 50: 0.003542140874440034, 51: 0.04665726367258736, 53: 0.0552074825928772, 58: 0.0032001197892672743, 59: 0.0024836534243497404, 60: 0.0010710088528075668, 65: 0.027779674303882188, 67: 0.0017478655099388031, 70: 0.005117289022810033, 71: 0.036149760135888574, 76: 0.0015444915589657797, 79: 0.00370262462966559, 81: 0.09287924558490393, 84: 0.3638489458552291, 85: 0.009236937913915524, 87: 0.009876986602178, 88: 0.00217769257173096, 93: 0.18829173289950027, 97: 0.06256742741296444, 98: 0.4067251703382367, 105: 0.003514684007098974, 107: 0.0029666759641233964, 110: 0.00880617998495855, 111: 0.0055208138680903135, 119: 0.0028258485179138517},[98, 84, 6, 93, 81, 7, 97, 53, 51, 71, 65, 11, 87, 85, 110, 5, 27, 14, 111, 70, 79, 50, 105, 58, 107, 119, 59, 88, 67, 76, 60]
2021-08-18:15:40:05,913 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:40:05,913 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:05,914 INFO     [oort.py:398] At round 58, UCB exploited 31, augment_factor 1.1153846153846154, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4843.679046260314, 'duration': 13.411352670399307, 'time_stamp': 59, 'count': 55, 'status': True, 'gradient': 17.892129081426578}, [0.8159238218231114, -5.0848319463041785e-06]), ({'reward': 4201.112231563358, 'duration': 13.298442137908651, 'time_stamp': 59, 'count': 56, 'status': True, 'gradient': 20.769743143801136}, [0.7076824112034866, -5.0848319463041785e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 59, 'count': 56, 'status': True, 'gradient': 20.97485439619046}, [1.684516040105007e-09, -5.0848319463041785e-06])]
2021-08-18:15:40:05,914 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:06,183 INFO     [param_server.py:553] For epoch: 60, median_reward: 705.3343486713455, dev: 3526.671743356728
2021-08-18:15:40:06,849 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3902, Top-1 Accuracy: 590.0/1033 (0.5712), Top-5 Accuracy: 1.0
2021-08-18:15:40:06,850 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 641.9864, eval_time 0.6322, test_loss 2.3902, test_accuracy 0.5712, test_5_accuracy 1.0 

2021-08-18:15:40:06,850 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7503, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:40:06,851 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 641.9758, eval_time 0.6311, test_loss 2.7503, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:40:06,919 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:40:06,923 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:40:06,928 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:06,931 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9798, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:40:06,931 INFO     [learner.py:656] After aggregation epoch 59, CumulTime 642.0707, eval_time 0.715, test_loss 1.9798, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:40:06,933 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:06,990 INFO     [learner.py:526] ====Start train round 60
2021-08-18:15:40:07,8 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:08,20 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:08,34 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:09,142 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:09,156 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:09,667 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:09,687 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:10,350 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:10,389 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:11,591 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:11,612 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:12,52 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:12,79 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:12,474 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:12,488 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:12,880 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:12,907 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:13,605 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:13,619 INFO     [learner.py:606] ====Pushing takes 0.01248931884765625 s
2021-08-18:15:40:13,640 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:13,646 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:13,647 INFO     [param_server.py:410] Lock worker 1 with localStep 60 , while globalStep is 59

2021-08-18:15:40:13,755 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:13,764 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:14,370 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:14,384 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:14,426 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:14,435 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:16,644 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:16,655 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:16,836 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:16,846 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:17,303 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:17,313 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:17,427 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:17,439 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:17,873 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:17,882 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:18,9 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:18,19 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:18,439 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:18,473 INFO     [learner.py:606] ====Pushing takes 0.03269362449645996 s
2021-08-18:15:40:18,517 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:18,525 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:18,526 INFO     [param_server.py:410] Lock worker 2 with localStep 60 , while globalStep is 59

2021-08-18:15:40:18,680 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:18,712 INFO     [learner.py:606] ====Pushing takes 0.030254840850830078 s
2021-08-18:15:40:18,744 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:18,753 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:18,754 INFO     [param_server.py:381] ====After aggregation in epoch: 59, virtual_clock: 1610.0621271008986, top_1: : 58.0833 % (1800.0), top_5: : 100.0 % (3099.0), test loss: 2.3734307068365594, test len: 3099.0
2021-08-18:15:40:18,755 INFO     [param_server.py:410] Lock worker 3 with localStep 60 , while globalStep is 60

2021-08-18:15:40:18,755 INFO     [param_server.py:441] ====Epoch 61 completes 20 clients with loss 5.716214308486835, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:18,756 INFO     [param_server.py:450] ====Start to sample for epoch 61, global virtualClock: 1610.0621271008986, round_duration: 38.39602155878561
2021-08-18:15:40:18,757 INFO     [oort.py:208] Training selector: Pacer 59: lastExploitationUtil 1784.5643514379337, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:40:18,757 INFO     [oort.py:321] scores are 26,{5: 0.084731970158407, 6: 0.04734608231681273, 7: 0.08243722464137353, 11: 0.18615888528396635, 14: 0.007644799730568975, 27: 0.07592367163912822, 50: 0.031399468872659306, 51: 0.14271647892250178, 53: 0.18382180164714174, 58: 0.0031030656695238633, 59: 0.003271692483167967, 60: 0.0010417317821685337, 65: 0.004472117453580221, 67: 0.001726834058837421, 70: 0.006740955024555774, 71: 0.008305982645656544, 76: 0.0014976497909765648, 79: 0.02049482008278921, 81: 0.02161178565959538, 84: 0.037937195273684235, 85: 0.00917890075295956, 87: 0.030837740792622803, 88: 0.002149773912944673, 93: 0.11236295338668753, 97: 0.12367901596525788, 98: 0.03730109576351606, 105: 0.03429456637523606, 107: 0.009168495037252597, 110: 0.008750849345090952, 111: 0.0072725143758451604, 119: 0.002831790668078554},[11, 53, 51, 97, 93, 5, 7, 27, 6, 84, 98, 105, 50, 87, 81, 79, 85, 107, 110, 71, 14, 111, 70, 65, 59, 58, 119, 88, 67, 76, 60]
2021-08-18:15:40:18,758 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:40:18,758 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:18,759 INFO     [oort.py:398] At round 59, UCB exploited 31, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3485.155778978526, 'duration': 21.635252629006885, 'time_stamp': 60, 'count': 11, 'status': True, 'gradient': 21.390634941840247}, [0.5638174455645686, -5.0000833347222494e-06]), ({'reward': 1197.8650353042874, 'duration': 11.058674649423494, 'time_stamp': 60, 'count': 57, 'status': True, 'gradient': 20.0562593693128}, [0.19378574461243442, -5.0000833347222494e-06]), ({'reward': 5117.963458175372, 'duration': 29.570969934622333, 'time_stamp': 60, 'count': 43, 'status': True, 'gradient': 19.74779638089001}, [0.8279686491366869, -5.0000833347222494e-06])]
2021-08-18:15:40:18,759 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:19,23 INFO     [param_server.py:541] Handle Wight 0.03583216667175293 | Send 0.26758503913879395
2021-08-18:15:40:19,24 INFO     [param_server.py:553] For epoch: 61, median_reward: 841.52948425204, dev: 4207.6474212602
2021-08-18:15:40:19,703 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.534, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:40:19,704 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 654.84, eval_time 0.6359, test_loss 2.534, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:40:19,704 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0918, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:40:19,705 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 654.8293, eval_time 0.6365, test_loss 2.0918, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:40:19,771 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:19,778 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:19,782 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:19,791 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:19,829 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1704, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:40:19,830 INFO     [learner.py:656] After aggregation epoch 60, CumulTime 654.9688, eval_time 0.7617, test_loss 2.1704, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:40:19,896 INFO     [learner.py:526] ====Start train round 61
2021-08-18:15:40:19,922 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:20,890 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:20,899 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:22,0 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:22,19 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:22,465 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:22,475 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:23,493 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:23,507 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:24,237 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:24,247 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:24,871 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:24,873 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:24,885 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:24,895 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:25,543 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:25,564 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:25,942 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:25,951 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:26,7 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:26,27 INFO     [learner.py:606] ====Pushing takes 0.01806473731994629 s
2021-08-18:15:40:26,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:26,55 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:26,56 INFO     [param_server.py:410] Lock worker 1 with localStep 61 , while globalStep is 60

2021-08-18:15:40:26,471 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:26,481 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:26,917 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:26,928 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:28,594 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:28,613 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:28,964 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:28,978 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:29,249 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:29,263 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:29,679 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:29,689 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:29,851 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:29,865 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:30,296 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:30,311 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:30,427 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:30,460 INFO     [learner.py:606] ====Pushing takes 0.03098440170288086 s
2021-08-18:15:40:30,497 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:30,506 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:30,507 INFO     [param_server.py:410] Lock worker 3 with localStep 61 , while globalStep is 60

2021-08-18:15:40:31,999 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:32,34 INFO     [learner.py:606] ====Pushing takes 0.03361320495605469 s
2021-08-18:15:40:32,72 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:32,80 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:32,82 INFO     [param_server.py:381] ====After aggregation in epoch: 60, virtual_clock: 1644.7031619818872, top_1: : 58.4382 % (1811.0), top_5: : 100.0 % (3099.0), test loss: 2.265404639420686, test len: 3099.0
2021-08-18:15:40:32,93 INFO     [param_server.py:410] Lock worker 2 with localStep 61 , while globalStep is 61

2021-08-18:15:40:32,94 INFO     [param_server.py:441] ====Epoch 62 completes 20 clients with loss 4.581674397999085, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:32,94 INFO     [param_server.py:450] ====Start to sample for epoch 62, global virtualClock: 1644.7031619818872, round_duration: 34.64103488098859
2021-08-18:15:40:32,95 INFO     [oort.py:208] Training selector: Pacer 60: lastExploitationUtil 1680.4052010015043, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:40:32,95 INFO     [oort.py:321] scores are 26,{5: 0.0378123427387867, 6: 0.047053070828087996, 7: 0.5222531494661987, 11: 0.014089913820495277, 14: 0.0074998866078731475, 27: 0.07965415803903801, 50: 0.012906769740873956, 51: 0.04607717427732419, 53: 0.7200044944670858, 58: 0.0031952692382832414, 59: 0.003369853855806928, 60: 0.0010699469349079456, 65: 0.03491385691593473, 67: 0.0017786446744155252, 70: 0.00661317498099827, 71: 0.04534376070127386, 76: 0.0015421505106474331, 79: 0.003656589926529513, 81: 0.021478036441492293, 84: 0.11624664111852846, 85: 0.11025512569624794, 87: 0.009754186104804509, 93: 0.08849722208362189, 97: 0.026136630919973657, 98: 0.03707024985048789, 105: 0.012768357691650677, 107: 0.008994699085351242, 110: 0.027999707904692667, 111: 0.007134658211498579, 119: 0.012402607395037128},[53, 7, 84, 85, 93, 27, 6, 51, 71, 5, 98, 65, 110, 97, 81, 11, 50, 105, 119, 87, 107, 14, 111, 70, 79, 59, 58, 67, 76, 60]
2021-08-18:15:40:32,110 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:40:32,111 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:32,111 INFO     [oort.py:398] At round 60, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5955.155214111225, 'duration': 11.058674649423494, 'time_stamp': 61, 'count': 58, 'status': True, 'gradient': 20.063686438001376}, [1.0, -4.918113411695278e-06]), ({'reward': 2622.2159039274134, 'duration': 5.8943907365129, 'time_stamp': 61, 'count': 58, 'status': True, 'gradient': 20.9866076319137}, [0.44032610713011855, -4.918113411695278e-06]), ({'reward': 4891.566474429439, 'duration': 30.380154975061778, 'time_stamp': 61, 'count': 48, 'status': True, 'gradient': 14.816998698178457}, [0.821400033138483, -4.918113411695278e-06])]
2021-08-18:15:40:32,112 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 50, 105, 119]
2021-08-18:15:40:32,380 INFO     [param_server.py:553] For epoch: 62, median_reward: 839.9281253038567, dev: 4199.640626519284
2021-08-18:15:40:32,976 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0633, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:40:32,980 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 668.119, eval_time 0.5658, test_loss 2.0633, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:40:33,64 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:33,94 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4855, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:40:33,95 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 668.2194, eval_time 0.6799, test_loss 2.4855, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:40:33,88 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:33,138 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5887, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:40:33,142 INFO     [learner.py:656] After aggregation epoch 61, CumulTime 668.2778, eval_time 0.727, test_loss 2.5887, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:40:33,159 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:33,166 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:33,211 INFO     [learner.py:526] ====Start train round 62
2021-08-18:15:40:33,223 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:34,355 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:34,373 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:35,488 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:35,508 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:35,864 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:35,878 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:36,265 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:36,292 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:37,416 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:37,436 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:37,835 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:37,846 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:38,12 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:38,22 INFO     [learner.py:606] ====Pushing takes 0.009058713912963867 s
2021-08-18:15:40:38,40 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:38,46 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:40:38,47 INFO     [param_server.py:410] Lock worker 1 with localStep 62 , while globalStep is 61

2021-08-18:15:40:38,118 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:38,131 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:39,331 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:39,340 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:39,964 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:39,973 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:40,536 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:40,550 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:42,247 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:42,261 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:42,632 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:42,641 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:42,888 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:42,897 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:43,287 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:43,297 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:43,516 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:43,525 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:44,9 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:44,29 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:44,82 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:44,115 INFO     [learner.py:606] ====Pushing takes 0.031177520751953125 s
2021-08-18:15:40:44,152 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:44,161 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:40:44,162 INFO     [param_server.py:410] Lock worker 3 with localStep 62 , while globalStep is 61

2021-08-18:15:40:44,620 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:44,640 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:40:45,455 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:40:45,491 INFO     [learner.py:606] ====Pushing takes 0.034761905670166016 s
2021-08-18:15:40:45,525 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:45,534 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:45,535 INFO     [param_server.py:381] ====After aggregation in epoch: 61, virtual_clock: 1683.0991835406728, top_1: : 59.6967 % (1850.0), top_5: : 100.0 % (3099.0), test loss: 2.3792029486762156, test len: 3099.0
2021-08-18:15:40:45,536 INFO     [param_server.py:410] Lock worker 2 with localStep 62 , while globalStep is 62

2021-08-18:15:40:45,537 INFO     [param_server.py:441] ====Epoch 63 completes 20 clients with loss 4.915989874570564, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:40:45,537 INFO     [param_server.py:450] ====Start to sample for epoch 63, global virtualClock: 1683.0991835406728, round_duration: 38.39602155878561
2021-08-18:15:40:45,538 INFO     [oort.py:208] Training selector: Pacer 61: lastExploitationUtil 2227.981323981341, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:40:45,538 INFO     [oort.py:321] scores are 26,{5: 0.08823045345101563, 6: 0.04676618286485673, 7: 0.08142752544238974, 11: 0.014004006001793398, 14: 0.006841585967284129, 27: 0.02925318735411867, 50: 0.03447941621199308, 51: 0.09931236821963811, 53: 0.37679402735959205, 58: 0.0028294335849516333, 59: 0.0029279466004330508, 60: 0.0008221079381578676, 65: 0.013837751930194344, 67: 0.0013194969289128011, 70: 0.006032705228062498, 71: 0.024811608248925664, 76: 0.0011480978312400194, 79: 0.0036639634872642534, 81: 0.0749936681742714, 84: 0.4976674959986909, 85: 0.05666095606285939, 87: 0.04643479523299427, 93: 0.014157634273907429, 97: 0.02597727288704624, 98: 0.03684422829038746, 105: 0.009979130763659071, 107: 0.008205191659522128, 110: 0.008643668085500952, 111: 0.006508415400562917, 119: 0.008161274490156141},[84, 53, 51, 5, 7, 81, 85, 6, 87, 98, 50, 27, 97, 71, 93, 11, 65, 105, 110, 107, 119, 14, 111, 70, 79, 59, 58, 67, 76, 60]
2021-08-18:15:40:45,539 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:40:45,540 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:45,540 INFO     [oort.py:398] At round 61, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 8886.448038083467, 'duration': 13.298442137908651, 'time_stamp': 62, 'count': 59, 'status': True, 'gradient': 20.79073707241699}, [1.0, -4.838787722382623e-06]), ({'reward': 0.01, 'duration': 21.635252629006885, 'time_stamp': 62, 'count': 13, 'status': True, 'gradient': 21.405325888453795}, [1.1253102700869318e-09, -4.838787722382623e-06]), ({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 62, 'count': 60, 'status': True, 'gradient': 20.68474125701849}, [1.1253102700869318e-09, -4.838787722382623e-06])]
2021-08-18:15:40:45,541 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:45,840 INFO     [param_server.py:553] For epoch: 63, median_reward: 943.2573608431562, dev: 4716.286804215781
2021-08-18:15:40:46,431 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 1.9572, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:40:46,432 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 681.5564, eval_time 0.5381, test_loss 1.9572, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:40:46,442 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9119, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:40:46,443 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 681.5824, eval_time 0.5584, test_loss 1.9119, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:40:46,471 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1649, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:40:46,471 INFO     [learner.py:656] After aggregation epoch 62, CumulTime 681.6074, eval_time 0.5822, test_loss 2.1649, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:40:46,500 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:46,509 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:40:46,534 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:46,547 INFO     [learner.py:526] ====Start train round 63
2021-08-18:15:40:46,555 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:40:46,562 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:40:47,680 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:40:47,694 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:40:48,809 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:40:48,819 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:40:49,277 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:40:49,291 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:40:49,328 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:40:49,342 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:40:50,362 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:40:50,380 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:40:50,899 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:40:50,912 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:40:51,0 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:40:51,11 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:40:51,173 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:40:51,187 INFO     [learner.py:606] ====Pushing takes 0.012932538986206055 s
2021-08-18:15:40:51,204 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:51,209 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:40:51,210 INFO     [param_server.py:410] Lock worker 1 with localStep 63 , while globalStep is 62

2021-08-18:15:40:51,493 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:40:51,502 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:40:52,530 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:40:52,540 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:40:53,102 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:40:53,112 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:40:53,582 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:40:53,596 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:40:55,202 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:40:55,214 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:40:55,741 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:40:55,750 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:40:55,793 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:40:55,807 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:40:56,279 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:40:56,293 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:40:56,467 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:40:56,487 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:40:56,821 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:40:56,854 INFO     [learner.py:606] ====Pushing takes 0.0307767391204834 s
2021-08-18:15:40:56,894 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:56,903 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:40:56,904 INFO     [param_server.py:410] Lock worker 3 with localStep 63 , while globalStep is 62

2021-08-18:15:40:57,44 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:40:57,58 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:40:58,896 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:40:58,931 INFO     [learner.py:606] ====Pushing takes 0.03343558311462402 s
2021-08-18:15:40:58,964 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:40:58,975 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:40:58,976 INFO     [param_server.py:381] ====After aggregation in epoch: 62, virtual_clock: 1717.7402184216614, top_1: : 59.5676 % (1846.0), top_5: : 100.0 % (3099.0), test loss: 2.0113139947255454, test len: 3099.0
2021-08-18:15:40:58,977 INFO     [param_server.py:410] Lock worker 2 with localStep 63 , while globalStep is 63

2021-08-18:15:40:58,977 INFO     [param_server.py:441] ====Epoch 64 completes 20 clients with loss 6.339865313547574, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:40:58,978 INFO     [param_server.py:450] ====Start to sample for epoch 64, global virtualClock: 1717.7402184216614, round_duration: 34.64103488098859
2021-08-18:15:40:58,978 INFO     [oort.py:208] Training selector: Pacer 62: lastExploitationUtil 3192.4131496839595, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:40:58,979 INFO     [oort.py:321] scores are 26,{5: 0.007532970909777469, 6: 0.046485202008227436, 7: 0.08093829210217629, 11: 0.12540084744375884, 14: 0.008492887918374858, 27: 0.09364694695327945, 50: 0.02517411207881256, 51: 0.3388104123089759, 53: 0.3023889390308985, 58: 0.003512352607186325, 59: 0.0027578885462878214, 60: 0.0007835692841486991, 65: 0.004390802217660465, 67: 0.0012477638079991672, 70: 0.007488773742160163, 71: 0.008154957332616909, 76: 0.0010865604645212178, 79: 0.04824472936637536, 81: 0.2261498901525005, 84: 0.28004390106413546, 85: 0.06191741642524584, 87: 0.009636465878376074, 93: 0.02620305355537665, 97: 0.02582119608236479, 98: 0.03662286057994603, 105: 0.011336779610599916, 107: 0.01018561682135355, 110: 0.06737086274260315, 111: 0.008079302487395038, 119: 0.014044739608607039},[51, 53, 84, 81, 11, 27, 7, 110, 85, 79, 6, 98, 93, 97, 50, 119, 105, 107, 87, 14, 71, 111, 5, 70, 65, 58, 59, 67, 76, 60]
2021-08-18:15:40:58,980 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:40:58,980 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:40:58,981 INFO     [oort.py:398] At round 62, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 13.411352670399307, 'time_stamp': 63, 'count': 59, 'status': True, 'gradient': 17.91494741770759}, [1.0380017585083656e-09, -4.761980348894431e-06]), ({'reward': 0.01, 'duration': 15.972045438625893, 'time_stamp': 63, 'count': 59, 'status': True, 'gradient': 20.796719851428932}, [1.0380017585083656e-09, -4.761980348894431e-06]), ({'reward': 7530.83263484227, 'duration': 17.619275735353515, 'time_stamp': 63, 'count': 59, 'status': True, 'gradient': 18.120393025450163}, [0.7817007148361216, -4.761980348894431e-06])]
2021-08-18:15:40:58,982 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:40:59,278 INFO     [param_server.py:553] For epoch: 64, median_reward: 1170.78489254808, dev: 5853.9244627404005
2021-08-18:15:41:00,104 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2062, Top-1 Accuracy: 588.0/1033 (0.5692), Top-5 Accuracy: 1.0
2021-08-18:15:41:00,105 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 695.2409, eval_time 0.7794, test_loss 2.2062, test_accuracy 0.5692, test_5_accuracy 1.0 

2021-08-18:15:41:00,108 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0093, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:41:00,112 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 695.2369, eval_time 0.7862, test_loss 2.0093, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:41:00,128 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1011, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:41:00,131 INFO     [learner.py:656] After aggregation epoch 63, CumulTime 695.2706, eval_time 0.8083, test_loss 2.1011, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:41:00,176 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:41:00,182 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:41:00,192 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:00,200 INFO     [learner.py:526] ====Start train round 64
2021-08-18:15:41:00,205 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:00,220 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:01,292 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:01,302 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:02,453 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:02,467 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:03,22 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:03,34 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:03,127 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:03,140 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:04,352 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:04,373 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:04,650 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:04,661 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:05,134 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:05,156 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:05,277 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:05,287 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:05,782 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:05,796 INFO     [learner.py:606] ====Pushing takes 0.012313127517700195 s
2021-08-18:15:41:05,812 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:05,818 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:05,819 INFO     [param_server.py:410] Lock worker 1 with localStep 64 , while globalStep is 63

2021-08-18:15:41:06,471 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:06,484 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:07,109 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:07,129 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:07,398 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:07,409 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:09,585 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:09,602 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:09,716 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:09,727 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:10,211 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:10,221 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:10,341 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:10,350 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:10,754 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:10,764 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:10,950 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:10,959 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:11,375 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:11,409 INFO     [learner.py:606] ====Pushing takes 0.031968116760253906 s
2021-08-18:15:41:11,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:11,462 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:11,463 INFO     [param_server.py:410] Lock worker 3 with localStep 64 , while globalStep is 63

2021-08-18:15:41:11,467 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:11,503 INFO     [learner.py:606] ====Pushing takes 0.034795522689819336 s
2021-08-18:15:41:11,536 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:11,545 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:11,545 INFO     [param_server.py:381] ====After aggregation in epoch: 63, virtual_clock: 1756.136239980447, top_1: : 57.8251 % (1792.0), top_5: : 100.0 % (3099.0), test loss: 2.105532262060377, test len: 3099.0
2021-08-18:15:41:11,546 INFO     [param_server.py:410] Lock worker 2 with localStep 64 , while globalStep is 64

2021-08-18:15:41:11,547 INFO     [param_server.py:441] ====Epoch 65 completes 20 clients with loss 5.020636567314566, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:11,547 INFO     [param_server.py:450] ====Start to sample for epoch 65, global virtualClock: 1756.136239980447, round_duration: 38.39602155878561
2021-08-18:15:41:11,548 INFO     [oort.py:208] Training selector: Pacer 63: lastExploitationUtil 2189.5969004523317, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:41:11,548 INFO     [oort.py:321] scores are 26,{5: 0.028622243030179784, 6: 0.04620992172133171, 7: 0.3241324335303844, 11: 0.021709956307807855, 14: 0.006072790231366004, 27: 0.007094764268114287, 50: 0.0034354186030097983, 51: 0.06556041239159985, 53: 0.7190275256052762, 58: 0.002511487353540344, 59: 0.0025989303646986824, 60: 0.0007577187728107313, 65: 0.004364800366706563, 67: 0.0011995231305861815, 70: 0.005354804215407895, 71: 0.008106664566378142, 76: 0.0010451859837183536, 79: 0.01671611748836211, 81: 0.042342513579844435, 84: 0.03702681907646035, 85: 0.008958635319474254, 87: 0.027558273701628607, 93: 0.037363619187664676, 97: 0.19196201620719217, 98: 0.25944020464677064, 105: 0.007818313717660579, 107: 0.00728316621244064, 110: 0.1099986810651968, 111: 0.007713301590663294, 119: 0.010042609571321023},[53, 7, 98, 97, 110, 51, 6, 81, 93, 84, 5, 87, 11, 79, 119, 85, 71, 105, 111, 107, 27, 14, 70, 65, 50, 59, 58, 67, 76, 60]
2021-08-18:15:41:11,549 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:41:11,550 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:11,550 INFO     [oort.py:398] At round 63, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 467.58234072242647, 'duration': 21.753601635627824, 'time_stamp': 64, 'count': 56, 'status': True, 'gradient': 21.011411306067448}, [0.04577546832482775, -4.6875732433319305e-06]), ({'reward': 10214.484419938799, 'duration': 11.058674649423494, 'time_stamp': 64, 'count': 61, 'status': True, 'gradient': 20.084971391078756}, [1.0, -4.6875732433319305e-06]), ({'reward': 5324.396600022763, 'duration': 15.972045438625893, 'time_stamp': 64, 'count': 60, 'status': True, 'gradient': 20.806262383527653}, [0.5212589885600865, -4.6875732433319305e-06])]
2021-08-18:15:41:11,570 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:11,837 INFO     [param_server.py:553] For epoch: 65, median_reward: 961.5441656598182, dev: 4807.7208282990905
2021-08-18:15:41:12,430 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2243, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:41:12,432 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 707.5563, eval_time 0.555, test_loss 2.2243, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:41:12,470 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2326, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:41:12,471 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 707.6072, eval_time 0.5949, test_loss 2.2326, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:41:12,496 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:12,504 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:12,507 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3156, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:41:12,508 INFO     [learner.py:656] After aggregation epoch 64, CumulTime 707.647, eval_time 0.6363, test_loss 2.3156, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:41:12,538 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:12,553 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:12,577 INFO     [learner.py:526] ====Start train round 65
2021-08-18:15:41:12,595 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:13,568 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:13,577 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:14,665 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:14,675 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:15,208 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:15,217 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:15,464 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:15,483 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:16,883 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:16,903 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:16,956 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:16,967 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:17,436 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:17,450 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:17,650 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:17,678 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:18,355 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:18,371 INFO     [learner.py:606] ====Pushing takes 0.014126062393188477 s
2021-08-18:15:41:18,387 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:18,395 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:18,395 INFO     [param_server.py:410] Lock worker 1 with localStep 65 , while globalStep is 64

2021-08-18:15:41:18,510 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:18,528 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:19,240 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:19,258 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:19,697 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:19,713 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:21,321 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:21,331 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:21,834 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:21,845 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:21,915 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:21,925 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:22,493 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:22,505 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:22,508 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:22,517 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:23,67 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:23,81 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:23,81 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:23,112 INFO     [learner.py:606] ====Pushing takes 0.028933048248291016 s
2021-08-18:15:41:23,149 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:23,158 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:23,159 INFO     [param_server.py:410] Lock worker 3 with localStep 65 , while globalStep is 64

2021-08-18:15:41:24,878 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:24,911 INFO     [learner.py:606] ====Pushing takes 0.031040668487548828 s
2021-08-18:15:41:24,943 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:24,952 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:24,953 INFO     [param_server.py:381] ====After aggregation in epoch: 64, virtual_clock: 1790.7772748614357, top_1: : 59.5999 % (1847.0), top_5: : 100.0 % (3099.0), test loss: 2.2574961671122797, test len: 3099.0
2021-08-18:15:41:24,954 INFO     [param_server.py:410] Lock worker 2 with localStep 65 , while globalStep is 65

2021-08-18:15:41:24,954 INFO     [param_server.py:441] ====Epoch 66 completes 20 clients with loss 5.1202662348383186, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:24,955 INFO     [param_server.py:450] ====Start to sample for epoch 66, global virtualClock: 1790.7772748614357, round_duration: 34.64103488098859
2021-08-18:15:41:24,955 INFO     [oort.py:208] Training selector: Pacer 64: lastExploitationUtil 1924.4274596073585, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:41:24,956 INFO     [oort.py:321] scores are 26,{5: 0.01749548985114993, 6: 0.29151203139383425, 7: 0.4027085266870031, 11: 0.054465049185234884, 14: 0.005215123493285238, 27: 0.007053344660998952, 50: 0.04611312487203045, 51: 0.04498733165699011, 53: 0.053231525680158806, 58: 0.00236538629224829, 59: 0.0022318806159888896, 60: 0.0007228736043553022, 65: 0.0071382078914459714, 67: 0.0011346405926314178, 70: 0.004598539419570057, 71: 0.016239579995937937, 76: 0.000989527350640699, 79: 0.0035701022542814053, 81: 0.10569409847783229, 84: 0.2182871543994641, 85: 0.008906334335086395, 87: 0.04128281789309901, 93: 0.057691800631506696, 97: 0.025518432977602288, 98: 0.03619344395109972, 105: 0.003388888302718423, 107: 0.006254556764338737, 110: 0.00849099386527545, 111: 0.004961158161549635, 119: 0.00862428095058812},[7, 6, 84, 81, 93, 11, 53, 50, 51, 87, 98, 97, 5, 71, 85, 119, 110, 65, 27, 107, 14, 111, 70, 79, 105, 58, 59, 67, 76, 60]
2021-08-18:15:41:24,957 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:41:24,957 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:24,958 INFO     [oort.py:398] At round 64, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3585.870461643117, 'duration': 5.8943907365129, 'time_stamp': 65, 'count': 62, 'status': True, 'gradient': 21.01387089322507}, [0.32271926699104647, -4.615455622394195e-06]), ({'reward': 11111.402579220907, 'duration': 43.65853298740619, 'time_stamp': 65, 'count': 47, 'status': True, 'gradient': 25.03739283070111}, [1.0, -4.615455622394195e-06]), ({'reward': 4751.025538480806, 'duration': 11.90395711384456, 'time_stamp': 65, 'count': 63, 'status': True, 'gradient': 20.707748290771352}, [0.42758056745198053, -4.615455622394195e-06])]
2021-08-18:15:41:24,959 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:25,230 INFO     [param_server.py:553] For epoch: 66, median_reward: 895.7337316170634, dev: 4478.6686580853175
2021-08-18:15:41:25,843 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1789, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:41:25,845 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 720.9692, eval_time 0.5682, test_loss 2.1789, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:41:25,882 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.0904, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:41:25,883 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 721.0194, eval_time 0.6091, test_loss 2.0904, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:41:25,909 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:25,918 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:25,958 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:25,971 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:25,963 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.9516, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:41:25,978 INFO     [learner.py:656] After aggregation epoch 65, CumulTime 721.1167, eval_time 0.7033, test_loss 1.9516, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:41:26,46 INFO     [learner.py:526] ====Start train round 66
2021-08-18:15:41:26,78 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:27,260 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:27,271 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:28,472 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:28,490 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:28,819 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:28,828 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:29,331 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:29,352 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:30,705 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:30,716 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:30,786 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:30,806 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:31,114 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:31,128 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:31,557 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:31,577 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:32,155 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:32,168 INFO     [learner.py:606] ====Pushing takes 0.011972904205322266 s
2021-08-18:15:41:32,190 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:32,194 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:32,195 INFO     [param_server.py:410] Lock worker 1 with localStep 66 , while globalStep is 65

2021-08-18:15:41:32,395 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:32,405 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:33,84 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:33,98 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:33,349 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:33,360 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:35,379 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:35,390 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:35,457 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:35,467 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:36,25 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:36,35 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:36,141 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:36,162 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:36,525 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:36,535 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:37,3 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:37,37 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:37,65 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:37,98 INFO     [learner.py:606] ====Pushing takes 0.03119945526123047 s
2021-08-18:15:41:37,136 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:37,146 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:37,146 INFO     [param_server.py:410] Lock worker 3 with localStep 66 , while globalStep is 65

2021-08-18:15:41:37,768 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:41:37,805 INFO     [learner.py:606] ====Pushing takes 0.035530805587768555 s
2021-08-18:15:41:37,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:37,847 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:37,848 INFO     [param_server.py:381] ====After aggregation in epoch: 65, virtual_clock: 1829.1732964202213, top_1: : 59.7289 % (1851.0), top_5: : 100.0 % (3099.0), test loss: 2.0736377548288414, test len: 3099.0
2021-08-18:15:41:37,849 INFO     [param_server.py:410] Lock worker 2 with localStep 66 , while globalStep is 66

2021-08-18:15:41:37,850 INFO     [param_server.py:441] ====Epoch 67 completes 20 clients with loss 4.605553788001708, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:41:37,850 INFO     [param_server.py:450] ====Start to sample for epoch 67, global virtualClock: 1829.1732964202213, round_duration: 38.39602155878561
2021-08-18:15:41:37,850 INFO     [oort.py:208] Training selector: Pacer 65: lastExploitationUtil 2086.8491699597657, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:41:37,851 INFO     [oort.py:321] scores are 26,{5: 0.010127545621805855, 6: 0.0456756875587541, 7: 0.07952879587236947, 11: 0.10430903067999361, 14: 0.006397190127308451, 27: 0.060410909087381594, 50: 0.003395701635048884, 51: 0.044728358401318, 53: 0.5693798482645682, 58: 0.002645647468596054, 59: 0.002584615071925882, 60: 0.0008163943211911271, 65: 0.0423887977330997, 67: 0.001307365259059757, 70: 0.005640850310215908, 71: 0.00801294319671139, 76: 0.0011378051849575373, 79: 0.0035495506685389354, 81: 0.020849310461826892, 84: 0.03659875101346915, 85: 0.008855064292745416, 87: 0.009468652078857219, 93: 0.01382750611771755, 97: 0.12271254867846464, 98: 0.4884638842244794, 105: 0.032007269029065345, 107: 0.007672222687542338, 110: 0.008442114764333252, 111: 0.006085660685110302, 119: 0.010579071621846082},[53, 98, 97, 11, 7, 27, 6, 51, 65, 84, 105, 81, 93, 119, 5, 87, 85, 110, 71, 107, 14, 111, 70, 79, 50, 58, 59, 67, 76, 60]
2021-08-18:15:41:37,852 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:41:37,852 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:37,852 INFO     [oort.py:398] At round 65, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4759.931740478429, 'duration': 21.753601635627824, 'time_stamp': 66, 'count': 58, 'status': True, 'gradient': 21.021284516256575}, [0.5269852447516296, -4.5455234170214745e-06]), ({'reward': 9032.372466717543, 'duration': 13.411352670399307, 'time_stamp': 66, 'count': 62, 'status': True, 'gradient': 17.933453602781093}, [1.0, -4.5455234170214745e-06]), ({'reward': 7009.661168613322, 'duration': 11.058674649423494, 'time_stamp': 66, 'count': 63, 'status': True, 'gradient': 20.097820600765775}, [0.7760595521583523, -4.5455234170214745e-06])]
2021-08-18:15:41:37,853 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 105, 119]
2021-08-18:15:41:38,176 INFO     [param_server.py:553] For epoch: 67, median_reward: 928.7154837054482, dev: 4643.57741852724
2021-08-18:15:41:38,882 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.252, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:41:38,879 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5356, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:41:38,884 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 734.0081, eval_time 0.6798, test_loss 2.5356, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:41:38,883 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 734.0192, eval_time 0.6808, test_loss 2.252, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:41:38,916 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0474, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:41:38,920 INFO     [learner.py:656] After aggregation epoch 66, CumulTime 734.0594, eval_time 0.7204, test_loss 2.0474, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:41:38,953 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:38,953 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:38,961 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:38,961 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:38,987 INFO     [learner.py:526] ====Start train round 67
2021-08-18:15:41:39,2 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:40,160 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:40,169 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:41,397 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:41,408 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:41,860 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:41,873 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:42,118 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:42,139 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:43,340 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:43,358 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:43,549 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:43,559 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:44,33 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:44,54 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:44,240 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:44,252 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:44,731 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:44,749 INFO     [learner.py:606] ====Pushing takes 0.016389846801757812 s
2021-08-18:15:41:44,772 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:44,777 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:44,778 INFO     [param_server.py:410] Lock worker 1 with localStep 67 , while globalStep is 66

2021-08-18:15:41:45,232 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:45,241 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:46,9 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:46,29 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:46,305 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:46,328 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:48,270 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:48,280 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:48,679 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:48,698 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:48,797 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:48,806 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:41:49,343 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:49,343 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:41:49,353 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:41:49,357 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:49,990 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:41:50,6 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:50,20 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:41:50,25 INFO     [learner.py:606] ====Pushing takes 0.03411531448364258 s
2021-08-18:15:41:50,67 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:50,75 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:41:50,76 INFO     [param_server.py:410] Lock worker 3 with localStep 67 , while globalStep is 66

2021-08-18:15:41:50,759 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:41:50,795 INFO     [learner.py:606] ====Pushing takes 0.03442978858947754 s
2021-08-18:15:41:50,832 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:50,846 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:41:50,847 INFO     [param_server.py:381] ====After aggregation in epoch: 66, virtual_clock: 1863.81433130121, top_1: : 59.7289 % (1851.0), top_5: : 100.0 % (3099.0), test loss: 2.2783361187687627, test len: 3099.0
2021-08-18:15:41:50,849 INFO     [param_server.py:410] Lock worker 2 with localStep 67 , while globalStep is 67

2021-08-18:15:41:50,849 INFO     [param_server.py:441] ====Epoch 68 completes 20 clients with loss 5.386906555836213, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:41:50,850 INFO     [param_server.py:450] ====Start to sample for epoch 68, global virtualClock: 1863.81433130121, round_duration: 34.64103488098859
2021-08-18:15:41:50,851 INFO     [oort.py:208] Training selector: Pacer 66: lastExploitationUtil 2194.0039954954004, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:41:50,851 INFO     [oort.py:321] scores are 26,{5: 0.007359765472386422, 6: 0.04541636876268872, 7: 0.7583259230743817, 11: 0.013599807847697931, 14: 0.0053990743031872455, 27: 0.00697292742082879, 50: 0.003401905703053762, 51: 0.11919550318732912, 53: 0.05262461752651142, 58: 0.0022328627067082656, 59: 0.0023106047818584733, 60: 0.0006945709470645178, 65: 0.022257763325909397, 67: 0.001081502429151742, 70: 0.004760741724402411, 71: 0.007967450574842511, 76: 0.0009439770211788347, 79: 0.0035293984769653648, 81: 0.03917168981247394, 84: 0.03639096554689897, 85: 0.019238913675701467, 87: 0.07036617228620269, 93: 0.013749001941192114, 97: 0.07571246695669025, 98: 0.48825958285620974, 105: 0.022406414822726515, 107: 0.006475171057338618, 110: 0.033167347391554095, 111: 0.005136150961440961, 119: 0.002693642065509828},[7, 98, 51, 97, 87, 53, 6, 81, 84, 110, 105, 65, 85, 93, 11, 71, 5, 27, 107, 14, 111, 70, 79, 50, 119, 59, 58, 67, 76, 60]
2021-08-18:15:41:50,852 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:41:50,853 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:41:50,853 INFO     [oort.py:398] At round 66, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 67, 'count': 64, 'status': True, 'gradient': 20.827439905727786}, [8.342572784292898e-10, -4.4776787713249495e-06]), ({'reward': 8141.9664556009575, 'duration': 5.8943907365129, 'time_stamp': 67, 'count': 64, 'status': True, 'gradient': 21.030098474898992}, [0.6792486442082292, -4.4776787713249495e-06]), ({'reward': 0.01, 'duration': 21.635252629006885, 'time_stamp': 67, 'count': 18, 'status': True, 'gradient': 21.443124181129278}, [8.342572784292898e-10, -4.4776787713249495e-06])]
2021-08-18:15:41:50,854 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:41:51,141 INFO     [param_server.py:553] For epoch: 68, median_reward: 935.8955780234286, dev: 4679.477890117143
2021-08-18:15:41:51,791 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2862, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:41:51,792 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 746.9282, eval_time 0.6085, test_loss 2.2862, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:41:51,836 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.551, Top-1 Accuracy: 600.0/1033 (0.5808), Top-5 Accuracy: 1.0
2021-08-18:15:41:51,837 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 746.9621, eval_time 0.6517, test_loss 2.551, test_accuracy 0.5808, test_5_accuracy 1.0 

2021-08-18:15:41:51,860 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:51,866 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0847, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:41:51,867 INFO     [learner.py:656] After aggregation epoch 67, CumulTime 747.0065, eval_time 0.6848, test_loss 2.0847, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:41:51,869 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:41:51,905 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:51,918 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:41:51,937 INFO     [learner.py:526] ====Start train round 68
2021-08-18:15:41:51,958 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:41:52,471 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:41:52,481 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:41:53,704 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:41:53,716 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:41:54,399 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:41:54,420 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:41:55,260 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:41:55,279 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:41:55,354 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:41:55,380 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:41:56,406 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:41:56,419 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:41:56,651 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:41:56,671 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:41:57,137 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:41:57,158 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:41:57,224 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:41:57,230 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:41:57,245 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:41:57,250 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:41:57,600 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:41:57,622 INFO     [learner.py:606] ====Pushing takes 0.015221834182739258 s
2021-08-18:15:41:57,643 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:41:57,650 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:41:57,651 INFO     [param_server.py:410] Lock worker 1 with localStep 68 , while globalStep is 67

2021-08-18:15:41:57,723 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:41:57,735 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:41:58,447 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:41:58,461 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:41:59,71 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:41:59,90 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:41:59,368 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:41:59,378 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:41:59,687 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:41:59,702 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:41:59,983 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:41:59,992 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:00,551 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:00,561 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:01,107 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:01,119 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:01,144 INFO     [learner.py:606] ====Pushing takes 0.03529787063598633 s
2021-08-18:15:42:01,177 INFO     [learner.py:606] ====Pushing takes 0.056593894958496094 s
2021-08-18:15:42:01,182 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:01,190 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:01,191 INFO     [param_server.py:410] Lock worker 2 with localStep 68 , while globalStep is 67

2021-08-18:15:42:01,218 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:01,227 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:01,229 INFO     [param_server.py:381] ====After aggregation in epoch: 67, virtual_clock: 1893.165281851753, top_1: : 58.9868 % (1828.0), top_5: : 100.0 % (3099.0), test loss: 2.30732270081838, test len: 3099.0
2021-08-18:15:42:01,231 INFO     [param_server.py:410] Lock worker 3 with localStep 68 , while globalStep is 68

2021-08-18:15:42:01,231 INFO     [param_server.py:441] ====Epoch 69 completes 20 clients with loss 5.292903730291799, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:42:01,232 INFO     [param_server.py:450] ====Start to sample for epoch 69, global virtualClock: 1893.165281851753, round_duration: 29.350950550543047
2021-08-18:15:42:01,245 INFO     [oort.py:208] Training selector: Pacer 67: lastExploitationUtil 2163.687842736598, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:42:01,246 INFO     [oort.py:321] scores are 26,{5: 0.007318548046210912, 6: 0.2105827512917397, 7: 0.34405440884258515, 11: 0.03212847813198897, 14: 0.004916061846320564, 27: 0.006933876431734974, 50: 0.0033575136797159345, 51: 0.49560571190023717, 53: 0.7178133067797655, 58: 0.0020571875614310412, 59: 0.002103893255055717, 60: 0.0006526907451921427, 65: 0.011064965019705738, 67: 0.0010036177214610294, 70: 0.004334835832450921, 71: 0.007922829885894236, 76: 0.0008771571996262674, 79: 0.014096050077692367, 81: 0.0737318457216625, 84: 0.036187162594004264, 85: 0.008755480514185057, 87: 0.00936216791107331, 93: 0.013672002412521768, 97: 0.0250862065449025, 98: 0.03558040618424961, 105: 0.005780963687662847, 107: 0.005895888738665797, 110: 0.020389929624193153, 111: 0.0046766601755373, 119: 0.00812972091413073},[53, 51, 7, 6, 81, 84, 98, 11, 97, 110, 79, 93, 65, 87, 85, 119, 71, 5, 27, 107, 105, 14, 111, 70, 50, 59, 58, 67, 76, 60]
2021-08-18:15:42:01,247 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:42:01,248 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:01,248 INFO     [oort.py:398] At round 67, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3894.2473184009, 'duration': 11.90395711384456, 'time_stamp': 68, 'count': 66, 'status': True, 'gradient': 20.7319669636704}, [0.2880243800058622, -4.4118295857292055e-06]), ({'reward': 13520.52283103672, 'duration': 11.058674649423494, 'time_stamp': 68, 'count': 65, 'status': True, 'gradient': 19.803587892183444}, [1.0, -4.4118295857292055e-06]), ({'reward': 2163.6961646129166, 'duration': 64.44623138309716, 'time_stamp': 68, 'count': 28, 'status': True, 'gradient': 17.559746915899993}, [0.1600298894022581, -4.4118295857292055e-06])]
2021-08-18:15:42:01,249 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 27, 65, 79, 50, 105, 119]
2021-08-18:15:42:01,538 INFO     [param_server.py:553] For epoch: 69, median_reward: 947.6104066119963, dev: 4738.052033059981
2021-08-18:15:42:02,131 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.158, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:42:02,132 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 757.2713, eval_time 0.5612, test_loss 2.158, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:42:02,221 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:42:02,245 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:02,353 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2613, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:42:02,354 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1477, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:42:02,354 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 757.49, eval_time 0.783, test_loss 2.2613, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:42:02,355 INFO     [learner.py:656] After aggregation epoch 68, CumulTime 757.4795, eval_time 0.7834, test_loss 2.1477, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:42:02,424 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:42:02,425 INFO     [learner.py:526] ====Start train round 69
2021-08-18:15:42:02,432 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:02,433 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:03,467 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:03,476 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:04,583 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:04,595 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:05,17 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:05,26 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:05,492 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:05,525 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:06,742 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:06,763 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:06,800 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:06,809 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:07,265 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:07,279 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:07,375 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:07,395 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:07,711 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:07,725 INFO     [learner.py:606] ====Pushing takes 0.012433052062988281 s
2021-08-18:15:42:07,741 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:07,747 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:07,747 INFO     [param_server.py:410] Lock worker 1 with localStep 69 , while globalStep is 68

2021-08-18:15:42:08,443 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:08,453 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:09,83 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:09,98 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:09,578 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:09,592 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:11,401 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:11,415 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:11,941 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:11,955 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:42:12,68 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:12,77 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:12,663 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:12,676 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:42:12,677 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:12,690 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:13,222 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:13,241 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:13,255 INFO     [learner.py:606] ====Pushing takes 0.03133893013000488 s
2021-08-18:15:42:13,255 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:42:13,290 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:13,304 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:13,305 INFO     [param_server.py:410] Lock worker 3 with localStep 69 , while globalStep is 68

2021-08-18:15:42:13,881 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:42:13,915 INFO     [learner.py:606] ====Pushing takes 0.03284740447998047 s
2021-08-18:15:42:13,952 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:13,961 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:13,961 INFO     [param_server.py:381] ====After aggregation in epoch: 68, virtual_clock: 1931.5613034105386, top_1: : 59.5676 % (1846.0), top_5: : 100.0 % (3099.0), test loss: 2.189021914093583, test len: 3099.0
2021-08-18:15:42:13,964 INFO     [param_server.py:410] Lock worker 2 with localStep 69 , while globalStep is 69

2021-08-18:15:42:13,964 INFO     [param_server.py:441] ====Epoch 70 completes 20 clients with loss 4.395653825065592, sampled rewards are: 
 {6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:42:13,964 INFO     [param_server.py:450] ====Start to sample for epoch 70, global virtualClock: 1931.5613034105386, round_duration: 38.39602155878561
2021-08-18:15:42:13,965 INFO     [oort.py:208] Training selector: Pacer 68: lastExploitationUtil 2345.6601668169546, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:42:13,965 INFO     [oort.py:321] scores are 26,{5: 0.0073314300486736605, 6: 0.04491248017359119, 7: 0.07819992776797959, 11: 0.01344891978299638, 14: 0.006080701431081101, 27: 0.05153380463421872, 50: 0.00333896194038429, 51: 0.3226352717879929, 53: 0.05204075437321116, 58: 0.0025147591408537233, 60: 0.0007364768679622592, 65: 0.00424224934016492, 67: 0.0011583428050052779, 70: 0.005361780073945628, 71: 0.10561966996554967, 76: 0.0010099846409398821, 79: 0.003490240268870531, 81: 0.23365299255558905, 84: 0.05769024079483136, 85: 0.008707102634683403, 87: 0.009310437816951993, 93: 0.18746437590314116, 97: 0.024947594223692183, 98: 0.2122856413328898, 105: 0.0033130800123911037, 107: 0.007292654204001301, 110: 0.020737598746066732, 111: 0.005784584309766905, 112: 0.15680959053274612, 119: 0.002663756463976696},[51, 81, 98, 93, 112, 71, 7, 84, 53, 27, 6, 97, 110, 11, 87, 85, 5, 107, 14, 111, 70, 65, 79, 50, 105, 119, 58, 67, 76, 60]
2021-08-18:15:42:13,966 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:42:13,966 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:13,966 INFO     [oort.py:398] At round 68, UCB exploited 30, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 8788.557946372695, 'duration': 17.619275735353515, 'time_stamp': 69, 'count': 65, 'status': True, 'gradient': 19.80781003985984}, [0.8130593396899187, -4.34788909984203e-06]), ({'reward': 589.5345040703205, 'duration': 16.330805291863395, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 19.37282713490919}, [0.054538976691078385, 0.29130422180031595]), ({'reward': 4226.005089535114, 'duration': 13.411352670399307, 'time_stamp': 69, 'count': 65, 'status': True, 'gradient': 17.953200331412337}, [0.3909616016453974, -4.34788909984203e-06])]
2021-08-18:15:42:13,967 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:42:14,252 INFO     [param_server.py:553] For epoch: 70, median_reward: 968.7545415232412, dev: 4843.772707616206
2021-08-18:15:42:14,831 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1788, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:42:14,832 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0871, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:42:14,833 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 769.9686, eval_time 0.5467, test_loss 2.1788, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:42:14,833 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 769.9574, eval_time 0.5468, test_loss 2.0871, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:42:14,904 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:14,908 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:14,915 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:14,922 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:14,920 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1966, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:42:14,923 INFO     [learner.py:656] After aggregation epoch 69, CumulTime 770.0619, eval_time 0.6368, test_loss 2.1966, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:42:14,993 INFO     [learner.py:526] ====Start train round 70
2021-08-18:15:42:15,12 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:15,494 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:15,507 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:16,570 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:16,582 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:17,56 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:17,65 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:18,108 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:18,118 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:18,340 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:18,367 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:18,838 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:18,852 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:19,534 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:19,560 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:19,602 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:19,616 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:19,765 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:19,776 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:20,140 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:20,166 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:20,299 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:20,313 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:20,636 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:20,651 INFO     [learner.py:606] ====Pushing takes 0.013370990753173828 s
2021-08-18:15:42:20,667 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:20,672 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:20,673 INFO     [param_server.py:410] Lock worker 1 with localStep 70 , while globalStep is 69

2021-08-18:15:42:21,91 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:21,105 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:21,723 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:21,745 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:42:21,777 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:21,792 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:22,453 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:22,460 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:42:22,462 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:22,473 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:23,19 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:23,29 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:23,616 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:23,648 INFO     [learner.py:606] ====Pushing takes 0.030013322830200195 s
2021-08-18:15:42:23,689 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:23,698 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:23,699 INFO     [param_server.py:410] Lock worker 3 with localStep 70 , while globalStep is 69

2021-08-18:15:42:23,778 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:23,810 INFO     [learner.py:606] ====Pushing takes 0.030169963836669922 s
2021-08-18:15:42:23,845 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:23,854 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:23,854 INFO     [param_server.py:381] ====After aggregation in epoch: 69, virtual_clock: 1959.5771589060273, top_1: : 58.6318 % (1817.0), top_5: : 100.0 % (3099.0), test loss: 2.154132843017578, test len: 3099.0
2021-08-18:15:42:23,856 INFO     [param_server.py:410] Lock worker 2 with localStep 70 , while globalStep is 70

2021-08-18:15:42:23,857 INFO     [param_server.py:441] ====Epoch 71 completes 20 clients with loss 5.1097847573246025, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:42:23,857 INFO     [param_server.py:450] ====Start to sample for epoch 71, global virtualClock: 1959.5771589060273, round_duration: 28.015855495488744
2021-08-18:15:42:23,858 INFO     [oort.py:208] Training selector: Pacer 69: lastExploitationUtil 1814.0171511767367, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:42:23,858 INFO     [oort.py:321] scores are 26,{5: 0.019799674215297703, 6: 0.044667594052714976, 7: 0.07777354122931854, 11: 0.013375589301515424, 14: 0.0049014738621396, 27: 0.006857965528245945, 50: 0.003320756189239538, 51: 0.04374117309442672, 53: 0.21771833459812928, 58: 0.002027073083290605, 60: 0.0007181437864507907, 65: 0.004219118397925985, 67: 0.0011240548823500578, 70: 0.005184842385365952, 71: 0.014394804183584306, 76: 0.000980582785355185, 79: 0.009277596171001806, 81: 0.14140094791156804, 84: 0.03579099167370307, 85: 0.04326828343471965, 87: 0.009259672484201717, 93: 0.136413726733291, 97: 0.07103255957443003, 98: 0.03519087793024275, 105: 0.0032950153829328526, 107: 0.005878393203755724, 110: 0.11440746484037081, 111: 0.004662782594906059, 119: 0.008105596677333394},[53, 81, 93, 110, 7, 97, 6, 51, 85, 84, 98, 5, 71, 11, 79, 87, 119, 27, 107, 70, 14, 111, 65, 50, 105, 58, 67, 76, 60]
2021-08-18:15:42:23,859 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:42:23,859 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:23,860 INFO     [oort.py:398] At round 69, UCB exploited 29, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 13.411352670399307, 'time_stamp': 70, 'count': 66, 'status': True, 'gradient': 17.959888711570965}, [8.830279892377222e-10, -4.285775511078734e-06]), ({'reward': 2824.2084763375974, 'duration': 11.058674649423494, 'time_stamp': 70, 'count': 67, 'status': True, 'gradient': 18.164514379145107}, [0.24938463105990089, -4.285775511078734e-06]), ({'reward': 5227.4125731035565, 'duration': 17.619275735353515, 'time_stamp': 70, 'count': 66, 'status': True, 'gradient': 13.210758778353627}, [0.4615942791894197, -4.285775511078734e-06])]
2021-08-18:15:42:23,861 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:42:24,138 INFO     [param_server.py:553] For epoch: 71, median_reward: 877.5423719819888, dev: 4387.711859909944
2021-08-18:15:42:24,740 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 1.896, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:42:24,741 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 779.8803, eval_time 0.5636, test_loss 1.896, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:42:24,796 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.032, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:42:24,797 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 779.9218, eval_time 0.6195, test_loss 2.032, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:42:24,805 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1984, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:42:24,812 INFO     [learner.py:656] After aggregation epoch 70, CumulTime 779.9484, eval_time 0.6348, test_loss 2.1984, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:42:24,815 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:24,838 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:24,870 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:24,882 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:24,894 INFO     [learner.py:526] ====Start train round 71
2021-08-18:15:42:24,907 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:25,957 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:25,967 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:27,113 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:27,125 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:27,661 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:27,682 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:27,699 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:27,718 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:28,800 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:28,820 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:29,398 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:29,407 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:29,411 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:29,428 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:29,742 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:29,756 INFO     [learner.py:606] ====Pushing takes 0.013013839721679688 s
2021-08-18:15:42:29,777 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:29,783 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:29,783 INFO     [param_server.py:410] Lock worker 1 with localStep 71 , while globalStep is 70

2021-08-18:15:42:30,148 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:30,160 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:31,337 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:31,347 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:31,997 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:32,6 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:32,178 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:32,190 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:34,267 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:34,277 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:34,556 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:34,582 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:35,55 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:35,69 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:35,351 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:35,371 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:42:35,722 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:35,732 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:36,72 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:42:36,92 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:36,323 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:36,357 INFO     [learner.py:606] ====Pushing takes 0.03171110153198242 s
2021-08-18:15:42:36,390 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:36,402 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:36,402 INFO     [param_server.py:410] Lock worker 3 with localStep 71 , while globalStep is 70

2021-08-18:15:42:36,623 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:36,660 INFO     [learner.py:606] ====Pushing takes 0.035064697265625 s
2021-08-18:15:42:36,697 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:36,706 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:36,707 INFO     [param_server.py:381] ====After aggregation in epoch: 70, virtual_clock: 1997.973180464813, top_1: : 60.2452 % (1867.0), top_5: : 100.0 % (3099.0), test loss: 2.042145846618546, test len: 3099.0
2021-08-18:15:42:36,710 INFO     [param_server.py:410] Lock worker 2 with localStep 71 , while globalStep is 71

2021-08-18:15:42:36,711 INFO     [param_server.py:441] ====Epoch 72 completes 20 clients with loss 4.244360199186797, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:42:36,711 INFO     [param_server.py:450] ====Start to sample for epoch 72, global virtualClock: 1997.973180464813, round_duration: 38.39602155878561
2021-08-18:15:42:36,712 INFO     [oort.py:208] Training selector: Pacer 70: lastExploitationUtil 1455.1146942869727, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:42:36,712 INFO     [oort.py:321] scores are 26,{5: 0.007199472134075111, 6: 0.07723902809682968, 7: 0.07735500183770971, 11: 0.10587958936302302, 14: 0.0053469776694001206, 27: 0.006821059291568319, 50: 0.014905292403000772, 51: 0.04350577936429917, 53: 0.05147847018631021, 58: 0.0022113174150163845, 60: 0.0008843597845695596, 65: 0.004196413153706916, 67: 0.0014313661869639128, 70: 0.0047148044758587365, 71: 0.014035817732393463, 76: 0.0012443732666468014, 79: 0.025829822658898743, 81: 0.28243994692003155, 84: 0.15075799215937322, 85: 0.008613025095182433, 87: 0.009209841428205339, 93: 0.013449553075889105, 97: 0.08437399750372716, 98: 0.035001497732217876, 105: 0.03618562043822692, 107: 0.006412690973468681, 110: 0.008211362889954672, 111: 0.005086591322012472, 119: 0.008842328991212128},[81, 84, 11, 97, 7, 6, 53, 51, 105, 98, 79, 50, 71, 93, 87, 119, 85, 110, 5, 27, 107, 14, 111, 70, 65, 58, 67, 76, 60]
2021-08-18:15:42:36,713 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:42:36,714 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:36,714 INFO     [oort.py:398] At round 70, UCB exploited 29, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7985.0591112881375, 'duration': 17.619275735353515, 'time_stamp': 71, 'count': 67, 'status': True, 'gradient': 19.82302164363464}, [1.0, -4.225411625515856e-06]), ({'reward': 1998.1960401464505, 'duration': 13.298442137908651, 'time_stamp': 71, 'count': 68, 'status': True, 'gradient': 20.855567480407085}, [0.2502409214765238, -4.225411625515856e-06]), ({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 71, 'count': 68, 'status': True, 'gradient': 26.94328707176991}, [1.2523404487693879e-09, -4.225411625515856e-06])]
2021-08-18:15:42:36,715 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 65, 79, 50, 105]
2021-08-18:15:42:37,24 INFO     [param_server.py:553] For epoch: 72, median_reward: 795.3494402587419, dev: 3976.7472012937096
2021-08-18:15:42:37,640 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2089, Top-1 Accuracy: 596.0/1033 (0.577), Top-5 Accuracy: 1.0
2021-08-18:15:42:37,641 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 792.7656, eval_time 0.5694, test_loss 2.2089, test_accuracy 0.577, test_5_accuracy 1.0 

2021-08-18:15:42:37,641 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2904, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:42:37,642 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 792.7778, eval_time 0.5702, test_loss 2.2904, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:42:37,711 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:37,711 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:37,716 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0443, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:42:37,719 INFO     [learner.py:656] After aggregation epoch 71, CumulTime 792.858, eval_time 0.65, test_loss 2.0443, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:42:37,719 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:37,720 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:37,791 INFO     [learner.py:526] ====Start train round 72
2021-08-18:15:42:37,812 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:38,723 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:38,733 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:39,860 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:39,871 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:40,251 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:40,261 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:41,63 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:41,83 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:41,952 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:41,966 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:42,415 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:42,436 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:42,897 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:42,916 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:43,96 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:43,110 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:43,565 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:43,581 INFO     [learner.py:606] ====Pushing takes 0.014645099639892578 s
2021-08-18:15:42:43,598 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:43,603 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:43,604 INFO     [param_server.py:410] Lock worker 1 with localStep 72 , while globalStep is 71

2021-08-18:15:42:43,983 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:43,992 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:44,624 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:44,630 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:44,635 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:44,651 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:42:46,668 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:42:46,678 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:42:47,17 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:42:47,35 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:42:47,299 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:42:47,308 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:42:47,595 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:42:47,613 INFO     [learner.py:165] Start to run client 65 on rank 2...
2021-08-18:15:42:47,935 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:42:47,944 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:42:48,214 INFO     [learner.py:439] Completed to run client 65
2021-08-18:15:42:48,233 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:42:48,589 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:42:48,626 INFO     [learner.py:606] ====Pushing takes 0.03466033935546875 s
2021-08-18:15:42:48,663 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:48,673 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:42:48,674 INFO     [param_server.py:410] Lock worker 3 with localStep 72 , while globalStep is 71

2021-08-18:15:42:50,81 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:42:50,123 INFO     [learner.py:606] ====Pushing takes 0.04091811180114746 s
2021-08-18:15:42:50,159 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:50,169 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:42:50,170 INFO     [param_server.py:381] ====After aggregation in epoch: 71, virtual_clock: 2032.6142153458015, top_1: : 58.5673 % (1815.0), top_5: : 100.0 % (3099.0), test loss: 2.1812112949512623, test len: 3099.0
2021-08-18:15:42:50,172 INFO     [param_server.py:410] Lock worker 2 with localStep 72 , while globalStep is 72

2021-08-18:15:42:50,173 INFO     [param_server.py:441] ====Epoch 73 completes 20 clients with loss 4.827428318136295, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 65: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0} 
==========
2021-08-18:15:42:50,173 INFO     [param_server.py:450] ====Start to sample for epoch 73, global virtualClock: 2032.6142153458015, round_duration: 34.64103488098859
2021-08-18:15:42:50,177 INFO     [oort.py:208] Training selector: Pacer 71: lastExploitationUtil 1426.6035173094942, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:42:50,178 INFO     [oort.py:321] scores are 26,{5: 0.10023177017711048, 6: 0.18364941841814605, 7: 0.6799890263736879, 11: 0.13704873940301093, 14: 0.008849893679819969, 27: 0.006784823414789091, 50: 0.019689557301254892, 51: 0.505937573826267, 53: 0.5806449556395331, 58: 0.003724644244561013, 60: 0.0014321616568074742, 67: 0.002444984381234578, 70: 0.00780357071084801, 71: 0.007752517981886733, 76: 0.0017664448084838112, 79: 0.040085911539812266, 81: 0.15389360784846068, 84: 0.035409270773685525, 85: 0.00856726966296808, 87: 0.009160915496779819, 93: 0.013378104298336907, 97: 0.024546944732832733, 98: 0.03481555741053194, 105: 0.019397439916397422, 107: 0.010613777880824035, 110: 0.008167741229278342, 111: 0.008418922833757713, 119: 0.014635122174167674},[7, 53, 51, 6, 81, 11, 5, 79, 84, 98, 97, 50, 105, 119, 93, 107, 87, 14, 85, 111, 110, 70, 71, 27, 58, 67, 76, 60]
2021-08-18:15:42:50,179 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000004
2021-08-18:15:42:50,179 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:42:50,180 INFO     [oort.py:398] At round 71, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3327.397328753611, 'duration': 12.029357192292537, 'time_stamp': 72, 'count': 69, 'status': True, 'gradient': 26.958060129587757}, [0.8226330174904273, -4.166724537840807e-06]), ({'reward': 2063.168107872715, 'duration': 17.619275735353515, 'time_stamp': 72, 'count': 68, 'status': True, 'gradient': 18.17883441139718}, [0.5100764699974052, -4.166724537840807e-06]), ({'reward': 2439.2072208500567, 'duration': 5.8943907365129, 'time_stamp': 72, 'count': 69, 'status': True, 'gradient': 21.06702944047691}, [0.6030449641069155, -4.166724537840807e-06])]
2021-08-18:15:42:50,181 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:42:50,517 INFO     [param_server.py:553] For epoch: 73, median_reward: 786.8531960839604, dev: 3934.265980419802
2021-08-18:15:42:51,109 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0484, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:42:51,110 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 806.249, eval_time 0.5574, test_loss 2.0484, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:42:51,123 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0652, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:42:51,124 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 806.2485, eval_time 0.5702, test_loss 2.0652, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:42:51,126 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1194, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:42:51,127 INFO     [learner.py:656] After aggregation epoch 72, CumulTime 806.2631, eval_time 0.5736, test_loss 2.1194, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:42:51,189 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:51,193 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:51,197 INFO     [learner.py:526] ====Start train round 73
2021-08-18:15:42:51,202 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:42:51,206 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:42:51,214 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:42:52,281 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:42:52,292 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:42:53,558 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:42:53,570 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:42:53,886 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:42:53,895 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:42:54,506 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:42:54,534 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:42:55,782 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:42:55,811 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:42:55,815 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:42:55,825 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:42:56,427 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:42:56,447 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:42:56,535 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:42:56,568 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:42:56,967 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:42:56,981 INFO     [learner.py:606] ====Pushing takes 0.013129711151123047 s
2021-08-18:15:42:57,6 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:42:57,14 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:42:57,15 INFO     [param_server.py:410] Lock worker 1 with localStep 73 , while globalStep is 72

2021-08-18:15:42:57,694 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:42:57,708 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:42:58,351 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:42:58,371 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:42:58,753 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:42:58,767 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:00,374 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:00,384 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:01,77 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:01,86 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:01,126 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:01,166 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:01,720 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:01,729 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:01,844 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:01,854 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:02,349 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:02,384 INFO     [learner.py:606] ====Pushing takes 0.03375506401062012 s
2021-08-18:15:43:02,421 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:02,429 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:02,430 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:02,438 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:02,439 INFO     [param_server.py:410] Lock worker 3 with localStep 73 , while globalStep is 72

2021-08-18:15:43:02,957 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:02,997 INFO     [learner.py:606] ====Pushing takes 0.03356456756591797 s
2021-08-18:15:43:03,31 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:03,41 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:03,42 INFO     [param_server.py:381] ====After aggregation in epoch: 72, virtual_clock: 2071.010236904587, top_1: : 59.5031 % (1844.0), top_5: : 100.0 % (3099.0), test loss: 2.0776824134367486, test len: 3099.0
2021-08-18:15:43:03,44 INFO     [param_server.py:410] Lock worker 2 with localStep 73 , while globalStep is 73

2021-08-18:15:43:03,44 INFO     [param_server.py:441] ====Epoch 74 completes 20 clients with loss 4.4794084855393095, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:03,45 INFO     [param_server.py:450] ====Start to sample for epoch 74, global virtualClock: 2071.010236904587, round_duration: 38.39602155878561
2021-08-18:15:43:03,46 INFO     [oort.py:208] Training selector: Pacer 72: lastExploitationUtil 2128.0173298316627, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:43:03,47 INFO     [oort.py:321] scores are 26,{5: 0.09012577596532688, 6: 0.14143887868757404, 7: 0.21147420913894746, 11: 0.013163527997068296, 14: 0.007134734364058959, 27: 0.01562712818578069, 50: 0.0063096068959399565, 51: 0.23720811433589958, 53: 0.05093642747772375, 58: 0.002950669205343712, 60: 0.0008924590450621613, 67: 0.001611618712698153, 70: 0.006291194688587932, 71: 0.007711855923387218, 76: 0.001060603094225073, 79: 0.026008200270125802, 81: 0.06770548124885578, 84: 0.03522354868403816, 85: 0.017530420868340918, 87: 0.12817228331919528, 93: 0.015393082112433124, 97: 0.23247923303197035, 98: 0.06992997469263156, 105: 0.012244689326882963, 107: 0.0085567678571642, 110: 0.060052925833157314, 111: 0.006787288098990328, 119: 0.01863216937023084},[51, 97, 7, 6, 87, 5, 98, 81, 110, 53, 84, 79, 119, 85, 27, 93, 11, 105, 107, 71, 14, 111, 50, 70, 58, 67, 76, 60]
2021-08-18:15:43:03,48 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:43:03,48 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:03,49 INFO     [oort.py:398] At round 72, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 73, 'count': 70, 'status': True, 'gradient': 20.149682191476245}, [1.2680153211866212e-09, -4.109645337607368e-06]), ({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 73, 'count': 70, 'status': True, 'gradient': 20.873141911573303}, [1.2680153211866212e-09, -4.109645337607368e-06]), ({'reward': 7033.200502835692, 'duration': 29.570969934622333, 'time_stamp': 73, 'count': 55, 'status': True, 'gradient': 19.83947867128191}, [0.8918193327100411, -4.109645337607368e-06])]
2021-08-18:15:43:03,50 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:03,394 INFO     [param_server.py:553] For epoch: 74, median_reward: 949.7938383824767, dev: 4748.969191912383
2021-08-18:15:43:04,30 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4938, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:43:04,31 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 819.1668, eval_time 0.6033, test_loss 2.4938, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:43:04,69 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1869, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:43:04,72 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 819.1969, eval_time 0.6447, test_loss 2.1869, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:43:04,104 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:43:04,107 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1601, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:43:04,108 INFO     [learner.py:656] After aggregation epoch 73, CumulTime 819.247, eval_time 0.6809, test_loss 2.1601, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:43:04,113 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:04,143 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:43:04,178 INFO     [learner.py:526] ====Start train round 74
2021-08-18:15:43:04,180 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:04,200 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:05,89 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:05,103 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:06,479 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:06,490 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:07,133 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:07,148 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:07,620 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:07,641 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:08,170 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:08,179 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:09,22 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:09,49 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:09,67 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:09,77 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:09,659 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:09,668 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:09,727 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:09,754 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:10,307 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:10,308 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:10,318 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:10,326 INFO     [learner.py:606] ====Pushing takes 0.016833782196044922 s
2021-08-18:15:43:10,349 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:10,355 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:10,356 INFO     [param_server.py:410] Lock worker 1 with localStep 74 , while globalStep is 73

2021-08-18:15:43:10,497 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:10,516 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:12,51 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:12,70 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:12,236 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:12,246 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:12,751 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:12,766 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:12,824 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:12,834 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:13,353 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:13,368 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:13,960 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:13,992 INFO     [learner.py:606] ====Pushing takes 0.03093719482421875 s
2021-08-18:15:43:14,39 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:14,52 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:14,53 INFO     [param_server.py:410] Lock worker 3 with localStep 74 , while globalStep is 73

2021-08-18:15:43:14,501 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:14,511 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:15,19 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:15,53 INFO     [learner.py:606] ====Pushing takes 0.033547163009643555 s
2021-08-18:15:43:15,93 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:15,103 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:15,104 INFO     [param_server.py:381] ====After aggregation in epoch: 73, virtual_clock: 2102.966234883825, top_1: : 60.3098 % (1869.0), top_5: : 100.0 % (3099.0), test loss: 2.28026815255483, test len: 3099.0
2021-08-18:15:43:15,106 INFO     [param_server.py:410] Lock worker 2 with localStep 74 , while globalStep is 74

2021-08-18:15:43:15,106 INFO     [param_server.py:441] ====Epoch 75 completes 20 clients with loss 5.1446321215825845, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:15,106 INFO     [param_server.py:450] ====Start to sample for epoch 75, global virtualClock: 2102.966234883825, round_duration: 31.95599797923794
2021-08-18:15:43:15,107 INFO     [oort.py:208] Training selector: Pacer 73: lastExploitationUtil 2749.748709026911, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:43:15,108 INFO     [oort.py:321] scores are 26,{5: 0.044762256790107854, 6: 0.1595155101185065, 7: 0.6818074844354428, 11: 0.013675276923103932, 14: 0.006544508154904392, 27: 0.0067142803260676846, 50: 0.0032511811057150757, 51: 0.04282472647863358, 53: 0.05067261034004788, 58: 0.0022456920357319847, 60: 0.0007182686427054825, 67: 0.0014782963555000858, 70: 0.0057707509267565325, 71: 0.03767318260604354, 76: 0.001306288286905838, 79: 0.048030752037498264, 81: 0.019961967076563673, 84: 0.2626169060844884, 85: 0.014243395688503455, 87: 0.09563903172802117, 93: 0.11484496914280634, 97: 0.07143000274374983, 98: 0.03445357349361187, 105: 0.01647689125633241, 107: 0.007848902869170943, 110: 0.008082819683209131, 111: 0.006225804640645015, 119: 0.0025937266852795243},[7, 84, 6, 93, 87, 97, 53, 79, 5, 51, 71, 98, 81, 105, 85, 11, 110, 107, 27, 14, 111, 70, 50, 119, 58, 67, 76, 60]
2021-08-18:15:43:15,109 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:43:15,109 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:15,110 INFO     [oort.py:398] At round 73, UCB exploited 28, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 11382.46686325016, 'duration': 42.701901101086094, 'time_stamp': 74, 'count': 34, 'status': True, 'gradient': 8.270144362283714}, [1.0, -4.054108839308643e-06]), ({'reward': 6893.947776633819, 'duration': 5.8943907365129, 'time_stamp': 74, 'count': 71, 'status': True, 'gradient': 21.085441696623754}, [0.6056634225283313, -4.054108839308643e-06]), ({'reward': 5628.867042250243, 'duration': 13.298442137908651, 'time_stamp': 74, 'count': 71, 'status': True, 'gradient': 19.847993272128686}, [0.4945203935258112, -4.054108839308643e-06])]
2021-08-18:15:43:15,110 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 107]
2021-08-18:15:43:15,455 INFO     [param_server.py:553] For epoch: 75, median_reward: 1090.3479595698263, dev: 5451.739797849132
2021-08-18:15:43:16,47 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4523, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:43:16,50 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 831.1895, eval_time 0.5608, test_loss 2.4523, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:43:16,123 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2149, Top-1 Accuracy: 604.0/1033 (0.5847), Top-5 Accuracy: 1.0
2021-08-18:15:43:16,124 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 831.2484, eval_time 0.633, test_loss 2.2149, test_accuracy 0.5847, test_5_accuracy 1.0 

2021-08-18:15:43:16,128 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:16,133 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5715, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:43:16,133 INFO     [learner.py:656] After aggregation epoch 74, CumulTime 831.2693, eval_time 0.6436, test_loss 2.5715, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:43:16,145 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:16,193 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:16,201 INFO     [learner.py:526] ====Start train round 75
2021-08-18:15:43:16,206 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:16,214 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:17,438 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:17,450 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:18,657 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:18,668 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:18,915 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:18,935 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:19,64 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:19,74 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:20,72 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:20,94 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:20,731 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:20,758 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:20,923 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:20,942 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:21,133 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:21,149 INFO     [learner.py:606] ====Pushing takes 0.01451730728149414 s
2021-08-18:15:43:21,179 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:21,185 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:21,186 INFO     [param_server.py:410] Lock worker 1 with localStep 75 , while globalStep is 74

2021-08-18:15:43:21,411 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:21,422 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:22,501 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:22,517 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:23,166 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:23,177 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:23,938 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:23,956 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:25,890 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:25,910 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:26,311 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:26,329 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:26,592 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:26,606 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:26,918 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:26,928 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:27,237 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:27,258 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:27,598 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:27,607 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:43:27,794 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:27,834 INFO     [learner.py:606] ====Pushing takes 0.03740215301513672 s
2021-08-18:15:43:27,883 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:27,893 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:27,894 INFO     [param_server.py:410] Lock worker 3 with localStep 75 , while globalStep is 74

2021-08-18:15:43:28,250 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:43:28,290 INFO     [learner.py:606] ====Pushing takes 0.03779172897338867 s
2021-08-18:15:43:28,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:28,334 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:28,335 INFO     [param_server.py:381] ====After aggregation in epoch: 74, virtual_clock: 2141.362256442611, top_1: : 58.5673 % (1815.0), top_5: : 100.0 % (3099.0), test loss: 2.4129050528561624, test len: 3099.0
2021-08-18:15:43:28,344 INFO     [param_server.py:410] Lock worker 2 with localStep 75 , while globalStep is 75

2021-08-18:15:43:28,345 INFO     [param_server.py:441] ====Epoch 76 completes 20 clients with loss 5.596319793850487, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0} 
==========
2021-08-18:15:43:28,345 INFO     [param_server.py:450] ====Start to sample for epoch 76, global virtualClock: 2141.362256442611, round_duration: 38.39602155878561
2021-08-18:15:43:28,346 INFO     [oort.py:208] Training selector: Pacer 74: lastExploitationUtil 2266.3635385958896, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:43:28,347 INFO     [oort.py:321] scores are 26,{5: 0.007050518293568369, 6: 0.043508035682685325, 7: 0.4794243659324717, 11: 0.013028362707883646, 14: 0.006233152064555017, 27: 0.018519714408558575, 50: 0.012260073654213739, 51: 0.08226225336286376, 53: 0.050413403790487865, 58: 0.002577807232986296, 60: 0.0007736919695355823, 67: 0.0014079661545542271, 70: 0.005496206468348535, 71: 0.024619822003221336, 76: 0.0012441413991255252, 79: 0.01966552722346452, 81: 0.019859855253754, 84: 0.10721099876953429, 85: 0.05553524734876401, 87: 0.009019293951162353, 93: 0.13725788802470448, 97: 0.024167465601683424, 98: 0.22047178118069777, 105: 0.0032094776962119796, 107: 0.0265751058532457, 110: 0.058817201392859786, 119: 0.002597835970784238},[7, 98, 93, 84, 51, 110, 85, 53, 6, 107, 71, 97, 81, 79, 27, 11, 50, 87, 5, 14, 70, 105, 119, 58, 67, 76, 60]
2021-08-18:15:43:28,349 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:43:28,349 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:28,350 INFO     [oort.py:398] At round 74, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4111.089387216348, 'duration': 13.411352670399307, 'time_stamp': 75, 'count': 71, 'status': True, 'gradient': 17.99478446563585}, [0.41149873260217146, -4.000053334044458e-06]), ({'reward': 3645.122441581117, 'duration': 42.701901101086094, 'time_stamp': 75, 'count': 35, 'status': True, 'gradient': 11.582801724033548}, [0.3648577439379207, -4.000053334044458e-06]), ({'reward': 4032.874464031756, 'duration': 5.8943907365129, 'time_stamp': 75, 'count': 72, 'status': True, 'gradient': 21.091195411909297}, [0.4036698052934873, -4.000053334044458e-06])]
2021-08-18:15:43:28,351 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:28,691 INFO     [param_server.py:553] For epoch: 76, median_reward: 967.8806405345156, dev: 4839.403202672578
2021-08-18:15:43:29,339 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.349, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:43:29,340 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 844.4763, eval_time 0.6265, test_loss 2.349, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:43:29,350 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4982, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:43:29,352 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 844.4762, eval_time 0.6334, test_loss 2.4982, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:43:29,376 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3945, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:15:43:29,377 INFO     [learner.py:656] After aggregation epoch 75, CumulTime 844.516, eval_time 0.6635, test_loss 2.3945, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:15:43:29,411 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:29,419 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:29,419 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:29,433 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:29,444 INFO     [learner.py:526] ====Start train round 76
2021-08-18:15:43:29,459 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:30,56 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:30,65 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:31,106 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:31,116 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:31,748 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:31,757 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:32,337 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:32,357 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:32,702 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:32,721 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:33,408 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:33,418 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:33,485 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:33,512 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:33,977 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:33,996 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:34,195 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:34,223 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:34,536 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:34,538 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:34,548 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:34,557 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:34,786 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:34,805 INFO     [learner.py:606] ====Pushing takes 0.016193628311157227 s
2021-08-18:15:43:34,827 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:34,835 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:34,836 INFO     [param_server.py:410] Lock worker 1 with localStep 76 , while globalStep is 75

2021-08-18:15:43:36,70 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:36,90 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:36,201 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:36,215 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:36,711 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:36,726 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:36,865 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:36,879 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:37,518 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:37,532 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:37,971 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:37,981 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:38,202 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:38,234 INFO     [learner.py:606] ====Pushing takes 0.0307161808013916 s
2021-08-18:15:43:38,281 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:38,292 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:38,293 INFO     [param_server.py:410] Lock worker 3 with localStep 76 , while globalStep is 75

2021-08-18:15:43:38,548 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:38,586 INFO     [learner.py:606] ====Pushing takes 0.03671526908874512 s
2021-08-18:15:43:38,621 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:38,630 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:38,631 INFO     [param_server.py:381] ====After aggregation in epoch: 75, virtual_clock: 2170.0456594656266, top_1: : 60.6647 % (1880.0), top_5: : 100.0 % (3099.0), test loss: 2.413893730552108, test len: 3099.0
2021-08-18:15:43:38,634 INFO     [param_server.py:410] Lock worker 2 with localStep 76 , while globalStep is 76

2021-08-18:15:43:38,634 INFO     [param_server.py:441] ====Epoch 77 completes 20 clients with loss 5.056398319611208, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:38,635 INFO     [param_server.py:450] ====Start to sample for epoch 77, global virtualClock: 2170.0456594656266, round_duration: 28.683403023015895
2021-08-18:15:43:38,636 INFO     [oort.py:208] Training selector: Pacer 75: lastExploitationUtil 2376.3064099578996, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:43:38,637 INFO     [oort.py:321] scores are 26,{5: 0.007014892800382638, 6: 0.32022387951485015, 7: 0.07537178217506166, 11: 0.04762818014321763, 14: 0.005958724566019486, 27: 0.006646181667810939, 50: 0.045092274829182655, 51: 0.04239038262169261, 53: 0.23179206991064163, 58: 0.002464313901951105, 60: 0.0007289957953639641, 67: 0.001345977512882192, 70: 0.00525422453418063, 71: 0.007594102269232296, 76: 0.0011893654834330388, 79: 0.008786888092296117, 81: 0.28192002511479364, 84: 0.03468571426245998, 85: 0.00839220523456781, 87: 0.008973720451198479, 93: 0.013104734803246663, 97: 0.02404535005708657, 98: 0.03410413289638865, 105: 0.02464076517568157, 107: 0.00714636596606288, 110: 0.07570955732706222, 119: 0.005130618328983004},[6, 81, 53, 110, 7, 11, 50, 51, 84, 98, 105, 97, 93, 87, 79, 85, 71, 107, 5, 27, 14, 70, 119, 58, 67, 76, 60]
2021-08-18:15:43:38,638 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:43:38,638 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:38,639 INFO     [oort.py:398] At round 75, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 10894.528543431199, 'duration': 43.65853298740619, 'time_stamp': 76, 'count': 57, 'status': True, 'gradient': 25.138035383782057}, [0.9807087304215603, -3.9474203607942245e-06]), ({'reward': 5356.573233596631, 'duration': 11.90395711384456, 'time_stamp': 76, 'count': 74, 'status': True, 'gradient': 20.791176974466595}, [0.4821900400909371, -3.9474203607942245e-06]), ({'reward': 2239.1759266251333, 'duration': 21.753601635627824, 'time_stamp': 76, 'count': 68, 'status': True, 'gradient': 21.101505829973316}, [0.20156646410219053, -3.9474203607942245e-06])]
2021-08-18:15:43:38,640 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:38,998 INFO     [param_server.py:553] For epoch: 77, median_reward: 1010.5880397434998, dev: 5052.940198717499
2021-08-18:15:43:39,624 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.1859, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:43:39,626 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 854.7617, eval_time 0.5826, test_loss 2.1859, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:43:39,641 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.0416, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:43:39,642 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 854.7817, eval_time 0.5996, test_loss 2.0416, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:43:39,661 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.519, Top-1 Accuracy: 597.0/1033 (0.5779), Top-5 Accuracy: 1.0
2021-08-18:15:43:39,662 INFO     [learner.py:656] After aggregation epoch 76, CumulTime 854.7864, eval_time 0.6185, test_loss 2.519, test_accuracy 0.5779, test_5_accuracy 1.0 

2021-08-18:15:43:39,696 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:39,704 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:39,721 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:39,730 INFO     [learner.py:526] ====Start train round 77
2021-08-18:15:43:39,746 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:39,748 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:40,919 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:40,932 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:42,2 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:42,18 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:42,623 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:42,630 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:42,633 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:42,639 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:43,659 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:43,673 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:44,226 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:44,239 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:44,337 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:44,391 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:44,508 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:44,523 INFO     [learner.py:606] ====Pushing takes 0.014043092727661133 s
2021-08-18:15:43:44,549 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:44,554 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:44,555 INFO     [param_server.py:410] Lock worker 1 with localStep 77 , while globalStep is 76

2021-08-18:15:43:44,777 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:44,786 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:45,955 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:45,968 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:46,576 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:46,586 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:47,460 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:47,479 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:43:48,884 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:43:48,903 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:43:49,590 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:43:49,604 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:43:49,703 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:43:49,718 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:43:50,424 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:43:50,444 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:43:50,818 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:43:50,828 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:43:51,0 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:43:51,33 INFO     [learner.py:606] ====Pushing takes 0.031868934631347656 s
2021-08-18:15:43:51,84 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:51,93 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:43:51,94 INFO     [param_server.py:410] Lock worker 3 with localStep 77 , while globalStep is 76

2021-08-18:15:43:51,417 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:43:51,426 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:43:52,99 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:43:52,133 INFO     [learner.py:606] ====Pushing takes 0.03235054016113281 s
2021-08-18:15:43:52,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:52,176 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:43:52,177 INFO     [param_server.py:381] ====After aggregation in epoch: 76, virtual_clock: 2208.4416810244124, top_1: : 58.7932 % (1822.0), top_5: : 100.0 % (3099.0), test loss: 2.248842696348826, test len: 3099.0
2021-08-18:15:43:52,180 INFO     [param_server.py:410] Lock worker 2 with localStep 77 , while globalStep is 77

2021-08-18:15:43:52,180 INFO     [param_server.py:441] ====Epoch 78 completes 20 clients with loss 5.097837732937152, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:43:52,181 INFO     [param_server.py:450] ====Start to sample for epoch 78, global virtualClock: 2208.4416810244124, round_duration: 38.39602155878561
2021-08-18:15:43:52,182 INFO     [oort.py:208] Training selector: Pacer 76: lastExploitationUtil 1815.9035603710367, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:43:52,183 INFO     [oort.py:321] scores are 26,{5: 0.006979874589295346, 6: 0.043072100524688274, 7: 1.0102155975347034, 11: 0.01289782311292408, 14: 0.005485119553741416, 27: 0.006613004055666216, 50: 0.003202141226413613, 51: 0.42994905448290255, 53: 0.20235273950436372, 58: 0.0022684479237774875, 60: 0.0010122657176663188, 67: 0.0015159671214268048, 70: 0.004836613844602363, 71: 0.05011625747262357, 76: 0.0010948336002853162, 79: 0.0033472206196375385, 81: 0.01966086651519118, 84: 0.0345125638383095, 85: 0.008350311506074062, 87: 0.008928923809832658, 93: 0.013039316217012807, 97: 0.3429485545054332, 98: 0.2102755633645315, 105: 0.0031773198627305897, 107: 0.006578366102400491, 110: 0.007960900759349956, 119: 0.008005021028992792},[7, 51, 97, 98, 53, 71, 6, 84, 81, 93, 11, 87, 85, 119, 110, 5, 27, 107, 14, 70, 79, 50, 105, 58, 67, 76, 60]
2021-08-18:15:43:52,184 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:43:52,184 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:43:52,185 INFO     [oort.py:398] At round 76, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6544.920272018539, 'duration': 12.029357192292537, 'time_stamp': 77, 'count': 74, 'status': True, 'gradient': 27.005905154743864}, [0.6894709508346644, -3.8961544955129325e-06]), ({'reward': 8877.73203275562, 'duration': 5.8943907365129, 'time_stamp': 77, 'count': 74, 'status': True, 'gradient': 21.107412524986085}, [0.935220070912385, -3.8961544955129325e-06]), ({'reward': 9492.665589333603, 'duration': 15.972045438625893, 'time_stamp': 77, 'count': 73, 'status': True, 'gradient': 20.904116771371754}, [1.0, -3.8961544955129325e-06])]
2021-08-18:15:43:52,186 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 71, 5, 27, 79, 50, 105, 119]
2021-08-18:15:43:52,539 INFO     [param_server.py:553] For epoch: 78, median_reward: 899.1355400547825, dev: 4495.677700273913
2021-08-18:15:43:53,114 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2261, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:43:53,114 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2211, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:43:53,117 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 868.2529, eval_time 0.5553, test_loss 2.2261, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:43:53,117 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 868.2418, eval_time 0.5546, test_loss 2.2211, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:43:53,153 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5184, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:43:53,156 INFO     [learner.py:656] After aggregation epoch 77, CumulTime 868.295, eval_time 0.5943, test_loss 2.5184, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:43:53,187 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:43:53,188 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:43:53,195 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:43:53,197 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:43:53,224 INFO     [learner.py:526] ====Start train round 78
2021-08-18:15:43:53,246 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:43:53,824 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:43:53,834 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:43:54,878 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:43:54,892 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:43:55,579 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:43:55,593 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:43:56,298 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:43:56,312 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:43:56,748 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:43:56,762 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:43:57,366 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:43:57,378 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:43:57,494 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:43:57,521 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:43:58,5 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:43:58,14 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:43:58,180 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:43:58,207 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:43:58,595 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:43:58,604 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:43:58,631 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:43:58,648 INFO     [learner.py:606] ====Pushing takes 0.015228271484375 s
2021-08-18:15:43:58,674 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:43:58,682 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:43:58,683 INFO     [param_server.py:410] Lock worker 1 with localStep 78 , while globalStep is 77

2021-08-18:15:43:59,168 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:43:59,182 INFO     [learner.py:165] Start to run client 71 on rank 2...
2021-08-18:15:44:00,223 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:00,237 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:00,853 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:00,871 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:00,878 INFO     [learner.py:439] Completed to run client 71
2021-08-18:15:44:00,896 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:01,528 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:01,539 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:01,540 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:01,553 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:02,51 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:02,86 INFO     [learner.py:606] ====Pushing takes 0.03343367576599121 s
2021-08-18:15:44:02,141 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:02,150 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:02,151 INFO     [param_server.py:410] Lock worker 3 with localStep 78 , while globalStep is 77

2021-08-18:15:44:02,766 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:02,778 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:03,335 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:03,376 INFO     [learner.py:606] ====Pushing takes 0.03874349594116211 s
2021-08-18:15:44:03,427 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:03,436 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:03,437 INFO     [param_server.py:381] ====After aggregation in epoch: 77, virtual_clock: 2239.269439084481, top_1: : 59.5031 % (1844.0), top_5: : 100.0 % (3099.0), test loss: 2.321906045631126, test len: 3099.0
2021-08-18:15:44:03,440 INFO     [param_server.py:410] Lock worker 2 with localStep 78 , while globalStep is 78

2021-08-18:15:44:03,440 INFO     [param_server.py:441] ====Epoch 79 completes 20 clients with loss 5.151986050218042, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 71: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:44:03,447 INFO     [param_server.py:450] ====Start to sample for epoch 79, global virtualClock: 2239.269439084481, round_duration: 30.82775806006842
2021-08-18:15:44:03,448 INFO     [oort.py:208] Training selector: Pacer 77: lastExploitationUtil 1949.3212298361486, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:44:03,449 INFO     [oort.py:321] scores are 26,{5: 0.009399519350951733, 6: 0.042859645438928604, 7: 0.0746256088403732, 11: 0.01283420401652086, 14: 0.006506813685203807, 27: 0.07393093490687473, 50: 0.04588410892902271, 51: 0.5383857097948995, 53: 0.2729003083270042, 58: 0.0026909838245074216, 60: 0.0012008169302857037, 67: 0.001469781797054754, 70: 0.005737513074375642, 71: 0.07928572597778004, 76: 0.0012328580070332716, 79: 0.017021983084163538, 81: 0.04435813520302671, 84: 0.03434232905475509, 85: 0.008309123216542511, 87: 0.01833353850187655, 93: 0.0341951730722127, 97: 0.023807303423212706, 98: 0.14551876641373257, 105: 0.013967489529483377, 107: 0.007803695464063947, 110: 0.007921633255955678, 119: 0.00254200296087916},[51, 53, 98, 71, 7, 27, 50, 81, 6, 84, 93, 97, 87, 79, 105, 11, 5, 85, 110, 107, 14, 70, 58, 119, 67, 76, 60]
2021-08-18:15:44:03,450 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:44:03,450 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:44:03,451 INFO     [oort.py:398] At round 77, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2710.310682961458, 'duration': 11.058674649423494, 'time_stamp': 78, 'count': 75, 'status': True, 'gradient': 19.878783879102798}, [0.3354526984492539, -3.846203156450727e-06]), ({'reward': 0.01, 'duration': 13.298442137908651, 'time_stamp': 78, 'count': 75, 'status': True, 'gradient': 19.879551939275654}, [1.2376955048581783e-09, -3.846203156450727e-06]), ({'reward': 7131.372605836911, 'duration': 12.029357192292537, 'time_stamp': 78, 'count': 75, 'status': True, 'gradient': 27.019036162095748}, [0.8826455453135365, -3.846203156450727e-06])]
2021-08-18:15:44:03,452 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119, 107]
2021-08-18:15:44:03,871 INFO     [param_server.py:553] For epoch: 79, median_reward: 923.3727712454278, dev: 4616.863856227139
2021-08-18:15:44:04,461 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1351, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:44:04,462 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 879.5867, eval_time 0.5578, test_loss 2.1351, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:44:04,480 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1075, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:44:04,482 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 879.621, eval_time 0.5777, test_loss 2.1075, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:44:04,502 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2547, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:44:04,504 INFO     [learner.py:656] After aggregation epoch 78, CumulTime 879.6398, eval_time 0.5995, test_loss 2.2547, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:44:04,535 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:04,546 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:04,569 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:04,576 INFO     [learner.py:526] ====Start train round 79
2021-08-18:15:44:04,586 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:04,590 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:05,880 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:05,898 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:07,242 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:07,263 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:07,474 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:07,485 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:08,6 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:08,32 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:09,178 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:09,198 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:44:09,658 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:44:09,667 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:09,763 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:44:09,773 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:44:09,808 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:44:09,828 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:44:10,163 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:44:10,178 INFO     [learner.py:606] ====Pushing takes 0.013724088668823242 s
2021-08-18:15:44:10,206 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:10,212 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:44:10,213 INFO     [param_server.py:410] Lock worker 1 with localStep 79 , while globalStep is 78

2021-08-18:15:44:10,880 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:44:10,896 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:44:11,445 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:44:11,459 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:44:12,662 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:12,673 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:13,316 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:13,328 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:13,749 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:13,763 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:13,863 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:13,873 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:14,369 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:14,378 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:14,594 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:14,604 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:44:15,53 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:15,62 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:15,186 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:44:15,218 INFO     [learner.py:606] ====Pushing takes 0.030746936798095703 s
2021-08-18:15:44:15,265 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:15,275 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:15,276 INFO     [param_server.py:410] Lock worker 2 with localStep 79 , while globalStep is 78

2021-08-18:15:44:15,596 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:15,632 INFO     [learner.py:606] ====Pushing takes 0.03413558006286621 s
2021-08-18:15:44:15,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:15,677 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:15,678 INFO     [param_server.py:381] ====After aggregation in epoch: 78, virtual_clock: 2278.4760295648753, top_1: : 59.7935 % (1853.0), top_5: : 100.0 % (3099.0), test loss: 2.1657659477657742, test len: 3099.0
2021-08-18:15:44:15,680 INFO     [param_server.py:410] Lock worker 3 with localStep 79 , while globalStep is 79

2021-08-18:15:44:15,681 INFO     [param_server.py:441] ====Epoch 80 completes 20 clients with loss 5.3383157456295285, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 119: 0} 
==========
2021-08-18:15:44:15,681 INFO     [param_server.py:450] ====Start to sample for epoch 80, global virtualClock: 2278.4760295648753, round_duration: 39.20659048039421
2021-08-18:15:44:15,683 INFO     [oort.py:208] Training selector: Pacer 78: lastExploitationUtil 1777.5736268008577, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:44:15,684 INFO     [oort.py:321] scores are 25,{5: 0.05974576943174578, 6: 0.3005325265888397, 7: 0.6062325858473966, 11: 0.012771643323281024, 14: 0.0065070531027936595, 27: 0.08059091934847705, 50: 0.0031708145829313222, 51: 0.04176613446411824, 53: 0.5971993462677415, 58: 0.002691082839000961, 60: 0.0012914162808877467, 67: 0.001469835877535998, 70: 0.005737724185622785, 76: 0.001298812232984042, 79: 0.003314474660108015, 81: 0.019468523669474744, 84: 0.10253029908737558, 85: 0.016949984271037135, 87: 0.008841571880890896, 93: 0.012911752196096495, 97: 0.023691254044193172, 98: 0.1286890695266563, 105: 0.04551302719990189, 107: 0.0018345414857985607, 110: 0.02748921169395367, 119: 0.0025296118950019464},[7, 53, 6, 98, 84, 27, 5, 105, 51, 110, 97, 81, 85, 93, 11, 87, 14, 70, 79, 50, 58, 119, 107, 67, 76, 60]
2021-08-18:15:44:15,685 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:44:15,686 INFO     [oort.py:365] exploration poss is [202.          16.91829855   9.05547074   1.91505738   0.90032832]
2021-08-18:15:44:15,687 INFO     [oort.py:398] At round 78, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 66, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6055.139403614331, 'duration': 11.058674649423494, 'time_stamp': 79, 'count': 76, 'status': True, 'gradient': 20.196834152732908}, [0.8231299475852758, -3.797516424258538e-06]), ({'reward': 3913.30667263578, 'duration': 5.8943907365129, 'time_stamp': 79, 'count': 76, 'status': True, 'gradient': 21.126577909724723}, [0.5319707430234599, -3.797516424258538e-06]), ({'reward': 1358.7033445015536, 'duration': 27.689063957948644, 'time_stamp': 79, 'count': 71, 'status': True, 'gradient': 20.402035427790864}, [0.18469979967079847, -3.797516424258538e-06])]
2021-08-18:15:44:15,688 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:44:16,217 INFO     [param_server.py:553] For epoch: 80, median_reward: 920.4174166072091, dev: 4602.087083036045
2021-08-18:15:44:16,867 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5505, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:44:16,868 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 891.9925, eval_time 0.5928, test_loss 2.5505, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:44:16,938 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2916, Top-1 Accuracy: 592.0/1033 (0.5731), Top-5 Accuracy: 1.0
2021-08-18:15:44:16,940 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 892.0762, eval_time 0.6652, test_loss 2.2916, test_accuracy 0.5731, test_5_accuracy 1.0 

2021-08-18:15:44:17,10 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:17,16 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:17,51 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:44:17,58 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:17,119 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3586, Top-1 Accuracy: 598.0/1033 (0.5789), Top-5 Accuracy: 1.0
2021-08-18:15:44:17,146 INFO     [learner.py:656] After aggregation epoch 79, CumulTime 892.2857, eval_time 0.8739, test_loss 2.3586, test_accuracy 0.5789, test_5_accuracy 1.0 

2021-08-18:15:44:17,251 INFO     [learner.py:526] ====Start train round 80
2021-08-18:15:44:17,285 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:18,465 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:44:18,478 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:19,816 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:19,835 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:20,44 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:20,58 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:20,992 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:21,19 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:21,114 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:21,127 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:22,647 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:23,337 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:44:24,94 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:44:23,792 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:44:24,980 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:44:24,994 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:44:25,701 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:44:25,716 INFO     [learner.py:606] ====Pushing takes 0.014130115509033203 s
2021-08-18:15:44:25,751 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:25,760 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:44:25,760 INFO     [param_server.py:410] Lock worker 1 with localStep 80 , while globalStep is 79

2021-08-18:15:44:26,284 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:44:26,300 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:44:26,516 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:44:26,534 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:26,878 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:44:27,788 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:44:33,194 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:44:33,210 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:44:33,234 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:33,248 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:44:33,812 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:44:34,618 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:44:35,89 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:44:35,103 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:44:35,208 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:44:35,217 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:44:35,801 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:44:35,870 INFO     [learner.py:606] ====Pushing takes 0.06717753410339355 s
2021-08-18:15:44:35,931 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:35,942 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:44:35,954 INFO     [param_server.py:410] Lock worker 3 with localStep 80 , while globalStep is 79

2021-08-18:15:44:38,320 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:44:39,298 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:44:39,829 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:44:39,887 INFO     [learner.py:606] ====Pushing takes 0.05190587043762207 s
2021-08-18:15:44:39,946 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:39,956 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:44:39,961 INFO     [param_server.py:381] ====After aggregation in epoch: 79, virtual_clock: 2321.7144267358085, top_1: : 57.8251 % (1792.0), top_5: : 100.0 % (3099.0), test loss: 2.4002127868157843, test len: 3099.0
2021-08-18:15:44:39,968 INFO     [param_server.py:410] Lock worker 2 with localStep 80 , while globalStep is 80

2021-08-18:15:44:39,970 INFO     [param_server.py:441] ====Epoch 81 completes 20 clients with loss 5.799200430063556, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:44:39,971 INFO     [param_server.py:450] ====Start to sample for epoch 81, global virtualClock: 2321.7144267358085, round_duration: 43.23839717093311
2021-08-18:15:44:39,975 INFO     [oort.py:208] Training selector: Pacer 79: lastExploitationUtil 1715.563515128696, lastExplorationUtil 0.009999000099990002, last_util_record 0
2021-08-18:15:44:39,977 INFO     [oort.py:321] scores are 26,{5: 0.0068782910572213855, 6: 0.4889295542014292, 7: 1.0739040581807506, 11: 0.012710111082985122, 14: 0.0061966822200792875, 27: 0.024768305617060983, 50: 0.04212274063419034, 51: 0.2890263028383975, 53: 0.06744298050968398, 58: 0.00256272461862012, 60: 0.0011435829088501926, 67: 0.001399728218731086, 70: 0.005464048453746741, 76: 0.0013111729558715572, 79: 0.0032985059201363406, 81: 0.019374726665728727, 84: 0.03401027571109869, 85: 0.008228782941935424, 87: 0.008798974251768513, 93: 0.012849544928115316, 97: 0.023577112433763037, 98: 0.11125346903341134, 105: 0.031154791254301137, 107: 0.007431751279899112, 110: 0.007845039592035391, 113: 0.0739040595564463, 119: 0.014124730133201029},[7, 6, 51, 98, 113, 53, 50, 84, 105, 27, 97, 81, 119, 93, 11, 87, 85, 110, 107, 5, 14, 70, 79, 58, 67, 76, 60]
2021-08-18:15:44:39,978 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:44:39,979 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:44:39,980 INFO     [oort.py:398] At round 79, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7269.059595015491, 'duration': 5.8943907365129, 'time_stamp': 80, 'count': 77, 'status': True, 'gradient': 21.132340279049114}, [1.0, -3.750046875585948e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 80, 'count': 1, 'status': True, 'gradient': 20.931751593110135}, [1.3756956608329928e-09, -3.750046875585948e-06]), ({'reward': 3198.3640166345535, 'duration': 12.029357192292537, 'time_stamp': 80, 'count': 77, 'status': True, 'gradient': 27.035938328204356}, [0.4399961756249065, -3.750046875585948e-06])]
2021-08-18:15:44:39,981 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:44:40,452 INFO     [param_server.py:541] Handle Wight 0.06637763977050781 | Send 0.4804079532623291
2021-08-18:15:44:40,453 INFO     [param_server.py:553] For epoch: 81, median_reward: 904.3841084159978, dev: 4521.920542079989
2021-08-18:15:44:41,145 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3909, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:44:42,248 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 917.3843, eval_time 1.7503, test_loss 2.3909, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:44:41,67 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3494, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:44:41,249 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.208, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:44:42,254 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 917.3784, eval_time 1.7557, test_loss 2.3494, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:44:42,258 INFO     [learner.py:656] After aggregation epoch 80, CumulTime 917.3975, eval_time 1.7626, test_loss 2.208, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:44:42,365 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:44:42,371 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:44:42,373 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:44:42,381 INFO     [learner.py:526] ====Start train round 81
2021-08-18:15:44:42,393 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:44:42,403 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:44:44,854 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:44:44,875 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:44:46,136 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:44:47,12 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:44:47,603 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:44:47,630 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:44:48,581 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:44:48,605 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:44:49,509 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:44:49,615 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:44:52,2 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:44:52,49 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:44:52,683 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:44:52,702 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:44:52,844 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:44:52,874 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:44:53,309 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:44:54,210 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:44:54,640 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:44:54,662 INFO     [learner.py:606] ====Pushing takes 0.021245718002319336 s
2021-08-18:15:44:54,665 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:44:54,704 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:44:54,722 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:44:54,722 INFO     [param_server.py:410] Lock worker 1 with localStep 81 , while globalStep is 80

2021-08-18:15:44:56,75 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:44:56,673 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:44:56,682 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:44:59,182 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:44:59,760 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:00,502 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:00,505 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:01,133 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:45:01,156 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:45:02,41 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:45:02,41 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:45:02,525 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:45:02,568 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:45:03,47 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:45:03,56 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:45:03,603 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:45:03,685 INFO     [learner.py:606] ====Pushing takes 0.07326889038085938 s
2021-08-18:15:45:03,752 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:03,764 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:45:03,764 INFO     [param_server.py:410] Lock worker 3 with localStep 81 , while globalStep is 80

2021-08-18:15:45:03,857 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:45:03,897 INFO     [learner.py:606] ====Pushing takes 0.03851771354675293 s
2021-08-18:15:45:03,942 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:03,950 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:45:03,951 INFO     [param_server.py:381] ====After aggregation in epoch: 80, virtual_clock: 2360.1104482945943, top_1: : 59.5999 % (1847.0), top_5: : 100.0 % (3099.0), test loss: 2.3161131957614867, test len: 3099.0
2021-08-18:15:45:04,58 INFO     [param_server.py:410] Lock worker 2 with localStep 81 , while globalStep is 81

2021-08-18:15:45:04,59 INFO     [param_server.py:441] ====Epoch 82 completes 20 clients with loss 5.242300753107669, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:45:04,59 INFO     [param_server.py:450] ====Start to sample for epoch 82, global virtualClock: 2360.1104482945943, round_duration: 38.39602155878561
2021-08-18:15:45:04,60 INFO     [oort.py:208] Training selector: Pacer 80: lastExploitationUtil 3320.217437897971, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:45:04,62 INFO     [oort.py:321] scores are 26,{5: 0.03079358848536619, 6: 0.3260754640029182, 7: 0.07355208740337557, 11: 0.03475983329209547, 14: 0.00783183932636992, 27: 0.03058840471690993, 50: 0.03895218781611275, 51: 0.04136695508156488, 53: 0.4910891791810358, 58: 0.0019283834065380516, 60: 0.0014453472488029002, 67: 0.0017690832158805737, 70: 0.006905880928116551, 76: 0.0015632404658704247, 79: 0.04791506629109485, 81: 0.08659600803867679, 84: 0.19084298537689856, 85: 0.06071077194317142, 87: 0.02278752840158091, 93: 0.012788348262851301, 97: 0.07871221330761169, 98: 0.03328075960556869, 105: 0.013181100181300974, 107: 0.009392813746219364, 110: 0.0636231700364929, 113: 0.4263545790951482, 119: 0.0025054351564240914},[53, 113, 6, 84, 81, 97, 7, 110, 85, 79, 51, 50, 11, 98, 5, 27, 87, 105, 93, 107, 14, 70, 119, 58, 67, 76, 60]
2021-08-18:15:45:04,64 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:45:04,64 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:45:04,65 INFO     [oort.py:398] At round 80, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3819.7297651092613, 'duration': 8.009219946401625, 'time_stamp': 81, 'count': 2, 'status': True, 'gradient': 20.939202352232407}, [0.3528024926154071, -3.7037494290052997e-06]), ({'reward': 1874.9582702505768, 'duration': 15.972045438625893, 'time_stamp': 81, 'count': 77, 'status': True, 'gradient': 20.93689289179871}, [0.17317668984721604, -3.7037494290052997e-06]), ({'reward': 7193.23910344967, 'duration': 11.058674649423494, 'time_stamp': 81, 'count': 78, 'status': True, 'gradient': 20.213560396462302}, [0.6643914503142228, -3.7037494290052997e-06])]
2021-08-18:15:45:04,66 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:45:04,677 INFO     [param_server.py:553] For epoch: 82, median_reward: 1265.2901294274293, dev: 6326.450647137146
2021-08-18:15:45:05,443 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.222, Top-1 Accuracy: 583.0/1033 (0.5644), Top-5 Accuracy: 1.0
2021-08-18:15:45:05,443 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7678, Top-1 Accuracy: 576.0/1033 (0.5576), Top-5 Accuracy: 1.0
2021-08-18:15:45:05,444 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 940.5683, eval_time 0.7044, test_loss 2.222, test_accuracy 0.5644, test_5_accuracy 1.0 

2021-08-18:15:45:05,444 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 940.58, eval_time 0.705, test_loss 2.7678, test_accuracy 0.5576, test_5_accuracy 1.0 

2021-08-18:15:45:05,536 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:05,554 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:05,552 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:45:05,584 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:45:05,570 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1847, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:45:05,646 INFO     [learner.py:656] After aggregation epoch 81, CumulTime 940.7854, eval_time 0.9073, test_loss 2.1847, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:45:05,782 INFO     [learner.py:526] ====Start train round 82
2021-08-18:15:45:05,814 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:45:07,708 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:45:07,741 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:45:08,688 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:45:09,849 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:45:10,299 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:45:10,309 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:45:10,385 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:45:10,395 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:45:12,517 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:45:12,524 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:45:13,488 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:45:13,489 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:45:14,168 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:45:14,219 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:45:14,638 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:45:14,640 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:45:15,252 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:45:15,268 INFO     [learner.py:606] ====Pushing takes 0.014241456985473633 s
2021-08-18:15:45:15,329 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:15,377 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:45:15,377 INFO     [param_server.py:410] Lock worker 1 with localStep 82 , while globalStep is 81

2021-08-18:15:45:15,873 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:45:16,385 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:45:17,403 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:45:17,404 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:45:17,997 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:45:20,441 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:45:22,73 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:45:22,81 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:23,256 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:45:23,783 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:45:24,809 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:25,674 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:26,405 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:45:26,991 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:45:29,584 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:45:29,603 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:45:30,203 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:45:30,292 INFO     [learner.py:606] ====Pushing takes 0.0504002571105957 s
2021-08-18:15:45:30,361 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:30,375 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:45:30,376 INFO     [param_server.py:410] Lock worker 2 with localStep 82 , while globalStep is 81

2021-08-18:15:45:30,320 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:45:31,52 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:45:31,717 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:45:31,761 INFO     [learner.py:606] ====Pushing takes 0.04276585578918457 s
2021-08-18:15:45:31,797 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:31,861 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:45:31,861 INFO     [param_server.py:381] ====After aggregation in epoch: 81, virtual_clock: 2404.477085384697, top_1: : 56.7925 % (1760.0), top_5: : 100.0 % (3099.0), test loss: 2.391486245172995, test len: 3099.0
2021-08-18:15:45:32,43 INFO     [param_server.py:410] Lock worker 3 with localStep 82 , while globalStep is 82

2021-08-18:15:45:32,44 INFO     [param_server.py:441] ====Epoch 83 completes 20 clients with loss 5.3267787264989765, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:45:32,44 INFO     [param_server.py:450] ====Start to sample for epoch 83, global virtualClock: 2404.477085384697, round_duration: 44.36663709010263
2021-08-18:15:45:32,45 INFO     [oort.py:208] Training selector: Pacer 81: lastExploitationUtil 1413.9180157968751, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:45:32,46 INFO     [oort.py:321] scores are 26,{5: 0.056383564323754416, 6: 0.616373110721304, 7: 0.07320576886603504, 11: 0.13873554629726628, 14: 0.0066858031927293044, 27: 0.03629665244434632, 50: 0.003844071843741679, 51: 0.3163363243855366, 53: 0.04871722449108634, 58: 0.002765007439261127, 60: 0.0012338490165538056, 67: 0.001510212572047281, 70: 0.005895340651633439, 76: 0.0027297730182126007, 79: 0.003267339621693176, 81: 0.019191662415386595, 84: 0.03368892585494848, 85: 0.008151032375102491, 87: 0.06637393192957253, 93: 0.09468780720536064, 97: 0.06269267620096208, 98: 0.03312405781238949, 105: 0.0031014935249223433, 107: 0.00801835961084411, 110: 0.007770914866737424, 113: 0.9111494321982031, 119: 0.0024936383649337857},[113, 6, 51, 11, 93, 7, 87, 97, 5, 53, 27, 84, 98, 81, 85, 107, 110, 14, 70, 50, 79, 105, 58, 76, 119, 67, 60]
2021-08-18:15:45:32,47 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:45:32,48 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:45:32,49 INFO     [oort.py:398] At round 81, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4713.1935512614455, 'duration': 8.009219946401625, 'time_stamp': 82, 'count': 3, 'status': True, 'gradient': 20.94757242723839}, [0.8379436651100399, -3.658581202209786e-06]), ({'reward': 2751.911104798506, 'duration': 12.029357192292537, 'time_stamp': 82, 'count': 79, 'status': True, 'gradient': 27.057755137971384}, [0.48925276857612965, -3.658581202209786e-06]), ({'reward': 1413.9234539430897, 'duration': 66.93898235209988, 'time_stamp': 82, 'count': 41, 'status': True, 'gradient': 20.244940269845763}, [0.25137570279732707, -3.658581202209786e-06])]
2021-08-18:15:45:32,50 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:45:37,513 INFO     [param_server.py:553] For epoch: 83, median_reward: 866.179023739507, dev: 4330.895118697535
2021-08-18:15:45:38,179 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1823, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:45:41,483 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 976.6074, eval_time 3.9101, test_loss 2.1823, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:45:41,677 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:45:41,698 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:45:42,57 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4289, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:45:43,71 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 978.2069, eval_time 5.5006, test_loss 2.4289, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:45:42,132 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4574, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:45:43,132 INFO     [learner.py:656] After aggregation epoch 82, CumulTime 978.2708, eval_time 5.5641, test_loss 2.4574, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:45:43,224 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:45:43,249 INFO     [learner.py:526] ====Start train round 83
2021-08-18:15:45:43,251 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:45:43,285 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:45:44,655 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:45:44,733 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:45:46,885 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:45:46,915 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:45:46,885 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:45:46,941 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:45:47,390 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:45:47,406 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:45:48,181 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:45:48,190 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:45:48,611 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:45:48,627 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:45:49,317 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:45:49,331 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:45:49,375 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:45:49,386 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:45:49,954 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:45:49,973 INFO     [learner.py:606] ====Pushing takes 0.01856517791748047 s
2021-08-18:15:45:50,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:50,89 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:45:50,90 INFO     [param_server.py:410] Lock worker 1 with localStep 83 , while globalStep is 82

2021-08-18:15:45:50,494 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:45:50,504 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:45:50,776 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:45:50,797 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:45:51,114 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:45:51,126 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:45:53,543 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:45:53,554 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:45:54,102 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:45:54,116 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:45:54,165 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:45:54,179 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:45:54,788 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:45:54,803 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:45:54,818 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:45:54,829 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:45:55,472 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:45:55,476 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:45:55,486 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:45:55,524 INFO     [learner.py:606] ====Pushing takes 0.046701669692993164 s
2021-08-18:15:45:55,570 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:45:55,578 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:45:55,578 INFO     [param_server.py:410] Lock worker 3 with localStep 83 , while globalStep is 82

2021-08-18:15:45:56,263 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:45:56,315 INFO     [learner.py:606] ====Pushing takes 0.05045032501220703 s
2021-08-18:15:45:56,360 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:00,60 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:00,61 INFO     [param_server.py:381] ====After aggregation in epoch: 82, virtual_clock: 2441.820604657759, top_1: : 58.9545 % (1827.0), top_5: : 100.0 % (3099.0), test loss: 2.3562031233752214, test len: 3099.0
2021-08-18:15:46:00,98 INFO     [param_server.py:410] Lock worker 2 with localStep 83 , while globalStep is 83

2021-08-18:15:46:00,98 INFO     [param_server.py:441] ====Epoch 84 completes 20 clients with loss 5.898202607306846, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:00,99 INFO     [param_server.py:450] ====Start to sample for epoch 84, global virtualClock: 2441.820604657759, round_duration: 37.343519273061496
2021-08-18:15:46:00,100 INFO     [oort.py:208] Training selector: Pacer 82: lastExploitationUtil 1495.7131206535976, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:46:00,101 INFO     [oort.py:321] scores are 26,{5: 0.008478152247262326, 6: 0.1735531838049417, 7: 0.07286494697045429, 11: 0.012531403222077981, 14: 0.005710054360358534, 27: 0.09460377780308259, 50: 0.0066594422796158285, 51: 0.04098049552036312, 53: 0.21525510940857331, 58: 0.002361472859707616, 60: 0.0010537768991852523, 67: 0.0012398728861885643, 70: 0.005034954608036632, 76: 0.0011397307409483893, 79: 0.0032521279669203203, 81: 0.10637867670862516, 84: 0.09395852949375508, 85: 0.03372120991657823, 87: 0.0936590801307045, 93: 0.012668876586765592, 97: 0.023245611371192042, 98: 0.03296984313302993, 105: 0.003087053994832442, 107: 0.006848132967571324, 110: 0.007734736052194478, 113: 0.8518856309985846, 119: 0.013336502799452758},[113, 53, 6, 81, 27, 84, 87, 7, 51, 85, 98, 97, 119, 93, 11, 5, 110, 107, 50, 14, 70, 79, 105, 58, 67, 76, 60]
2021-08-18:15:46:00,102 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:46:00,103 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:00,131 INFO     [oort.py:398] At round 82, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5224.614680612231, 'duration': 26.145070720211294, 'time_stamp': 83, 'count': 76, 'status': True, 'gradient': 16.5998274747877}, [0.7137933668223878, -3.6145013795346962e-06]), ({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 83, 'count': 80, 'status': True, 'gradient': 27.07185773839821}, [1.3662150709793027e-09, -3.6145013795346962e-06]), ({'reward': 2436.756132155559, 'duration': 17.619275735353515, 'time_stamp': 83, 'count': 79, 'status': True, 'gradient': 18.25977022420703}, [0.33291193035637345, -3.6145013795346962e-06])]
2021-08-18:15:46:00,139 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 50, 105, 119, 107]
2021-08-18:15:46:00,529 INFO     [param_server.py:553] For epoch: 84, median_reward: 868.0154750042018, dev: 4340.077375021009
2021-08-18:15:46:01,128 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2531, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:46:01,128 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 996.2531, eval_time 0.5629, test_loss 2.2531, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:46:01,251 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7317, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:46:01,251 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 996.3875, eval_time 0.6859, test_loss 2.7317, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:46:01,275 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:01,282 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:01,281 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1401, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:46:01,372 INFO     [learner.py:656] After aggregation epoch 83, CumulTime 996.5113, eval_time 0.8089, test_loss 2.1401, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:46:01,395 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:01,424 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:01,553 INFO     [learner.py:526] ====Start train round 84
2021-08-18:15:46:01,577 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:03,836 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:03,907 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:05,115 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:05,133 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:05,237 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:05,328 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:05,942 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:09,575 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:10,113 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:10,133 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:12,129 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:12,147 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:12,289 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:12,303 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:13,4 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:13,16 INFO     [learner.py:606] ====Pushing takes 0.009742021560668945 s
2021-08-18:15:46:13,38 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:13,82 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:46:13,83 INFO     [param_server.py:410] Lock worker 1 with localStep 84 , while globalStep is 83

2021-08-18:15:46:13,355 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:13,364 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:14,17 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:14,30 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:14,168 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:14,186 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:16,871 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:46:16,880 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:46:17,156 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:46:17,180 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:46:17,514 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:17,526 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:18,230 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:18,240 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:18,360 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:18,383 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:46:18,801 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:18,847 INFO     [learner.py:606] ====Pushing takes 0.045052289962768555 s
2021-08-18:15:46:18,909 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:18,920 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 11 clients
2021-08-18:15:46:18,920 INFO     [param_server.py:410] Lock worker 3 with localStep 84 , while globalStep is 83

2021-08-18:15:46:24,666 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:46:25,753 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:46:26,295 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:46:26,315 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:46:26,937 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:46:27,44 INFO     [learner.py:606] ====Pushing takes 0.10158276557922363 s
2021-08-18:15:46:27,117 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:27,128 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:27,129 INFO     [param_server.py:381] ====After aggregation in epoch: 83, virtual_clock: 2486.1872417478617, top_1: : 58.6964 % (1819.0), top_5: : 100.0 % (3099.0), test loss: 2.3749553296301102, test len: 3099.0
2021-08-18:15:46:27,177 INFO     [param_server.py:410] Lock worker 2 with localStep 84 , while globalStep is 84

2021-08-18:15:46:27,178 INFO     [param_server.py:441] ====Epoch 85 completes 20 clients with loss 4.63795143603338, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:27,178 INFO     [param_server.py:450] ====Start to sample for epoch 85, global virtualClock: 2486.1872417478617, round_duration: 44.36663709010263
2021-08-18:15:46:27,179 INFO     [oort.py:208] Training selector: Pacer 83: lastExploitationUtil 2469.045972998898, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:46:27,180 INFO     [oort.py:321] scores are 26,{5: 0.029299442295348015, 6: 0.04165577490264381, 7: 0.8772303877542803, 11: 0.012473708265472862, 14: 0.006680120106048364, 27: 0.04896015559423218, 50: 0.0030968462765707345, 51: 0.04079182008882501, 53: 0.19747882051806548, 58: 0.0027626571192624983, 60: 0.0012328002164754704, 67: 0.0015089288565824101, 70: 0.005890329476315964, 76: 0.0013333565247551657, 79: 0.0032565976194797743, 81: 0.019014364750525665, 84: 0.18070117162728513, 85: 0.04636667616916385, 87: 0.042280820885799694, 93: 0.012610548698662743, 97: 0.23352783254057993, 98: 0.0328180489855488, 105: 0.045439632272472295, 107: 0.01775363692626575, 110: 0.0076991250952270105, 113: 0.10190916383291282, 119: 0.0024706014726864566},[7, 97, 53, 84, 113, 27, 85, 105, 87, 6, 51, 98, 5, 81, 107, 93, 11, 110, 14, 70, 79, 50, 58, 119, 67, 76, 60]
2021-08-18:15:46:27,182 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:46:27,182 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:27,183 INFO     [oort.py:398] At round 83, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2198.781623346066, 'duration': 11.058674649423494, 'time_stamp': 84, 'count': 81, 'status': True, 'gradient': 20.236763811177717}, [0.22421544658692194, -3.5714710889415383e-06]), ({'reward': 7891.319756650621, 'duration': 5.8943907365129, 'time_stamp': 84, 'count': 81, 'status': True, 'gradient': 21.164539450591022}, [0.804700914206686, -3.5714710889415383e-06]), ({'reward': 6467.202848868153, 'duration': 15.972045438625893, 'time_stamp': 84, 'count': 80, 'status': True, 'gradient': 20.963313703499356}, [0.6594793715835845, -3.5714710889415383e-06])]
2021-08-18:15:46:27,184 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:46:27,562 INFO     [param_server.py:553] For epoch: 85, median_reward: 1067.1224586735343, dev: 5335.612293367672
2021-08-18:15:46:28,263 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1438, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:46:28,325 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1023.4494, eval_time 0.7019, test_loss 2.1438, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:46:28,403 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3798, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:46:28,404 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1023.5397, eval_time 0.7808, test_loss 2.3798, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:46:28,444 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:28,460 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:28,463 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2704, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:46:28,466 INFO     [learner.py:656] After aggregation epoch 84, CumulTime 1023.6055, eval_time 0.8489, test_loss 2.2704, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:46:28,500 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:28,528 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:28,696 INFO     [learner.py:526] ====Start train round 85
2021-08-18:15:46:28,726 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:29,926 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:29,943 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:31,156 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:31,165 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:31,429 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:31,440 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:31,715 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:31,724 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:32,382 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:32,394 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:33,18 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:33,28 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:33,647 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:33,661 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:46:33,878 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:33,890 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:34,271 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:46:34,290 INFO     [learner.py:606] ====Pushing takes 0.017022371292114258 s
2021-08-18:15:46:34,339 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:34,415 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:46:34,416 INFO     [param_server.py:410] Lock worker 1 with localStep 85 , while globalStep is 84

2021-08-18:15:46:34,987 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:34,998 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:35,16 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:35,50 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:35,587 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:35,598 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:41,524 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:46:41,542 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:46:42,372 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:42,529 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:46:43,560 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:43,565 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:46:44,199 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:44,211 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:46:44,153 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:44,262 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:44,954 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:44,967 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:46:44,981 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:46:44,993 INFO     [learner.py:606] ====Pushing takes 0.03743290901184082 s
2021-08-18:15:46:45,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:45,72 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:46:45,72 INFO     [param_server.py:410] Lock worker 3 with localStep 85 , while globalStep is 84

2021-08-18:15:46:45,667 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:46:45,714 INFO     [learner.py:606] ====Pushing takes 0.04584169387817383 s
2021-08-18:15:46:45,749 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:45,759 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:46:45,759 INFO     [param_server.py:381] ====After aggregation in epoch: 84, virtual_clock: 2523.5307610209234, top_1: : 59.2126 % (1835.0), top_5: : 100.0 % (3099.0), test loss: 2.2646745134282997, test len: 3099.0
2021-08-18:15:46:45,764 INFO     [param_server.py:410] Lock worker 2 with localStep 85 , while globalStep is 85

2021-08-18:15:46:45,765 INFO     [param_server.py:441] ====Epoch 86 completes 20 clients with loss 4.66471779300964, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:46:45,766 INFO     [param_server.py:450] ====Start to sample for epoch 86, global virtualClock: 2523.5307610209234, round_duration: 37.343519273061496
2021-08-18:15:46:45,767 INFO     [oort.py:208] Training selector: Pacer 84: lastExploitationUtil 3183.12154419088, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:46:45,768 INFO     [oort.py:321] scores are 26,{5: 0.027442978529972906, 6: 0.35171313171829593, 7: 0.07219920887862946, 11: 0.03269670692816295, 14: 0.006799860837349214, 27: 0.028666724937025947, 50: 0.003082744670645464, 51: 0.04060607300275908, 53: 0.2266897482717122, 58: 0.002812177573766673, 60: 0.00103658154034619, 67: 0.0015359763111041545, 70: 0.005995913260424638, 76: 0.0013572568563097413, 79: 0.003222414564837621, 81: 0.1958484888477885, 84: 0.11825240463587257, 85: 0.11938308405062431, 87: 0.010397918470181206, 93: 0.01255312609115544, 97: 0.13311536006843347, 98: 0.03266861076592141, 105: 0.02680054599620667, 107: 0.008155150237873464, 110: 0.007664066839709569, 113: 0.777791742034737, 119: 0.01167312007439235},[113, 6, 53, 81, 97, 85, 84, 7, 51, 11, 98, 27, 5, 105, 93, 119, 87, 107, 110, 14, 70, 79, 50, 58, 67, 76, 60]
2021-08-18:15:46:45,774 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:46:45,774 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:46:45,775 INFO     [oort.py:398] At round 84, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 85, 'count': 82, 'status': True, 'gradient': 21.17705979714303}, [8.102717122729721e-10, -3.5294532876857404e-06]), ({'reward': 4258.5805403901395, 'duration': 15.972045438625893, 'time_stamp': 85, 'count': 81, 'status': True, 'gradient': 20.973230133299772}, [0.3450599251700012, -3.5294532876857404e-06]), ({'reward': 8328.776732428241, 'duration': 17.619275735353515, 'time_stamp': 85, 'count': 81, 'status': True, 'gradient': 18.273203516499944}, [0.6748564089509789, -3.5294532876857404e-06])]
2021-08-18:15:46:45,775 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:46:46,210 INFO     [param_server.py:553] For epoch: 86, median_reward: 1242.4148064058534, dev: 6212.074032029267
2021-08-18:15:46:46,818 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2319, Top-1 Accuracy: 597.0/1033 (0.5779), Top-5 Accuracy: 1.0
2021-08-18:15:46:46,819 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1041.9553, eval_time 0.5738, test_loss 2.2319, test_accuracy 0.5779, test_5_accuracy 1.0 

2021-08-18:15:46:46,896 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3895, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:46:46,898 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1042.0223, eval_time 0.648, test_loss 2.3895, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:46:46,931 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:46:46,934 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3906, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:46:46,937 INFO     [learner.py:656] After aggregation epoch 85, CumulTime 1042.0765, eval_time 0.6945, test_loss 2.3906, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:46:46,942 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:46:46,990 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:46:46,998 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:46:47,125 INFO     [learner.py:526] ====Start train round 86
2021-08-18:15:46:47,162 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:46:48,768 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:46:48,780 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:46:49,937 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:46:49,951 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:46:50,98 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:46:50,112 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:46:50,373 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:46:50,394 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:46:51,317 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:46:51,335 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:46:51,929 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:46:51,957 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:46:52,591 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:46:52,604 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:46:52,740 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:46:52,769 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:46:53,479 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:46:53,500 INFO     [learner.py:606] ====Pushing takes 0.019408226013183594 s
2021-08-18:15:46:53,534 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:53,633 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:46:53,634 INFO     [param_server.py:410] Lock worker 1 with localStep 86 , while globalStep is 85

2021-08-18:15:46:53,849 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:46:53,859 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:46:54,554 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:46:54,574 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:46:54,634 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:46:54,660 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:46:57,587 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:46:57,615 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:46:57,827 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:46:57,845 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:46:58,323 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:46:58,405 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:46:59,36 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:46:59,51 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:46:59,58 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:46:59,68 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:46:59,720 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:46:59,754 INFO     [learner.py:606] ====Pushing takes 0.033106327056884766 s
2021-08-18:15:46:59,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:46:59,826 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:46:59,826 INFO     [param_server.py:410] Lock worker 3 with localStep 86 , while globalStep is 85

2021-08-18:15:47:05,404 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:47:05,426 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:47:06,53 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:47:06,91 INFO     [learner.py:606] ====Pushing takes 0.03638100624084473 s
2021-08-18:15:47:06,141 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:06,149 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:47:06,150 INFO     [param_server.py:381] ====After aggregation in epoch: 85, virtual_clock: 2567.897398111026, top_1: : 58.1478 % (1802.0), top_5: : 100.0 % (3099.0), test loss: 2.3373087070606373, test len: 3099.0
2021-08-18:15:47:06,172 INFO     [param_server.py:410] Lock worker 2 with localStep 86 , while globalStep is 86

2021-08-18:15:47:06,174 INFO     [param_server.py:441] ====Epoch 87 completes 20 clients with loss 5.249129106744143, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:47:06,188 INFO     [param_server.py:450] ====Start to sample for epoch 87, global virtualClock: 2567.897398111026, round_duration: 44.36663709010263
2021-08-18:15:47:13,435 INFO     [oort.py:208] Training selector: Pacer 85: lastExploitationUtil 2172.7135473753233, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:47:13,441 INFO     [oort.py:321] scores are 26,{5: 0.006689353482786881, 6: 0.12514762160510357, 7: 0.6287371723770551, 11: 0.04353304545284479, 14: 0.005673807441218103, 27: 0.0945163985912119, 50: 0.012221764411479227, 51: 0.040423177045787566, 53: 0.04783096280065999, 58: 0.0023464824392323952, 60: 0.001047087616799082, 67: 0.0017240746843861744, 70: 0.005002993162306756, 76: 0.001132495831190643, 79: 0.028171874467326965, 81: 0.12421566179945236, 84: 0.03307605833860798, 85: 0.008002749138384028, 87: 0.008557278045718113, 93: 0.012496584893259503, 97: 0.02292948028235415, 98: 0.04657320363318263, 105: 0.012042433999744775, 107: 0.006804661626271714, 110: 0.08919066004678161, 113: 0.07187401261058489, 119: 0.002448274201114835},[7, 6, 81, 27, 110, 113, 53, 98, 11, 51, 84, 79, 97, 93, 50, 105, 87, 85, 107, 5, 14, 70, 119, 58, 67, 76, 60]
2021-08-18:15:47:13,450 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:47:13,460 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:47:13,520 INFO     [oort.py:398] At round 85, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 86, 'count': 83, 'status': True, 'gradient': 20.251602765172674}, [9.369729319353906e-10, -3.4884126559611187e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 86, 'count': 7, 'status': True, 'gradient': 20.980299688999583}, [9.369729319353906e-10, -3.4884126559611187e-06]), ({'reward': 5943.225014933284, 'duration': 5.8943907365129, 'time_stamp': 86, 'count': 83, 'status': True, 'gradient': 21.182327727319695}, [0.5568631607034431, -3.4884126559611187e-06])]
2021-08-18:15:47:13,521 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:47:13,944 INFO     [param_server.py:553] For epoch: 87, median_reward: 1029.4428844027889, dev: 5147.214422013944
2021-08-18:15:47:14,668 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3889, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:47:14,724 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2209, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:47:14,730 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2189, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:47:14,758 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1069.8827, eval_time 0.7695, test_loss 2.2209, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:47:14,758 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1069.8937, eval_time 0.7691, test_loss 2.3889, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:47:14,758 INFO     [learner.py:656] After aggregation epoch 86, CumulTime 1069.8975, eval_time 0.7717, test_loss 2.2189, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:47:22,43 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:47:22,43 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:47:22,43 INFO     [learner.py:526] ====Start train round 87
2021-08-18:15:47:22,57 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:47:22,60 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:47:22,89 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:47:28,662 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:47:28,672 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:47:29,886 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:47:29,898 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:47:29,954 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:47:29,963 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:47:30,617 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:47:37,408 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:47:37,620 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:47:37,616 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:47:38,530 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:47:38,626 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:47:39,127 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:47:39,181 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:47:39,758 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:47:39,772 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:47:39,850 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:47:39,872 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:47:40,346 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:47:40,374 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:47:40,462 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:47:40,477 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:47:40,573 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:47:40,591 INFO     [learner.py:606] ====Pushing takes 0.016507387161254883 s
2021-08-18:15:47:40,628 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:40,759 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:47:40,759 INFO     [param_server.py:410] Lock worker 1 with localStep 87 , while globalStep is 86

2021-08-18:15:47:50,274 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:47:50,285 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:47:50,993 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:47:51,7 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:47:51,212 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:47:51,233 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:47:51,682 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:47:51,694 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:47:51,881 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:47:51,900 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:47:52,315 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:47:52,365 INFO     [learner.py:606] ====Pushing takes 0.04855084419250488 s
2021-08-18:15:47:52,422 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:52,432 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:47:52,433 INFO     [param_server.py:410] Lock worker 3 with localStep 87 , while globalStep is 86

2021-08-18:15:47:52,543 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:47:52,558 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:47:53,206 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:47:53,418 INFO     [learner.py:606] ====Pushing takes 0.07769775390625 s
2021-08-18:15:47:53,468 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:47:53,485 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:47:53,486 INFO     [param_server.py:381] ====After aggregation in epoch: 86, virtual_clock: 2605.240917384088, top_1: : 60.3743 % (1871.0), top_5: : 100.0 % (3099.0), test loss: 2.2762091866245977, test len: 3099.0
2021-08-18:15:47:53,502 INFO     [param_server.py:410] Lock worker 2 with localStep 87 , while globalStep is 87

2021-08-18:15:47:53,502 INFO     [param_server.py:441] ====Epoch 88 completes 20 clients with loss 5.336357653315367, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:47:53,503 INFO     [param_server.py:450] ====Start to sample for epoch 88, global virtualClock: 2605.240917384088, round_duration: 37.343519273061496
2021-08-18:15:47:53,504 INFO     [oort.py:208] Training selector: Pacer 86: lastExploitationUtil 2190.419531524544, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:47:53,505 INFO     [oort.py:321] scores are 26,{5: 0.0066595467387235915, 6: 0.041095389739390795, 7: 0.38945245968940717, 11: 0.01230590245561686, 14: 0.005745372471885613, 27: 0.06856595552323935, 50: 0.03362331667548959, 51: 0.04024305750276607, 53: 0.047617835288387145, 58: 0.0023760791588010787, 60: 0.00106029477234395, 67: 0.0012977847968321616, 70: 0.005066097059081399, 76: 0.0011415938508186735, 79: 0.02217480942905743, 81: 0.10237632334525723, 84: 0.03292867644167904, 85: 0.007967090102576707, 87: 0.008519148113245048, 93: 0.019525599180111868, 97: 0.04053368103383697, 98: 0.28898041044558215, 105: 0.045398294080114206, 107: 0.006890490379364121, 110: 0.00759555060925291, 112: 0.16104566792447084, 113: 0.07155375291669996, 119: 0.0024373650627807397},[7, 98, 112, 81, 113, 27, 53, 105, 6, 97, 51, 50, 84, 79, 93, 11, 87, 85, 110, 107, 5, 14, 70, 119, 58, 67, 76, 60]
2021-08-18:15:47:53,506 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:47:53,507 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:47:53,507 INFO     [oort.py:398] At round 86, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 87, 'count': 85, 'status': True, 'gradient': 20.88403916341453}, [9.467225779174729e-10, -3.448315497879289e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 87, 'count': 8, 'status': True, 'gradient': 20.98842339258005}, [9.467225779174729e-10, -3.448315497879289e-06]), ({'reward': 5990.222293382781, 'duration': 13.411352670399307, 'time_stamp': 87, 'count': 83, 'status': True, 'gradient': 18.080914239239576}, [0.567106923413174, -3.448315497879289e-06])]
2021-08-18:15:47:53,508 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 107]
2021-08-18:15:48:06,542 INFO     [param_server.py:553] For epoch: 88, median_reward: 1024.859096698439, dev: 5124.295483492196
2021-08-18:15:48:07,233 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.397, Top-1 Accuracy: 594.0/1033 (0.575), Top-5 Accuracy: 1.0
2021-08-18:15:48:07,162 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3056, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:48:07,241 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1122.3654, eval_time 0.6627, test_loss 2.3056, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:48:07,241 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1122.3765, eval_time 0.6645, test_loss 2.397, test_accuracy 0.575, test_5_accuracy 1.0 

2021-08-18:15:48:07,263 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3802, Top-1 Accuracy: 601.0/1033 (0.5818), Top-5 Accuracy: 1.0
2021-08-18:15:48:07,294 INFO     [learner.py:656] After aggregation epoch 87, CumulTime 1122.4337, eval_time 0.7188, test_loss 2.3802, test_accuracy 0.5818, test_5_accuracy 1.0 

2021-08-18:15:48:07,349 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:48:07,353 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:48:07,363 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:48:07,369 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:48:07,411 INFO     [learner.py:526] ====Start train round 88
2021-08-18:15:48:07,429 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:48:08,621 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:48:08,639 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:48:14,490 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:48:14,652 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:48:15,118 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:48:15,128 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:48:15,786 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:48:15,795 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:48:15,816 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:48:15,837 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:48:25,18 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:48:25,133 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:48:25,413 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:48:25,493 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:48:25,907 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:48:25,934 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:48:26,644 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:48:26,654 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:48:26,657 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:48:26,673 INFO     [learner.py:606] ====Pushing takes 0.014828681945800781 s
2021-08-18:15:48:26,692 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:48:26,722 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:48:26,723 INFO     [param_server.py:410] Lock worker 1 with localStep 88 , while globalStep is 87

2021-08-18:15:48:26,751 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:48:26,778 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:48:27,385 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:48:27,399 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:48:29,555 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:48:29,564 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:48:30,162 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:48:30,152 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:48:52,557 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:48:52,560 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:48:53,107 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:48:53,229 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:48:53,818 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:48:53,836 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:48:54,331 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:48:54,367 INFO     [learner.py:606] ====Pushing takes 0.034770965576171875 s
2021-08-18:15:48:54,420 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:48:54,469 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:48:54,470 INFO     [param_server.py:410] Lock worker 3 with localStep 88 , while globalStep is 87

2021-08-18:15:48:54,806 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:48:54,820 INFO     [learner.py:165] Start to run client 107 on rank 2...
2021-08-18:15:49:18,829 INFO     [learner.py:439] Completed to run client 107
2021-08-18:15:49:18,906 INFO     [learner.py:606] ====Pushing takes 0.05383634567260742 s
2021-08-18:15:49:18,966 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:49:19,52 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:49:19,53 INFO     [param_server.py:381] ====After aggregation in epoch: 87, virtual_clock: 2645.6602159281424, top_1: : 58.2446 % (1805.0), top_5: : 100.0 % (3099.0), test loss: 2.3609238620157598, test len: 3099.0
2021-08-18:15:49:19,58 INFO     [param_server.py:410] Lock worker 2 with localStep 88 , while globalStep is 88

2021-08-18:15:49:19,59 INFO     [param_server.py:441] ====Epoch 89 completes 20 clients with loss 5.359397537136497, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 107: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:49:19,59 INFO     [param_server.py:450] ====Start to sample for epoch 89, global virtualClock: 2645.6602159281424, round_duration: 40.41929854405443
2021-08-18:15:49:19,60 INFO     [oort.py:208] Training selector: Pacer 87: lastExploitationUtil 1566.370351326461, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:49:19,61 INFO     [oort.py:321] scores are 26,{5: 0.006630187631252651, 6: 0.04091421765497501, 7: 0.07123830287118633, 11: 0.012251650968707015, 14: 0.006145617625182781, 27: 0.0848786889306851, 50: 0.00304171613419133, 51: 0.040065642988454934, 53: 0.6466757511252514, 58: 0.0025416061410488324, 60: 0.0011341590597811245, 67: 0.0018111040230880042, 70: 0.005419021226131074, 76: 0.0012266694653840825, 79: 0.020307753151514372, 81: 0.025019499584164502, 84: 0.16884798828821695, 85: 0.06315166365178064, 87: 0.008481590814703501, 93: 0.012386055364750948, 97: 0.04334386712340538, 98: 0.48471261181692965, 105: 0.0030181383039056113, 107: 0.0017598488622561246, 110: 0.059187549416460886, 113: 0.07123830287118633, 119: 0.002440526001466132},[53, 98, 84, 27, 7, 113, 85, 110, 97, 6, 51, 81, 79, 93, 11, 87, 5, 14, 70, 50, 105, 58, 119, 67, 107, 76, 60]
2021-08-18:15:49:19,62 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:49:19,62 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:49:19,63 INFO     [oort.py:398] At round 87, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6210.487758318379, 'duration': 11.058674649423494, 'time_stamp': 88, 'count': 85, 'status': True, 'gradient': 20.266656593284196}, [0.9005000531889986, -3.409129649200562e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 88, 'count': 9, 'status': True, 'gradient': 20.994842195559563}, [1.449969047120173e-09, -3.409129649200562e-06]), ({'reward': 2039.1365453940998, 'duration': 13.298442137908651, 'time_stamp': 88, 'count': 85, 'status': True, 'gradient': 20.99513917411869}, [0.2956670388482344, -3.409129649200562e-06])]
2021-08-18:15:49:19,77 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:49:19,556 INFO     [param_server.py:553] For epoch: 89, median_reward: 876.7424684555601, dev: 4383.7123422778
2021-08-18:15:49:20,158 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1961, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:49:20,162 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1195.2869, eval_time 0.5724, test_loss 2.1961, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:49:20,193 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2274, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:49:20,194 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1195.3304, eval_time 0.6048, test_loss 2.2274, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:49:20,216 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1483, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:49:20,223 INFO     [learner.py:656] After aggregation epoch 88, CumulTime 1195.3619, eval_time 0.6332, test_loss 2.1483, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:49:20,290 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:49:20,290 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:49:20,304 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:49:20,308 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:49:20,315 INFO     [learner.py:526] ====Start train round 89
2021-08-18:15:49:20,335 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:49:22,17 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:49:22,32 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:49:23,10 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:49:23,19 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:49:23,317 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:49:23,331 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:49:23,855 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:49:23,883 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:49:24,625 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:49:24,639 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:49:25,397 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:49:25,406 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:49:25,581 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:49:25,602 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:50:06,786 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:50:06,816 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:50:06,988 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:50:07,22 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:50:07,559 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:50:07,569 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:50:07,653 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:50:07,669 INFO     [learner.py:606] ====Pushing takes 0.014429092407226562 s
2021-08-18:15:50:07,701 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:07,713 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:50:07,713 INFO     [param_server.py:410] Lock worker 1 with localStep 89 , while globalStep is 88

2021-08-18:15:50:07,924 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:50:07,952 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:50:10,257 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:50:10,268 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:50:10,889 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:50:10,898 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:50:11,3 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:50:11,15 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:50:11,493 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:50:11,503 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:50:12,128 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:50:12,161 INFO     [learner.py:606] ====Pushing takes 0.03183555603027344 s
2021-08-18:15:50:12,220 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:50:12,229 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:12,230 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:50:12,240 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:50:12,241 INFO     [param_server.py:410] Lock worker 3 with localStep 89 , while globalStep is 88

2021-08-18:15:50:13,414 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:50:13,425 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:50:14,3 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:50:14,38 INFO     [learner.py:606] ====Pushing takes 0.033121585845947266 s
2021-08-18:15:50:14,95 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:14,104 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:50:14,105 INFO     [param_server.py:381] ====After aggregation in epoch: 88, virtual_clock: 2690.026853018245, top_1: : 59.7289 % (1851.0), top_5: : 100.0 % (3099.0), test loss: 2.190596359747427, test len: 3099.0
2021-08-18:15:50:14,110 INFO     [param_server.py:410] Lock worker 2 with localStep 89 , while globalStep is 89

2021-08-18:15:50:14,110 INFO     [param_server.py:441] ====Epoch 90 completes 20 clients with loss 4.012987339884243, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:50:14,111 INFO     [param_server.py:450] ====Start to sample for epoch 90, global virtualClock: 2690.026853018245, round_duration: 44.36663709010263
2021-08-18:15:50:14,112 INFO     [oort.py:208] Training selector: Pacer 88: lastExploitationUtil 1637.008988477777, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:50:14,112 INFO     [oort.py:321] scores are 26,{5: 0.027865403810481755, 6: 0.615064657360746, 7: 0.07092753837657564, 11: 0.012198205308605856, 14: 0.005524053409202505, 27: 0.06363970976829966, 50: 0.003028447185618813, 51: 0.19072047476267895, 53: 0.4022797632079001, 58: 0.002356750423247676, 60: 0.0010516695726373742, 67: 0.0012872276825835554, 70: 0.005024885784625263, 76: 0.0011374515252532168, 79: 0.0031656570239844894, 81: 0.029273878816396103, 84: 0.10584797747883773, 85: 0.007897364791725125, 87: 0.012554384106574926, 93: 0.012332023389247448, 97: 0.02262753300686177, 98: 0.032093206834225466, 105: 0.003004972209446927, 107: 0.006834438178458829, 110: 0.06758486138998572, 113: 0.07092753837657564, 119: 0.02399475273279798},[6, 53, 51, 84, 7, 113, 110, 27, 98, 81, 5, 119, 97, 87, 93, 11, 85, 107, 14, 70, 79, 50, 105, 58, 67, 76, 60]
2021-08-18:15:50:14,113 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:50:14,114 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:50:14,114 INFO     [oort.py:398] At round 88, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7957.103599220103, 'duration': 11.90395711384456, 'time_stamp': 89, 'count': 87, 'status': True, 'gradient': 20.898096458426856}, [1.0, -3.370824391285298e-06]), ({'reward': 0.01, 'duration': 21.635252629006885, 'time_stamp': 89, 'count': 40, 'status': True, 'gradient': 21.62324294574814}, [1.2567402736612671e-09, -3.370824391285298e-06]), ({'reward': 2133.951581768898, 'duration': 12.029357192292537, 'time_stamp': 89, 'count': 86, 'status': True, 'gradient': 27.13914170934488}, [0.2681810340016914, -3.370824391285298e-06])]
2021-08-18:15:50:14,115 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:50:14,493 INFO     [param_server.py:553] For epoch: 90, median_reward: 899.9001404698699, dev: 4499.50070234935
2021-08-18:15:50:15,116 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3759, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:15:50:15,117 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1250.253, eval_time 0.5827, test_loss 2.3759, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:15:50:15,122 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2189, Top-1 Accuracy: 613.0/1033 (0.5934), Top-5 Accuracy: 1.0
2021-08-18:15:50:15,123 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1250.2472, eval_time 0.5857, test_loss 2.2189, test_accuracy 0.5934, test_5_accuracy 1.0 

2021-08-18:15:50:15,207 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:50:15,223 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:50:15,229 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4471, Top-1 Accuracy: 608.0/1033 (0.5886), Top-5 Accuracy: 1.0
2021-08-18:15:50:15,230 INFO     [learner.py:656] After aggregation epoch 89, CumulTime 1250.3693, eval_time 0.6974, test_loss 2.4471, test_accuracy 0.5886, test_5_accuracy 1.0 

2021-08-18:15:50:15,235 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:50:15,244 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:50:15,315 INFO     [learner.py:526] ====Start train round 90
2021-08-18:15:50:15,344 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:50:16,669 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:50:16,696 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:50:17,999 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:50:18,25 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:50:18,42 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:50:18,51 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:50:18,840 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:50:18,866 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:50:19,307 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:50:19,321 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:50:20,102 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:50:20,121 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:50:20,578 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:50:20,592 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:50:20,790 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:50:20,804 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:50:21,366 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:50:21,381 INFO     [learner.py:606] ====Pushing takes 0.013325929641723633 s
2021-08-18:15:50:21,432 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:21,438 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:50:21,439 INFO     [param_server.py:410] Lock worker 1 with localStep 90 , while globalStep is 89

2021-08-18:15:50:21,566 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:50:21,578 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:50:21,884 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:50:21,898 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:50:22,572 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:50:22,586 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:50:24,425 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:50:24,458 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:50:24,924 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:50:24,938 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:50:25,64 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:50:25,708 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:50:55,848 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:50:55,857 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:50:56,385 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:50:56,390 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:50:56,400 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:50:56,409 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:50:56,966 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:50:56,994 INFO     [learner.py:606] ====Pushing takes 0.026795148849487305 s
2021-08-18:15:50:57,57 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:57,83 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:50:57,83 INFO     [param_server.py:410] Lock worker 3 with localStep 90 , while globalStep is 89

2021-08-18:15:50:57,250 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:50:57,285 INFO     [learner.py:606] ====Pushing takes 0.03402066230773926 s
2021-08-18:15:50:57,321 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:50:57,329 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:50:57,329 INFO     [param_server.py:381] ====After aggregation in epoch: 89, virtual_clock: 2728.422874577031, top_1: : 59.4385 % (1842.0), top_5: : 100.0 % (3099.0), test loss: 2.347302516301473, test len: 3099.0
2021-08-18:15:50:57,334 INFO     [param_server.py:410] Lock worker 2 with localStep 90 , while globalStep is 90

2021-08-18:15:50:57,335 INFO     [param_server.py:441] ====Epoch 91 completes 20 clients with loss 4.508287961552428, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:50:57,335 INFO     [param_server.py:450] ====Start to sample for epoch 91, global virtualClock: 2728.422874577031, round_duration: 38.39602155878561
2021-08-18:15:50:57,336 INFO     [oort.py:208] Training selector: Pacer 89: lastExploitationUtil 2044.3729708977994, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:50:57,337 INFO     [oort.py:321] scores are 26,{5: 0.006572766716138341, 6: 0.04055987899224083, 7: 0.2761649905006505, 11: 0.012145545221869898, 14: 0.0060687906932990485, 27: 0.006227294257898531, 50: 0.0030153732712654086, 51: 0.03971865342903493, 53: 0.2273099509077705, 58: 0.0025098332886224943, 60: 0.0009518083503330931, 67: 0.00137083963406382, 70: 0.0053512775427443145, 76: 0.0012113347574330465, 79: 0.02892030568838913, 81: 0.01851412763771927, 84: 0.2579454940579808, 85: 0.007863271586667792, 87: 0.008408135773414815, 93: 0.08464515936845476, 97: 0.22958335749769848, 98: 0.03195465931737616, 105: 0.04535879080108231, 107: 0.007278369521067346, 110: 0.007496573594858577, 113: 0.5607467038578329, 119: 0.015384229607460624},[113, 7, 84, 97, 53, 93, 105, 6, 51, 98, 79, 81, 119, 11, 87, 85, 110, 107, 5, 27, 14, 70, 50, 58, 67, 76, 60]
2021-08-18:15:50:57,337 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:50:57,338 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:50:57,338 INFO     [oort.py:398] At round 89, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 90, 'count': 87, 'status': True, 'gradient': 27.139787885341097}, [1.095718472730543e-09, -3.3333703707819004e-06]), ({'reward': 5923.276740560834, 'duration': 15.972045438625893, 'time_stamp': 90, 'count': 86, 'status': True, 'gradient': 21.008090519192333}, [0.6490232797500388, -3.3333703707819004e-06]), ({'reward': 4470.977540014438, 'duration': 13.298442137908651, 'time_stamp': 90, 'count': 87, 'status': True, 'gradient': 21.010676998871602}, [0.4898921735529838, -3.3333703707819004e-06])]
2021-08-18:15:50:57,339 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:50:57,709 INFO     [param_server.py:553] For epoch: 91, median_reward: 988.7513316963467, dev: 4943.756658481733
2021-08-18:15:50:58,333 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1756, Top-1 Accuracy: 578.0/1033 (0.5595), Top-5 Accuracy: 1.0
2021-08-18:15:50:58,346 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1293.4704, eval_time 0.5901, test_loss 2.1756, test_accuracy 0.5595, test_5_accuracy 1.0 

2021-08-18:15:50:58,404 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4198, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:50:58,408 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1293.5444, eval_time 0.6537, test_loss 2.4198, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:50:58,414 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:50:58,428 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:50:58,493 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:50:58,511 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:50:58,509 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3423, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:50:58,516 INFO     [learner.py:656] After aggregation epoch 90, CumulTime 1293.655, eval_time 0.7617, test_loss 2.3423, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:50:58,615 INFO     [learner.py:526] ====Start train round 91
2021-08-18:15:50:58,652 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:51:00,387 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:51:00,408 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:51:01,306 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:51:01,319 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:51:01,746 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:51:01,760 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:51:01,893 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:51:01,907 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:51:02,967 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:51:02,978 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:51:03,320 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:51:03,334 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:51:03,659 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:51:03,668 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:51:04,129 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:51:04,144 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:51:04,759 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:51:04,778 INFO     [learner.py:606] ====Pushing takes 0.017542600631713867 s
2021-08-18:15:51:04,808 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:04,813 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:51:04,814 INFO     [param_server.py:410] Lock worker 1 with localStep 91 , while globalStep is 90

2021-08-18:15:51:04,934 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:51:04,944 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:51:05,555 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:51:05,569 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:51:05,771 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:51:05,792 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:51:08,343 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:51:08,354 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:51:08,590 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:51:08,600 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:51:09,6 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:51:09,21 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:51:09,611 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:51:09,623 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:51:09,952 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:51:09,961 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:51:10,315 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:51:10,346 INFO     [learner.py:606] ====Pushing takes 0.030059814453125 s
2021-08-18:15:51:10,394 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:10,403 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:51:10,404 INFO     [param_server.py:410] Lock worker 3 with localStep 91 , while globalStep is 90

2021-08-18:15:51:12,297 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:51:12,311 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:51:12,808 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:51:12,845 INFO     [learner.py:606] ====Pushing takes 0.03529810905456543 s
2021-08-18:15:51:12,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:12,906 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:51:12,907 INFO     [param_server.py:381] ====After aggregation in epoch: 90, virtual_clock: 2772.789511667134, top_1: : 57.6315 % (1786.0), top_5: : 100.0 % (3099.0), test loss: 2.312556584676107, test len: 3099.0
2021-08-18:15:51:12,912 INFO     [param_server.py:410] Lock worker 2 with localStep 91 , while globalStep is 91

2021-08-18:15:51:12,912 INFO     [param_server.py:441] ====Epoch 92 completes 20 clients with loss 4.065658839928093, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:51:12,913 INFO     [param_server.py:450] ====Start to sample for epoch 92, global virtualClock: 2772.789511667134, round_duration: 44.36663709010263
2021-08-18:15:51:12,914 INFO     [oort.py:208] Training selector: Pacer 90: lastExploitationUtil 1351.031519484338, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:51:12,914 INFO     [oort.py:321] scores are 26,{5: 0.006544683315589419, 6: 0.040386579166285026, 7: 0.07031959850340964, 11: 0.012093651061300753, 14: 0.004260418577297312, 27: 0.019998227953307114, 50: 0.0030024895133231805, 51: 0.03954894789988955, 53: 0.3861421558952909, 58: 0.0023620852465219997, 60: 0.0007862500764937916, 67: 0.0009623582256527093, 70: 0.003756709270028923, 76: 0.0008503824509209151, 79: 0.022595072285202432, 81: 0.018435022493003377, 84: 0.03236072480116037, 85: 0.02462709128141767, 87: 0.008372210408193081, 93: 0.09054235755047244, 97: 0.02243358605958136, 98: 0.04388659867145242, 105: 0.002979215747772207, 107: 0.0051095683286999545, 110: 0.11361621633315594, 113: 0.07031959850340964, 119: 0.0023953255508555944},[53, 110, 93, 7, 113, 98, 6, 51, 84, 85, 79, 97, 27, 81, 11, 87, 5, 107, 14, 70, 50, 105, 119, 58, 67, 76, 60]
2021-08-18:15:51:12,915 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:51:12,916 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:51:12,916 INFO     [oort.py:398] At round 90, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5046.504217609004, 'duration': 11.058674649423494, 'time_stamp': 91, 'count': 88, 'status': True, 'gradient': 20.290031143833176}, [0.5099235035703054, -3.2967395246101635e-06]), ({'reward': 263.9704139513154, 'duration': 13.411352670399307, 'time_stamp': 91, 'count': 87, 'status': True, 'gradient': 18.106622657636514}, [0.02667190689504272, -3.2967395246101635e-06]), ({'reward': 9896.581127190624, 'duration': 27.689063957948644, 'time_stamp': 91, 'count': 83, 'status': True, 'gradient': 20.493990557588486}, [1.0, -3.2967395246101635e-06])]
2021-08-18:15:51:12,917 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:51:13,320 INFO     [param_server.py:553] For epoch: 92, median_reward: 841.9214856822587, dev: 4209.607428411293
2021-08-18:15:51:13,919 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.614, Top-1 Accuracy: 587.0/1033 (0.5682), Top-5 Accuracy: 1.0
2021-08-18:15:51:13,920 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1309.0558, eval_time 0.5522, test_loss 2.614, test_accuracy 0.5682, test_5_accuracy 1.0 

2021-08-18:15:51:13,936 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.677, Top-1 Accuracy: 599.0/1033 (0.5799), Top-5 Accuracy: 1.0
2021-08-18:15:51:13,936 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1309.0608, eval_time 0.5683, test_loss 2.677, test_accuracy 0.5799, test_5_accuracy 1.0 

2021-08-18:15:51:14,5 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:51:14,10 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:51:14,25 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:51:14,28 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:51:14,43 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4114, Top-1 Accuracy: 589.0/1033 (0.5702), Top-5 Accuracy: 1.0
2021-08-18:15:51:14,44 INFO     [learner.py:656] After aggregation epoch 91, CumulTime 1309.1827, eval_time 0.6779, test_loss 2.4114, test_accuracy 0.5702, test_5_accuracy 1.0 

2021-08-18:15:51:14,178 INFO     [learner.py:526] ====Start train round 92
2021-08-18:15:51:14,207 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:51:15,345 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:51:15,366 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:51:16,627 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:51:16,641 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:51:16,840 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:51:16,850 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:51:17,543 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:51:17,564 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:51:17,745 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:51:17,763 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:51:18,922 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:51:18,950 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:51:19,171 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:51:19,195 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:51:19,709 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:51:19,730 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:51:20,187 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:51:20,201 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:51:20,404 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:51:20,423 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:51:20,431 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:51:20,447 INFO     [learner.py:606] ====Pushing takes 0.014718055725097656 s
2021-08-18:15:51:20,470 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:20,476 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:51:20,476 INFO     [param_server.py:410] Lock worker 1 with localStep 92 , while globalStep is 91

2021-08-18:15:51:21,137 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:51:21,157 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:51:22,995 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:51:23,6 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:51:23,264 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:51:23,275 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:51:23,673 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:51:23,687 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:51:23,842 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:51:23,851 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:51:24,232 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:51:24,247 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:51:24,345 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:51:24,355 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:51:24,898 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:51:24,933 INFO     [learner.py:606] ====Pushing takes 0.0329742431640625 s
2021-08-18:15:51:24,994 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:25,5 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:51:25,6 INFO     [param_server.py:410] Lock worker 3 with localStep 92 , while globalStep is 91

2021-08-18:15:51:25,87 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:51:25,126 INFO     [learner.py:606] ====Pushing takes 0.037200927734375 s
2021-08-18:15:51:25,163 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:51:25,173 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:51:25,174 INFO     [param_server.py:381] ====After aggregation in epoch: 91, virtual_clock: 2810.1330309401956, top_1: : 57.2765 % (1775.0), top_5: : 100.0 % (3099.0), test loss: 2.567450170163755, test len: 3099.0
2021-08-18:15:51:25,177 INFO     [param_server.py:410] Lock worker 2 with localStep 92 , while globalStep is 92

2021-08-18:15:51:25,177 INFO     [param_server.py:441] ====Epoch 93 completes 20 clients with loss 5.646079703379445, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:51:25,178 INFO     [param_server.py:450] ====Start to sample for epoch 93, global virtualClock: 2810.1330309401956, round_duration: 37.343519273061496
2021-08-18:15:51:25,178 INFO     [oort.py:208] Training selector: Pacer 91: lastExploitationUtil 1519.55783795569, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:51:25,179 INFO     [oort.py:321] scores are 26,{5: 0.006517004166979034, 6: 0.6145446947011107, 7: 0.4891081073158163, 11: 0.012042503901258564, 14: 0.005266169735110866, 27: 0.006174462654833579, 50: 0.03130100059964459, 51: 0.03938168522979245, 53: 0.12834333749857724, 58: 0.0027306672399522885, 60: 0.0009718590513908707, 67: 0.0011895408092700243, 70: 0.004643550463998496, 76: 0.0010511310673023127, 79: 0.003125249665578619, 81: 0.01835705604258641, 84: 0.17584301606345903, 85: 0.0077965605519785585, 87: 0.04250887102705648, 93: 0.012174613889360534, 97: 0.022338708655669705, 98: 0.03168355989486372, 105: 0.017337775861640706, 107: 0.0063157771012139095, 110: 0.034392883085816166, 113: 0.07002219883969142, 119: 0.013132764398705362},[6, 7, 84, 53, 113, 87, 51, 110, 98, 50, 97, 81, 105, 119, 93, 11, 85, 5, 107, 27, 14, 70, 79, 58, 67, 76, 60]
2021-08-18:15:51:25,180 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:51:25,181 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:51:25,182 INFO     [oort.py:398] At round 91, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 8185.53610205684, 'duration': 11.90395711384456, 'time_stamp': 92, 'count': 90, 'status': True, 'gradient': 20.922337931821236}, [1.0, -3.260905009837066e-06]), ({'reward': 5427.510888445835, 'duration': 43.65853298740619, 'time_stamp': 92, 'count': 73, 'status': True, 'gradient': 8.327292458841262}, [0.6630607274529878, -3.260905009837066e-06]), ({'reward': 2776.6069983589423, 'duration': 43.8287324306519, 'time_stamp': 92, 'count': 78, 'status': True, 'gradient': 11.658567448384991}, [0.33920813034475134, -3.260905009837066e-06])]
2021-08-18:15:51:25,183 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:51:25,690 INFO     [param_server.py:553] For epoch: 93, median_reward: 878.4356617896499, dev: 4392.17830894825
2021-08-18:15:51:26,352 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2535, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:51:26,353 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1321.4781, eval_time 0.6294, test_loss 2.2535, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:51:26,385 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5243, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:15:51:26,386 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1321.5215, eval_time 0.6621, test_loss 2.5243, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:15:51:26,441 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2526, Top-1 Accuracy: 610.0/1033 (0.5905), Top-5 Accuracy: 1.0
2021-08-18:15:51:26,442 INFO     [learner.py:656] After aggregation epoch 92, CumulTime 1321.5815, eval_time 0.7191, test_loss 2.2526, test_accuracy 0.5905, test_5_accuracy 1.0 

2021-08-18:15:51:26,453 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:51:26,464 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:51:26,469 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:51:26,476 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:51:26,547 INFO     [learner.py:526] ====Start train round 93
2021-08-18:15:51:26,564 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:02,633 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:02,661 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:03,751 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:03,767 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:03,887 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:03,906 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:03,948 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:03,984 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:05,106 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:05,116 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:05,422 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:05,442 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:52:06,59 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:06,71 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:06,177 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:06,201 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:06,890 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:06,906 INFO     [learner.py:606] ====Pushing takes 0.014190196990966797 s
2021-08-18:15:52:06,939 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:06,947 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:06,948 INFO     [param_server.py:410] Lock worker 1 with localStep 93 , while globalStep is 92

2021-08-18:15:52:07,126 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:07,138 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:07,861 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:07,872 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:07,888 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:07,901 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:10,563 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:10,573 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:10,675 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:10,687 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:11,193 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:11,202 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:11,780 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:11,790 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:11,791 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:11,809 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:52:12,480 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:12,520 INFO     [learner.py:606] ====Pushing takes 0.03855013847351074 s
2021-08-18:15:52:12,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:12,574 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:12,575 INFO     [param_server.py:410] Lock worker 3 with localStep 93 , while globalStep is 92

2021-08-18:15:52:14,646 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:52:14,667 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:52:15,318 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:52:15,353 INFO     [learner.py:606] ====Pushing takes 0.03376150131225586 s
2021-08-18:15:52:15,400 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:15,408 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:52:15,409 INFO     [param_server.py:381] ====After aggregation in epoch: 92, virtual_clock: 2854.4996680302984, top_1: : 59.6967 % (1850.0), top_5: : 100.0 % (3099.0), test loss: 2.3434600675547563, test len: 3099.0
2021-08-18:15:52:15,414 INFO     [param_server.py:410] Lock worker 2 with localStep 93 , while globalStep is 93

2021-08-18:15:52:15,415 INFO     [param_server.py:441] ====Epoch 94 completes 20 clients with loss 4.425498927179667, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:52:15,415 INFO     [param_server.py:450] ====Start to sample for epoch 94, global virtualClock: 2854.4996680302984, round_duration: 44.36663709010263
2021-08-18:15:52:15,416 INFO     [oort.py:208] Training selector: Pacer 92: lastExploitationUtil 2457.859474557057, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:52:15,417 INFO     [oort.py:321] scores are 26,{5: 0.02462288357480068, 6: 0.040047401705136355, 7: 0.6033961846551215, 11: 0.05593674251361701, 14: 0.0059788987853064005, 27: 0.016930365559649902, 50: 0.03199212385959471, 51: 0.4187319845534813, 53: 0.7118869226637311, 58: 0.0024726572325580046, 60: 0.0011033914959308808, 67: 0.0009605722503147169, 70: 0.0052720135554318774, 76: 0.0011933922713486772, 79: 0.003112165116570201, 81: 0.018280200167011096, 84: 0.06527110056024381, 85: 0.007763918526682773, 87: 0.008301898311227365, 93: 0.03520689756646352, 97: 0.13218624304683343, 98: 0.03155090966318095, 105: 0.00545476671737779, 107: 0.007170561136104144, 110: 0.022178313084848852, 113: 0.27207020816597827, 119: 0.0023752089562903886},[53, 7, 51, 113, 97, 84, 11, 6, 93, 50, 98, 5, 110, 81, 27, 87, 85, 107, 14, 105, 70, 79, 58, 119, 76, 60, 67]
2021-08-18:15:52:15,418 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:52:15,418 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:52:15,419 INFO     [oort.py:398] At round 92, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5947.7556738475205, 'duration': 5.8943907365129, 'time_stamp': 93, 'count': 90, 'status': True, 'gradient': 21.23913467780931}, [0.533667150136555, -3.2258411380767565e-06]), ({'reward': 11145.057389536601, 'duration': 11.058674649423494, 'time_stamp': 93, 'count': 90, 'status': True, 'gradient': 20.305873192805123}, [1.0, -3.2258411380767565e-06]), ({'reward': 2255.1119611782706, 'duration': 8.009219946401625, 'time_stamp': 93, 'count': 14, 'status': True, 'gradient': 21.034950236455696}, [0.20234117364741178, -3.2258411380767565e-06])]
2021-08-18:15:52:15,420 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:52:30,2 INFO     [param_server.py:553] For epoch: 94, median_reward: 1077.3616553757943, dev: 5386.808276878972
2021-08-18:15:52:30,623 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0998, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:52:30,630 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1385.7545, eval_time 0.5755, test_loss 2.0998, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:52:30,625 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4149, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:52:30,687 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1385.8228, eval_time 0.6325, test_loss 2.4149, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:52:30,687 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1713, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:52:30,696 INFO     [learner.py:656] After aggregation epoch 93, CumulTime 1385.8348, eval_time 0.6414, test_loss 2.1713, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:52:30,734 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:30,747 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:52:30,779 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:30,791 INFO     [learner.py:526] ====Start train round 94
2021-08-18:15:52:30,800 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:52:30,817 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:31,964 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:31,974 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:33,69 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:33,87 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:33,386 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:33,401 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:34,14 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:34,28 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:34,382 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:34,395 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:38,797 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:38,816 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:52:39,335 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:39,353 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:39,491 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:39,511 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:40,140 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:40,156 INFO     [learner.py:606] ====Pushing takes 0.014383077621459961 s
2021-08-18:15:52:40,179 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:40,187 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:40,188 INFO     [param_server.py:410] Lock worker 1 with localStep 94 , while globalStep is 93

2021-08-18:15:52:40,327 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:40,338 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:40,629 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:40,648 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:41,240 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:41,255 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:43,359 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:43,371 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:43,430 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:43,453 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:43,890 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:43,904 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:44,145 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:44,167 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:52:44,610 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:44,624 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:44,766 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:52:44,776 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:52:45,203 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:45,236 INFO     [learner.py:606] ====Pushing takes 0.03185153007507324 s
2021-08-18:15:52:45,299 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:45,307 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:45,322 INFO     [param_server.py:410] Lock worker 3 with localStep 94 , while globalStep is 93

2021-08-18:15:52:45,479 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:52:45,517 INFO     [learner.py:606] ====Pushing takes 0.036127567291259766 s
2021-08-18:15:52:45,559 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:45,569 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:52:45,570 INFO     [param_server.py:381] ====After aggregation in epoch: 93, virtual_clock: 2891.84318730336, top_1: : 60.4711 % (1874.0), top_5: : 100.0 % (3099.0), test loss: 2.228655223493223, test len: 3099.0
2021-08-18:15:52:45,574 INFO     [param_server.py:410] Lock worker 2 with localStep 94 , while globalStep is 94

2021-08-18:15:52:45,574 INFO     [param_server.py:441] ====Epoch 95 completes 20 clients with loss 6.223644589117002, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:52:45,575 INFO     [param_server.py:450] ====Start to sample for epoch 95, global virtualClock: 2891.84318730336, round_duration: 37.343519273061496
2021-08-18:15:52:45,576 INFO     [oort.py:208] Training selector: Pacer 93: lastExploitationUtil 2380.5105388445277, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:52:45,577 INFO     [oort.py:321] scores are 26,{5: 0.006462819217097721, 6: 0.03988140408978649, 7: 0.4535110678307842, 11: 0.10830453226627589, 14: 0.007094571583661129, 27: 0.07623882517417217, 50: 0.0029649329066263374, 51: 0.3654330569246122, 53: 0.04621117217916947, 58: 0.002934059325665803, 60: 0.001309286247146832, 67: 0.0016025466036131688, 70: 0.0062557803538944665, 76: 0.0014543479054240239, 79: 0.027864832936511385, 81: 0.08617523232427157, 84: 0.4921509002282416, 85: 0.007731736864294557, 87: 0.008267486707381316, 93: 0.012073389334869396, 97: 0.30691169015592845, 98: 0.03142013024820744, 105: 0.002941950260713009, 107: 0.0085086001790382, 110: 0.007371172899272516, 113: 0.06944000658731685, 119: 0.018481838441972383},[84, 7, 51, 97, 11, 81, 27, 113, 53, 6, 98, 79, 119, 93, 107, 87, 85, 110, 14, 5, 70, 50, 105, 58, 67, 76, 60]
2021-08-18:15:52:45,578 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:52:45,579 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:52:45,579 INFO     [oort.py:398] At round 93, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 8656.840276248926, 'duration': 13.298442137908651, 'time_stamp': 94, 'count': 91, 'status': True, 'gradient': 21.044615199401278}, [1.0, -3.191523314077812e-06]), ({'reward': 7727.057950083346, 'duration': 15.972045438625893, 'time_stamp': 94, 'count': 90, 'status': True, 'gradient': 21.044886099243673}, [0.8925955233704298, -3.191523314077812e-06]), ({'reward': 3324.8479950442143, 'duration': 5.8943907365129, 'time_stamp': 94, 'count': 91, 'status': True, 'gradient': 21.24818008957101}, [0.3840710623986246, -3.191523314077812e-06])]
2021-08-18:15:52:45,580 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:52:46,92 INFO     [param_server.py:553] For epoch: 95, median_reward: 1068.4218652260818, dev: 5342.109326130409
2021-08-18:15:52:46,828 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.0255, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:15:52:46,829 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1401.9535, eval_time 0.7007, test_loss 2.0255, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:15:52:46,840 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3043, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:52:46,841 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1401.9766, eval_time 0.7132, test_loss 2.3043, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:52:46,872 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.1101, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:15:52:46,873 INFO     [learner.py:656] After aggregation epoch 94, CumulTime 1402.0127, eval_time 0.7469, test_loss 2.1101, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:15:52:46,947 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:52:46,955 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:52:46,957 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:52:46,958 INFO     [learner.py:526] ====Start train round 95
2021-08-18:15:52:46,970 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:52:46,974 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:52:48,825 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:52:48,843 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:52:49,665 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:52:49,677 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:52:50,78 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:52:50,89 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:52:50,214 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:52:50,234 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:52:51,260 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:52:51,270 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:52:51,757 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:52:51,810 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:52:51,824 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:52:51,833 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:52:52,574 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:52:52,601 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:52:53,17 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:52:53,31 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:52:53,264 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:52:53,280 INFO     [learner.py:606] ====Pushing takes 0.01462101936340332 s
2021-08-18:15:52:53,305 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:53,312 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:52:53,313 INFO     [param_server.py:410] Lock worker 1 with localStep 95 , while globalStep is 94

2021-08-18:15:52:53,669 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:52:53,678 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:52:54,2 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:52:54,22 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:52:56,293 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:52:56,303 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:52:56,958 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:52:56,972 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:52:57,91 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:52:57,109 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:52:57,597 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:52:57,608 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:52:58,140 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:52:58,181 INFO     [learner.py:606] ====Pushing takes 0.03990578651428223 s
2021-08-18:15:52:58,261 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:52:58,283 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:52:58,284 INFO     [param_server.py:410] Lock worker 3 with localStep 95 , while globalStep is 94

2021-08-18:15:52:58,288 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:52:58,303 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:00,448 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:00,457 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:00,950 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:00,988 INFO     [learner.py:606] ====Pushing takes 0.03678154945373535 s
2021-08-18:15:53:01,38 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:01,63 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:01,64 INFO     [param_server.py:381] ====After aggregation in epoch: 94, virtual_clock: 2936.209824393463, top_1: : 61.4714 % (1905.0), top_5: : 100.0 % (3099.0), test loss: 2.146643420060476, test len: 3099.0
2021-08-18:15:53:01,67 INFO     [param_server.py:410] Lock worker 2 with localStep 95 , while globalStep is 95

2021-08-18:15:53:01,68 INFO     [param_server.py:441] ====Epoch 96 completes 20 clients with loss 4.969248487696169, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:01,68 INFO     [param_server.py:450] ====Start to sample for epoch 96, global virtualClock: 2936.209824393463, round_duration: 44.36663709010263
2021-08-18:15:53:01,69 INFO     [oort.py:208] Training selector: Pacer 94: lastExploitationUtil 1870.4120513326613, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:53:01,70 INFO     [oort.py:321] scores are 26,{5: 0.038745144785830216, 6: 0.0397177238441418, 7: 0.36279486631625035, 11: 0.12482813752398413, 14: 0.007495585897550188, 27: 0.06394475221431364, 50: 0.010505743821117878, 51: 0.21147488294091274, 53: 0.04602151346011367, 58: 0.00309990440503626, 60: 0.0013832924813348337, 67: 0.0016931291171793424, 70: 0.006609382743675846, 76: 0.0018797613178515701, 79: 0.0030865451788212525, 81: 0.10984716498464399, 84: 0.03182478827327198, 85: 0.007700004466248623, 87: 0.01996174930975782, 93: 0.11660192329869216, 97: 0.34108529432784696, 98: 0.057347280728981875, 105: 0.0029298759831809574, 107: 0.00898954119467491, 110: 0.007745672945008782, 113: 0.4755112186366883, 119: 0.034374567965065266},[113, 7, 97, 51, 11, 93, 81, 27, 98, 53, 6, 5, 119, 84, 87, 50, 107, 110, 85, 14, 70, 58, 79, 105, 76, 67, 60]
2021-08-18:15:53:01,71 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:53:01,71 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:01,72 INFO     [oort.py:398] At round 94, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1947.3072821931873, 'duration': 12.029357192292537, 'time_stamp': 95, 'count': 92, 'status': True, 'gradient': 27.196117688030753}, [0.3068557212105236, -3.157927978189247e-06]), ({'reward': 1863.439789145577, 'duration': 5.8943907365129, 'time_stamp': 95, 'count': 92, 'status': True, 'gradient': 21.257789499454084}, [0.29363985521593877, -3.157927978189247e-06]), ({'reward': 6345.980286761098, 'duration': 15.972045438625893, 'time_stamp': 95, 'count': 91, 'status': True, 'gradient': 21.051099647388334}, [1.0, -3.157927978189247e-06])]
2021-08-18:15:53:01,72 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:01,484 INFO     [param_server.py:553] For epoch: 96, median_reward: 957.9001011831049, dev: 4789.500505915525
2021-08-18:15:53:02,129 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3973, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:53:02,130 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1417.255, eval_time 0.6025, test_loss 2.3973, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:53:02,139 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.28, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:15:53:02,140 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1417.2763, eval_time 0.6133, test_loss 2.28, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:15:53:02,212 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5198, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:53:05,327 INFO     [learner.py:656] After aggregation epoch 95, CumulTime 1420.4658, eval_time 3.8, test_loss 2.5198, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:53:05,364 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:53:05,364 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:53:05,373 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:05,374 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:05,470 INFO     [learner.py:526] ====Start train round 96
2021-08-18:15:53:05,498 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:06,543 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:06,570 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:07,684 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:07,698 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:08,40 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:08,59 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:08,863 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:08,882 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:09,276 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:09,338 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:10,424 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:10,438 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:10,755 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:10,783 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:11,320 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:11,341 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:11,464 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:11,484 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:11,736 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:11,747 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:12,62 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:12,78 INFO     [learner.py:606] ====Pushing takes 0.014475584030151367 s
2021-08-18:15:53:12,118 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:12,129 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:12,130 INFO     [param_server.py:410] Lock worker 1 with localStep 96 , while globalStep is 95

2021-08-18:15:53:12,396 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:12,405 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:14,209 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:14,219 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:14,634 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:14,646 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:14,800 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:14,819 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:15,283 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:15,295 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:15,419 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:15,437 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:15,904 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:15,914 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:16,182 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:16,219 INFO     [learner.py:606] ====Pushing takes 0.03562784194946289 s
2021-08-18:15:53:16,266 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:16,287 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:16,288 INFO     [param_server.py:410] Lock worker 2 with localStep 96 , while globalStep is 95

2021-08-18:15:53:16,556 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:16,590 INFO     [learner.py:606] ====Pushing takes 0.032936811447143555 s
2021-08-18:15:53:16,627 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:16,636 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:16,637 INFO     [param_server.py:381] ====After aggregation in epoch: 95, virtual_clock: 2973.5533436665246, top_1: : 59.5999 % (1847.0), top_5: : 100.0 % (3099.0), test loss: 2.3990524157329842, test len: 3099.0
2021-08-18:15:53:16,641 INFO     [param_server.py:410] Lock worker 3 with localStep 96 , while globalStep is 96

2021-08-18:15:53:16,641 INFO     [param_server.py:441] ====Epoch 97 completes 20 clients with loss 5.381540103303542, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:16,642 INFO     [param_server.py:450] ====Start to sample for epoch 97, global virtualClock: 2973.5533436665246, round_duration: 37.343519273061496
2021-08-18:15:53:16,643 INFO     [oort.py:208] Training selector: Pacer 95: lastExploitationUtil 1340.0986595577233, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:53:16,644 INFO     [oort.py:321] scores are 26,{5: 0.0064101366273797075, 6: 0.12413806387119693, 7: 0.06887395650078842, 11: 0.011845027771188918, 14: 0.003863233510380953, 27: 0.006073212200581398, 31: 0.043624845392915244, 50: 0.00680146280736922, 51: 0.03873589405060191, 53: 0.045834475238945155, 58: 0.001597694261689091, 60: 0.0007129505206920975, 67: 0.0010928386733674283, 70: 0.0034064833953336964, 76: 0.0007711040409371276, 79: 0.012298463647926557, 81: 0.05577534108383848, 84: 0.044282951972528656, 85: 0.007668710511963417, 87: 0.014278648773999853, 93: 0.01913004500023616, 97: 0.02197239266588506, 98: 0.48364279548441536, 105: 0.009770318939392739, 107: 0.004633219772395465, 110: 0.027713670035711627, 113: 0.06887395650078842, 119: 0.01296737949049932},[98, 6, 7, 113, 81, 53, 84, 31, 51, 110, 97, 93, 87, 119, 79, 11, 105, 85, 50, 5, 27, 107, 14, 70, 58, 67, 76, 60]
2021-08-18:15:53:16,645 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:15:53:16,645 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:16,646 INFO     [oort.py:398] At round 95, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 11291.877705114648, 'duration': 13.411352670399307, 'time_stamp': 96, 'count': 92, 'status': True, 'gradient': 18.14570200841189}, [1.0, -3.125032552422424e-06]), ({'reward': 515.9693150843117, 'duration': 31.23200382212914, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 21.101973412573706}, [0.04569300120242093, 0.29374993489515516]), ({'reward': 308.8713441007403, 'duration': 13.298442137908651, 'time_stamp': 96, 'count': 93, 'status': True, 'gradient': 21.065710403268195}, [0.027352548036611888, -3.125032552422424e-06])]
2021-08-18:15:53:16,647 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:17,76 INFO     [param_server.py:553] For epoch: 97, median_reward: 838.1030103487287, dev: 4190.515051743643
2021-08-18:15:53:17,719 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1309, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:53:17,720 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1432.8443, eval_time 0.6045, test_loss 2.1309, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:53:17,754 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4465, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:53:17,754 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1432.8904, eval_time 0.6396, test_loss 2.4465, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:53:17,790 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3366, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:53:17,791 INFO     [learner.py:656] After aggregation epoch 96, CumulTime 1432.93, eval_time 0.681, test_loss 2.3366, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:53:17,810 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:17,818 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:17,843 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:17,859 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:17,866 INFO     [learner.py:526] ====Start train round 97
2021-08-18:15:53:17,884 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:19,564 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:19,576 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:20,501 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:20,510 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:20,635 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:20,647 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:21,399 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:21,426 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:21,828 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:21,846 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:22,846 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:22,868 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:22,995 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:23,8 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:23,710 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:23,730 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:23,955 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:23,967 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:24,412 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:24,428 INFO     [learner.py:606] ====Pushing takes 0.015292882919311523 s
2021-08-18:15:53:24,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:24,459 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:24,459 INFO     [param_server.py:410] Lock worker 1 with localStep 97 , while globalStep is 96

2021-08-18:15:53:24,622 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:24,631 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:24,723 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:24,743 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:27,318 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:27,329 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:27,593 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:27,602 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:27,958 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:27,967 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:28,541 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:28,551 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:28,815 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:28,827 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:29,122 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:29,155 INFO     [learner.py:606] ====Pushing takes 0.031295061111450195 s
2021-08-18:15:53:29,199 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:29,208 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:29,209 INFO     [param_server.py:410] Lock worker 3 with localStep 97 , while globalStep is 96

2021-08-18:15:53:31,131 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:31,142 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:31,666 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:31,702 INFO     [learner.py:606] ====Pushing takes 0.03430438041687012 s
2021-08-18:15:53:31,749 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:31,758 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:31,759 INFO     [param_server.py:381] ====After aggregation in epoch: 96, virtual_clock: 3017.9199807566274, top_1: : 60.3743 % (1871.0), top_5: : 100.0 % (3099.0), test loss: 2.304622056307616, test len: 3099.0
2021-08-18:15:53:31,762 INFO     [param_server.py:410] Lock worker 2 with localStep 97 , while globalStep is 97

2021-08-18:15:53:31,762 INFO     [param_server.py:441] ====Epoch 98 completes 20 clients with loss 5.067737830862651, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:31,763 INFO     [param_server.py:450] ====Start to sample for epoch 98, global virtualClock: 3017.9199807566274, round_duration: 44.36663709010263
2021-08-18:15:53:31,764 INFO     [oort.py:208] Training selector: Pacer 96: lastExploitationUtil 1259.766395274819, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:53:31,764 INFO     [oort.py:321] scores are 26,{5: 0.006384336692591763, 6: 0.4616084090768408, 7: 0.5849166990673116, 11: 0.01179735313306143, 14: 0.006205333413405401, 27: 0.00604876834113867, 50: 0.002928927656953375, 51: 0.0385799873049969, 53: 0.045649997662109504, 58: 0.0026957228093991985, 60: 0.0011451794659234024, 67: 0.0014016823804896186, 70: 0.00547167681644758, 76: 0.0013010516476265701, 79: 0.003061628564634291, 81: 0.017983359141379048, 84: 0.03156787773898662, 85: 0.007637844987152105, 87: 0.09808925502789453, 93: 0.026286997111319443, 97: 0.24224576770985315, 98: 0.031038573676787095, 105: 0.0029062241053502097, 107: 0.007442126754191735, 110: 0.09996451265148402, 113: 1.0685967462745236, 119: 0.002336639386141587},[113, 7, 6, 97, 110, 87, 53, 51, 84, 98, 93, 81, 11, 85, 107, 5, 14, 27, 70, 79, 50, 105, 58, 119, 67, 76, 60]
2021-08-18:15:53:31,765 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:53:31,766 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:31,766 INFO     [oort.py:398] At round 96, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5414.637234343552, 'duration': 8.009219946401625, 'time_stamp': 97, 'count': 18, 'status': True, 'gradient': 21.074603804515732}, [1.0, -3.0928153898493827e-06]), ({'reward': 4727.614240150738, 'duration': 27.689063957948644, 'time_stamp': 97, 'count': 89, 'status': True, 'gradient': 20.549261978723827}, [0.8731172132097329, -3.0928153898493827e-06]), ({'reward': 4089.5228059399, 'duration': 26.145070720211294, 'time_stamp': 97, 'count': 90, 'status': True, 'gradient': 26.708500724654353}, [0.7552713476651699, -3.0928153898493827e-06])]
2021-08-18:15:53:31,767 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:32,126 INFO     [param_server.py:553] For epoch: 98, median_reward: 816.9478027027684, dev: 4084.739013513842
2021-08-18:15:53:32,742 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2039, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:53:32,743 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1447.8674, eval_time 0.5525, test_loss 2.2039, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:53:32,833 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:32,841 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:32,841 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2195, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:53:32,842 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1447.9782, eval_time 0.6557, test_loss 2.2195, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:53:32,865 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.636, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:53:32,870 INFO     [learner.py:656] After aggregation epoch 97, CumulTime 1448.0088, eval_time 0.6879, test_loss 2.636, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:53:32,932 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:32,936 INFO     [learner.py:526] ====Start train round 98
2021-08-18:15:53:32,944 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:32,962 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:34,188 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:34,199 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:35,511 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:35,525 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:35,529 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:35,544 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:36,284 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:36,337 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:36,803 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:36,824 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:37,847 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:37,874 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:38,43 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:38,63 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:38,598 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:38,619 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:39,266 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:39,281 INFO     [learner.py:606] ====Pushing takes 0.013004541397094727 s
2021-08-18:15:53:39,292 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:39,303 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:39,306 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:39,316 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:39,317 INFO     [param_server.py:410] Lock worker 1 with localStep 98 , while globalStep is 97

2021-08-18:15:53:39,327 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:39,338 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:39,956 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:39,966 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:41,993 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:42,11 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:42,134 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:42,153 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:42,617 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:42,628 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:42,728 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:42,749 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:43,122 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:43,137 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:43,288 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:43,298 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:43,739 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:43,780 INFO     [learner.py:606] ====Pushing takes 0.03920698165893555 s
2021-08-18:15:53:43,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:43,845 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:43,846 INFO     [param_server.py:410] Lock worker 2 with localStep 98 , while globalStep is 97

2021-08-18:15:53:43,878 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:43,911 INFO     [learner.py:606] ====Pushing takes 0.0321040153503418 s
2021-08-18:15:53:43,948 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:43,956 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:43,957 INFO     [param_server.py:381] ====After aggregation in epoch: 97, virtual_clock: 3055.263500029689, top_1: : 58.8254 % (1823.0), top_5: : 100.0 % (3099.0), test loss: 2.353118526714819, test len: 3099.0
2021-08-18:15:53:43,959 INFO     [param_server.py:410] Lock worker 3 with localStep 98 , while globalStep is 98

2021-08-18:15:53:43,959 INFO     [param_server.py:441] ====Epoch 99 completes 20 clients with loss 5.990803869389309, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:43,960 INFO     [param_server.py:450] ====Start to sample for epoch 99, global virtualClock: 3055.263500029689, round_duration: 37.343519273061496
2021-08-18:15:53:43,961 INFO     [oort.py:208] Training selector: Pacer 97: lastExploitationUtil 2120.1844148478062, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:53:43,962 INFO     [oort.py:321] scores are 26,{5: 0.024743593874782057, 6: 0.0392400441527939, 7: 0.06832329469449228, 11: 0.011750324276290433, 14: 0.00686819087153177, 27: 0.048459029538324636, 50: 0.0029172518074880014, 51: 0.5933759955993294, 53: 0.04546801894388064, 58: 0.0028404364152840537, 60: 0.0012675082272177807, 67: 0.0010524547410318105, 70: 0.006056164634363074, 76: 0.0013708955776901492, 79: 0.028935831108486344, 81: 0.057516657465398996, 84: 0.4916369949998574, 85: 0.0842449551349627, 87: 0.043181788446307164, 93: 0.011879228963643098, 97: 0.02179671875300471, 98: 0.16635685620916815, 105: 0.0028946387611078718, 107: 0.008237099222984606, 110: 0.05755421360288121, 113: 0.06832329469449228, 119: 0.0074313459349596165},[51, 84, 98, 85, 7, 113, 110, 81, 27, 53, 87, 6, 79, 5, 97, 93, 11, 107, 119, 14, 70, 50, 105, 58, 76, 60, 67]
2021-08-18:15:53:43,963 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:53:43,963 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:43,964 INFO     [oort.py:398] At round 97, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7891.11576044248, 'duration': 12.029357192292537, 'time_stamp': 98, 'count': 95, 'status': True, 'gradient': 27.238141885418116}, [0.9867227694177539, -3.061255727099259e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 98, 'count': 95, 'status': True, 'gradient': 21.28936447117621}, [1.2504239559348663e-09, -3.061255727099259e-06]), ({'reward': 0.01, 'duration': 21.753601635627824, 'time_stamp': 98, 'count': 90, 'status': True, 'gradient': 21.287103799968847}, [1.2504239559348663e-09, -3.061255727099259e-06])]
2021-08-18:15:53:43,964 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:44,317 INFO     [param_server.py:553] For epoch: 99, median_reward: 1002.0335089756696, dev: 5010.167544878348
2021-08-18:15:53:44,964 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3083, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:53:44,965 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1460.1005, eval_time 0.6091, test_loss 2.3083, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:53:44,965 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1437, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:53:44,965 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1460.09, eval_time 0.6096, test_loss 2.1437, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:53:45,38 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3861, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:53:45,38 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:45,39 INFO     [learner.py:656] After aggregation epoch 98, CumulTime 1460.1778, eval_time 0.6833, test_loss 2.3861, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:53:45,46 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:45,62 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:45,70 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:45,103 INFO     [learner.py:526] ====Start train round 99
2021-08-18:15:53:45,121 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:53:46,586 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:53:46,597 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:53:47,659 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:53:47,677 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:53:47,689 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:53:47,707 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:53:48,768 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:53:48,786 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:53:48,788 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:53:48,884 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:53:49,786 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:53:49,798 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:53:50,308 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:53:50,329 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:53:50,955 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:53:50,966 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:53:51,112 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:53:51,133 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:53:51,620 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:53:51,629 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:53:51,632 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:53:51,650 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:53:51,816 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:53:51,830 INFO     [learner.py:606] ====Pushing takes 0.013059616088867188 s
2021-08-18:15:53:51,862 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:51,867 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:53:51,867 INFO     [param_server.py:410] Lock worker 1 with localStep 99 , while globalStep is 98

2021-08-18:15:53:54,183 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:53:54,194 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:53:54,433 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:53:54,443 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:53:54,871 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:53:54,881 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:53:55,508 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:53:55,518 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:53:55,616 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:53:55,634 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:53:56,99 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:53:56,147 INFO     [learner.py:606] ====Pushing takes 0.046369075775146484 s
2021-08-18:15:53:56,196 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:56,205 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:53:56,205 INFO     [param_server.py:410] Lock worker 3 with localStep 99 , while globalStep is 98

2021-08-18:15:53:57,907 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:53:57,925 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:53:58,468 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:53:58,502 INFO     [learner.py:606] ====Pushing takes 0.03311324119567871 s
2021-08-18:15:53:58,556 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:53:58,567 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:53:58,568 INFO     [param_server.py:381] ====After aggregation in epoch: 98, virtual_clock: 3099.630137119792, top_1: : 60.2452 % (1867.0), top_5: : 100.0 % (3099.0), test loss: 2.2793934279017978, test len: 3099.0
2021-08-18:15:53:58,570 INFO     [param_server.py:410] Lock worker 2 with localStep 99 , while globalStep is 99

2021-08-18:15:53:58,571 INFO     [param_server.py:441] ====Epoch 100 completes 20 clients with loss 4.342786030558879, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:53:58,571 INFO     [param_server.py:450] ====Start to sample for epoch 100, global virtualClock: 3099.630137119792, round_duration: 44.36663709010263
2021-08-18:15:53:58,572 INFO     [oort.py:208] Training selector: Pacer 98: lastExploitationUtil 1413.2095604700426, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:53:58,572 INFO     [oort.py:321] scores are 26,{5: 0.04746554379391613, 6: 0.03908510026904712, 7: 0.12935853089834493, 11: 0.011703926752588288, 14: 0.006588971651211588, 27: 0.08931898694773414, 50: 0.0029057326990191267, 51: 0.03827446211371441, 53: 0.045288483176438465, 58: 0.002724961400672559, 60: 0.0016961913355662823, 67: 0.0014883399253128092, 70: 0.005809957503698346, 76: 0.0013151632310645439, 79: 0.006332137212801561, 81: 0.280001463425658, 84: 0.03309103709993025, 85: 0.04230720967370982, 87: 0.11893983592959737, 93: 0.0118323224447723, 97: 0.021710651870832605, 98: 0.030792770947906785, 105: 0.00899463373243405, 107: 0.007902228444673113, 110: 0.09224036995842312, 113: 0.06805351220930651, 119: 0.013311727369518375},[81, 7, 87, 110, 27, 113, 5, 53, 85, 6, 51, 84, 98, 97, 119, 93, 11, 105, 107, 14, 79, 70, 50, 58, 60, 67, 76]
2021-08-18:15:53:58,573 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:53:58,574 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:53:58,574 INFO     [oort.py:398] At round 98, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5611.819028351042, 'duration': 17.619275735353515, 'time_stamp': 99, 'count': 95, 'status': True, 'gradient': 23.395512024972504}, [1.0, -3.0303336397337374e-06]), ({'reward': 5224.27932203127, 'duration': 26.145070720211294, 'time_stamp': 99, 'count': 92, 'status': True, 'gradient': 26.736826020594098}, [0.9309421073184546, -3.0303336397337374e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 99, 'count': 20, 'status': True, 'gradient': 21.096890313682106}, [1.7819565725882154e-09, -3.0303336397337374e-06])]
2021-08-18:15:53:58,575 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:53:58,908 INFO     [param_server.py:553] For epoch: 100, median_reward: 856.0252108402995, dev: 4280.126054201497
2021-08-18:15:53:59,546 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0261, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:53:59,549 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1474.6739, eval_time 0.5795, test_loss 3.0261, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:53:59,629 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:53:59,632 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8059, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:15:53:59,633 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1474.7694, eval_time 0.6657, test_loss 2.8059, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:15:53:59,644 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:53:59,700 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8038, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:15:53:59,704 INFO     [learner.py:656] After aggregation epoch 99, CumulTime 1474.8434, eval_time 0.7405, test_loss 2.8038, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:15:53:59,723 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:53:59,746 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:53:59,772 INFO     [learner.py:526] ====Start train round 100
2021-08-18:15:53:59,800 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:01,61 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:01,75 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:02,453 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:02,467 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:02,477 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:02,496 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:02,814 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:02,825 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:03,591 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:03,605 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:04,176 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:04,194 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:04,661 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:04,750 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:54:04,797 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:54:04,815 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:54:05,503 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:54:05,520 INFO     [learner.py:606] ====Pushing takes 0.014557838439941406 s
2021-08-18:15:54:05,543 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:05,548 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:54:05,549 INFO     [param_server.py:410] Lock worker 1 with localStep 100 , while globalStep is 99

2021-08-18:15:54:05,706 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:54:05,715 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:54:05,902 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:54:05,912 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:54:06,464 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:54:06,474 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:54:12,497 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:54:12,515 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:54:12,515 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:54:12,533 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:54:13,88 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:54:13,104 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:54:36,866 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:54:36,870 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:54:37,331 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:54:37,346 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:54:37,365 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:54:37,385 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:54:37,873 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:54:37,911 INFO     [learner.py:606] ====Pushing takes 0.03578376770019531 s
2021-08-18:15:54:37,939 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:54:37,965 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:37,974 INFO     [learner.py:606] ====Pushing takes 0.03394174575805664 s
2021-08-18:15:54:37,976 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:54:37,977 INFO     [param_server.py:410] Lock worker 3 with localStep 100 , while globalStep is 99

2021-08-18:15:54:38,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:38,20 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:54:38,21 INFO     [param_server.py:381] ====After aggregation in epoch: 99, virtual_clock: 3136.9736563928536, top_1: : 59.5031 % (1844.0), top_5: : 100.0 % (3099.0), test loss: 2.8786091009775796, test len: 3099.0
2021-08-18:15:54:38,25 INFO     [param_server.py:410] Lock worker 2 with localStep 100 , while globalStep is 100

2021-08-18:15:54:38,25 INFO     [param_server.py:441] ====Epoch 101 completes 20 clients with loss 5.7273625717029235, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:54:38,25 INFO     [param_server.py:450] ====Start to sample for epoch 101, global virtualClock: 3136.9736563928536, round_duration: 37.343519273061496
2021-08-18:15:54:38,26 INFO     [oort.py:208] Training selector: Pacer 99: lastExploitationUtil 1384.1708919810958, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:54:38,27 INFO     [oort.py:321] scores are 26,{5: 0.006309002310966519, 6: 0.34734791784262947, 7: 0.42506381066660104, 11: 0.06803547876859789, 14: 0.006112485717088527, 27: 0.08156713793461935, 50: 0.0028943666736459483, 51: 0.038124748236840575, 53: 0.045111333348076786, 58: 0.0025279039769682096, 60: 0.0011280446452462932, 67: 0.0014046479381140107, 70: 0.005389806503677585, 76: 0.001220056313953607, 79: 0.00302550172706469, 81: 0.017771157732572946, 84: 0.031195380694548573, 85: 0.11889184548696126, 87: 0.008070718209904869, 93: 0.011786039289691894, 97: 0.021625728773771606, 98: 0.3834242018666928, 105: 0.002871931021137564, 107: 0.007330773458761689, 110: 0.0071957369212824925, 113: 0.7880814701978499, 119: 0.0023090673310147912},[113, 7, 98, 6, 85, 27, 11, 53, 51, 84, 97, 81, 93, 87, 107, 110, 5, 14, 70, 79, 50, 105, 58, 119, 67, 76, 60]
2021-08-18:15:54:38,28 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:54:38,29 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:54:38,29 INFO     [oort.py:398] At round 99, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2159.899471774338, 'duration': 5.8943907365129, 'time_stamp': 100, 'count': 97, 'status': True, 'gradient': 21.31393980634761}, [0.3572764973245413, -3.0000300003000056e-06]), ({'reward': 3246.4163268331417, 'duration': 11.90395711384456, 'time_stamp': 100, 'count': 98, 'status': True, 'gradient': 21.001258225839866}, [0.5370018673192098, -3.0000300003000056e-06]), ({'reward': 4713.018144904847, 'duration': 13.411352670399307, 'time_stamp': 100, 'count': 96, 'status': True, 'gradient': 18.183601999060038}, [0.7795987061630262, -3.0000300003000056e-06])]
2021-08-18:15:54:38,30 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:54:38,373 INFO     [param_server.py:541] Handle Wight 0.039550065994262695 | Send 0.3471546173095703
2021-08-18:15:54:38,374 INFO     [param_server.py:553] For epoch: 101, median_reward: 843.8419953562055, dev: 4219.209976781028
2021-08-18:15:54:38,910 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3926, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:54:38,911 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1514.0357, eval_time 0.4807, test_loss 2.3926, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:54:38,956 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3903, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:54:38,957 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1514.093, eval_time 0.5282, test_loss 2.3903, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:54:39,4 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:39,19 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:54:39,72 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3815, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:54:39,74 INFO     [learner.py:656] After aggregation epoch 100, CumulTime 1514.2137, eval_time 0.6458, test_loss 2.3815, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:54:39,90 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:39,120 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:54:39,156 INFO     [learner.py:526] ====Start train round 101
2021-08-18:15:54:39,189 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:40,930 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:40,949 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:41,705 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:41,715 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:42,206 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:42,220 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:42,495 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:42,516 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:43,489 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:43,503 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:43,973 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:43,987 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:44,58 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:44,68 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:54:44,657 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:54:44,670 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:54:45,186 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:54:45,195 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:54:45,247 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:54:45,262 INFO     [learner.py:606] ====Pushing takes 0.014090299606323242 s
2021-08-18:15:54:45,286 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:45,292 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:54:45,292 INFO     [param_server.py:410] Lock worker 1 with localStep 101 , while globalStep is 100

2021-08-18:15:54:45,828 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:54:45,837 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:54:46,176 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:54:46,195 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:54:48,544 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:54:48,560 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:54:49,134 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:54:49,140 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:54:49,155 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:54:49,160 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:54:49,843 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:54:49,857 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:54:50,372 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:54:50,381 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:54:50,445 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:54:50,479 INFO     [learner.py:606] ====Pushing takes 0.032624244689941406 s
2021-08-18:15:54:50,525 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:50,533 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:54:50,534 INFO     [param_server.py:410] Lock worker 3 with localStep 101 , while globalStep is 100

2021-08-18:15:54:52,735 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:54:52,758 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:54:53,400 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:54:53,450 INFO     [learner.py:606] ====Pushing takes 0.0485224723815918 s
2021-08-18:15:54:53,496 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:54:53,506 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:54:53,507 INFO     [param_server.py:381] ====After aggregation in epoch: 100, virtual_clock: 3181.3402934829564, top_1: : 60.8906 % (1887.0), top_5: : 100.0 % (3099.0), test loss: 2.3881482548183866, test len: 3099.0
2021-08-18:15:54:53,510 INFO     [param_server.py:410] Lock worker 2 with localStep 101 , while globalStep is 101

2021-08-18:15:54:53,510 INFO     [param_server.py:441] ====Epoch 102 completes 20 clients with loss 4.864792119583365, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:54:53,510 INFO     [param_server.py:450] ====Start to sample for epoch 102, global virtualClock: 3181.3402934829564, round_duration: 44.36663709010263
2021-08-18:15:54:53,511 INFO     [oort.py:208] Training selector: Pacer 100: lastExploitationUtil 1807.013523032859, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:54:53,512 INFO     [oort.py:321] scores are 26,{5: 0.09935509765061026, 6: 0.03878134383235778, 7: 0.8389717781788241, 11: 0.02587086186973431, 14: 0.008387016150161672, 27: 0.005954229789665548, 50: 0.030693222328060363, 51: 0.03797700568791959, 53: 0.5365503635872448, 58: 0.0034685678563824824, 60: 0.0015478038061233204, 67: 0.0018944884955201784, 70: 0.007395419193571856, 76: 0.0013486707596062097, 79: 0.03788025879312792, 81: 0.17843233273728878, 84: 0.23185358995731492, 85: 0.007518470139127148, 87: 0.03377643777923431, 93: 0.02294190913530695, 97: 0.021541923884845847, 98: 0.030553459744544348, 105: 0.0028608015992000807, 107: 0.010058643608756978, 110: 0.09323566386594685, 113: 0.6940810249608329, 119: 0.0023001191409573775},[7, 113, 53, 84, 81, 5, 110, 6, 51, 79, 87, 50, 98, 11, 93, 97, 107, 14, 85, 70, 27, 58, 105, 119, 67, 60, 76]
2021-08-18:15:54:53,513 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:54:53,514 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:54:53,515 INFO     [oort.py:398] At round 100, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2321.1930841639373, 'duration': 13.298442137908651, 'time_stamp': 101, 'count': 98, 'status': True, 'gradient': 21.119682305586345}, [0.4362913923142998, -2.970326438875635e-06]), ({'reward': 4313.677560988478, 'duration': 27.689063957948644, 'time_stamp': 101, 'count': 93, 'status': True, 'gradient': 20.593853620045046}, [0.8108003350789037, -2.970326438875635e-06]), ({'reward': 3333.4521757212037, 'duration': 8.009219946401625, 'time_stamp': 101, 'count': 22, 'status': True, 'gradient': 21.119134875155655}, [0.6265564039580286, -2.970326438875635e-06])]
2021-08-18:15:54:53,515 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:54:53,869 INFO     [param_server.py:553] For epoch: 102, median_reward: 935.2162612848122, dev: 4676.081306424061
2021-08-18:15:54:54,493 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3409, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:54:54,496 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1529.6203, eval_time 0.5789, test_loss 2.3409, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:54:54,557 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7134, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:54:54,558 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1529.6941, eval_time 0.6413, test_loss 2.7134, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:54:54,563 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:54,570 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:54:54,609 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7499, Top-1 Accuracy: 607.0/1033 (0.5876), Top-5 Accuracy: 1.0
2021-08-18:15:54:54,611 INFO     [learner.py:656] After aggregation epoch 101, CumulTime 1529.7501, eval_time 0.6978, test_loss 2.7499, test_accuracy 0.5876, test_5_accuracy 1.0 

2021-08-18:15:54:54,645 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:54,657 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:54:54,678 INFO     [learner.py:526] ====Start train round 102
2021-08-18:15:54:54,705 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:54:55,800 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:54:55,810 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:54:56,891 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:54:56,912 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:54:57,224 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:54:57,235 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:54:58,72 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:54:58,99 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:54:58,133 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:54:58,151 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:54:59,530 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:54:59,557 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:54:59,593 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:54:59,604 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:00,306 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:00,333 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:00,581 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:00,597 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:00,647 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:00,658 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:01,56 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:01,71 INFO     [learner.py:606] ====Pushing takes 0.013148069381713867 s
2021-08-18:15:55:01,93 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:01,100 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:01,101 INFO     [param_server.py:410] Lock worker 1 with localStep 102 , while globalStep is 101

2021-08-18:15:55:01,208 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:01,217 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:03,234 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:03,246 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:03,451 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:03,460 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:03,914 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:03,924 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:04,96 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:04,106 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:04,497 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:04,506 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:55:04,783 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:04,792 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:05,138 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:55:05,173 INFO     [learner.py:606] ====Pushing takes 0.033333539962768555 s
2021-08-18:15:55:05,221 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:05,230 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:15:55:05,232 INFO     [param_server.py:410] Lock worker 2 with localStep 102 , while globalStep is 101

2021-08-18:15:55:05,391 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:05,424 INFO     [learner.py:606] ====Pushing takes 0.03161430358886719 s
2021-08-18:15:55:05,459 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:05,472 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:05,473 INFO     [param_server.py:381] ====After aggregation in epoch: 101, virtual_clock: 3218.683812756018, top_1: : 59.6321 % (1848.0), top_5: : 100.0 % (3099.0), test loss: 2.6013879643546214, test len: 3099.0
2021-08-18:15:55:05,475 INFO     [param_server.py:410] Lock worker 3 with localStep 102 , while globalStep is 102

2021-08-18:15:55:05,476 INFO     [param_server.py:441] ====Epoch 103 completes 20 clients with loss 5.5496770630573975, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:55:05,477 INFO     [param_server.py:450] ====Start to sample for epoch 103, global virtualClock: 3218.683812756018, round_duration: 37.343519273061496
2021-08-18:15:55:05,478 INFO     [oort.py:208] Training selector: Pacer 101: lastExploitationUtil 1558.6979098708032, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:55:05,478 INFO     [oort.py:321] scores are 25,{5: 0.02838479609956541, 6: 0.03863243951351819, 7: 1.0672653548097943, 11: 0.011568378723031934, 14: 0.0060459992002517724, 27: 0.06636325765358843, 50: 0.020726093228523295, 51: 0.037831189694849006, 53: 0.21362338358702523, 58: 0.002810291520242386, 60: 0.0011157747173037044, 67: 0.001365691412026241, 70: 0.005331180688020989, 79: 0.0030022055240242766, 81: 0.017634320759353665, 84: 0.030955177915590562, 85: 0.007489602323725444, 87: 0.008008574107186963, 93: 0.011695287411456697, 97: 0.32468893540217497, 98: 0.030436147097228132, 105: 0.0028498173043982927, 107: 0.007251035424915689, 110: 0.07755489888222389, 113: 0.06726535626136187, 119: 0.013066481420177474},[7, 97, 53, 110, 113, 27, 6, 51, 84, 98, 5, 50, 81, 119, 93, 11, 87, 85, 107, 14, 70, 79, 105, 58, 67, 60]
2021-08-18:15:55:05,496 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:55:05,497 INFO     [oort.py:365] exploration poss is [104.21122692  16.91829855   9.79312991   9.05547074   1.91505738]
2021-08-18:15:55:05,497 INFO     [oort.py:398] At round 101, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6889.113758681974, 'duration': 5.8943907365129, 'time_stamp': 102, 'count': 99, 'status': True, 'gradient': 21.33485560871778}, [1.0, -2.9412053059343743e-06]), ({'reward': 6548.062862907347, 'duration': 15.972045438625893, 'time_stamp': 102, 'count': 98, 'status': True, 'gradient': 21.13132827759825}, [0.9504941561012549, -2.9412053059343743e-06]), ({'reward': 4569.822754658546, 'duration': 27.689063957948644, 'time_stamp': 102, 'count': 94, 'status': True, 'gradient': 20.607658072409194}, [0.6633392264220233, -2.9412053059343743e-06])]
2021-08-18:15:55:05,498 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:55:05,838 INFO     [param_server.py:553] For epoch: 103, median_reward: 883.4836928634725, dev: 4417.418464317362
2021-08-18:15:55:06,442 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1622, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:55:06,443 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1541.5677, eval_time 0.5449, test_loss 2.1622, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:55:06,488 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4454, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:15:55:06,489 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1541.6248, eval_time 0.5917, test_loss 2.4454, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:15:55:06,512 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:55:06,520 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:06,561 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:55:06,576 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:06,601 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4287, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:55:06,601 INFO     [learner.py:656] After aggregation epoch 102, CumulTime 1541.7407, eval_time 0.7085, test_loss 2.4287, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:55:06,672 INFO     [learner.py:526] ====Start train round 103
2021-08-18:15:55:06,698 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:08,286 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:08,315 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:09,182 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:09,201 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:09,612 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:09,624 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:10,233 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:10,247 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:10,863 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:10,872 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:11,299 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:11,310 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:11,583 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:11,593 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:12,208 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:12,218 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:12,424 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:12,433 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:12,893 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:12,908 INFO     [learner.py:606] ====Pushing takes 0.012823343276977539 s
2021-08-18:15:55:12,930 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:12,935 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:12,936 INFO     [param_server.py:410] Lock worker 1 with localStep 103 , while globalStep is 102

2021-08-18:15:55:13,98 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:13,111 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:13,535 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:13,546 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:15,675 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:15,686 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:16,138 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:16,148 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:16,383 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:16,393 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:17,56 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:17,65 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:17,405 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:17,425 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:17,700 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:17,734 INFO     [learner.py:606] ====Pushing takes 0.03223133087158203 s
2021-08-18:15:55:17,780 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:17,792 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:55:17,793 INFO     [param_server.py:410] Lock worker 3 with localStep 103 , while globalStep is 102

2021-08-18:15:55:20,81 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:20,101 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:55:20,612 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:55:20,646 INFO     [learner.py:606] ====Pushing takes 0.032332658767700195 s
2021-08-18:15:55:20,688 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:20,696 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:20,696 INFO     [param_server.py:381] ====After aggregation in epoch: 102, virtual_clock: 3263.050449846121, top_1: : 60.7293 % (1882.0), top_5: : 100.0 % (3099.0), test loss: 2.345415225735417, test len: 3099.0
2021-08-18:15:55:20,698 INFO     [param_server.py:410] Lock worker 2 with localStep 103 , while globalStep is 103

2021-08-18:15:55:20,699 INFO     [param_server.py:441] ====Epoch 104 completes 20 clients with loss 4.208667035635857, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:55:20,699 INFO     [param_server.py:450] ====Start to sample for epoch 104, global virtualClock: 3263.050449846121, round_duration: 44.36663709010263
2021-08-18:15:55:20,700 INFO     [oort.py:208] Training selector: Pacer 102: lastExploitationUtil 2134.877417952201, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:55:20,701 INFO     [oort.py:321] scores are 25,{5: 0.021013534625026236, 6: 0.038485459330141844, 7: 0.14199071600862823, 11: 0.12238832160891017, 14: 0.006788139128885984, 27: 0.005908801649655491, 50: 0.002861153146405634, 51: 0.6001044032630687, 53: 0.044593670360644766, 58: 0.002807329897254608, 60: 0.0012527348692397394, 67: 0.0012051697651032829, 70: 0.005985577409604945, 79: 0.031587419082533305, 81: 0.13221874565594208, 84: 0.030837406483504606, 85: 0.057127722361971604, 87: 0.0918981204653425, 93: 0.011650791761945008, 97: 0.021377568532617873, 98: 0.1215719848126855, 105: 0.021948050015728533, 107: 0.008141092259945866, 110: 0.04700713224449935, 113: 0.1819309150704742, 119: 0.0022825702491499796},[51, 113, 7, 81, 11, 98, 87, 85, 110, 53, 6, 79, 84, 105, 97, 5, 93, 107, 14, 70, 27, 50, 58, 119, 60, 67]
2021-08-18:15:55:20,709 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:55:20,710 INFO     [oort.py:365] exploration poss is [16.91829855  9.79312991  9.05547074  1.91505738  0.90032832]
2021-08-18:15:55:20,710 INFO     [oort.py:398] At round 102, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 65, exploration 0.0, round_threshold 10, sampled score is [({'reward': 8131.624824520359, 'duration': 12.029357192292537, 'time_stamp': 103, 'count': 100, 'status': True, 'gradient': 27.30603133279662}, [1.0, -2.9126496373751228e-06]), ({'reward': 0.01, 'duration': 11.90395711384456, 'time_stamp': 103, 'count': 101, 'status': True, 'gradient': 21.033255736983495}, [1.229768035439598e-09, -2.9126496373751228e-06]), ({'reward': 3667.685409319634, 'duration': 43.8287324306519, 'time_stamp': 103, 'count': 89, 'status': True, 'gradient': 15.069676472840383}, [0.45103899950469933, -2.9126496373751228e-06])]
2021-08-18:15:55:20,711 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:55:21,53 INFO     [param_server.py:553] For epoch: 104, median_reward: 1001.4522677931669, dev: 5007.2613389658345
2021-08-18:15:55:21,631 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1864, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:55:21,632 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1556.7564, eval_time 0.5413, test_loss 2.1864, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:55:21,689 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6697, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:55:21,691 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1556.827, eval_time 0.6007, test_loss 2.6697, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:55:21,702 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:21,712 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:21,737 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5402, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:55:21,740 INFO     [learner.py:656] After aggregation epoch 103, CumulTime 1556.8791, eval_time 0.6541, test_loss 2.5402, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:55:21,763 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:21,779 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:21,808 INFO     [learner.py:526] ====Start train round 104
2021-08-18:15:55:21,826 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:23,144 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:23,158 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:24,290 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:24,301 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:24,314 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:24,324 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:25,77 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:25,103 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:25,528 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:25,539 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:26,686 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:26,686 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:26,695 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:26,713 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:27,477 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:27,505 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:27,728 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:27,747 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:27,849 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:27,858 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:28,290 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:28,304 INFO     [learner.py:606] ====Pushing takes 0.013045549392700195 s
2021-08-18:15:55:28,329 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:28,334 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:28,335 INFO     [param_server.py:410] Lock worker 1 with localStep 104 , while globalStep is 103

2021-08-18:15:55:28,476 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:28,490 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:30,596 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:30,607 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:30,665 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:30,685 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:31,202 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:31,216 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:31,323 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:31,337 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:31,734 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:31,744 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:55:31,839 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:31,868 INFO     [learner.py:606] ====Pushing takes 0.027559518814086914 s
2021-08-18:15:55:31,909 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:31,916 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:55:31,917 INFO     [param_server.py:410] Lock worker 2 with localStep 104 , while globalStep is 103

2021-08-18:15:55:32,271 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:55:32,281 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:32,925 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:32,964 INFO     [learner.py:606] ====Pushing takes 0.034966230392456055 s
2021-08-18:15:55:33,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:33,21 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:33,22 INFO     [param_server.py:381] ====After aggregation in epoch: 103, virtual_clock: 3300.342201586204, top_1: : 59.8903 % (1856.0), top_5: : 100.0 % (3099.0), test loss: 2.465447985463672, test len: 3099.0
2021-08-18:15:55:33,24 INFO     [param_server.py:410] Lock worker 3 with localStep 104 , while globalStep is 104

2021-08-18:15:55:33,25 INFO     [param_server.py:441] ====Epoch 105 completes 20 clients with loss 5.602082645425719, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:33,25 INFO     [param_server.py:450] ====Start to sample for epoch 105, global virtualClock: 3300.342201586204, round_duration: 37.29175174008306
2021-08-18:15:55:33,26 INFO     [oort.py:208] Training selector: Pacer 103: lastExploitationUtil 1689.6366892807666, lastExplorationUtil 1036.6162047673404, last_util_record 0
2021-08-18:15:55:33,27 INFO     [oort.py:321] scores are 26,{5: 0.016811968092287008, 6: 0.03834036088863235, 7: 0.0667567999028539, 11: 0.012677177522298267, 12: 0.009058610442652881, 14: 0.005285600553090119, 27: 0.043390536756766775, 50: 0.002850365984976635, 51: 0.03754516887910424, 53: 0.05486816576552271, 58: 0.002185934049950822, 60: 0.0009754449624569652, 67: 0.001140800349402935, 70: 0.004660683976281979, 79: 0.03897192762717878, 81: 0.18604943007418054, 84: 0.3379130739815591, 85: 0.007432977560308936, 87: 0.12700744264311178, 93: 0.011606865776483642, 97: 0.02129697051114861, 98: 0.030206036130824603, 105: 0.0028282714033388153, 107: 0.006339080701633968, 110: 0.007086346019672641, 113: 0.0667567999028539, 119: 0.008740829286425477},[84, 81, 87, 7, 113, 53, 27, 79, 6, 51, 98, 97, 5, 11, 93, 12, 119, 85, 110, 107, 14, 70, 50, 105, 58, 67, 60]
2021-08-18:15:55:33,28 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:55:33,29 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:33,29 INFO     [oort.py:398] At round 103, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5636.919865880339, 'duration': 17.619275735353515, 'time_stamp': 104, 'count': 100, 'status': True, 'gradient': 18.423395124788673}, [0.6429207310356665, -2.8846431215684793e-06]), ({'reward': 5852.647258992233, 'duration': 13.298442137908651, 'time_stamp': 104, 'count': 101, 'status': True, 'gradient': 21.1451975859623}, [0.6675256327172384, -2.8846431215684793e-06]), ({'reward': 3729.057994909137, 'duration': 30.380154975061778, 'time_stamp': 104, 'count': 91, 'status': True, 'gradient': 16.748724414877927}, [0.42531853837894673, -2.8846431215684793e-06])]
2021-08-18:15:55:33,30 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:55:33,375 INFO     [param_server.py:553] For epoch: 105, median_reward: 915.6660771725763, dev: 4578.3303858628815
2021-08-18:15:55:34,48 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3358, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:15:55:34,50 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1569.1856, eval_time 0.6407, test_loss 2.3358, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:15:55:34,52 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.269, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:55:34,53 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1569.1776, eval_time 0.6428, test_loss 2.269, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:55:34,120 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:34,122 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3323, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:55:34,123 INFO     [learner.py:656] After aggregation epoch 104, CumulTime 1569.2622, eval_time 0.7142, test_loss 2.3323, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:55:34,123 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:34,128 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:34,130 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:34,209 INFO     [learner.py:526] ====Start train round 105
2021-08-18:15:55:34,232 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:35,342 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:35,353 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:35,933 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:35,945 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:36,366 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:36,375 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:37,211 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:37,220 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:37,297 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:37,324 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:38,294 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:38,303 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:38,498 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:38,531 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:38,957 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:38,970 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:39,30 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:39,48 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:39,161 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:39,188 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:39,574 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:39,583 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:39,678 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:39,697 INFO     [learner.py:606] ====Pushing takes 0.017030954360961914 s
2021-08-18:15:55:39,721 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:39,728 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:39,729 INFO     [param_server.py:410] Lock worker 1 with localStep 105 , while globalStep is 104

2021-08-18:15:55:40,699 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:40,708 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:40,811 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:40,821 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:41,292 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:41,302 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:41,389 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:41,398 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:42,42 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:42,51 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:55:42,396 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:42,422 INFO     [learner.py:606] ====Pushing takes 0.02400040626525879 s
2021-08-18:15:55:42,459 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:42,466 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:55:42,467 INFO     [param_server.py:410] Lock worker 2 with localStep 105 , while globalStep is 104

2021-08-18:15:55:42,679 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:55:42,689 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:43,230 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:43,268 INFO     [learner.py:606] ====Pushing takes 0.03617382049560547 s
2021-08-18:15:55:43,303 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:43,311 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:43,312 INFO     [param_server.py:381] ====After aggregation in epoch: 104, virtual_clock: 3329.0256046092195, top_1: : 59.7289 % (1851.0), top_5: : 100.0 % (3099.0), test loss: 2.3123706181844077, test len: 3099.0
2021-08-18:15:55:43,313 INFO     [param_server.py:410] Lock worker 3 with localStep 105 , while globalStep is 105

2021-08-18:15:55:43,314 INFO     [param_server.py:441] ====Epoch 106 completes 20 clients with loss 5.684679649427593, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:43,314 INFO     [param_server.py:450] ====Start to sample for epoch 106, global virtualClock: 3329.0256046092195, round_duration: 28.683403023015895
2021-08-18:15:55:43,315 INFO     [oort.py:208] Training selector: Pacer 104: lastExploitationUtil 1662.9745771191917, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:55:43,315 INFO     [oort.py:321] scores are 26,{5: 0.039518109897061365, 6: 0.11381716540887415, 7: 0.06650736511697042, 11: 0.055103759476789006, 12: 0.01173359610384726, 14: 0.006186844890067472, 27: 0.052287248924023325, 50: 0.0028397156777392176, 51: 0.25349283477312123, 53: 0.2580175008212075, 58: 0.0025586562531775482, 60: 0.0011417674530835925, 67: 0.001397506128275989, 70: 0.0054553741913058035, 79: 0.006987705435842793, 81: 0.10176062226397241, 84: 0.030606354211425366, 85: 0.007405204462003889, 87: 0.007918328123372299, 93: 0.011563497069715963, 97: 0.02121739501790829, 98: 0.4116924504238499, 105: 0.045184494802370315, 107: 0.007433217919176039, 110: 0.022260199006676598, 113: 0.19660095576045405, 119: 0.010231222443409554},[98, 53, 51, 113, 6, 81, 7, 11, 27, 105, 5, 84, 110, 97, 12, 93, 119, 87, 107, 85, 79, 14, 70, 50, 58, 67, 60]
2021-08-18:15:55:43,316 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:55:43,316 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:43,317 INFO     [oort.py:398] At round 104, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 925.1379720340738, 'duration': 8.009219946401625, 'time_stamp': 105, 'count': 26, 'status': True, 'gradient': 21.153594449860417}, [0.13009359204970627, -2.8571700682863672e-06]), ({'reward': 5997.30247268275, 'duration': 13.411352670399307, 'time_stamp': 105, 'count': 101, 'status': True, 'gradient': 18.221861755076773}, [0.8433528514935393, -2.8571700682863672e-06]), ({'reward': 2546.5233023632954, 'duration': 29.570969934622333, 'time_stamp': 105, 'count': 87, 'status': True, 'gradient': 11.72854031376739}, [0.35809646928994865, -2.8571700682863672e-06])]
2021-08-18:15:55:43,317 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:55:43,593 INFO     [param_server.py:553] For epoch: 106, median_reward: 916.2121279909584, dev: 4581.060639954792
2021-08-18:15:55:44,238 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2263, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:55:44,239 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1579.3779, eval_time 0.5902, test_loss 2.2263, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:55:44,247 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.265, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:55:44,248 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1579.3726, eval_time 0.5886, test_loss 2.265, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:55:44,311 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:44,314 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:44,322 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:44,325 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3986, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:55:44,328 INFO     [learner.py:656] After aggregation epoch 105, CumulTime 1579.4638, eval_time 0.6705, test_loss 2.3986, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:55:44,343 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:44,396 INFO     [learner.py:526] ====Start train round 106
2021-08-18:15:55:44,414 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:45,691 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:45,703 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:46,740 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:46,750 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:47,63 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:47,72 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:47,373 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:47,394 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:55:48,5 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:48,16 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:48,496 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:55:48,517 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:55:49,96 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:55:49,117 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:55:49,252 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:55:49,262 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:55:49,443 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:55:49,457 INFO     [learner.py:606] ====Pushing takes 0.01275634765625 s
2021-08-18:15:55:49,486 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:49,491 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:55:49,491 INFO     [param_server.py:410] Lock worker 1 with localStep 106 , while globalStep is 105

2021-08-18:15:55:50,328 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:55:50,342 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:55:50,387 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:55:50,401 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:55:50,898 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:55:50,907 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:55:53,18 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:55:53,33 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:55:53,161 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:55:53,173 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:55:53,744 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:55:53,758 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:55:54,138 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:55:54,156 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:55:54,300 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:55:54,314 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:55:54,660 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:55:54,686 INFO     [learner.py:606] ====Pushing takes 0.025330305099487305 s
2021-08-18:15:55:54,726 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:54,734 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:55:54,735 INFO     [param_server.py:410] Lock worker 2 with localStep 106 , while globalStep is 105

2021-08-18:15:55:54,875 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:55:54,884 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:55:55,485 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:55:55,517 INFO     [learner.py:606] ====Pushing takes 0.029866933822631836 s
2021-08-18:15:55:55,561 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:55:55,570 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:55:55,579 INFO     [param_server.py:381] ====After aggregation in epoch: 105, virtual_clock: 3367.4216261680053, top_1: : 61.2456 % (1898.0), top_5: : 100.0 % (3099.0), test loss: 2.2966123123963675, test len: 3099.0
2021-08-18:15:55:55,581 INFO     [param_server.py:410] Lock worker 3 with localStep 106 , while globalStep is 106

2021-08-18:15:55:55,582 INFO     [param_server.py:441] ====Epoch 107 completes 20 clients with loss 6.358088963544329, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:55:55,582 INFO     [param_server.py:450] ====Start to sample for epoch 107, global virtualClock: 3367.4216261680053, round_duration: 38.39602155878561
2021-08-18:15:55:55,583 INFO     [oort.py:208] Training selector: Pacer 105: lastExploitationUtil 2066.6868888870604, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:55:55,584 INFO     [oort.py:321] scores are 26,{5: 0.006166953434263555, 6: 0.44024508307307086, 7: 0.06626106544432256, 11: 0.011395659552788758, 12: 0.0032445161086918323, 14: 0.006555698803187462, 27: 0.08030610520572712, 50: 0.002829199232822026, 51: 0.22369728060067118, 53: 0.04409563959606649, 58: 0.0027112009489123037, 60: 0.001209838562094107, 67: 0.0012532434434032777, 70: 0.005780618504643518, 79: 0.018718253405552717, 81: 0.017371035356767945, 84: 0.2719343235709041, 85: 0.0321012383179266, 87: 0.007889003827916076, 93: 0.011520673458557614, 97: 0.05920109213669983, 98: 0.4824605175463736, 105: 0.0028072687250385647, 107: 0.007862323940600284, 110: 0.10126695134988198, 112: 0.1691419715665271, 113: 0.1232710341867019, 119: 0.010841198368345264},[98, 6, 84, 51, 112, 113, 110, 27, 7, 97, 53, 85, 79, 81, 93, 11, 119, 87, 107, 14, 5, 70, 12, 50, 105, 58, 67, 60]
2021-08-18:15:55:55,585 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:55:55,586 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:55:55,586 INFO     [oort.py:398] At round 105, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2066.6948376827877, 'duration': 48.8795967667807, 'time_stamp': 106, 'count': 85, 'status': True, 'gradient': 19.18066367381853}, [0.25200411533927763, -2.830215379390374e-06]), ({'reward': 8201.006409841688, 'duration': 13.411352670399307, 'time_stamp': 106, 'count': 102, 'status': True, 'gradient': 18.23062851097108}, [1.0, -2.830215379390374e-06]), ({'reward': 2718.489208501053, 'duration': 12.029357192292537, 'time_stamp': 106, 'count': 103, 'status': True, 'gradient': 27.33481795907934}, [0.33148157605872125, -2.830215379390374e-06])]
2021-08-18:15:55:55,587 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 79, 50, 105, 119]
2021-08-18:15:55:55,920 INFO     [param_server.py:553] For epoch: 107, median_reward: 1003.6705483908212, dev: 5018.352741954106
2021-08-18:15:55:56,523 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1929, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:55:56,524 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1591.6489, eval_time 0.5587, test_loss 2.1929, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:55:56,564 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3946, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:15:55:56,565 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1591.7005, eval_time 0.599, test_loss 2.3946, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:15:55:56,579 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:56,587 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:55:56,634 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:56,647 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3492, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:55:56,648 INFO     [learner.py:656] After aggregation epoch 106, CumulTime 1591.7875, eval_time 0.6829, test_loss 2.3492, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:55:56,651 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:55:56,718 INFO     [learner.py:526] ====Start train round 107
2021-08-18:15:55:56,742 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:55:57,992 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:55:58,13 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:55:58,698 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:55:58,719 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:55:58,950 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:55:58,960 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:55:59,781 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:55:59,790 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:55:59,873 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:55:59,884 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:00,824 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:00,836 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:01,17 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:01,31 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:01,379 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:01,390 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:01,406 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:01,452 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:01,721 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:01,742 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:02,87 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:02,96 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:02,192 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:02,210 INFO     [learner.py:606] ====Pushing takes 0.01584339141845703 s
2021-08-18:15:56:02,229 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:02,237 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:02,238 INFO     [param_server.py:410] Lock worker 1 with localStep 107 , while globalStep is 106

2021-08-18:15:56:03,102 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:03,115 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:03,553 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:03,564 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:03,626 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:03,635 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:04,97 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:04,107 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:04,648 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:04,657 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:05,60 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:05,74 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:56:05,135 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:05,167 INFO     [learner.py:606] ====Pushing takes 0.030229806900024414 s
2021-08-18:15:56:05,205 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:05,215 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 12 clients
2021-08-18:15:56:05,216 INFO     [param_server.py:410] Lock worker 3 with localStep 107 , while globalStep is 106

2021-08-18:15:56:05,659 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:56:05,727 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:05,735 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:05,735 INFO     [param_server.py:381] ====After aggregation in epoch: 106, virtual_clock: 3397.121144308904, top_1: : 59.6644 % (1849.0), top_5: : 100.0 % (3099.0), test loss: 2.312264109099353, test len: 3099.0
2021-08-18:15:56:05,693 INFO     [learner.py:606] ====Pushing takes 0.03299522399902344 s
2021-08-18:15:56:05,738 INFO     [param_server.py:410] Lock worker 2 with localStep 107 , while globalStep is 107

2021-08-18:15:56:05,739 INFO     [param_server.py:441] ====Epoch 108 completes 20 clients with loss 6.152414110009462, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:56:05,739 INFO     [param_server.py:450] ====Start to sample for epoch 108, global virtualClock: 3397.121144308904, round_duration: 29.6995181408989
2021-08-18:15:56:05,740 INFO     [oort.py:208] Training selector: Pacer 106: lastExploitationUtil 2299.860383299086, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:56:05,741 INFO     [oort.py:321] scores are 26,{5: 0.006144315743027275, 6: 0.037915951347460126, 7: 0.1972389678000446, 11: 0.05248790252763462, 12: 0.003247818466603416, 14: 0.004973622906448046, 27: 0.03420276909778178, 50: 0.0028188137905836097, 51: 0.03712956173488617, 53: 0.14421159221280133, 58: 0.0020569113298703695, 60: 0.0009178702326302332, 67: 0.0009003193820037728, 70: 0.0043855914481845245, 79: 0.03508343177895385, 81: 0.07081423367798916, 84: 0.04807714890894156, 85: 0.01007158063260993, 87: 0.00786004482332461, 93: 0.011478383298372549, 97: 0.021061223187088474, 98: 0.029871669691965235, 105: 0.04516375496322918, 107: 0.005964922371032586, 110: 0.007007903543047738, 113: 0.4377627175594717, 119: 0.012709691623748586},[113, 7, 53, 81, 11, 84, 105, 6, 51, 79, 27, 98, 97, 119, 93, 85, 87, 110, 5, 107, 14, 70, 12, 50, 58, 60, 67]
2021-08-18:15:56:05,742 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:56:05,743 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:05,744 INFO     [oort.py:398] At round 106, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1720.1910721279407, 'duration': 5.8943907365129, 'time_stamp': 107, 'count': 104, 'status': True, 'gradient': 21.38348797761483}, [0.13122113465200286, -2.8037645211637515e-06]), ({'reward': 320.3512524174076, 'duration': 27.035726288496562, 'time_stamp': 107, 'count': 100, 'status': True, 'gradient': 11.739978275005319}, [0.024436697023936207, -2.8037645211637515e-06]), ({'reward': 4873.22282448923, 'duration': 8.009219946401625, 'time_stamp': 107, 'count': 28, 'status': True, 'gradient': 21.173867903971463}, [0.37174488441142994, -2.8037645211637515e-06])]
2021-08-18:15:56:05,745 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:56:06,119 INFO     [param_server.py:553] For epoch: 108, median_reward: 1035.026246630513, dev: 5175.131233152565
2021-08-18:15:56:06,813 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1641, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:56:06,814 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1601.9386, eval_time 0.6266, test_loss 2.1641, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:56:06,826 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5535, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:56:06,828 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1601.9669, eval_time 0.6433, test_loss 2.5535, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:56:06,847 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4893, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:56:06,848 INFO     [learner.py:656] After aggregation epoch 107, CumulTime 1601.9836, eval_time 0.663, test_loss 2.4893, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:56:06,886 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:56:06,894 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:56:06,899 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:06,917 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:06,918 INFO     [learner.py:526] ====Start train round 108
2021-08-18:15:56:06,930 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:08,118 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:08,137 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:09,179 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:09,199 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:09,489 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:09,499 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:09,831 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:09,852 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:10,289 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:10,303 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:10,882 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:10,895 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:11,447 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:11,461 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:11,736 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:11,751 INFO     [learner.py:606] ====Pushing takes 0.013368844985961914 s
2021-08-18:15:56:11,773 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:11,778 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:11,779 INFO     [param_server.py:410] Lock worker 1 with localStep 108 , while globalStep is 107

2021-08-18:15:56:11,981 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:11,990 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:12,526 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:12,535 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:13,50 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:13,62 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:13,603 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:13,612 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:15,41 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:15,54 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:15,747 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:15,760 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:15,838 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:15,847 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:16,315 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:16,344 INFO     [learner.py:606] ====Pushing takes 0.026948928833007812 s
2021-08-18:15:56:16,376 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:16,379 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:16,387 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:16,387 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:16,388 INFO     [param_server.py:410] Lock worker 2 with localStep 108 , while globalStep is 107

2021-08-18:15:56:17,0 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:17,10 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:56:17,615 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:56:17,625 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:18,238 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:18,280 INFO     [learner.py:606] ====Pushing takes 0.03849029541015625 s
2021-08-18:15:56:18,320 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:18,331 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:18,332 INFO     [param_server.py:381] ====After aggregation in epoch: 107, virtual_clock: 3435.51716586769, top_1: : 61.0197 % (1891.0), top_5: : 100.0 % (3099.0), test loss: 2.4022937130045006, test len: 3099.0
2021-08-18:15:56:18,334 INFO     [param_server.py:410] Lock worker 3 with localStep 108 , while globalStep is 108

2021-08-18:15:56:18,335 INFO     [param_server.py:441] ====Epoch 109 completes 20 clients with loss 6.244475938040036, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:18,335 INFO     [param_server.py:450] ====Start to sample for epoch 109, global virtualClock: 3435.51716586769, round_duration: 38.39602155878561
2021-08-18:15:56:18,336 INFO     [oort.py:208] Training selector: Pacer 107: lastExploitationUtil 2310.6693822412253, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:56:18,336 INFO     [oort.py:321] scores are 26,{5: 0.006121957638868474, 6: 0.3884087999066756, 7: 0.3991265697081084, 11: 0.012196754157481188, 12: 0.034190544730643056, 14: 0.006418940995234247, 27: 0.04525314054823037, 50: 0.002808556613874282, 51: 0.03699445367023613, 53: 0.04377390563160096, 58: 0.002654642844303586, 60: 0.001181394343820986, 67: 0.0014499328069923546, 70: 0.005660029572930477, 79: 0.02244663695271785, 81: 0.017244291485414683, 84: 0.49046548216875324, 85: 0.04766120994222764, 87: 0.08395592598859353, 93: 0.01143661544331873, 97: 0.16431108366010466, 98: 0.029762971843367823, 105: 0.002786786117132197, 107: 0.007698308750181257, 110: 0.006982402991985058, 113: 0.06577760641140237, 119: 0.010615041162385772},[84, 7, 6, 97, 87, 113, 85, 27, 53, 51, 12, 98, 79, 81, 11, 93, 119, 107, 110, 14, 5, 70, 50, 105, 58, 67, 60]
2021-08-18:15:56:18,337 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:56:18,338 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:18,338 INFO     [oort.py:398] At round 107, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 9398.767344863538, 'duration': 13.298442137908651, 'time_stamp': 108, 'count': 105, 'status': True, 'gradient': 21.18140778850036}, [1.0, -2.777803498180541e-06]), ({'reward': 0.01, 'duration': 43.65853298740619, 'time_stamp': 108, 'count': 89, 'status': True, 'gradient': 8.388514329028153}, [1.0639704401800448e-09, -2.777803498180541e-06]), ({'reward': 3133.0760205210513, 'duration': 5.8943907365129, 'time_stamp': 108, 'count': 105, 'status': True, 'gradient': 21.385750822715682}, [0.33334896436067646, -2.777803498180541e-06])]
2021-08-18:15:56:18,339 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:56:18,675 INFO     [param_server.py:553] For epoch: 109, median_reward: 1061.8410303493454, dev: 5309.205151746727
2021-08-18:15:56:19,307 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4489, Top-1 Accuracy: 611.0/1033 (0.5915), Top-5 Accuracy: 1.0
2021-08-18:15:56:19,308 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1614.4326, eval_time 0.5963, test_loss 2.4489, test_accuracy 0.5915, test_5_accuracy 1.0 

2021-08-18:15:56:19,307 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6592, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:56:19,312 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1614.4477, eval_time 0.6002, test_loss 2.6592, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:56:19,377 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:56:19,379 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:56:19,384 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:19,384 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2682, Top-1 Accuracy: 603.0/1033 (0.5837), Top-5 Accuracy: 1.0
2021-08-18:15:56:19,387 INFO     [learner.py:656] After aggregation epoch 108, CumulTime 1614.5264, eval_time 0.6783, test_loss 2.2682, test_accuracy 0.5837, test_5_accuracy 1.0 

2021-08-18:15:56:19,391 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:19,455 INFO     [learner.py:526] ====Start train round 109
2021-08-18:15:56:19,477 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:20,657 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:20,671 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:21,355 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:21,375 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:21,651 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:21,661 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:22,424 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:22,451 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:22,516 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:22,531 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:23,679 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:23,688 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:23,973 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:24,6 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:24,174 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:24,183 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:24,264 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:24,273 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:24,722 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:24,755 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:24,866 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:24,875 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:25,230 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:25,248 INFO     [learner.py:606] ====Pushing takes 0.01585555076599121 s
2021-08-18:15:56:25,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:25,275 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:25,276 INFO     [param_server.py:410] Lock worker 1 with localStep 109 , while globalStep is 108

2021-08-18:15:56:26,5 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:26,23 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:26,599 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:26,613 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:26,648 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:26,658 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:27,167 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:27,176 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:27,786 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:27,795 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:56:28,15 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:28,42 INFO     [learner.py:606] ====Pushing takes 0.024767160415649414 s
2021-08-18:15:56:28,73 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:28,80 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:28,81 INFO     [param_server.py:410] Lock worker 2 with localStep 109 , while globalStep is 108

2021-08-18:15:56:28,435 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:56:28,444 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:29,8 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:29,42 INFO     [learner.py:606] ====Pushing takes 0.03334784507751465 s
2021-08-18:15:56:29,76 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:29,85 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:29,85 INFO     [param_server.py:381] ====After aggregation in epoch: 108, virtual_clock: 3464.2005688907057, top_1: : 58.6318 % (1817.0), top_5: : 100.0 % (3099.0), test loss: 2.458779642979304, test len: 3099.0
2021-08-18:15:56:29,87 INFO     [param_server.py:410] Lock worker 3 with localStep 109 , while globalStep is 109

2021-08-18:15:56:29,88 INFO     [param_server.py:441] ====Epoch 110 completes 20 clients with loss 5.639946742141769, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:29,88 INFO     [param_server.py:450] ====Start to sample for epoch 110, global virtualClock: 3464.2005688907057, round_duration: 28.683403023015895
2021-08-18:15:56:29,89 INFO     [oort.py:208] Training selector: Pacer 108: lastExploitationUtil 1499.7223165963383, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:56:29,89 INFO     [oort.py:321] scores are 26,{5: 0.006099873200446837, 6: 0.037641700909703965, 7: 0.0655403193238387, 11: 0.05093795998003143, 12: 0.0032092243067489254, 14: 0.006562451808473481, 27: 0.051090611850657754, 50: 0.0027984249861741843, 51: 0.03686099934366006, 53: 0.0696142649647346, 58: 0.0027139937487173473, 60: 0.0017266258580157126, 67: 0.001482349530627641, 70: 0.005786573102084655, 79: 0.012799075504172398, 81: 0.017182084179206535, 84: 0.28941328635872976, 85: 0.07945530497174456, 87: 0.007803192214937554, 93: 0.011395358831560046, 97: 0.2088906460639612, 98: 0.4821343950011988, 105: 0.013864219140849043, 107: 0.007870422896443931, 110: 0.0889876341123236, 113: 0.28667576088030966, 119: 0.0108523658536258},[98, 84, 113, 97, 110, 85, 53, 7, 27, 11, 6, 51, 81, 105, 79, 93, 119, 107, 87, 14, 5, 70, 12, 50, 58, 60, 67]
2021-08-18:15:56:29,90 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:56:29,91 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:29,92 INFO     [oort.py:398] At round 108, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5926.5148630928625, 'duration': 13.411352670399307, 'time_stamp': 109, 'count': 105, 'status': True, 'gradient': 18.255883732906703}, [1.0, -2.7523188286131087e-06]), ({'reward': 3338.7210879508807, 'duration': 13.298442137908651, 'time_stamp': 109, 'count': 106, 'status': True, 'gradient': 18.46458752839191}, [0.5633524597455547, -2.7523188286131087e-06]), ({'reward': 1310.5702719979672, 'duration': 8.009219946401625, 'time_stamp': 109, 'count': 30, 'status': True, 'gradient': 21.19091011537737}, [0.22113544324380613, -2.7523188286131087e-06])]
2021-08-18:15:56:29,93 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:56:29,428 INFO     [param_server.py:553] For epoch: 110, median_reward: 886.135157003732, dev: 4430.6757850186605
2021-08-18:15:56:30,15 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6816, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:56:30,16 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1625.1552, eval_time 0.5543, test_loss 2.6816, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:56:30,49 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5332, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:15:56:30,50 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1625.1744, eval_time 0.5857, test_loss 2.5332, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:15:56:30,82 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:30,94 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4569, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:56:30,95 INFO     [learner.py:656] After aggregation epoch 109, CumulTime 1625.2308, eval_time 0.6308, test_loss 2.4569, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:56:30,101 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:30,118 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:30,139 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:30,166 INFO     [learner.py:526] ====Start train round 110
2021-08-18:15:56:30,181 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:31,622 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:31,631 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:32,947 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:32,966 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:32,965 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:32,978 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:33,85 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:33,106 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:34,145 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:34,164 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:34,232 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:34,253 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:34,828 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:34,848 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:35,116 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:35,125 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:35,139 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:35,151 INFO     [learner.py:606] ====Pushing takes 0.010847806930541992 s
2021-08-18:15:56:35,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:35,172 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:35,173 INFO     [param_server.py:410] Lock worker 1 with localStep 110 , while globalStep is 109

2021-08-18:15:56:36,186 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:36,196 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:36,344 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:36,424 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:36,823 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:36,833 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:39,26 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:39,44 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:39,90 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:39,109 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:39,706 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:39,716 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:39,718 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:39,733 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:40,378 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:40,402 INFO     [learner.py:606] ====Pushing takes 0.023174762725830078 s
2021-08-18:15:56:40,405 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:40,419 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:56:40,433 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:40,443 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:40,443 INFO     [param_server.py:410] Lock worker 2 with localStep 110 , while globalStep is 109

2021-08-18:15:56:41,449 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:56:41,459 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:42,23 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:42,64 INFO     [learner.py:606] ====Pushing takes 0.0399632453918457 s
2021-08-18:15:56:42,105 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:42,115 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:42,116 INFO     [param_server.py:381] ====After aggregation in epoch: 109, virtual_clock: 3502.5965904494915, top_1: : 61.0197 % (1891.0), top_5: : 100.0 % (3099.0), test loss: 2.557240706902963, test len: 3099.0
2021-08-18:15:56:42,118 INFO     [param_server.py:410] Lock worker 3 with localStep 110 , while globalStep is 110

2021-08-18:15:56:42,118 INFO     [param_server.py:441] ====Epoch 111 completes 20 clients with loss 5.590764570153375, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:42,119 INFO     [param_server.py:450] ====Start to sample for epoch 111, global virtualClock: 3502.5965904494915, round_duration: 38.39602155878561
2021-08-18:15:56:42,120 INFO     [oort.py:208] Training selector: Pacer 109: lastExploitationUtil 1960.710331086958, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:56:42,120 INFO     [oort.py:321] scores are 26,{5: 0.04029507674214729, 6: 0.037507072620144556, 7: 0.36104880459571737, 11: 0.08373394898547692, 12: 0.0031977462818778787, 14: 0.004940513364317091, 27: 0.00717134268967967, 50: 0.0027884162150441896, 51: 0.14787373573945248, 53: 0.21002239265835895, 58: 0.0016961740647764077, 60: 0.0009117599456805287, 67: 0.001115980411040701, 70: 0.004356396447366393, 79: 0.0029147509716743493, 81: 0.03174659531811196, 84: 0.10003838023801756, 85: 0.007271429446066356, 87: 0.013182145243630585, 93: 0.01135460249931861, 97: 0.02083410278455576, 98: 0.28629789900623875, 105: 0.007906436009321548, 107: 0.005925213721569929, 110: 0.1130840048779275, 113: 0.0653059095900992, 119: 0.008170156535864698},[7, 98, 53, 51, 110, 84, 11, 113, 5, 6, 81, 97, 87, 93, 119, 105, 85, 27, 107, 14, 70, 12, 79, 50, 58, 67, 60]
2021-08-18:15:56:42,121 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:56:42,122 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:42,122 INFO     [oort.py:398] At round 109, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2219.913157273566, 'duration': 12.029357192292537, 'time_stamp': 110, 'count': 107, 'status': True, 'gradient': 27.393542357766865}, [0.1976194604583355, -2.727297520886556e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 110, 'count': 31, 'status': True, 'gradient': 21.201666861829413}, [8.902165795863932e-10, -2.727297520886556e-06]), ({'reward': 0.01, 'duration': 42.701901101086094, 'time_stamp': 110, 'count': 69, 'status': True, 'gradient': 11.755901819056994}, [8.902165795863932e-10, -2.727297520886556e-06])]
2021-08-18:15:56:42,124 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:56:42,471 INFO     [param_server.py:553] For epoch: 111, median_reward: 979.3484318168659, dev: 4896.74215908433
2021-08-18:15:56:43,62 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.043, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:56:43,62 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3523, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:56:43,63 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1638.1872, eval_time 0.5556, test_loss 2.043, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:56:43,63 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1638.1988, eval_time 0.5579, test_loss 2.3523, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:56:43,131 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:43,131 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:43,139 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:43,137 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.29, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:56:43,139 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:43,140 INFO     [learner.py:656] After aggregation epoch 110, CumulTime 1638.2789, eval_time 0.6355, test_loss 2.29, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:56:43,195 INFO     [learner.py:526] ====Start train round 111
2021-08-18:15:56:43,218 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:44,229 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:44,238 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:44,946 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:44,955 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:45,245 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:45,255 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:45,972 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:45,985 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:46,770 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:46,803 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:47,82 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:47,92 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:47,704 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:47,714 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:56:47,784 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:47,805 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:48,171 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:48,197 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:48,345 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:56:48,354 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:56:49,4 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:49,31 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:49,378 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:49,397 INFO     [learner.py:606] ====Pushing takes 0.017026424407958984 s
2021-08-18:15:56:49,419 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:49,424 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:49,425 INFO     [param_server.py:410] Lock worker 1 with localStep 111 , while globalStep is 110

2021-08-18:15:56:49,616 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:56:49,626 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:56:49,988 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:56:49,999 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:56:50,229 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:56:50,243 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:56:50,581 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:56:50,591 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:56:51,178 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:56:51,187 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:56:51,500 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:56:51,526 INFO     [learner.py:606] ====Pushing takes 0.024353981018066406 s
2021-08-18:15:56:51,564 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:51,572 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:56:51,573 INFO     [param_server.py:410] Lock worker 2 with localStep 111 , while globalStep is 110

2021-08-18:15:56:51,707 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:56:51,716 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:56:52,283 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:56:52,319 INFO     [learner.py:606] ====Pushing takes 0.03525567054748535 s
2021-08-18:15:56:52,368 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:52,379 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:56:52,380 INFO     [param_server.py:381] ====After aggregation in epoch: 110, virtual_clock: 3532.065404254554, top_1: : 60.6002 % (1878.0), top_5: : 100.0 % (3099.0), test loss: 2.22846746886218, test len: 3099.0
2021-08-18:15:56:52,382 INFO     [param_server.py:410] Lock worker 3 with localStep 111 , while globalStep is 111

2021-08-18:15:56:52,382 INFO     [param_server.py:441] ====Epoch 112 completes 20 clients with loss 6.76760897822236, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:56:52,383 INFO     [param_server.py:450] ====Start to sample for epoch 112, global virtualClock: 3532.065404254554, round_duration: 29.468813805062297
2021-08-18:15:56:52,384 INFO     [oort.py:208] Training selector: Pacer 110: lastExploitationUtil 1993.7774400685132, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:56:52,384 INFO     [oort.py:321] scores are 26,{3: 0.030915165276161036, 5: 0.0709408497903191, 6: 0.03737406430358747, 7: 0.08782130261410873, 11: 0.14953403301973803, 12: 0.003186406371295233, 14: 0.007379122406723384, 27: 0.043154448836517784, 50: 0.019938496006313998, 51: 0.03659891361097586, 53: 0.4412520190146186, 58: 0.003051739299176036, 60: 0.0013444382202230398, 67: 0.0016668219371800237, 70: 0.006506688731885453, 79: 0.002904414624611174, 81: 0.01705991768341609, 84: 0.029946874298255093, 85: 0.04629314453333615, 87: 0.0077477106657299274, 93: 0.04497807138377165, 97: 0.020760220480638962, 98: 0.48192354051147523, 105: 0.041308649273436845, 107: 0.00884986520899841, 110: 0.007754648501590791, 113: 0.5176618995365472, 119: 0.012202898912423075},[113, 98, 53, 11, 7, 5, 85, 93, 27, 105, 6, 51, 3, 84, 97, 50, 81, 119, 107, 110, 87, 14, 70, 12, 58, 79, 67, 60]
2021-08-18:15:56:52,386 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:56:52,386 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:56:52,387 INFO     [oort.py:398] At round 110, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 1316.7649001690868, 'duration': 21.635252629006885, 'time_stamp': 111, 'count': 62, 'status': True, 'gradient': 21.834580702926623}, [0.1936167151642752, -2.7027270515950618e-06]), ({'reward': 3077.9824595675937, 'duration': 8.009219946401625, 'time_stamp': 111, 'count': 32, 'status': True, 'gradient': 21.20917458086152}, [0.45258758051429854, -2.7027270515950618e-06]), ({'reward': 6800.842805761173, 'duration': 13.411352670399307, 'time_stamp': 111, 'count': 107, 'status': True, 'gradient': 18.271453761457593}, [1.0, -2.7027270515950618e-06])]
2021-08-18:15:56:52,388 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50]
2021-08-18:15:56:52,765 INFO     [param_server.py:553] For epoch: 112, median_reward: 990.3545812148054, dev: 4951.772906074028
2021-08-18:15:56:53,327 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2836, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:56:53,328 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1648.4674, eval_time 0.5413, test_loss 2.2836, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:56:53,400 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3681, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:56:53,401 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1648.5368, eval_time 0.6139, test_loss 2.3681, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:56:53,401 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7387, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:56:53,404 INFO     [learner.py:656] After aggregation epoch 111, CumulTime 1648.5284, eval_time 0.6143, test_loss 2.7387, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:56:53,405 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:53,426 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:56:53,471 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:53,472 INFO     [learner.py:526] ====Start train round 112
2021-08-18:15:56:53,479 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:56:53,480 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:56:54,699 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:56:54,710 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:56:55,904 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:56:55,922 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:56:56,146 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:56:56,155 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:56:56,447 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:56:56,481 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:56:57,120 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:56:57,134 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:56:57,675 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:56:57,702 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:56:58,362 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:56:58,389 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:56:58,611 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:56:58,620 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:56:58,744 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:56:58,758 INFO     [learner.py:606] ====Pushing takes 0.01202082633972168 s
2021-08-18:15:56:58,784 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:56:58,791 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:56:58,791 INFO     [param_server.py:410] Lock worker 1 with localStep 112 , while globalStep is 111

2021-08-18:15:56:59,263 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:56:59,281 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:56:59,762 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:56:59,774 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:00,489 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:00,498 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:01,87 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:01,96 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:02,234 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:02,255 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:02,928 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:02,937 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:03,154 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:03,163 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:03,607 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:03,632 INFO     [learner.py:606] ====Pushing takes 0.023736238479614258 s
2021-08-18:15:57:03,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:03,676 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:03,677 INFO     [param_server.py:410] Lock worker 2 with localStep 112 , while globalStep is 111

2021-08-18:15:57:03,747 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:03,756 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:04,308 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:04,318 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:57:05,640 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:57:05,677 INFO     [learner.py:606] ====Pushing takes 0.03478074073791504 s
2021-08-18:15:57:05,725 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:05,734 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:05,735 INFO     [param_server.py:381] ====After aggregation in epoch: 111, virtual_clock: 3570.4614258133397, top_1: : 60.2775 % (1868.0), top_5: : 100.0 % (3099.0), test loss: 2.463494883643256, test len: 3099.0
2021-08-18:15:57:05,737 INFO     [param_server.py:410] Lock worker 3 with localStep 112 , while globalStep is 112

2021-08-18:15:57:05,738 INFO     [param_server.py:441] ====Epoch 113 completes 20 clients with loss 3.985035921744619, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:05,739 INFO     [param_server.py:450] ====Start to sample for epoch 113, global virtualClock: 3570.4614258133397, round_duration: 38.39602155878561
2021-08-18:15:57:05,739 INFO     [oort.py:208] Training selector: Pacer 111: lastExploitationUtil 2373.7019956043746, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:57:05,740 INFO     [oort.py:321] scores are 26,{3: 0.05780513660883562, 5: 0.0813711705343146, 6: 0.1368225212230888, 7: 0.453006654665812, 11: 0.07808052003422376, 12: 0.03129629274904912, 14: 0.008167615168588839, 27: 0.005717987676298, 50: 0.007934506602036196, 51: 0.555786958030356, 53: 0.1317094676609137, 58: 0.0033778315112130953, 60: 0.0015073138788040462, 67: 0.0015992838293110608, 70: 0.00624304362640567, 79: 0.002894201499322963, 81: 0.016999927943924048, 84: 0.029841568679488853, 85: 0.11856429082853745, 87: 0.046814505969298245, 93: 0.10066086671068573, 97: 0.2662164266931648, 98: 0.19255774202029, 105: 0.01679929180480486, 107: 0.009795513522735855, 110: 0.006883457510538086, 113: 0.06484549221772486, 119: 0.01350683411445395},[51, 7, 97, 98, 6, 53, 85, 93, 5, 11, 113, 3, 87, 12, 84, 81, 105, 119, 107, 14, 50, 110, 70, 27, 58, 79, 67, 60]
2021-08-18:15:57:05,742 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:57:05,742 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:05,743 INFO     [oort.py:398] At round 111, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6608.273473821618, 'duration': 12.029357192292537, 'time_stamp': 112, 'count': 109, 'status': True, 'gradient': 27.409760060350177}, [0.9233657718674191, -2.6785953446012936e-06]), ({'reward': 2777.9678946876425, 'duration': 5.8943907365129, 'time_stamp': 112, 'count': 109, 'status': True, 'gradient': 21.428545346686974}, [0.38816116384537674, -2.6785953446012936e-06]), ({'reward': 2581.553797020099, 'duration': 13.411352670399307, 'time_stamp': 112, 'count': 108, 'status': True, 'gradient': 18.27906744099477}, [0.3607164266095741, -2.6785953446012936e-06])]
2021-08-18:15:57:05,744 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50]
2021-08-18:15:57:06,110 INFO     [param_server.py:553] For epoch: 113, median_reward: 1089.5622377230889, dev: 5447.811188615444
2021-08-18:15:57:06,845 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4081, Top-1 Accuracy: 614.0/1033 (0.5944), Top-5 Accuracy: 1.0
2021-08-18:15:57:06,847 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1661.9712, eval_time 0.7017, test_loss 2.4081, test_accuracy 0.5944, test_5_accuracy 1.0 

2021-08-18:15:57:06,848 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6485, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:57:06,849 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1661.9851, eval_time 0.7044, test_loss 2.6485, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:57:06,931 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.2769, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:57:06,934 INFO     [learner.py:656] After aggregation epoch 112, CumulTime 1662.0737, eval_time 0.7906, test_loss 2.2769, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:57:06,938 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:57:06,941 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:57:06,947 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:06,949 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:06,992 INFO     [learner.py:526] ====Start train round 113
2021-08-18:15:57:07,12 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:08,12 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:08,23 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:08,609 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:08,623 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:57:09,59 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:09,68 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:09,703 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:57:09,721 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:10,394 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:10,434 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:10,721 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:10,732 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:11,385 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:11,396 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:11,399 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:11,416 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:11,876 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:11,903 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:11,917 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:11,927 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:12,456 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:12,467 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:12,525 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:12,552 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:12,941 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:12,962 INFO     [learner.py:606] ====Pushing takes 0.01626443862915039 s
2021-08-18:15:57:12,984 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:12,989 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:12,989 INFO     [param_server.py:410] Lock worker 1 with localStep 113 , while globalStep is 112

2021-08-18:15:57:13,221 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:13,241 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:13,829 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:13,850 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:14,175 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:14,187 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:14,793 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:14,802 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:15,196 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:15,221 INFO     [learner.py:606] ====Pushing takes 0.02380681037902832 s
2021-08-18:15:57:15,263 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:15,270 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:15,271 INFO     [param_server.py:410] Lock worker 2 with localStep 113 , while globalStep is 112

2021-08-18:15:57:15,419 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:15,431 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:57:15,992 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:57:16,28 INFO     [learner.py:606] ====Pushing takes 0.03449273109436035 s
2021-08-18:15:57:16,65 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:16,76 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:16,76 INFO     [param_server.py:381] ====After aggregation in epoch: 112, virtual_clock: 3599.930239618402, top_1: : 59.7935 % (1853.0), top_5: : 100.0 % (3099.0), test loss: 2.44451458034692, test len: 3099.0
2021-08-18:15:57:16,78 INFO     [param_server.py:410] Lock worker 3 with localStep 113 , while globalStep is 113

2021-08-18:15:57:16,79 INFO     [param_server.py:441] ====Epoch 114 completes 20 clients with loss 3.8969071724963316, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:16,80 INFO     [param_server.py:450] ====Start to sample for epoch 114, global virtualClock: 3599.930239618402, round_duration: 29.468813805062297
2021-08-18:15:57:16,80 INFO     [oort.py:208] Training selector: Pacer 112: lastExploitationUtil 2862.2702800802517, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:57:16,81 INFO     [oort.py:321] scores are 26,{3: 0.13012406967560164, 5: 0.00601415984214029, 6: 0.36668310411617816, 7: 0.06461936888943981, 11: 0.011113318559582877, 12: 0.04059916971527255, 14: 0.006700849486846032, 27: 0.09387669393596089, 31: 0.04444653034739693, 50: 0.0027591024632869264, 51: 0.23236828113589125, 53: 0.04300311777914758, 58: 0.0027712300446784245, 60: 0.0010685656300542083, 67: 0.0015136112815041364, 70: 0.0059086080223300875, 79: 0.002884109101943094, 81: 0.15682006534684975, 84: 0.029737507863535816, 85: 0.007194987171576475, 87: 0.036467791004973715, 93: 0.07691650119907459, 97: 0.29366947791684506, 98: 0.07525821843264416, 105: 0.013782422842658563, 107: 0.006944239833731078, 110: 0.00685945414084871, 113: 0.06461936888943981, 119: 0.01108123492311779},[6, 97, 51, 81, 3, 27, 93, 98, 7, 113, 31, 53, 12, 87, 84, 105, 11, 119, 85, 107, 110, 14, 5, 70, 79, 58, 50, 67, 60]
2021-08-18:15:57:16,82 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:15:57:16,82 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:16,83 INFO     [oort.py:398] At round 112, UCB exploited 29, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 515.9693150843117, 'duration': 31.23200382212914, 'time_stamp': 2, 'count': 1, 'status': True, 'gradient': 21.101973412573706}, [0.046993016058794086, 0.2946902184975088]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 113, 'count': 110, 'status': True, 'gradient': 21.435734795576266}, [9.10789160581857e-10, -2.6548907512455885e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 113, 'count': 34, 'status': True, 'gradient': 21.22813656048098}, [9.10789160581857e-10, -2.6548907512455885e-06])]
2021-08-18:15:57:16,84 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 98, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50]
2021-08-18:15:57:16,420 INFO     [param_server.py:553] For epoch: 114, median_reward: 1201.7512067795024, dev: 6008.756033897512
2021-08-18:15:57:17,5 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4095, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:57:17,7 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1672.1461, eval_time 0.5573, test_loss 2.4095, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:57:17,76 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5742, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:57:17,77 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1672.213, eval_time 0.6251, test_loss 2.5742, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:57:17,79 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3172, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:57:17,80 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:57:17,80 INFO     [learner.py:656] After aggregation epoch 113, CumulTime 1672.2047, eval_time 0.6274, test_loss 2.3172, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:57:17,104 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:17,149 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:57:17,159 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:17,162 INFO     [learner.py:526] ====Start train round 114
2021-08-18:15:57:17,170 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:18,212 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:18,226 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:19,424 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:19,434 INFO     [learner.py:165] Start to run client 98 on rank 2...
2021-08-18:15:57:19,669 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:19,691 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:20,50 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:20,76 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:20,705 INFO     [learner.py:439] Completed to run client 98
2021-08-18:15:57:20,720 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:21,353 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:21,387 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:21,968 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:21,977 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:22,115 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:22,154 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:22,625 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:22,644 INFO     [learner.py:606] ====Pushing takes 0.013081073760986328 s
2021-08-18:15:57:22,667 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:22,675 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:22,676 INFO     [param_server.py:410] Lock worker 1 with localStep 114 , while globalStep is 113

2021-08-18:15:57:23,175 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:23,194 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:23,312 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:23,325 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:23,797 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:23,811 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:24,464 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:24,484 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:26,220 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:26,234 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:26,532 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:26,543 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:26,978 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:26,996 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:27,306 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:27,315 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:27,601 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:27,626 INFO     [learner.py:606] ====Pushing takes 0.023204565048217773 s
2021-08-18:15:57:27,658 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:27,665 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:57:27,666 INFO     [param_server.py:410] Lock worker 2 with localStep 114 , while globalStep is 113

2021-08-18:15:57:27,823 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:27,832 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:57:28,804 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:57:28,842 INFO     [learner.py:606] ====Pushing takes 0.03640389442443848 s
2021-08-18:15:57:28,887 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:28,896 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:28,896 INFO     [param_server.py:381] ====After aggregation in epoch: 113, virtual_clock: 3638.326261177188, top_1: : 61.2456 % (1898.0), top_5: : 100.0 % (3099.0), test loss: 2.4336393453456737, test len: 3099.0
2021-08-18:15:57:28,899 INFO     [param_server.py:410] Lock worker 3 with localStep 114 , while globalStep is 114

2021-08-18:15:57:28,899 INFO     [param_server.py:441] ====Epoch 115 completes 20 clients with loss 5.923168667327724, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 98: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:28,900 INFO     [param_server.py:450] ====Start to sample for epoch 115, global virtualClock: 3638.326261177188, round_duration: 38.39602155878561
2021-08-18:15:57:28,901 INFO     [oort.py:208] Training selector: Pacer 113: lastExploitationUtil 2941.766542555241, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:57:28,901 INFO     [oort.py:321] scores are 26,{3: 0.15673067790544842, 5: 0.005993361164883693, 6: 0.036984425905092724, 7: 0.4413134185176775, 11: 0.011074885539504005, 12: 0.0031531869101903364, 14: 0.00571904882043874, 27: 0.062419911737219204, 50: 0.04544732313238649, 51: 0.047316592782763026, 53: 0.04285440075279771, 58: 0.0023185229566404803, 60: 0.0009010739514269606, 67: 0.0012663483171800642, 70: 0.005042885653061708, 79: 0.0063566951282557635, 81: 0.016882061752345183, 84: 0.14462110078548657, 85: 0.007170104857175978, 87: 0.01735508963032537, 93: 0.14951803771690225, 97: 0.07109203643248775, 98: 0.05620685568542266, 105: 0.011763038291760624, 107: 0.006858920125576051, 110: 0.037291008830949816, 113: 0.06439589671155732, 119: 0.009457625281759674},[7, 3, 93, 84, 97, 113, 27, 98, 51, 50, 53, 110, 6, 87, 81, 105, 11, 119, 85, 107, 79, 5, 14, 70, 12, 58, 67, 60]
2021-08-18:15:57:28,902 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:28,903 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:28,903 INFO     [oort.py:398] At round 113, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5199.518166701062, 'duration': 5.8943907365129, 'time_stamp': 114, 'count': 111, 'status': True, 'gradient': 21.44570868455841}, [0.37691752253103017, -2.6316020315967705e-06]), ({'reward': 3446.8465095489864, 'duration': 13.298442137908651, 'time_stamp': 114, 'count': 111, 'status': True, 'gradient': 21.239786733573197}, [0.249864609760489, -2.6316020315967705e-06]), ({'reward': 3957.789927105566, 'duration': 27.689063957948644, 'time_stamp': 114, 'count': 106, 'status': True, 'gradient': 20.710420421743596}, [0.2869034066147623, -2.6316020315967705e-06])]
2021-08-18:15:57:28,904 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:57:29,252 INFO     [param_server.py:553] For epoch: 115, median_reward: 1222.3845041446477, dev: 6111.922520723238
2021-08-18:15:57:29,917 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5981, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:57:29,918 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1685.054, eval_time 0.6208, test_loss 2.5981, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:57:29,919 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.262, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:15:57:29,919 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1685.0441, eval_time 0.622, test_loss 2.262, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:15:57:29,984 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:29,985 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:29,991 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:29,994 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:30,41 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5565, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:15:57:30,42 INFO     [learner.py:656] After aggregation epoch 114, CumulTime 1685.1811, eval_time 0.7447, test_loss 2.5565, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:15:57:30,111 INFO     [learner.py:526] ====Start train round 115
2021-08-18:15:57:30,137 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:31,177 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:31,188 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:31,741 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:31,750 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:32,203 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:32,213 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:33,273 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:33,295 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:33,882 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:33,915 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:33,979 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:33,990 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:34,693 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:34,708 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:35,267 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:35,294 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:35,341 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:35,352 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:35,389 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:35,415 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:35,889 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:35,896 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:35,906 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:35,910 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:35,972 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:35,993 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:36,393 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:36,411 INFO     [learner.py:606] ====Pushing takes 0.016263723373413086 s
2021-08-18:15:57:36,427 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:36,432 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:36,432 INFO     [param_server.py:410] Lock worker 1 with localStep 115 , while globalStep is 114

2021-08-18:15:57:37,460 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:37,484 INFO     [learner.py:606] ====Pushing takes 0.022753238677978516 s
2021-08-18:15:57:37,518 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:37,524 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:57:37,525 INFO     [param_server.py:410] Lock worker 2 with localStep 115 , while globalStep is 114

2021-08-18:15:57:37,557 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:37,571 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:38,97 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:38,106 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:38,710 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:38,719 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:57:39,396 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:57:39,405 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:39,998 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:40,39 INFO     [learner.py:606] ====Pushing takes 0.039235591888427734 s
2021-08-18:15:57:40,96 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:40,108 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:40,109 INFO     [param_server.py:381] ====After aggregation in epoch: 114, virtual_clock: 3667.7950749822503, top_1: : 58.7609 % (1821.0), top_5: : 100.0 % (3099.0), test loss: 2.4722220919750355, test len: 3099.0
2021-08-18:15:57:40,111 INFO     [param_server.py:410] Lock worker 3 with localStep 115 , while globalStep is 115

2021-08-18:15:57:40,112 INFO     [param_server.py:441] ====Epoch 116 completes 20 clients with loss 4.757638836505108, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:40,112 INFO     [param_server.py:450] ====Start to sample for epoch 116, global virtualClock: 3667.7950749822503, round_duration: 29.468813805062297
2021-08-18:15:57:40,113 INFO     [oort.py:208] Training selector: Pacer 114: lastExploitationUtil 3509.4690351509985, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:57:40,114 INFO     [oort.py:321] scores are 26,{3: 0.01736271857676057, 5: 0.044076995746468006, 6: 0.19333460693353335, 7: 0.5293191177945481, 11: 0.05539154414940066, 12: 0.03572305420280998, 14: 0.006321345474287473, 27: 0.0056588665710542016, 50: 0.0027401298697859303, 51: 0.0360931330411712, 53: 0.04270741267803029, 58: 0.0026142808513346847, 60: 0.0008712414366215546, 67: 0.0012222589135837587, 70: 0.005573972770857608, 79: 0.04749654661465055, 81: 0.016824157273190383, 84: 0.029533021928006113, 85: 0.03485254623202795, 87: 0.007640640779534744, 93: 0.011157977528629397, 97: 0.15507680974846155, 105: 0.021301027432992014, 107: 0.00758126133481463, 110: 0.07842210441025713, 113: 0.06417502257227922, 119: 0.01045364686496449},[7, 6, 97, 110, 113, 11, 79, 5, 53, 51, 12, 85, 84, 105, 3, 81, 93, 119, 87, 107, 14, 27, 70, 50, 58, 67, 60]
2021-08-18:15:57:40,115 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:40,115 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:40,116 INFO     [oort.py:398] At round 114, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 115, 'count': 112, 'status': True, 'gradient': 20.197921806163503}, [6.915932910735032e-10, -2.608718336681191e-06]), ({'reward': 14459.375239881789, 'duration': 42.701901101086094, 'time_stamp': 115, 'count': 74, 'status': True, 'gradient': 8.41602944398402}, [1.0, -2.608718336681191e-06]), ({'reward': 6725.69836664458, 'duration': 5.8943907365129, 'time_stamp': 115, 'count': 112, 'status': True, 'gradient': 21.455836897469016}, [0.4651440959138622, -2.608718336681191e-06])]
2021-08-18:15:57:40,116 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:57:40,408 INFO     [param_server.py:553] For epoch: 116, median_reward: 1323.6812418109866, dev: 6618.406209054933
2021-08-18:15:57:41,47 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5182, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:57:41,48 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1696.1844, eval_time 0.5948, test_loss 2.5182, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:57:41,48 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3796, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:57:41,49 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1696.174, eval_time 0.5956, test_loss 2.3796, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:57:41,60 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5645, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:57:41,78 INFO     [learner.py:656] After aggregation epoch 115, CumulTime 1696.2169, eval_time 0.6242, test_loss 2.5645, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:57:41,125 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:41,125 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:41,134 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:41,136 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:41,155 INFO     [learner.py:526] ====Start train round 116
2021-08-18:15:57:41,184 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:42,317 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:42,326 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:43,399 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:43,412 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:43,780 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:43,789 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:44,387 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:44,414 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:45,724 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:45,727 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:45,747 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:45,780 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:57:45,959 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:45,973 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:46,469 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:57:46,496 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:57:46,872 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:57:46,886 INFO     [learner.py:606] ====Pushing takes 0.012320756912231445 s
2021-08-18:15:57:46,910 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:46,915 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:57:46,916 INFO     [param_server.py:410] Lock worker 1 with localStep 116 , while globalStep is 115

2021-08-18:15:57:47,40 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:47,54 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:47,661 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:57:47,681 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:57:48,273 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:57:48,286 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:57:48,765 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:57:48,779 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:57:49,387 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:57:49,401 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:57:49,998 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:57:50,24 INFO     [learner.py:606] ====Pushing takes 0.0238034725189209 s
2021-08-18:15:57:50,58 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:50,64 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:57:50,65 INFO     [param_server.py:410] Lock worker 2 with localStep 116 , while globalStep is 115

2021-08-18:15:57:50,317 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:57:50,326 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:57:50,970 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:57:50,984 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:57:51,619 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:57:51,628 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:57:52,897 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:57:52,912 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:57:53,575 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:57:53,617 INFO     [learner.py:606] ====Pushing takes 0.04057002067565918 s
2021-08-18:15:57:53,665 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:57:53,675 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:57:53,675 INFO     [param_server.py:381] ====After aggregation in epoch: 115, virtual_clock: 3706.191096541036, top_1: : 60.9874 % (1890.0), top_5: : 100.0 % (3099.0), test loss: 2.4874433411492247, test len: 3099.0
2021-08-18:15:57:53,677 INFO     [param_server.py:410] Lock worker 3 with localStep 116 , while globalStep is 116

2021-08-18:15:57:53,678 INFO     [param_server.py:441] ====Epoch 117 completes 20 clients with loss 6.753701739236423, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:57:53,678 INFO     [param_server.py:450] ====Start to sample for epoch 117, global virtualClock: 3706.191096541036, round_duration: 38.39602155878561
2021-08-18:15:57:53,679 INFO     [oort.py:208] Training selector: Pacer 115: lastExploitationUtil 2126.824384943437, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:57:53,680 INFO     [oort.py:321] scores are 26,{3: 0.017303649529826798, 5: 0.029755500089278537, 6: 0.05729189617643513, 7: 0.8841615113018745, 11: 0.01099935111630678, 12: 0.025793949185685436, 14: 0.005578532588609284, 27: 0.0056396147555277465, 50: 0.0027308077777893664, 51: 0.5983874874385939, 53: 0.042562119407696754, 58: 0.002307080191118904, 60: 0.0011250904588439962, 67: 0.0012600984213916133, 70: 0.0049189826559439655, 79: 0.03740936039336701, 81: 0.016766920445259452, 84: 0.13960592542493802, 85: 0.007121202344123489, 87: 0.007614646845070213, 93: 0.011120017396095387, 97: 0.020403672027286046, 105: 0.025977085343626048, 107: 0.006690397414767783, 110: 0.006789110215538654, 113: 0.06395669515980987, 119: 0.009225252747729458},[7, 51, 84, 113, 6, 53, 79, 5, 105, 12, 97, 3, 81, 93, 11, 119, 87, 85, 110, 107, 27, 14, 70, 50, 58, 67, 60]
2021-08-18:15:57:53,681 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:57:53,681 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:57:53,682 INFO     [oort.py:398] At round 115, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4758.261351832974, 'duration': 40.768613044536735, 'time_stamp': 116, 'count': 12, 'status': True, 'gradient': 21.049328061917155}, [0.4628197180123784, -2.5862291916309646e-06]), ({'reward': 10281.013967677787, 'duration': 12.029357192292537, 'time_stamp': 116, 'count': 113, 'status': True, 'gradient': 27.460763161833214}, [1.0, -2.5862291916309646e-06]), ({'reward': 2461.3427457406706, 'duration': 13.298442137908651, 'time_stamp': 116, 'count': 113, 'status': True, 'gradient': 21.25959101284817}, [0.23940587525155516, -2.5862291916309646e-06])]
2021-08-18:15:57:53,682 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:57:54,19 INFO     [param_server.py:553] For epoch: 117, median_reward: 1029.50031328163, dev: 5147.50156640815
2021-08-18:15:57:54,768 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3862, Top-1 Accuracy: 615.0/1033 (0.5954), Top-5 Accuracy: 1.0
2021-08-18:15:57:54,772 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1709.9078, eval_time 0.7047, test_loss 2.3862, test_accuracy 0.5954, test_5_accuracy 1.0 

2021-08-18:15:57:54,772 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4337, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:57:54,773 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1709.8974, eval_time 0.7054, test_loss 2.4337, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:57:54,841 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:54,842 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:54,850 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:57:54,851 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:57:54,855 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4603, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:57:54,856 INFO     [learner.py:656] After aggregation epoch 116, CumulTime 1709.995, eval_time 0.7913, test_loss 2.4603, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:57:54,928 INFO     [learner.py:526] ====Start train round 117
2021-08-18:15:57:54,952 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:57:55,986 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:57:55,997 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:57:56,640 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:57:56,649 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:57:57,1 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:57:57,12 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:57:58,281 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:57:58,314 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:57:58,347 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:57:58,374 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:57:58,725 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:57:58,739 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:57:59,295 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:57:59,306 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:57:59,648 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:57:59,675 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:00,15 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:00,24 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:00,367 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:00,389 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:00,438 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:00,465 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:00,637 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:00,646 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:00,860 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:00,878 INFO     [learner.py:606] ====Pushing takes 0.01595282554626465 s
2021-08-18:15:58:00,900 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:00,908 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:00,909 INFO     [param_server.py:410] Lock worker 1 with localStep 117 , while globalStep is 116

2021-08-18:15:58:00,990 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:01,4 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:02,208 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:02,218 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:02,248 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:02,272 INFO     [learner.py:606] ====Pushing takes 0.02305006980895996 s
2021-08-18:15:58:02,306 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:02,312 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:02,314 INFO     [param_server.py:410] Lock worker 2 with localStep 117 , while globalStep is 116

2021-08-18:15:58:02,937 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:02,952 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:03,547 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:03,557 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:58:04,141 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:58:04,150 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:04,747 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:04,788 INFO     [learner.py:606] ====Pushing takes 0.040264129638671875 s
2021-08-18:15:58:04,829 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:04,838 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:04,839 INFO     [param_server.py:381] ====After aggregation in epoch: 116, virtual_clock: 3735.6599103460985, top_1: : 59.9871 % (1859.0), top_5: : 100.0 % (3099.0), test loss: 2.426745999742437, test len: 3099.0
2021-08-18:15:58:04,841 INFO     [param_server.py:410] Lock worker 3 with localStep 117 , while globalStep is 117

2021-08-18:15:58:04,842 INFO     [param_server.py:441] ====Epoch 118 completes 20 clients with loss 5.4679917649344265, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:04,843 INFO     [param_server.py:450] ====Start to sample for epoch 118, global virtualClock: 3735.6599103460985, round_duration: 29.468813805062297
2021-08-18:15:58:04,843 INFO     [oort.py:208] Training selector: Pacer 116: lastExploitationUtil 2063.0618326241943, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:58:04,844 INFO     [oort.py:321] scores are 26,{3: 0.017245255837167687, 5: 0.0059323969092192706, 6: 0.036608221646005044, 7: 0.3261812519554645, 11: 0.010962232199431576, 12: 0.003121112805583246, 14: 0.005911136934869105, 27: 0.005620583051829493, 50: 0.006418835613221366, 51: 0.03584895478828049, 53: 0.49093381679746007, 58: 0.0024446333713769013, 60: 0.00109088620821723, 67: 0.001368605450529736, 70: 0.005212263188871981, 79: 0.01891887376865069, 81: 0.03226983934931033, 84: 0.489528183545746, 85: 0.0070971708067111465, 87: 0.0887961058737361, 93: 0.012604227496061883, 97: 0.02033481685592899, 105: 0.03345576479028325, 107: 0.007089293580204003, 110: 0.07103007174158489, 113: 0.06374086395066425, 119: 0.009775282546875097},[53, 84, 7, 87, 110, 113, 6, 51, 105, 81, 97, 79, 3, 93, 11, 119, 85, 107, 50, 5, 14, 27, 70, 12, 58, 67, 60]
2021-08-18:15:58:04,845 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:58:04,845 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:04,846 INFO     [oort.py:398] At round 116, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6228.675443293009, 'duration': 11.058674649423494, 'time_stamp': 117, 'count': 114, 'status': True, 'gradient': 20.21778541355461}, [0.673969215988006, -2.56412447969641e-06]), ({'reward': 9241.775497289662, 'duration': 13.298442137908651, 'time_stamp': 117, 'count': 114, 'status': True, 'gradient': 18.533010365769666}, [1.0, -2.56412447969641e-06]), ({'reward': 2425.4225255824786, 'duration': 5.8943907365129, 'time_stamp': 117, 'count': 114, 'status': True, 'gradient': 21.482192290021466}, [0.2624403890868446, -2.56412447969641e-06])]
2021-08-18:15:58:04,847 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:58:05,121 INFO     [param_server.py:553] For epoch: 118, median_reward: 1013.6277191420828, dev: 5068.138595710414
2021-08-18:15:58:05,671 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.544, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:15:58:05,683 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1720.8188, eval_time 0.5262, test_loss 2.544, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:15:58:05,706 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3001, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:15:58:05,707 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1720.8315, eval_time 0.55, test_loss 2.3001, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:15:58:05,718 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3394, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:58:05,719 INFO     [learner.py:656] After aggregation epoch 117, CumulTime 1720.8584, eval_time 0.5648, test_loss 2.3394, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:58:05,756 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:58:05,764 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:05,780 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:58:05,788 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:05,790 INFO     [learner.py:526] ====Start train round 118
2021-08-18:15:58:05,810 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:06,776 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:06,785 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:07,967 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:07,985 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:08,247 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:08,262 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:09,217 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:09,257 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:10,358 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:10,368 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:10,448 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:10,469 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:10,711 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:10,721 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:11,42 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:11,62 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:11,384 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:11,397 INFO     [learner.py:606] ====Pushing takes 0.012544631958007812 s
2021-08-18:15:58:11,420 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:11,424 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:11,425 INFO     [param_server.py:410] Lock worker 1 with localStep 118 , while globalStep is 117

2021-08-18:15:58:11,886 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:11,896 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:12,653 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:12,666 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:13,214 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:13,236 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:13,309 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:13,319 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:13,935 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:13,957 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:14,647 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:14,672 INFO     [learner.py:606] ====Pushing takes 0.023806095123291016 s
2021-08-18:15:58:14,709 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:14,716 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:14,716 INFO     [param_server.py:410] Lock worker 2 with localStep 118 , while globalStep is 117

2021-08-18:15:58:15,678 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:15,689 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:16,352 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:16,362 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:16,983 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:16,992 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:58:18,61 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:58:18,70 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:18,692 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:18,735 INFO     [learner.py:606] ====Pushing takes 0.04134821891784668 s
2021-08-18:15:58:18,783 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:18,794 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:18,795 INFO     [param_server.py:381] ====After aggregation in epoch: 117, virtual_clock: 3774.0559319048843, top_1: : 61.2778 % (1899.0), top_5: : 100.0 % (3099.0), test loss: 2.3944908380508423, test len: 3099.0
2021-08-18:15:58:18,798 INFO     [param_server.py:410] Lock worker 3 with localStep 118 , while globalStep is 118

2021-08-18:15:58:18,798 INFO     [param_server.py:441] ====Epoch 119 completes 20 clients with loss 5.234296586626117, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:18,798 INFO     [param_server.py:450] ====Start to sample for epoch 119, global virtualClock: 3774.0559319048843, round_duration: 38.39602155878561
2021-08-18:15:58:18,799 INFO     [oort.py:208] Training selector: Pacer 117: lastExploitationUtil 1056.8223009716103, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:58:18,800 INFO     [oort.py:321] scores are 26,{3: 0.07467134519785315, 5: 0.02250082670054206, 6: 0.11007568402212747, 7: 0.06352748128313279, 11: 0.010925534385755494, 12: 0.04304873611463751, 14: 0.005685544836819964, 27: 0.049784207423259376, 50: 0.002712481305637606, 51: 0.035728944717396315, 53: 0.042276484694631564, 58: 0.002351336603380091, 60: 0.0010492537251338306, 67: 0.0022878375839417795, 70: 0.00501334284557461, 79: 0.027202117388789093, 81: 0.1454831686364893, 84: 0.48942998549029476, 85: 0.007073411900025561, 87: 0.007563544891103817, 93: 0.011045390873205663, 97: 0.020266742826247807, 105: 0.002691455535626194, 107: 0.006818738417962622, 110: 0.04676177224978038, 113: 0.06352748128313279, 119: 0.009402219543417282},[84, 81, 6, 3, 7, 113, 27, 110, 12, 53, 51, 79, 5, 97, 93, 11, 119, 87, 85, 107, 14, 70, 50, 105, 58, 67, 60]
2021-08-18:15:58:18,801 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:58:18,801 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:18,801 INFO     [oort.py:398] At round 117, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 118, 'count': 115, 'status': True, 'gradient': 21.485589709439882}, [2.010695405711835e-09, -2.5423944270714182e-06]), ({'reward': 4973.413704750792, 'duration': 13.298442137908651, 'time_stamp': 118, 'count': 115, 'status': True, 'gradient': 21.27840078672854}, [1.0, -2.5423944270714182e-06]), ({'reward': 0.01, 'duration': 21.635252629006885, 'time_stamp': 118, 'count': 69, 'status': True, 'gradient': 21.904097015983396}, [2.010695405711835e-09, -2.5423944270714182e-06])]
2021-08-18:15:58:18,803 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 119]
2021-08-18:15:58:19,116 INFO     [param_server.py:553] For epoch: 119, median_reward: 795.6083154177462, dev: 3978.041577088731
2021-08-18:15:58:19,774 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.755, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:15:58:19,775 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1734.9107, eval_time 0.6006, test_loss 2.755, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:15:58:19,803 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5242, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:15:58:19,804 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1734.9283, eval_time 0.6283, test_loss 2.5242, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:15:58:19,841 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:58:19,855 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:19,873 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:58:19,886 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:19,921 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4455, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:15:58:19,924 INFO     [learner.py:656] After aggregation epoch 118, CumulTime 1735.0633, eval_time 0.7523, test_loss 2.4455, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:15:58:20,14 INFO     [learner.py:526] ====Start train round 119
2021-08-18:15:58:20,50 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:21,197 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:21,217 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:21,854 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:21,875 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:22,8 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:22,17 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:23,450 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:23,464 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:23,755 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:23,769 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:23,965 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:23,974 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:24,557 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:24,576 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:24,599 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:24,613 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:25,222 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:25,232 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:25,241 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:25,254 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:25,546 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:25,555 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:25,745 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:25,764 INFO     [learner.py:606] ====Pushing takes 0.017016172409057617 s
2021-08-18:15:58:25,789 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:25,793 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:25,794 INFO     [param_server.py:410] Lock worker 1 with localStep 119 , while globalStep is 118

2021-08-18:15:58:25,919 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:25,930 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:26,215 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:26,224 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:27,328 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:27,340 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:58:27,687 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:27,701 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:27,856 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:58:27,883 INFO     [learner.py:606] ====Pushing takes 0.02465367317199707 s
2021-08-18:15:58:27,928 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:27,936 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:58:27,936 INFO     [param_server.py:410] Lock worker 2 with localStep 119 , while globalStep is 118

2021-08-18:15:58:28,384 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:28,393 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:28,910 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:28,920 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:58:29,485 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:58:29,521 INFO     [learner.py:606] ====Pushing takes 0.03505849838256836 s
2021-08-18:15:58:29,573 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:29,582 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:29,583 INFO     [param_server.py:381] ====After aggregation in epoch: 118, virtual_clock: 3803.5247457099467, top_1: : 61.4069 % (1903.0), top_5: : 100.0 % (3099.0), test loss: 2.574916002927003, test len: 3099.0
2021-08-18:15:58:29,585 INFO     [param_server.py:410] Lock worker 3 with localStep 119 , while globalStep is 119

2021-08-18:15:58:29,586 INFO     [param_server.py:441] ====Epoch 120 completes 20 clients with loss 5.872671448101878, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:58:29,586 INFO     [param_server.py:450] ====Start to sample for epoch 120, global virtualClock: 3803.5247457099467, round_duration: 29.468813805062297
2021-08-18:15:58:29,587 INFO     [oort.py:208] Training selector: Pacer 118: lastExploitationUtil 2583.3705111088593, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:58:29,588 INFO     [oort.py:321] scores are 26,{3: 0.17110407110869613, 5: 0.005892900859172633, 6: 0.03636449551365506, 7: 0.06331649714056443, 11: 0.032345933822470904, 12: 0.011272500191275214, 14: 0.00694050773498829, 27: 0.04277796134880364, 50: 0.008744892603396625, 51: 0.03561028361807655, 53: 0.04213607824857167, 58: 0.0028703440658201566, 60: 0.001280854131708825, 67: 0.001567746123482863, 70: 0.006119931474732752, 79: 0.04208677595584312, 81: 0.10715413984510651, 84: 0.09651846091392491, 85: 0.007049920055006421, 87: 0.007538425242073272, 93: 0.06505731272254324, 97: 0.3392226723572261, 105: 0.0026938594307227737, 107: 0.008323829657669445, 110: 0.054758222909164565, 113: 0.5120207675691392, 119: 0.017994666003473454},[113, 97, 3, 81, 84, 93, 7, 110, 27, 53, 79, 6, 51, 11, 119, 12, 50, 107, 87, 85, 14, 70, 5, 58, 105, 67, 60]
2021-08-18:15:58:29,588 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:58:29,589 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:29,589 INFO     [oort.py:398] At round 118, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4236.270406212226, 'duration': 8.009219946401625, 'time_stamp': 119, 'count': 40, 'status': True, 'gradient': 21.28857363876119}, [0.44870427148777375, -2.521029588483939e-06]), ({'reward': 9441.106688647442, 'duration': 15.972045438625893, 'time_stamp': 119, 'count': 115, 'status': True, 'gradient': 21.28568453554496}, [1.0, -2.521029588483939e-06]), ({'reward': 4272.4120820933695, 'duration': 27.689063957948644, 'time_stamp': 119, 'count': 111, 'status': True, 'gradient': 20.761177241939848}, [0.4525323941132227, -2.521029588483939e-06])]
2021-08-18:15:58:29,590 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:58:29,896 INFO     [param_server.py:553] For epoch: 120, median_reward: 1108.6381783623485, dev: 5543.190891811742
2021-08-18:15:58:30,525 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.1972, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:15:58:30,527 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1745.6512, eval_time 0.5729, test_loss 2.1972, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:15:58:30,533 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6354, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:15:58:30,534 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1745.6704, eval_time 0.581, test_loss 2.6354, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:15:58:30,586 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4797, Top-1 Accuracy: 617.0/1033 (0.5973), Top-5 Accuracy: 1.0
2021-08-18:15:58:30,587 INFO     [learner.py:656] After aggregation epoch 119, CumulTime 1745.7263, eval_time 0.6362, test_loss 2.4797, test_accuracy 0.5973, test_5_accuracy 1.0 

2021-08-18:15:58:30,591 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:30,594 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:30,599 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:30,601 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:30,670 INFO     [learner.py:526] ====Start train round 120
2021-08-18:15:58:30,702 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:31,736 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:31,763 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:33,30 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:33,49 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:33,316 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:33,337 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:34,143 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:34,164 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:35,215 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:35,233 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:35,292 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:35,306 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:35,701 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:35,711 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:35,777 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:35,791 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:36,67 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:36,81 INFO     [learner.py:606] ====Pushing takes 0.013515233993530273 s
2021-08-18:15:58:36,104 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:36,108 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:36,109 INFO     [param_server.py:410] Lock worker 1 with localStep 120 , while globalStep is 119

2021-08-18:15:58:36,907 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:36,919 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:37,540 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:37,549 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:38,187 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:38,196 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:38,205 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:38,216 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:38,899 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:38,908 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:39,452 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:39,476 INFO     [learner.py:606] ====Pushing takes 0.022853612899780273 s
2021-08-18:15:58:39,519 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:39,527 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:39,528 INFO     [param_server.py:410] Lock worker 2 with localStep 120 , while globalStep is 119

2021-08-18:15:58:40,465 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:40,476 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:41,111 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:41,125 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:41,837 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:41,851 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:58:42,842 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:58:42,856 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:43,488 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:43,527 INFO     [learner.py:606] ====Pushing takes 0.0379481315612793 s
2021-08-18:15:58:43,574 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:43,584 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:43,584 INFO     [param_server.py:381] ====After aggregation in epoch: 119, virtual_clock: 3841.9207672687326, top_1: : 60.2775 % (1868.0), top_5: : 100.0 % (3099.0), test loss: 2.4374344922878124, test len: 3099.0
2021-08-18:15:58:43,586 INFO     [param_server.py:410] Lock worker 3 with localStep 120 , while globalStep is 120

2021-08-18:15:58:43,587 INFO     [param_server.py:441] ====Epoch 121 completes 20 clients with loss 7.055016486148643, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:43,597 INFO     [param_server.py:450] ====Start to sample for epoch 121, global virtualClock: 3841.9207672687326, round_duration: 38.39602155878561
2021-08-18:15:58:43,597 INFO     [oort.py:208] Training selector: Pacer 119: lastExploitationUtil 2597.1355903915764, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:58:43,598 INFO     [oort.py:321] scores are 26,{3: 0.022321527421502257, 5: 0.005873483648893964, 6: 0.03790319323773873, 7: 0.24509205783032595, 11: 0.010853368809271702, 12: 0.0030901177568645366, 14: 0.006224813035541776, 27: 0.005564766342735426, 50: 0.00566513388337876, 51: 0.11273081725103454, 53: 0.5336735096672783, 58: 0.002574358510881688, 60: 0.0011487743836801716, 67: 0.001401417514942975, 70: 0.005488853362772474, 79: 0.0028166473949020575, 81: 0.23162230957358007, 84: 0.43642614053303047, 85: 0.007026690446460948, 87: 0.007513586000485231, 93: 0.0842287323509345, 97: 0.04767784936944663, 105: 0.002673677875197777, 107: 0.007465488885991051, 110: 0.11285067910159927, 113: 0.48165810464721737, 119: 0.010294010592945189},[53, 113, 84, 7, 81, 110, 51, 93, 97, 6, 3, 11, 119, 87, 107, 85, 14, 5, 50, 27, 70, 12, 79, 105, 58, 67, 60]
2021-08-18:15:58:43,599 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:58:43,599 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:43,599 INFO     [oort.py:398] At round 119, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 8025.4498560354505, 'duration': 11.058674649423494, 'time_stamp': 120, 'count': 117, 'status': True, 'gradient': 20.555074481065937}, [0.7388257405435389, -2.5000208335069482e-06]), ({'reward': 4546.480932583322, 'duration': 8.009219946401625, 'time_stamp': 120, 'count': 41, 'status': True, 'gradient': 21.291617117220838}, [0.4185502373807166, -2.5000208335069482e-06]), ({'reward': 1976.7997765397233, 'duration': 5.8943907365129, 'time_stamp': 120, 'count': 117, 'status': True, 'gradient': 21.498729709980317}, [0.1819841905638252, -2.5000208335069482e-06])]
2021-08-18:15:58:43,600 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:58:43,875 INFO     [param_server.py:541] Handle Wight 0.046863555908203125 | Send 0.27802038192749023
2021-08-18:15:58:43,875 INFO     [param_server.py:553] For epoch: 121, median_reward: 1133.1487107374144, dev: 5665.743553687072
2021-08-18:15:58:44,523 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2951, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:58:44,524 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1759.6487, eval_time 0.6007, test_loss 2.2951, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:58:44,589 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:44,596 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:44,603 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6656, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:58:44,604 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1759.7402, eval_time 0.6832, test_loss 2.6656, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:58:44,641 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4709, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:15:58:44,643 INFO     [learner.py:656] After aggregation epoch 120, CumulTime 1759.7827, eval_time 0.725, test_loss 2.4709, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:15:58:44,674 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:44,697 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:44,712 INFO     [learner.py:526] ====Start train round 121
2021-08-18:15:58:44,738 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:45,894 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:45,909 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:46,573 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:46,584 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:46,842 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:46,852 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:47,740 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:47,760 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:48,505 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:58:48,519 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:58:48,701 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:58:48,715 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:58:49,167 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:49,181 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:58:49,252 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:58:49,261 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:58:49,780 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:58:49,801 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:58:49,810 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:58:49,820 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:58:50,235 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:58:50,253 INFO     [learner.py:606] ====Pushing takes 0.016523122787475586 s
2021-08-18:15:58:50,262 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:58:50,271 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:58:50,275 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:50,280 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:58:50,281 INFO     [param_server.py:410] Lock worker 1 with localStep 121 , while globalStep is 120

2021-08-18:15:58:50,427 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:58:50,437 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:58:50,885 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:58:50,894 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:58:52,155 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:58:52,181 INFO     [learner.py:606] ====Pushing takes 0.02353048324584961 s
2021-08-18:15:58:52,195 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:58:52,204 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:58:52,219 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:52,227 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:58:52,228 INFO     [param_server.py:410] Lock worker 2 with localStep 121 , while globalStep is 120

2021-08-18:15:58:52,741 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:58:52,750 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:58:53,232 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:58:53,242 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:58:53,786 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:58:53,795 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:58:54,334 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:58:54,376 INFO     [learner.py:606] ====Pushing takes 0.03997087478637695 s
2021-08-18:15:58:54,417 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:58:54,427 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:58:54,428 INFO     [param_server.py:381] ====After aggregation in epoch: 120, virtual_clock: 3871.389581073795, top_1: : 60.6325 % (1879.0), top_5: : 100.0 % (3099.0), test loss: 2.4771860440572104, test len: 3099.0
2021-08-18:15:58:54,430 INFO     [param_server.py:410] Lock worker 3 with localStep 121 , while globalStep is 121

2021-08-18:15:58:54,430 INFO     [param_server.py:441] ====Epoch 122 completes 20 clients with loss 5.155845884256998, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:58:54,431 INFO     [param_server.py:450] ====Start to sample for epoch 122, global virtualClock: 3871.389581073795, round_duration: 29.468813805062297
2021-08-18:15:58:54,432 INFO     [oort.py:208] Training selector: Pacer 120: lastExploitationUtil 789.2854797316527, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:58:54,432 INFO     [oort.py:321] scores are 26,{3: 0.017018177264529033, 5: 0.04246751458432755, 6: 0.036126179350042247, 7: 0.06290154996533757, 11: 0.010817885947669085, 12: 0.003080015251123743, 14: 0.004422303310230478, 27: 0.00554657348137965, 50: 0.0026857554389128468, 51: 0.3676532652014154, 53: 0.04185993778859696, 58: 0.001828905398345227, 60: 0.002138782079061966, 67: 0.0009989253144303226, 70: 0.003899454370270218, 79: 0.002807438944378262, 81: 0.27865082228897153, 84: 0.19396592736679838, 85: 0.007003718124316765, 87: 0.007489021873265411, 93: 0.019481218104182192, 97: 0.22549073134927713, 105: 0.0026649368341732996, 107: 0.005303718525279954, 110: 0.006677104787478795, 113: 0.06290154996533757, 119: 0.007313189466222579},[51, 81, 97, 84, 7, 113, 5, 53, 6, 93, 3, 11, 87, 119, 85, 110, 27, 107, 14, 70, 12, 79, 50, 105, 60, 58, 67]
2021-08-18:15:58:54,442 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:15:58:54,443 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:58:54,443 INFO     [oort.py:398] At round 120, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3348.199649109497, 'duration': 15.972045438625893, 'time_stamp': 121, 'count': 117, 'status': True, 'gradient': 21.305264727444573}, [0.6439144577719881, -2.4793593335482134e-06]), ({'reward': 0.01, 'duration': 8.009219946401625, 'time_stamp': 121, 'count': 42, 'status': True, 'gradient': 21.30388528821119}, [1.9231719924229767e-09, -2.4793593335482134e-06]), ({'reward': 5199.752935195836, 'duration': 17.619275735353515, 'time_stamp': 121, 'count': 117, 'status': True, 'gradient': 15.18779082719186}, [1.0, -2.4793593335482134e-06])]
2021-08-18:15:58:54,444 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:58:54,789 INFO     [param_server.py:553] For epoch: 122, median_reward: 741.5610563212159, dev: 3707.8052816060795
2021-08-18:15:58:55,408 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5354, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:15:58:55,409 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1770.5478, eval_time 0.5853, test_loss 2.5354, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:15:58:55,424 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6171, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:15:58:55,424 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1770.5489, eval_time 0.5999, test_loss 2.6171, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:15:58:55,451 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8992, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:58:55,455 INFO     [learner.py:656] After aggregation epoch 121, CumulTime 1770.591, eval_time 0.6316, test_loss 2.8992, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:58:55,485 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:55,491 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:55,500 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:58:55,513 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:58:55,526 INFO     [learner.py:526] ====Start train round 122
2021-08-18:15:58:55,538 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:58:56,657 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:58:56,667 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:58:57,800 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:58:57,811 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:58:58,262 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:58:58,277 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:58:58,524 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:58:58,551 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:58:59,677 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:58:59,698 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:00,183 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:00,197 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:00,286 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:00,307 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:00,556 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:00,565 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:00,637 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:00,650 INFO     [learner.py:606] ====Pushing takes 0.012835502624511719 s
2021-08-18:15:59:00,675 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:00,685 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:59:00,686 INFO     [param_server.py:410] Lock worker 1 with localStep 122 , while globalStep is 121

2021-08-18:15:59:01,606 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:01,621 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:02,202 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:02,214 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:03,52 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:03,67 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:03,68 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:03,79 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:03,659 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:03,668 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:04,148 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:04,173 INFO     [learner.py:606] ====Pushing takes 0.02407097816467285 s
2021-08-18:15:59:04,209 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:04,219 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:59:04,219 INFO     [param_server.py:410] Lock worker 2 with localStep 122 , while globalStep is 121

2021-08-18:15:59:05,326 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:05,340 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:05,997 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:06,10 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:06,610 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:06,619 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:59:07,692 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:59:07,701 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:08,275 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:08,317 INFO     [learner.py:606] ====Pushing takes 0.04050302505493164 s
2021-08-18:15:59:08,373 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:08,384 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:08,385 INFO     [param_server.py:381] ====After aggregation in epoch: 121, virtual_clock: 3909.785602632581, top_1: : 60.9551 % (1889.0), top_5: : 100.0 % (3099.0), test loss: 2.683929655287001, test len: 3099.0
2021-08-18:15:59:08,387 INFO     [param_server.py:410] Lock worker 3 with localStep 122 , while globalStep is 122

2021-08-18:15:59:08,388 INFO     [param_server.py:441] ====Epoch 123 completes 20 clients with loss 4.709597517982399, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:08,388 INFO     [param_server.py:450] ====Start to sample for epoch 123, global virtualClock: 3909.785602632581, round_duration: 38.39602155878561
2021-08-18:15:59:08,390 INFO     [oort.py:208] Training selector: Pacer 121: lastExploitationUtil 2587.619208884904, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:59:08,391 INFO     [oort.py:321] scores are 26,{3: 0.016962969910742483, 5: 0.005835290077447501, 6: 0.03600898520325831, 7: 1.0626974948227321, 11: 0.1146740808106876, 12: 0.04790893530264267, 14: 0.007074929195703944, 27: 0.024156793948881657, 50: 0.010084244665242475, 51: 0.3712554640401091, 53: 0.11344591086405534, 58: 0.0012658631517136587, 60: 0.0013056612913464433, 67: 0.0015981097124300374, 70: 0.006238460285552479, 79: 0.002798331548643263, 81: 0.01643680811487147, 84: 0.028853071604155043, 85: 0.07938654090148697, 87: 0.007464727316119486, 93: 0.10130886367434556, 97: 0.02000195820372557, 105: 0.0026562917185221856, 107: 0.008485042840343621, 110: 0.006655444107810089, 113: 0.898210449678551, 119: 0.011699852777758953},[7, 113, 51, 11, 53, 93, 85, 12, 6, 84, 27, 97, 3, 81, 119, 50, 107, 87, 14, 110, 70, 5, 79, 105, 67, 60, 58]
2021-08-18:15:59:08,392 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:59:08,393 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:08,393 INFO     [oort.py:398] At round 121, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5567.246583770337, 'duration': 21.753601635627824, 'time_stamp': 122, 'count': 114, 'status': True, 'gradient': 21.523758820860618}, [0.6040850409458983, -2.4590365494799157e-06]), ({'reward': 7700.081969201826, 'duration': 8.009219946401625, 'time_stamp': 122, 'count': 43, 'status': True, 'gradient': 21.3118121849522}, [0.835512954855819, -2.4590365494799157e-06]), ({'reward': 5505.724461771105, 'duration': 12.029357192292537, 'time_stamp': 122, 'count': 119, 'status': True, 'gradient': 27.53031183420676}, [0.5974094501099401, -2.4590365494799157e-06])]
2021-08-18:15:59:08,394 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:59:08,745 INFO     [param_server.py:553] For epoch: 123, median_reward: 1116.1360540497813, dev: 5580.680270248906
2021-08-18:15:59:09,384 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2534, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:15:59:09,385 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1784.5097, eval_time 0.6048, test_loss 2.2534, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:15:59:09,403 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3173, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:15:59:09,404 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1784.5403, eval_time 0.6257, test_loss 2.3173, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:15:59:09,428 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3576, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:15:59:09,431 INFO     [learner.py:656] After aggregation epoch 122, CumulTime 1784.5703, eval_time 0.6527, test_loss 2.3576, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:15:59:09,454 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:59:09,467 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:09,471 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:59:09,492 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:09,496 INFO     [learner.py:526] ====Start train round 123
2021-08-18:15:59:09,517 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:10,715 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:10,729 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:11,346 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:11,365 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:11,715 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:11,725 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:12,465 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:12,479 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:13,45 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:13,58 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:13,650 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:13,659 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:13,765 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:13,786 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:14,286 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:14,296 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:14,402 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:14,422 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:14,684 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:14,693 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:14,886 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:14,906 INFO     [learner.py:606] ====Pushing takes 0.01776123046875 s
2021-08-18:15:59:14,914 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:14,924 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:14,929 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:14,934 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:59:14,935 INFO     [param_server.py:410] Lock worker 1 with localStep 123 , while globalStep is 122

2021-08-18:15:59:15,298 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:15,308 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:15,652 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:15,661 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:16,696 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:16,719 INFO     [learner.py:606] ====Pushing takes 0.022706270217895508 s
2021-08-18:15:59:16,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:16,760 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:59:16,761 INFO     [param_server.py:410] Lock worker 2 with localStep 123 , while globalStep is 122

2021-08-18:15:59:17,389 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:17,398 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:17,985 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:17,999 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:18,564 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:18,575 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:59:19,34 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:59:19,43 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:19,504 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:19,545 INFO     [learner.py:606] ====Pushing takes 0.03980445861816406 s
2021-08-18:15:59:19,594 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:19,606 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:19,607 INFO     [param_server.py:381] ====After aggregation in epoch: 122, virtual_clock: 3939.254416437643, top_1: : 62.0845 % (1924.0), top_5: : 100.0 % (3099.0), test loss: 2.3094424539142184, test len: 3099.0
2021-08-18:15:59:19,609 INFO     [param_server.py:410] Lock worker 3 with localStep 123 , while globalStep is 123

2021-08-18:15:59:19,609 INFO     [param_server.py:441] ====Epoch 124 completes 20 clients with loss 6.69270221205527, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:19,610 INFO     [param_server.py:450] ====Start to sample for epoch 124, global virtualClock: 3939.254416437643, round_duration: 29.468813805062297
2021-08-18:15:59:19,610 INFO     [oort.py:208] Training selector: Pacer 122: lastExploitationUtil 3298.7864050514418, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:59:19,611 INFO     [oort.py:321] scores are 26,{3: 0.13787968896413486, 5: 0.01973918343635252, 6: 0.3923912068678599, 7: 0.6244883626291649, 11: 0.010748081562941748, 12: 0.003060140890218521, 14: 0.008390181924225833, 27: 0.005510783203030847, 50: 0.0026684251114488374, 51: 0.5207060950414585, 53: 0.04158982889521496, 58: 0.003469877106533301, 60: 0.0012667663939179906, 67: 0.001895203591620697, 70: 0.007398210678154386, 79: 0.04742159311347241, 81: 0.05688919430749873, 84: 0.028760190602140096, 85: 0.076030072250507, 87: 0.1067663561002006, 93: 0.010865991338104937, 97: 0.24956763141892965, 105: 0.002647740842558435, 107: 0.010062440357503744, 110: 0.030546319414894378, 113: 0.7621588301457052, 119: 0.013874894091048131},[113, 7, 51, 6, 97, 3, 87, 85, 81, 79, 53, 110, 84, 5, 119, 93, 11, 107, 14, 70, 27, 58, 12, 50, 105, 67, 60]
2021-08-18:15:59:19,612 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:59:19,613 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:19,613 INFO     [oort.py:398] At round 122, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7980.83009887547, 'duration': 26.145070720211294, 'time_stamp': 123, 'count': 116, 'status': True, 'gradient': 11.82181252786585}, [0.8342528550531242, -2.4390442198717086e-06]), ({'reward': 6885.8391478535095, 'duration': 15.972045438625893, 'time_stamp': 123, 'count': 119, 'status': True, 'gradient': 21.32128761918995}, [0.7197910184642373, -2.4390442198717086e-06]), ({'reward': 5938.094860388335, 'duration': 11.90395711384456, 'time_stamp': 123, 'count': 121, 'status': True, 'gradient': 21.215210996604625}, [0.6207212027195097, -2.4390442198717086e-06])]
2021-08-18:15:59:19,614 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 119]
2021-08-18:15:59:19,957 INFO     [param_server.py:553] For epoch: 124, median_reward: 1285.2090445737065, dev: 6426.045222868533
2021-08-18:15:59:20,589 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4295, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:15:59:20,590 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1795.7262, eval_time 0.5857, test_loss 2.4295, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:15:59:20,591 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2847, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:15:59:20,592 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1795.7162, eval_time 0.5858, test_loss 2.2847, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:15:59:20,596 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7198, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:15:59:20,597 INFO     [learner.py:656] After aggregation epoch 123, CumulTime 1795.7363, eval_time 0.596, test_loss 2.7198, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:15:59:20,663 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:59:20,671 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:20,675 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:59:20,663 INFO     [learner.py:526] ====Start train round 124
2021-08-18:15:59:20,691 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:20,696 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:21,780 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:21,790 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:22,942 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:22,968 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:23,494 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:23,506 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:23,652 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:23,673 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:24,812 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:24,839 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:25,272 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:25,286 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:25,526 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:25,559 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:25,719 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:25,730 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:25,943 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:25,957 INFO     [learner.py:606] ====Pushing takes 0.013367652893066406 s
2021-08-18:15:59:25,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:25,988 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:59:25,989 INFO     [param_server.py:410] Lock worker 1 with localStep 124 , while globalStep is 123

2021-08-18:15:59:26,981 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:26,993 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:27,672 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:27,681 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:28,18 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:28,32 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:28,339 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:28,353 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:28,749 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:28,763 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:29,410 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:29,424 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:59:30,43 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:59:30,68 INFO     [learner.py:606] ====Pushing takes 0.02399468421936035 s
2021-08-18:15:59:30,107 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:30,115 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:15:59:30,115 INFO     [param_server.py:410] Lock worker 2 with localStep 124 , while globalStep is 123

2021-08-18:15:59:30,722 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:30,738 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:31,342 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:31,351 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:31,888 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:31,897 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:59:33,53 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:59:33,92 INFO     [learner.py:606] ====Pushing takes 0.03763437271118164 s
2021-08-18:15:59:33,144 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:33,155 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:33,156 INFO     [param_server.py:381] ====After aggregation in epoch: 123, virtual_clock: 3977.650437996429, top_1: : 61.2456 % (1898.0), top_5: : 100.0 % (3099.0), test loss: 2.47799019018809, test len: 3099.0
2021-08-18:15:59:33,159 INFO     [param_server.py:410] Lock worker 3 with localStep 124 , while globalStep is 124

2021-08-18:15:59:33,159 INFO     [param_server.py:441] ====Epoch 125 completes 20 clients with loss 2.9520630939956876, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:59:33,160 INFO     [param_server.py:450] ====Start to sample for epoch 125, global virtualClock: 3977.650437996429, round_duration: 38.39602155878561
2021-08-18:15:59:33,160 INFO     [oort.py:208] Training selector: Pacer 123: lastExploitationUtil 3371.0972133466244, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:59:33,161 INFO     [oort.py:321] scores are 26,{3: 0.09094722142749723, 5: 0.06754839242639045, 6: 0.03577840548936543, 7: 0.6490208263345222, 11: 0.010713746012916256, 12: 0.029121558434589117, 14: 0.010581172623625854, 27: 0.027736907843464158, 50: 0.01129761373152396, 51: 0.33150741439117876, 53: 0.2599854646020393, 58: 0.004375991960434636, 60: 0.0019527301446510595, 67: 0.0023901122217567005, 70: 0.009330160537457804, 79: 0.002780412729653462, 81: 0.1297505198929809, 84: 0.028668314023293947, 85: 0.11828042198363899, 87: 0.1236809724179748, 93: 0.13295071337122547, 97: 0.2971716976300817, 105: 0.002649989508379038, 107: 0.012690120357254451, 110: 0.061893059656089836, 113: 0.9812763042325832, 119: 0.010327836749438761},[113, 7, 51, 97, 53, 93, 81, 87, 85, 3, 5, 110, 6, 12, 84, 27, 107, 50, 11, 14, 119, 70, 58, 79, 105, 67, 60]
2021-08-18:15:59:33,162 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:15:59:33,163 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:33,163 INFO     [oort.py:398] At round 123, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6491.386789694879, 'duration': 15.972045438625893, 'time_stamp': 124, 'count': 120, 'status': True, 'gradient': 21.325433946883212}, [0.8692088431794455, -2.4193743497931457e-06]), ({'reward': 3936.747382786419, 'duration': 12.029357192292537, 'time_stamp': 124, 'count': 121, 'status': True, 'gradient': 27.549992760499844}, [0.5271373178099892, -2.4193743497931457e-06]), ({'reward': 6863.087094508104, 'duration': 8.009219946401625, 'time_stamp': 124, 'count': 45, 'status': True, 'gradient': 21.329264102444977}, [0.918980286422632, -2.4193743497931457e-06])]
2021-08-18:15:59:33,164 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 50, 105, 119]
2021-08-18:15:59:33,492 INFO     [param_server.py:553] For epoch: 125, median_reward: 1279.3129536194494, dev: 6396.564768097247
2021-08-18:15:59:34,112 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.2806, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:15:59:34,116 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1809.2517, eval_time 0.5793, test_loss 2.2806, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:15:59:34,145 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2202, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:15:59:34,146 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1809.2702, eval_time 0.6071, test_loss 2.2202, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:15:59:34,188 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:59:34,192 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.477, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:15:59:34,195 INFO     [learner.py:656] After aggregation epoch 124, CumulTime 1809.334, eval_time 0.6586, test_loss 2.477, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:15:59:34,209 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:34,216 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:59:34,230 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:34,265 INFO     [learner.py:526] ====Start train round 125
2021-08-18:15:59:34,287 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:35,333 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:35,347 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:35,974 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:35,988 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:36,378 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:36,387 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:37,143 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:37,158 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:37,842 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:37,851 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:38,198 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:38,209 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:38,464 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:38,484 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:38,843 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:38,852 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:39,140 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:39,151 INFO     [learner.py:606] ====Pushing takes 0.009366989135742188 s
2021-08-18:15:59:39,168 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:39,175 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 3 clients
2021-08-18:15:59:39,176 INFO     [param_server.py:410] Lock worker 1 with localStep 125 , while globalStep is 124

2021-08-18:15:59:39,490 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:39,499 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:39,541 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:39,555 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:40,65 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:40,75 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:40,128 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:40,142 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:41,439 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:41,450 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:15:59:41,854 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:41,863 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:41,987 INFO     [learner.py:439] Completed to run client 119
2021-08-18:15:59:42,14 INFO     [learner.py:606] ====Pushing takes 0.02512049674987793 s
2021-08-18:15:59:42,55 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:42,63 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:59:42,63 INFO     [param_server.py:410] Lock worker 2 with localStep 125 , while globalStep is 124

2021-08-18:15:59:42,402 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:42,411 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:42,954 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:42,969 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:59:43,559 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:59:43,569 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:44,98 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:44,142 INFO     [learner.py:606] ====Pushing takes 0.04165506362915039 s
2021-08-18:15:59:44,188 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:44,197 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:44,198 INFO     [param_server.py:381] ====After aggregation in epoch: 124, virtual_clock: 4007.1192518014914, top_1: : 61.7941 % (1915.0), top_5: : 100.0 % (3099.0), test loss: 2.325911999852569, test len: 3099.0
2021-08-18:15:59:44,200 INFO     [param_server.py:410] Lock worker 3 with localStep 125 , while globalStep is 125

2021-08-18:15:59:44,200 INFO     [param_server.py:441] ====Epoch 126 completes 20 clients with loss 4.7399190771862525, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:15:59:44,201 INFO     [param_server.py:450] ====Start to sample for epoch 126, global virtualClock: 4007.1192518014914, round_duration: 29.468813805062297
2021-08-18:15:59:44,201 INFO     [oort.py:208] Training selector: Pacer 124: lastExploitationUtil 1978.8395895039478, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:59:44,202 INFO     [oort.py:321] scores are 26,{3: 0.01680091368839883, 5: 0.08591850846968706, 6: 0.03566497232443024, 7: 0.2893688257679833, 11: 0.010679778760828455, 12: 0.0030406940525257316, 14: 0.005722290516246308, 27: 0.05275214799014076, 50: 0.0026514675817469933, 51: 0.03492526877560848, 53: 0.4514705530967257, 58: 0.0023665332931487996, 60: 0.001056035052539953, 67: 0.0012925709640899978, 70: 0.005045744083159587, 79: 0.0027827509626336985, 81: 0.01627977859442195, 84: 0.028577422952310232, 85: 0.006914304738720615, 87: 0.018296299400070357, 93: 0.18466485651980963, 97: 0.019810868919064483, 105: 0.0026309147589678437, 107: 0.006862807928130921, 110: 0.023550458767289374, 112: 0.16942321639816815, 113: 0.06209851357212252, 119: 0.030115923251240344},[53, 7, 93, 112, 5, 113, 27, 6, 51, 119, 84, 110, 97, 87, 3, 81, 11, 85, 107, 14, 70, 12, 79, 50, 105, 58, 67, 60]
2021-08-18:15:59:44,203 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:59:44,203 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:44,204 INFO     [oort.py:398] At round 124, UCB exploited 28, augment_factor 1.0769230769230769, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 125, 'count': 122, 'status': True, 'gradient': 27.5641796500085}, [1.0900667981053097e-09, -2.400019200153603e-06]), ({'reward': 7899.123761142584, 'duration': 29.570969934622333, 'time_stamp': 125, 'count': 107, 'status': True, 'gradient': 13.522720886220569}, [0.8610561656379306, -2.400019200153603e-06]), ({'reward': 9173.759724769472, 'duration': 21.635252629006885, 'time_stamp': 125, 'count': 76, 'status': True, 'gradient': 21.968313807143858}, [1.0, -2.400019200153603e-06])]
2021-08-18:15:59:44,204 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:59:44,545 INFO     [param_server.py:553] For epoch: 126, median_reward: 977.6559749055159, dev: 4888.2798745275795
2021-08-18:15:59:45,172 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5919, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:15:59:45,173 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1820.3088, eval_time 0.5823, test_loss 2.5919, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:15:59:45,173 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2503, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:15:59:45,174 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1820.2985, eval_time 0.5832, test_loss 2.2503, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:15:59:45,251 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:45,259 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:45,265 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:45,273 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:45,325 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5046, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:15:59:45,326 INFO     [learner.py:656] After aggregation epoch 125, CumulTime 1820.4651, eval_time 0.7355, test_loss 3.5046, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:15:59:45,395 INFO     [learner.py:526] ====Start train round 126
2021-08-18:15:59:45,413 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:46,546 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:46,561 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:15:59:47,769 INFO     [learner.py:439] Completed to run client 53
2021-08-18:15:59:47,790 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:15:59:48,156 INFO     [learner.py:439] Completed to run client 6
2021-08-18:15:59:48,166 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:15:59:48,622 INFO     [learner.py:439] Completed to run client 7
2021-08-18:15:59:48,650 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:15:59:50,206 INFO     [learner.py:439] Completed to run client 97
2021-08-18:15:59:50,220 INFO     [learner.py:439] Completed to run client 11
2021-08-18:15:59:50,229 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:15:59:50,233 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:15:59:50,277 INFO     [learner.py:439] Completed to run client 51
2021-08-18:15:59:50,286 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:15:59:50,883 INFO     [learner.py:439] Completed to run client 85
2021-08-18:15:59:50,910 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:15:59:51,299 INFO     [learner.py:439] Completed to run client 84
2021-08-18:15:59:51,309 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:15:59:51,665 INFO     [learner.py:439] Completed to run client 79
2021-08-18:15:59:51,679 INFO     [learner.py:606] ====Pushing takes 0.012236595153808594 s
2021-08-18:15:59:51,700 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:51,705 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:15:59:51,706 INFO     [param_server.py:410] Lock worker 1 with localStep 126 , while globalStep is 125

2021-08-18:15:59:51,917 INFO     [learner.py:439] Completed to run client 3
2021-08-18:15:59:51,926 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:15:59:52,511 INFO     [learner.py:439] Completed to run client 81
2021-08-18:15:59:52,525 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:15:59:52,969 INFO     [learner.py:439] Completed to run client 110
2021-08-18:15:59:52,987 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:15:59:53,585 INFO     [learner.py:439] Completed to run client 5
2021-08-18:15:59:53,599 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:15:59:54,139 INFO     [learner.py:439] Completed to run client 50
2021-08-18:15:59:54,163 INFO     [learner.py:606] ====Pushing takes 0.023112058639526367 s
2021-08-18:15:59:54,192 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:54,199 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:15:59:54,200 INFO     [param_server.py:410] Lock worker 2 with localStep 126 , while globalStep is 125

2021-08-18:15:59:54,822 INFO     [learner.py:439] Completed to run client 93
2021-08-18:15:59:54,832 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:15:59:55,423 INFO     [learner.py:439] Completed to run client 87
2021-08-18:15:59:55,432 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:15:59:55,973 INFO     [learner.py:439] Completed to run client 27
2021-08-18:15:59:55,982 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:15:59:57,37 INFO     [learner.py:439] Completed to run client 12
2021-08-18:15:59:57,46 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:15:59:57,635 INFO     [learner.py:439] Completed to run client 105
2021-08-18:15:59:57,674 INFO     [learner.py:606] ====Pushing takes 0.038512229919433594 s
2021-08-18:15:59:57,723 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:15:59:57,736 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:15:59:57,736 INFO     [param_server.py:381] ====After aggregation in epoch: 125, virtual_clock: 4045.515273360277, top_1: : 61.8587 % (1917.0), top_5: : 100.0 % (3099.0), test loss: 2.7822576187275074, test len: 3099.0
2021-08-18:15:59:57,739 INFO     [param_server.py:410] Lock worker 3 with localStep 126 , while globalStep is 126

2021-08-18:15:59:57,739 INFO     [param_server.py:441] ====Epoch 127 completes 20 clients with loss 5.504491563015952, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:15:59:57,740 INFO     [param_server.py:450] ====Start to sample for epoch 127, global virtualClock: 4045.515273360277, round_duration: 38.39602155878561
2021-08-18:15:59:57,740 INFO     [oort.py:208] Training selector: Pacer 125: lastExploitationUtil 2489.7087234809396, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:15:59:57,741 INFO     [oort.py:321] scores are 26,{3: 0.08757019520317993, 5: 0.005761356245348713, 6: 0.41325141432944373, 7: 1.0619031100156122, 11: 0.06929159225957764, 12: 0.02623744435606571, 14: 0.006529670736935235, 27: 0.015140894625597473, 50: 0.002643124330855513, 51: 0.03481537104129212, 53: 0.041195493250839155, 58: 0.0022566355716231693, 60: 0.0012050351446104704, 67: 0.0012325461994797048, 70: 0.005757667736779602, 79: 0.002762876348965404, 81: 0.016228551765096917, 84: 0.43961055209435984, 85: 0.00689254781452798, 87: 0.07898584845055294, 93: 0.010762965001860825, 97: 0.186016015747436, 105: 0.006056117312117308, 107: 0.007831108185489186, 110: 0.006571118824802919, 113: 0.22263768238247558, 119: 0.010798155599319995},[7, 84, 6, 113, 97, 3, 87, 11, 53, 51, 12, 81, 27, 119, 93, 107, 85, 110, 14, 105, 5, 70, 79, 50, 58, 67, 60]
2021-08-18:15:59:57,742 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:15:59:57,743 INFO     [oort.py:365] exploration poss is []
2021-08-18:15:59:57,743 INFO     [oort.py:398] At round 125, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6418.39050887907, 'duration': 11.90395711384456, 'time_stamp': 126, 'count': 124, 'status': True, 'gradient': 21.24141295650968}, [0.6576347695597856, -2.380971277549824e-06]), ({'reward': 1568.7464615834804, 'duration': 8.009219946401625, 'time_stamp': 126, 'count': 47, 'status': True, 'gradient': 21.34851440182396}, [0.16073457236686328, -2.380971277549824e-06]), ({'reward': 5870.646420862989, 'duration': 26.145070720211294, 'time_stamp': 126, 'count': 119, 'status': True, 'gradient': 23.675878400583716}, [0.6015122701160942, -2.380971277549824e-06])]
2021-08-18:15:59:57,744 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 12, 79, 50, 105]
2021-08-18:15:59:58,85 INFO     [param_server.py:553] For epoch: 127, median_reward: 1100.5778436362255, dev: 5502.889218181127
2021-08-18:15:59:58,704 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8973, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:15:59:58,705 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1833.8413, eval_time 0.5863, test_loss 2.8973, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:15:59:58,748 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3413, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:15:59:58,749 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1833.874, eval_time 0.6301, test_loss 2.3413, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:15:59:58,775 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:58,783 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4604, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:15:59:58,788 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:15:59:58,786 INFO     [learner.py:656] After aggregation epoch 126, CumulTime 1833.925, eval_time 0.6674, test_loss 2.4604, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:15:59:58,831 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:58,846 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:15:59:58,867 INFO     [learner.py:526] ====Start train round 127
2021-08-18:15:59:58,889 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:15:59:59,900 INFO     [learner.py:439] Completed to run client 113
2021-08-18:15:59:59,918 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:00,628 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:00,641 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:00,899 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:00,908 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:01,924 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:01,944 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:02,337 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:02,355 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:02,885 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:02,902 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:03,288 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:03,315 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:03,542 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:03,552 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:04,37 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:04,65 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:04,162 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:04,176 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:04,216 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:04,226 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:04,527 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:04,545 INFO     [learner.py:606] ====Pushing takes 0.016478538513183594 s
2021-08-18:16:00:04,566 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:04,571 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 4 clients
2021-08-18:16:00:04,572 INFO     [param_server.py:410] Lock worker 1 with localStep 127 , while globalStep is 126

2021-08-18:16:00:04,809 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:04,820 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:04,831 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:04,846 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:06,91 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:06,115 INFO     [learner.py:606] ====Pushing takes 0.02252793312072754 s
2021-08-18:16:00:06,149 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:06,156 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:00:06,156 INFO     [param_server.py:410] Lock worker 2 with localStep 127 , while globalStep is 126

2021-08-18:16:00:06,481 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:06,491 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:07,150 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:07,161 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:07,785 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:07,795 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:00:08,358 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:00:08,367 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:00:09,11 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:00:09,53 INFO     [learner.py:606] ====Pushing takes 0.04042172431945801 s
2021-08-18:16:00:09,101 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:09,110 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:09,111 INFO     [param_server.py:381] ====After aggregation in epoch: 126, virtual_clock: 4074.9840871653396, top_1: : 61.3746 % (1902.0), top_5: : 100.0 % (3099.0), test loss: 2.566288144500167, test len: 3099.0
2021-08-18:16:00:09,113 INFO     [param_server.py:410] Lock worker 3 with localStep 127 , while globalStep is 127

2021-08-18:16:00:09,113 INFO     [param_server.py:441] ====Epoch 128 completes 20 clients with loss 5.524277799336538, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:09,114 INFO     [param_server.py:450] ====Start to sample for epoch 128, global virtualClock: 4074.9840871653396, round_duration: 29.468813805062297
2021-08-18:16:00:09,114 INFO     [oort.py:208] Training selector: Pacer 126: lastExploitationUtil 2725.440920234956, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:00:09,115 INFO     [oort.py:321] scores are 25,{3: 0.01669573895885112, 5: 0.005743362182145926, 6: 0.28218584753328974, 7: 0.20400271203459502, 11: 0.010612922703852513, 12: 0.006599421080794158, 14: 0.006357891630165507, 27: 0.01922632332781014, 50: 0.002634869235312578, 51: 0.03470663449380796, 53: 0.04106683008930943, 58: 0.002629395025348818, 60: 0.001093066805351184, 67: 0.0014361427632257988, 70: 0.005606198074564275, 79: 0.0324086388233855, 81: 0.25020520110969136, 84: 0.3696236787543476, 85: 0.006871020775455717, 87: 0.039747195852132114, 93: 0.010729349744576705, 97: 0.15314719760790854, 105: 0.04498123624615354, 110: 0.022333134206025514, 113: 0.061709773144584194, 119: 0.010514083461789468},[84, 6, 81, 7, 97, 113, 105, 53, 87, 51, 79, 110, 27, 3, 93, 11, 119, 85, 12, 14, 5, 70, 50, 58, 67, 60]
2021-08-18:16:00:09,116 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:00:09,117 INFO     [oort.py:365] exploration poss is [16.91829855  9.05547074  1.91505738  0.90032832]
2021-08-18:16:00:09,117 INFO     [oort.py:398] At round 126, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 64, exploration 0.0, round_threshold 10, sampled score is [({'reward': 9851.980164100492, 'duration': 17.619275735353515, 'time_stamp': 127, 'count': 123, 'status': True, 'gradient': 15.228239958859763}, [0.8926871802022258, -2.362223324593109e-06]), ({'reward': 1570.3986210306252, 'duration': 5.8943907365129, 'time_stamp': 127, 'count': 124, 'status': True, 'gradient': 21.567923679886622}, [0.142292939796111, -2.362223324593109e-06]), ({'reward': 8183.2062918665115, 'duration': 13.298442137908651, 'time_stamp': 127, 'count': 124, 'status': True, 'gradient': 18.612427073158415}, [0.7414795520756299, -2.362223324593109e-06])]
2021-08-18:16:00:09,118 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 50]
2021-08-18:16:00:09,399 INFO     [param_server.py:553] For epoch: 128, median_reward: 1160.167791084309, dev: 5800.8389554215455
2021-08-18:16:00:09,985 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6886, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:00:09,991 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9159, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:16:00:09,991 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4804, Top-1 Accuracy: 616.0/1033 (0.5963), Top-5 Accuracy: 1.0
2021-08-18:16:00:09,992 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1845.1278, eval_time 0.5595, test_loss 2.9159, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:16:00:09,992 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1845.1313, eval_time 0.5599, test_loss 2.4804, test_accuracy 0.5963, test_5_accuracy 1.0 

2021-08-18:16:00:09,986 INFO     [learner.py:656] After aggregation epoch 127, CumulTime 1845.1103, eval_time 0.5533, test_loss 2.6886, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:00:10,66 INFO     [learner.py:526] ====Start train round 128
2021-08-18:16:00:10,66 INFO     [learner.py:526] ====Start train round 128
2021-08-18:16:00:10,71 INFO     [learner.py:526] ====Start train round 128
2021-08-18:16:00:10,75 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:10,74 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:10,89 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:11,230 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:11,240 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:12,413 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:12,431 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:12,915 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:12,925 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:13,324 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:13,357 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:14,607 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:14,640 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:14,831 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:14,851 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:15,273 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:15,300 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:15,324 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:15,333 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:15,805 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:15,832 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:16,181 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:16,201 INFO     [learner.py:606] ====Pushing takes 0.019385814666748047 s
2021-08-18:16:00:16,232 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:16,241 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:16,241 INFO     [param_server.py:410] Lock worker 1 with localStep 128 , while globalStep is 127

2021-08-18:16:00:16,566 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:16,584 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:17,311 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:17,329 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:17,620 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:17,629 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:18,72 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:18,87 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:18,329 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:18,340 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:18,919 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:18,944 INFO     [learner.py:606] ====Pushing takes 0.02279186248779297 s
2021-08-18:16:00:18,971 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:18,978 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:18,978 INFO     [param_server.py:410] Lock worker 2 with localStep 128 , while globalStep is 127

2021-08-18:16:00:20,388 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:20,397 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:21,51 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:21,62 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:21,621 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:21,630 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:00:22,899 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:00:22,950 INFO     [learner.py:606] ====Pushing takes 0.04414105415344238 s
2021-08-18:16:00:23,4 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:23,13 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:23,14 INFO     [param_server.py:381] ====After aggregation in epoch: 127, virtual_clock: 4112.327606438401, top_1: : 60.6002 % (1878.0), top_5: : 100.0 % (3099.0), test loss: 2.694974234810582, test len: 3099.0
2021-08-18:16:00:23,16 INFO     [param_server.py:410] Lock worker 3 with localStep 128 , while globalStep is 128

2021-08-18:16:00:23,17 INFO     [param_server.py:441] ====Epoch 129 completes 20 clients with loss 7.142414144426315, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:23,17 INFO     [param_server.py:450] ====Start to sample for epoch 129, global virtualClock: 4112.327606438401, round_duration: 37.343519273061496
2021-08-18:16:00:23,18 INFO     [oort.py:208] Training selector: Pacer 127: lastExploitationUtil 2037.3660380694246, lastExplorationUtil 0.009999000099990002, last_util_record 0
2021-08-18:16:00:23,18 INFO     [oort.py:321] scores are 26,{3: 0.016643979436434, 5: 0.005725556819690924, 6: 0.5117284569410876, 7: 0.061518462751297326, 11: 0.04731302332505885, 12: 0.003012291487317832, 14: 0.004480817857314053, 27: 0.005424614724114395, 50: 0.0026267007095834996, 51: 0.0345990382484107, 53: 0.7064229228590605, 58: 0.0018531049078622027, 60: 0.0009894389559758916, 67: 0.0010121427846587865, 70: 0.00395105074219287, 79: 0.002745708622783517, 81: 0.09895177352526939, 84: 0.028310486488182084, 85: 0.006849719486861529, 87: 0.007324352315769785, 93: 0.13937669660451918, 97: 0.026391650505777207, 103: 0.00398769241065678, 105: 0.009216223482062613, 110: 0.00653028776526777, 113: 0.061518462751297326, 119: 0.007409955323137554},[53, 6, 93, 81, 7, 113, 11, 51, 84, 97, 3, 105, 119, 87, 85, 110, 5, 27, 14, 103, 70, 12, 79, 50, 58, 67, 60]
2021-08-18:16:00:23,19 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:00:23,20 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:23,20 INFO     [oort.py:398] At round 127, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10, sampled score is [({'reward': 10415.388993822648, 'duration': 11.90395711384456, 'time_stamp': 128, 'count': 126, 'status': True, 'gradient': 21.25905870752813}, [0.8294839546327119, -2.3437683106899294e-06]), ({'reward': 12556.466260976917, 'duration': 11.058674649423494, 'time_stamp': 128, 'count': 125, 'status': True, 'gradient': 20.627401571385576}, [1.0, -2.3437683106899294e-06]), ({'reward': 9293.11289565943, 'duration': 21.635252629006885, 'time_stamp': 128, 'count': 79, 'status': True, 'gradient': 21.995873183514995}, [0.7401055445189241, -2.3437683106899294e-06])]
2021-08-18:16:00:23,25 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 105]
2021-08-18:16:00:23,359 INFO     [param_server.py:553] For epoch: 129, median_reward: 1014.6434545912969, dev: 5073.2172729564845
2021-08-18:16:00:23,892 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3129, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:00:23,892 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1859.0171, eval_time 0.4994, test_loss 2.3129, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:00:23,938 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5894, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:00:23,940 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1859.0757, eval_time 0.5469, test_loss 2.5894, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:00:23,962 INFO     [learner.py:526] ====Start train round 129
2021-08-18:16:00:23,971 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:23,976 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3496, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:00:23,979 INFO     [learner.py:656] After aggregation epoch 128, CumulTime 1859.1187, eval_time 0.5866, test_loss 2.3496, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:00:24,10 INFO     [learner.py:526] ====Start train round 129
2021-08-18:16:00:24,26 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:24,50 INFO     [learner.py:526] ====Start train round 129
2021-08-18:16:00:24,69 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:25,330 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:25,345 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:26,44 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:26,58 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:26,510 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:26,524 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:27,567 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:27,594 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:27,801 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:27,811 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:28,574 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:28,585 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:28,885 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:28,907 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:29,217 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:29,231 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:29,557 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:29,567 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:29,572 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:29,588 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:29,808 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:29,861 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:30,243 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:30,262 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:30,263 INFO     [learner.py:606] ====Pushing takes 0.018678903579711914 s
2021-08-18:16:00:30,276 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:30,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:30,299 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:30,300 INFO     [param_server.py:410] Lock worker 2 with localStep 129 , while globalStep is 128

2021-08-18:16:00:30,450 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:30,460 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:30,678 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:30,706 INFO     [learner.py:606] ====Pushing takes 0.026556968688964844 s
2021-08-18:16:00:30,728 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:30,734 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:00:30,735 INFO     [param_server.py:410] Lock worker 1 with localStep 129 , while globalStep is 128

2021-08-18:16:00:32,2 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:32,12 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:32,741 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:32,751 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:33,266 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:33,277 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:00:33,828 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:00:33,838 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:00:34,385 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:00:34,431 INFO     [learner.py:606] ====Pushing takes 0.044051170349121094 s
2021-08-18:16:00:34,475 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:34,487 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:34,488 INFO     [param_server.py:381] ====After aggregation in epoch: 128, virtual_clock: 4141.796420243463, top_1: : 60.8906 % (1887.0), top_5: : 100.0 % (3099.0), test loss: 2.4173060633518078, test len: 3099.0
2021-08-18:16:00:34,490 INFO     [param_server.py:410] Lock worker 3 with localStep 129 , while globalStep is 129

2021-08-18:16:00:34,490 INFO     [param_server.py:441] ====Epoch 130 completes 20 clients with loss 7.8416738998173985, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:34,491 INFO     [param_server.py:450] ====Start to sample for epoch 130, global virtualClock: 4141.796420243463, round_duration: 29.468813805062297
2021-08-18:16:00:34,491 INFO     [oort.py:208] Training selector: Pacer 128: lastExploitationUtil 2367.083573022162, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:00:34,492 INFO     [oort.py:321] scores are 26,{3: 0.10329160451320248, 5: 0.005707936823854426, 6: 0.038290624512334254, 7: 0.16487305521108986, 11: 0.010547461641607001, 12: 0.0030030213734867513, 14: 0.006740624188439794, 27: 0.0510632119786821, 50: 0.0026288262966198623, 51: 0.2717469117203734, 53: 0.04081352773370797, 58: 0.002787679428938006, 60: 0.0012439661004245133, 67: 0.001522595729993684, 70: 0.005943680160778209, 79: 0.0027372588988483185, 81: 0.23696794878575997, 84: 0.02822336296993571, 85: 0.0895785431008909, 87: 0.06161826374519075, 93: 0.12004265553177523, 97: 0.019565422158101704, 103: 0.00397542056952661, 105: 0.04496511020300516, 110: 0.036047852405370874, 113: 0.06132914403668467, 119: 0.011147010585326378},[51, 81, 7, 93, 3, 85, 87, 113, 27, 105, 53, 6, 110, 84, 97, 119, 11, 14, 70, 5, 103, 12, 58, 79, 50, 67, 60]
2021-08-18:16:00:34,493 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:00:34,494 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:34,494 INFO     [oort.py:398] At round 128, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7500.3527498711655, 'duration': 17.619275735353515, 'time_stamp': 129, 'count': 125, 'status': True, 'gradient': 15.242565122232664}, [0.842574881240476, -2.325599423251345e-06]), ({'reward': 3755.168163139996, 'duration': 12.029357192292537, 'time_stamp': 129, 'count': 126, 'status': True, 'gradient': 27.620190360205903}, [0.42184764791029145, -2.325599423251345e-06]), ({'reward': 2852.566285913536, 'duration': 17.343863580585587, 'time_stamp': 129, 'count': 20, 'status': True, 'gradient': 15.243558778921827}, [0.32045099260269067, -2.325599423251345e-06])]
2021-08-18:16:00:34,495 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 50]
2021-08-18:16:00:34,768 INFO     [param_server.py:553] For epoch: 130, median_reward: 1082.3129232269491, dev: 5411.564616134746
2021-08-18:16:00:35,418 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3888, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:00:35,419 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1870.5587, eval_time 0.6075, test_loss 2.3888, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:00:35,469 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3051, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:00:35,469 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1870.594, eval_time 0.6554, test_loss 2.3051, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:00:35,500 INFO     [learner.py:526] ====Start train round 130
2021-08-18:16:00:35,506 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6303, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:00:35,511 INFO     [learner.py:656] After aggregation epoch 129, CumulTime 1870.6468, eval_time 0.6988, test_loss 2.6303, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:00:35,526 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:35,542 INFO     [learner.py:526] ====Start train round 130
2021-08-18:16:00:35,551 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:35,583 INFO     [learner.py:526] ====Start train round 130
2021-08-18:16:00:35,602 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:36,820 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:36,834 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:37,708 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:37,734 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:37,777 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:37,791 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:39,1 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:39,35 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:39,318 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:39,333 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:39,396 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:39,410 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:40,122 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:40,135 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:40,203 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:40,230 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:40,723 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:40,743 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:40,773 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:40,799 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:41,53 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:41,62 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:41,293 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:41,319 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:41,351 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:41,371 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:41,479 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:41,498 INFO     [learner.py:606] ====Pushing takes 0.01812434196472168 s
2021-08-18:16:00:41,528 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:41,534 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:41,535 INFO     [param_server.py:410] Lock worker 1 with localStep 130 , while globalStep is 129

2021-08-18:16:00:41,691 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:41,700 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:42,709 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:42,727 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:42,998 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:43,23 INFO     [learner.py:606] ====Pushing takes 0.023826122283935547 s
2021-08-18:16:00:43,51 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:43,57 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:43,58 INFO     [param_server.py:410] Lock worker 2 with localStep 130 , while globalStep is 129

2021-08-18:16:00:43,422 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:43,436 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:43,965 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:43,974 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:00:44,612 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:00:44,648 INFO     [learner.py:606] ====Pushing takes 0.034781694412231445 s
2021-08-18:16:00:44,688 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:44,696 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:44,697 INFO     [param_server.py:381] ====After aggregation in epoch: 129, virtual_clock: 4170.479823266479, top_1: : 61.1165 % (1894.0), top_5: : 100.0 % (3099.0), test loss: 2.441409111022949, test len: 3099.0
2021-08-18:16:00:44,699 INFO     [param_server.py:410] Lock worker 3 with localStep 130 , while globalStep is 130

2021-08-18:16:00:44,699 INFO     [param_server.py:441] ====Epoch 131 completes 20 clients with loss 4.399538887246651, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:44,700 INFO     [param_server.py:450] ====Start to sample for epoch 131, global virtualClock: 4170.479823266479, round_duration: 28.683403023015895
2021-08-18:16:00:44,700 INFO     [oort.py:208] Training selector: Pacer 129: lastExploitationUtil 2242.637492184234, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:00:44,701 INFO     [oort.py:321] scores are 26,{3: 0.26782793291760704, 5: 0.010280334989239902, 6: 0.5064243010643716, 7: 0.17222597110574353, 11: 0.01051523867211461, 12: 0.01704714716742224, 14: 0.005735349858184708, 27: 0.05163241097686845, 50: 0.0026106172307338517, 51: 0.24730807584398287, 53: 0.04068884057164688, 58: 0.0023719341666969167, 60: 0.0011051812785279984, 67: 0.001295520853850361, 70: 0.005057259419042754, 79: 0.002728896449854673, 81: 0.01602896101906235, 84: 0.028137139327238072, 85: 0.006807778157919478, 87: 0.12633892175557276, 93: 0.05068342232346152, 97: 0.0195056489138152, 103: 0.00396327548096559, 105: 0.011796566547458668, 110: 0.006490302339912077, 113: 0.07692331837925323, 119: 0.009484582405495743},[6, 3, 51, 7, 87, 113, 27, 93, 53, 84, 97, 12, 81, 105, 11, 5, 119, 85, 110, 14, 70, 103, 79, 50, 58, 67, 60]
2021-08-18:16:00:44,701 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:00:44,702 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:44,702 INFO     [oort.py:398] At round 129, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10, sampled score is [({'reward': 8469.349326900694, 'duration': 11.90395711384456, 'time_stamp': 130, 'count': 128, 'status': True, 'gradient': 21.280187587134357}, [0.8206252393272806, -2.3077100593081503e-06]), ({'reward': 162.88483138625318, 'duration': 8.009219946401625, 'time_stamp': 130, 'count': 51, 'status': True, 'gradient': 21.384575813890898}, [0.01578153860368272, -2.3077100593081503e-06]), ({'reward': 0.01, 'duration': 42.701901101086094, 'time_stamp': 130, 'count': 88, 'status': True, 'gradient': 8.469940275022646}, [9.689365447335475e-10, -2.3077100593081503e-06])]
2021-08-18:16:00:44,703 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 50]
2021-08-18:16:00:44,985 INFO     [param_server.py:553] For epoch: 131, median_reward: 1075.0751909835785, dev: 5375.375954917892
2021-08-18:16:00:45,522 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.3299, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:00:45,524 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1880.6635, eval_time 0.5153, test_loss 2.3299, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:00:45,585 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:45,603 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:45,635 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.368, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:00:45,636 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1880.7601, eval_time 0.6254, test_loss 2.368, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:00:45,680 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6642, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:00:45,680 INFO     [learner.py:656] After aggregation epoch 130, CumulTime 1880.8164, eval_time 0.6704, test_loss 2.6642, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:00:45,704 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:45,712 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:45,752 INFO     [learner.py:526] ====Start train round 131
2021-08-18:16:00:45,774 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:47,60 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:47,74 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:00:48,295 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:00:48,306 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:00:48,310 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:00:48,320 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:00:48,640 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:00:48,667 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:00:49,868 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:00:49,930 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:00:50,563 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:00:50,564 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:00:50,574 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:00:50,590 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:00:50,684 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:00:50,694 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:00:51,196 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:00:51,223 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:00:51,598 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:00:51,619 INFO     [learner.py:606] ====Pushing takes 0.01876544952392578 s
2021-08-18:16:00:51,651 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:51,658 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:00:51,659 INFO     [param_server.py:410] Lock worker 1 with localStep 131 , while globalStep is 130

2021-08-18:16:00:51,881 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:00:51,892 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:00:52,444 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:00:52,465 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:00:53,54 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:00:53,68 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:00:53,434 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:00:53,453 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:00:54,523 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:00:54,533 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:00:55,69 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:00:55,92 INFO     [learner.py:606] ====Pushing takes 0.022201061248779297 s
2021-08-18:16:00:55,118 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:55,125 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:00:55,125 INFO     [param_server.py:410] Lock worker 2 with localStep 131 , while globalStep is 130

2021-08-18:16:00:55,205 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:00:55,214 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:00:55,817 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:00:55,826 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:00:56,408 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:00:56,417 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:00:57,129 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:00:57,165 INFO     [learner.py:606] ====Pushing takes 0.034210920333862305 s
2021-08-18:16:00:57,209 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:00:57,218 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:00:57,218 INFO     [param_server.py:381] ====After aggregation in epoch: 130, virtual_clock: 4208.875844825265, top_1: : 62.02 % (1922.0), top_5: : 100.0 % (3099.0), test loss: 2.454044697461305, test len: 3099.0
2021-08-18:16:00:57,221 INFO     [param_server.py:410] Lock worker 3 with localStep 131 , while globalStep is 131

2021-08-18:16:00:57,221 INFO     [param_server.py:441] ====Epoch 132 completes 20 clients with loss 4.2283551664761845, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:00:57,222 INFO     [param_server.py:450] ====Start to sample for epoch 132, global virtualClock: 4208.875844825265, round_duration: 38.39602155878561
2021-08-18:16:00:57,223 INFO     [oort.py:208] Training selector: Pacer 130: lastExploitationUtil 1556.4517784264794, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:00:57,223 INFO     [oort.py:321] scores are 26,{3: 0.13627184495396605, 5: 0.005673239648160905, 6: 0.23748401600255586, 7: 0.060956338914371286, 11: 0.010483346158028053, 12: 0.008022632663954478, 14: 0.003907022713194937, 27: 0.005375047405521078, 50: 0.006307899800259346, 51: 0.03428289016433431, 53: 0.04056543211069219, 58: 0.0016158038990878776, 60: 0.0007210317135226708, 67: 0.0011476629602456458, 70: 0.0034450954005049873, 79: 0.002720619760073152, 81: 0.01598034549248862, 84: 0.028051799931687396, 85: 0.01938873394939525, 87: 0.007840097085188404, 93: 0.06620185197826864, 97: 0.06781771716625523, 103: 0.06877232213251169, 105: 0.008036031729235142, 110: 0.006470617379327152, 113: 0.060956338914371286, 119: 0.0064610668572482955},[6, 3, 103, 97, 93, 7, 113, 53, 51, 84, 85, 81, 11, 105, 12, 87, 110, 119, 50, 5, 27, 14, 70, 79, 58, 67, 60]
2021-08-18:16:00:57,224 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:00:57,225 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:00:57,226 INFO     [oort.py:398] At round 130, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4262.8105037857895, 'duration': 11.90395711384456, 'time_stamp': 131, 'count': 129, 'status': True, 'gradient': 21.287715213081206}, [0.3525419328981276, -2.2900938175100593e-06]), ({'reward': 12091.622691906845, 'duration': 35.433463751176646, 'time_stamp': 131, 'count': 4, 'status': True, 'gradient': 15.253007980568363}, [1.0, -2.2900938175100593e-06]), ({'reward': 1833.3753791649237, 'duration': 15.972045438625893, 'time_stamp': 131, 'count': 127, 'status': True, 'gradient': 21.395737800123225}, [0.15162290046519622, -2.2900938175100593e-06])]
2021-08-18:16:00:57,227 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 50]
2021-08-18:16:00:57,560 INFO     [param_server.py:553] For epoch: 132, median_reward: 925.3639931856646, dev: 4626.819965928324
2021-08-18:16:00:58,83 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.2675, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:00:58,90 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1893.2145, eval_time 0.5027, test_loss 2.2675, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:00:58,119 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5075, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:00:58,120 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1893.2563, eval_time 0.5333, test_loss 2.5075, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:00:58,132 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5314, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:00:58,133 INFO     [learner.py:656] After aggregation epoch 131, CumulTime 1893.2723, eval_time 0.5505, test_loss 2.5314, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:00:58,159 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:58,167 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:00:58,193 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:58,205 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:00:58,205 INFO     [learner.py:526] ====Start train round 132
2021-08-18:16:00:58,219 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:00:59,600 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:00:59,615 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:00,244 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:00,258 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:00,323 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:00,332 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:01,728 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:01,768 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:01,975 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:01,984 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:02,26 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:02,35 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:02,653 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:02,663 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:03,150 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:03,155 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:03,164 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:03,183 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:03,715 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:03,733 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:03,768 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:03,777 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:03,878 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:03,912 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:04,270 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:04,284 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:04,519 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:04,553 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:04,940 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:04,957 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:04,974 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:05,4 INFO     [learner.py:606] ====Pushing takes 0.027580976486206055 s
2021-08-18:16:01:05,33 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:05,38 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:05,39 INFO     [param_server.py:410] Lock worker 1 with localStep 132 , while globalStep is 131

2021-08-18:16:01:05,551 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:05,563 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:05,579 INFO     [learner.py:606] ====Pushing takes 0.024285316467285156 s
2021-08-18:16:01:05,583 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:05,605 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:05,612 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:01:05,612 INFO     [param_server.py:410] Lock worker 2 with localStep 132 , while globalStep is 131

2021-08-18:16:01:06,165 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:06,185 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:06,705 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:06,742 INFO     [learner.py:606] ====Pushing takes 0.035222530364990234 s
2021-08-18:16:01:06,789 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:06,798 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:06,799 INFO     [param_server.py:381] ====After aggregation in epoch: 131, virtual_clock: 4236.891700320753, top_1: : 61.6651 % (1911.0), top_5: : 100.0 % (3099.0), test loss: 2.43544594446818, test len: 3099.0
2021-08-18:16:01:06,801 INFO     [param_server.py:410] Lock worker 3 with localStep 132 , while globalStep is 132

2021-08-18:16:01:06,801 INFO     [param_server.py:441] ====Epoch 133 completes 20 clients with loss 5.465974551639084, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:06,802 INFO     [param_server.py:450] ====Start to sample for epoch 133, global virtualClock: 4236.891700320753, round_duration: 28.015855495488744
2021-08-18:16:01:06,803 INFO     [oort.py:208] Training selector: Pacer 131: lastExploitationUtil 2155.5344948575794, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:01:06,803 INFO     [oort.py:321] scores are 26,{3: 0.022561580788068962, 5: 0.0056561562690549275, 6: 0.6080210551126334, 7: 0.06077278589860467, 11: 0.057146098941437885, 12: 0.014183418858762111, 14: 0.008573162970982966, 27: 0.0640062440397842, 50: 0.04281257181764304, 51: 0.42830972863047473, 53: 0.04044328062435944, 58: 0.0035455514781746124, 60: 0.001207516460525143, 67: 0.0019365359894333504, 70: 0.00755955787494278, 79: 0.002712427372364022, 81: 0.015932225138471635, 84: 0.049104637068668376, 85: 0.04696669382561355, 87: 0.1262949893633468, 93: 0.010566437723416498, 97: 0.019387930983006882, 103: 0.01415224014680532, 105: 0.017633429522191144, 110: 0.103330627723201, 113: 0.8636145329189155, 119: 0.01417749094381645},[113, 6, 51, 87, 110, 27, 7, 11, 84, 85, 50, 53, 3, 97, 105, 81, 12, 119, 103, 93, 14, 70, 5, 58, 79, 67, 60]
2021-08-18:16:01:06,804 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:06,805 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:06,805 INFO     [oort.py:398] At round 131, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 63, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6051.69379638571, 'duration': 11.90395711384456, 'time_stamp': 132, 'count': 130, 'status': True, 'gradient': 21.29435918133317}, [0.997890696534392, -2.272744490488566e-06]), ({'reward': 4249.866589392231, 'duration': 12.029357192292537, 'time_stamp': 132, 'count': 129, 'status': True, 'gradient': 27.647551896387363}, [0.7007789068000918, -2.272744490488566e-06]), ({'reward': 5712.237222116509, 'duration': 43.65853298740619, 'time_stamp': 132, 'count': 112, 'status': True, 'gradient': 25.745027138587442}, [0.9419161003429595, -2.272744490488566e-06])]
2021-08-18:16:01:06,806 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 50]
2021-08-18:16:01:07,83 INFO     [param_server.py:553] For epoch: 133, median_reward: 1049.4475113735532, dev: 5247.237556867766
2021-08-18:16:01:07,676 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5691, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:01:07,676 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1902.8156, eval_time 0.5587, test_loss 2.5691, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:01:07,763 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:01:07,777 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:07,794 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5083, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:01:07,794 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1902.9191, eval_time 0.6741, test_loss 2.5083, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:01:07,825 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4547, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:01:07,826 INFO     [learner.py:656] After aggregation epoch 132, CumulTime 1902.9618, eval_time 0.7063, test_loss 2.4547, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:01:07,862 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:01:07,870 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:07,895 INFO     [learner.py:526] ====Start train round 133
2021-08-18:16:01:07,911 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:09,347 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:09,368 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:10,502 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:10,515 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:10,524 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:10,533 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:10,569 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:10,588 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:11,557 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:11,575 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:12,234 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:12,267 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:12,664 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:12,673 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:12,742 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:12,756 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:12,894 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:12,921 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:13,297 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:13,318 INFO     [learner.py:606] ====Pushing takes 0.019828081130981445 s
2021-08-18:16:01:13,350 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:13,358 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:13,359 INFO     [param_server.py:410] Lock worker 1 with localStep 133 , while globalStep is 132

2021-08-18:16:01:13,757 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:13,767 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:14,458 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:14,468 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:15,104 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:15,114 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:15,559 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:15,570 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:16,275 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:16,286 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:01:16,809 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:01:16,834 INFO     [learner.py:606] ====Pushing takes 0.023038625717163086 s
2021-08-18:16:01:16,867 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:16,874 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:01:16,875 INFO     [param_server.py:410] Lock worker 2 with localStep 133 , while globalStep is 132

2021-08-18:16:01:17,333 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:17,353 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:18,63 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:18,81 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:18,684 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:18,694 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:19,661 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:19,702 INFO     [learner.py:606] ====Pushing takes 0.03922104835510254 s
2021-08-18:16:01:19,748 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:19,757 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:19,759 INFO     [param_server.py:381] ====After aggregation in epoch: 132, virtual_clock: 4275.287721879539, top_1: : 61.3746 % (1902.0), top_5: : 100.0 % (3099.0), test loss: 2.5107118266600152, test len: 3099.0
2021-08-18:16:01:19,761 INFO     [param_server.py:410] Lock worker 3 with localStep 133 , while globalStep is 133

2021-08-18:16:01:19,762 INFO     [param_server.py:441] ====Epoch 134 completes 20 clients with loss 4.406182399507062, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:19,762 INFO     [param_server.py:450] ====Start to sample for epoch 134, global virtualClock: 4275.287721879539, round_duration: 38.39602155878561
2021-08-18:16:01:19,763 INFO     [oort.py:208] Training selector: Pacer 132: lastExploitationUtil 2040.6908094257149, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:01:19,763 INFO     [oort.py:321] scores are 25,{3: 0.0163930753310524, 5: 0.005639245386950782, 6: 0.1630032186558954, 7: 0.060591086283427055, 11: 0.010420529561206223, 12: 0.00296688189620048, 27: 0.00534283992322667, 50: 0.002587103809445508, 51: 0.26624759920660057, 53: 0.28163422506311553, 58: 0.0018927822646957017, 60: 0.0007006118510862123, 67: 0.0010338140620176526, 70: 0.004035647814652248, 79: 0.0027043177061298945, 81: 0.08727025726267738, 84: 0.0795530685122638, 85: 0.06592051524530712, 87: 0.007213939414077231, 93: 0.010534845989719342, 97: 0.3383532030440343, 103: 0.003927578878273854, 105: 0.009413554667255427, 110: 0.04011855506525714, 113: 0.060591086283427055, 119: 0.007568611986464613},[97, 53, 51, 6, 81, 84, 85, 7, 113, 110, 3, 93, 11, 105, 119, 87, 5, 27, 70, 103, 12, 79, 50, 58, 67, 60]
2021-08-18:16:01:19,764 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:19,765 INFO     [oort.py:365] exploration poss is [24.8550604   9.05547074  1.91505738  0.90032832]
2021-08-18:16:01:19,766 INFO     [oort.py:398] At round 132, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 63, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4579.055041926634, 'duration': 11.058674649423494, 'time_stamp': 133, 'count': 130, 'status': True, 'gradient': 20.670917851602763}, [0.3626113896106264, -2.2556560575643446e-06]), ({'reward': 12627.97806580598, 'duration': 15.972045438625893, 'time_stamp': 133, 'count': 129, 'status': True, 'gradient': 21.408778517560542}, [1.0, -2.2556560575643446e-06]), ({'reward': 5212.932566921335, 'duration': 12.029357192292537, 'time_stamp': 133, 'count': 130, 'status': True, 'gradient': 27.6662294156921}, [0.4128077094927737, -2.2556560575643446e-06])]
2021-08-18:16:01:19,766 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:20,54 INFO     [param_server.py:553] For epoch: 134, median_reward: 1025.5217169598213, dev: 5127.608584799107
2021-08-18:16:01:20,740 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5363, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:01:20,741 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1915.8656, eval_time 0.6478, test_loss 3.5363, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:01:20,783 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9985, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:01:20,784 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1915.9201, eval_time 0.6921, test_loss 2.9985, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:01:20,808 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:01:20,816 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:20,822 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7062, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:01:20,823 INFO     [learner.py:656] After aggregation epoch 133, CumulTime 1915.9623, eval_time 0.7355, test_loss 2.7062, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:01:20,854 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:01:20,869 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:20,914 INFO     [learner.py:526] ====Start train round 134
2021-08-18:16:01:20,933 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:22,162 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:22,177 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:23,398 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:23,418 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:23,519 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:23,530 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:24,207 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:24,234 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:25,782 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:25,803 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:25,845 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:25,854 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:26,171 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:26,184 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:26,574 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:26,601 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:27,94 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:27,105 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:27,338 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:27,365 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:27,817 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:27,826 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:28,50 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:28,70 INFO     [learner.py:606] ====Pushing takes 0.018898963928222656 s
2021-08-18:16:01:28,103 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:28,108 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:28,109 INFO     [param_server.py:410] Lock worker 1 with localStep 134 , while globalStep is 133

2021-08-18:16:01:28,522 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:28,532 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:29,55 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:29,68 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:30,97 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:30,117 INFO     [learner.py:606] ====Pushing takes 0.019415855407714844 s
2021-08-18:16:01:30,147 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:30,152 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:01:30,153 INFO     [param_server.py:410] Lock worker 2 with localStep 134 , while globalStep is 133

2021-08-18:16:01:31,475 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:31,495 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:32,172 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:32,186 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:32,877 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:32,891 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:33,489 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:33,501 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:34,6 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:34,48 INFO     [learner.py:606] ====Pushing takes 0.04091835021972656 s
2021-08-18:16:01:34,97 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:34,110 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:34,111 INFO     [param_server.py:381] ====After aggregation in epoch: 133, virtual_clock: 4315.150902191051, top_1: : 61.6005 % (1909.0), top_5: : 100.0 % (3099.0), test loss: 3.0803361468844948, test len: 3099.0
2021-08-18:16:01:34,113 INFO     [param_server.py:410] Lock worker 3 with localStep 134 , while globalStep is 134

2021-08-18:16:01:34,114 INFO     [param_server.py:441] ====Epoch 135 completes 20 clients with loss 3.793612054518582, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:34,114 INFO     [param_server.py:450] ====Start to sample for epoch 135, global virtualClock: 4315.150902191051, round_duration: 39.863180311511634
2021-08-18:16:01:34,115 INFO     [oort.py:208] Training selector: Pacer 133: lastExploitationUtil 1254.0385507737233, lastExplorationUtil 11518.90191863961, last_util_record 0
2021-08-18:16:01:34,115 INFO     [oort.py:321] scores are 26,{3: 0.05700170917587464, 5: 0.006936832714382671, 6: 0.03469590549251053, 7: 0.060411210711858176, 11: 0.01038959433911589, 12: 0.002958074172002236, 27: 0.008358362414603283, 36: 0.0459450846328002, 50: 0.00869081446872617, 51: 0.042740880250834515, 53: 0.1700361937962193, 58: 0.00173391555774177, 60: 0.0007458515694619194, 67: 0.0009470430484157175, 70: 0.0036969241850525665, 79: 0.002696289451102108, 81: 0.08340580507243765, 84: 0.1472871861884899, 85: 0.020153532596671058, 87: 0.007192523533376552, 93: 0.010503571398685822, 97: 0.18161222484024017, 103: 0.003915919151753905, 105: 0.008623447712740977, 110: 0.02744718660017488, 113: 0.1685949409886031, 119: 0.006933356423831267},[97, 53, 113, 84, 81, 7, 3, 36, 51, 6, 110, 85, 93, 11, 50, 105, 27, 87, 5, 119, 103, 70, 12, 79, 58, 67, 60]
2021-08-18:16:01:34,116 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:16:01:34,117 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:34,117 INFO     [oort.py:398] At round 133, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2991.1050218629653, 'duration': 13.298442137908651, 'time_stamp': 134, 'count': 131, 'status': True, 'gradient': 21.422923794898658}, [0.25964267835279503, -2.2388226777811796e-06]), ({'reward': 1246.2913132727467, 'duration': 8.009219946401625, 'time_stamp': 134, 'count': 55, 'status': True, 'gradient': 21.4210954132857}, [0.10818373114479717, -2.2388226777811796e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 134, 'count': 131, 'status': True, 'gradient': 21.63582151233969}, [8.680522537295291e-10, -2.2388226777811796e-06])]
2021-08-18:16:01:34,118 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:34,392 INFO     [param_server.py:553] For epoch: 135, median_reward: 955.8939559373699, dev: 4779.4697796868495
2021-08-18:16:01:35,4 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.3982, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:01:35,5 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1930.141, eval_time 0.5874, test_loss 2.3982, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:01:35,23 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4705, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:01:35,24 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1930.1482, eval_time 0.6031, test_loss 2.4705, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:01:35,60 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4688, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:01:35,61 INFO     [learner.py:656] After aggregation epoch 134, CumulTime 1930.1998, eval_time 0.643, test_loss 2.4688, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:01:35,82 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:01:35,90 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:35,95 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:01:35,103 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:35,131 INFO     [learner.py:526] ====Start train round 135
2021-08-18:16:01:35,145 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:36,279 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:36,294 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:37,0 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:37,20 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:37,215 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:37,225 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:38,236 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:38,256 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:38,417 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:38,431 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:38,886 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:38,899 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:39,417 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:39,431 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:39,461 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:39,470 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:39,933 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:39,944 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:40,39 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:40,48 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:40,78 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:40,106 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:40,509 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:40,529 INFO     [learner.py:606] ====Pushing takes 0.01920938491821289 s
2021-08-18:16:01:40,561 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:40,567 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:40,568 INFO     [param_server.py:410] Lock worker 2 with localStep 135 , while globalStep is 134

2021-08-18:16:01:40,722 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:40,731 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:40,888 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:40,916 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:41,466 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:41,496 INFO     [learner.py:606] ====Pushing takes 0.02787017822265625 s
2021-08-18:16:01:41,519 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:41,524 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:01:41,525 INFO     [param_server.py:410] Lock worker 1 with localStep 135 , while globalStep is 134

2021-08-18:16:01:41,935 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:41,950 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:42,631 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:42,645 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:43,284 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:43,298 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:43,930 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:43,944 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:44,481 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:44,526 INFO     [learner.py:606] ====Pushing takes 0.04392409324645996 s
2021-08-18:16:01:44,576 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:44,585 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:44,586 INFO     [param_server.py:381] ====After aggregation in epoch: 134, virtual_clock: 4343.166757686539, top_1: : 61.4714 % (1905.0), top_5: : 100.0 % (3099.0), test loss: 2.4458319765550116, test len: 3099.0
2021-08-18:16:01:44,588 INFO     [param_server.py:410] Lock worker 3 with localStep 135 , while globalStep is 135

2021-08-18:16:01:44,589 INFO     [param_server.py:441] ====Epoch 136 completes 20 clients with loss 5.424771251902202, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:44,589 INFO     [param_server.py:450] ====Start to sample for epoch 136, global virtualClock: 4343.166757686539, round_duration: 28.015855495488744
2021-08-18:16:01:44,590 INFO     [oort.py:208] Training selector: Pacer 134: lastExploitationUtil 4615.541688206897, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:01:44,590 INFO     [oort.py:321] scores are 26,{3: 0.016296228514133218, 5: 0.0876639465727832, 6: 0.17007270774475003, 7: 0.48593393136632657, 11: 0.010358967279679743, 12: 0.04681534599116128, 27: 0.005311275556600898, 36: 0.01673255924315474, 50: 0.019625190033829624, 51: 0.3167625497881514, 53: 0.34279965793201606, 58: 0.003915446871607596, 60: 0.0017472178205758027, 67: 0.0009451696518963562, 70: 0.008348220978988583, 79: 0.0026883411699103145, 81: 0.20321915454614656, 84: 0.18304053566967227, 85: 0.11805073111006663, 87: 0.09602413053025893, 93: 0.010472608350946006, 97: 0.04953641659215284, 103: 0.03791813078521803, 105: 0.019473065581866053, 110: 0.046804110318903934, 113: 0.5260422416551079, 119: 0.015656580620792587},[113, 7, 53, 51, 81, 84, 6, 85, 87, 5, 97, 12, 110, 103, 50, 105, 36, 3, 119, 93, 11, 70, 27, 58, 79, 60, 67]
2021-08-18:16:01:44,591 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:01:44,592 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:44,592 INFO     [oort.py:398] At round 134, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4919.5304792669485, 'duration': 5.8943907365129, 'time_stamp': 135, 'count': 132, 'status': True, 'gradient': 21.64194025713826}, [0.4257008052524918, -2.2222386832495074e-06]), ({'reward': 8624.346929643529, 'duration': 26.145070720211294, 'time_stamp': 135, 'count': 128, 'status': True, 'gradient': 15.278842075464162}, [0.7462896410300609, -2.2222386832495074e-06]), ({'reward': 5256.7409027990525, 'duration': 11.058674649423494, 'time_stamp': 135, 'count': 132, 'status': True, 'gradient': 18.675111356465784}, [0.45488063063391654, -2.2222386832495074e-06])]
2021-08-18:16:01:44,593 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:44,886 INFO     [param_server.py:553] For epoch: 136, median_reward: 1599.4425793993075, dev: 7997.212896996538
2021-08-18:16:01:45,523 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6194, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:01:45,526 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1940.6652, eval_time 0.5943, test_loss 2.6194, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:01:45,601 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:45,605 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7153, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:01:45,606 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1940.742, eval_time 0.6742, test_loss 3.7153, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:01:45,626 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:45,649 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7162, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:01:45,650 INFO     [learner.py:656] After aggregation epoch 135, CumulTime 1940.7743, eval_time 0.7175, test_loss 2.7162, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:01:45,676 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:45,685 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:45,719 INFO     [learner.py:526] ====Start train round 136
2021-08-18:16:01:45,732 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:46,818 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:46,827 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:47,523 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:47,532 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:47,966 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:47,975 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:48,626 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:48,647 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:48,856 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:48,875 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:01:49,326 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:01:49,353 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:01:49,656 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:01:49,665 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:01:49,888 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:01:49,915 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:01:50,313 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:01:50,322 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:01:50,323 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:01:50,341 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:01:50,413 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:01:50,439 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:01:50,601 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:01:50,621 INFO     [learner.py:606] ====Pushing takes 0.018871545791625977 s
2021-08-18:16:01:50,651 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:50,656 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:01:50,656 INFO     [param_server.py:410] Lock worker 1 with localStep 136 , while globalStep is 135

2021-08-18:16:01:50,937 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:01:50,945 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:01:50,951 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:01:50,964 INFO     [learner.py:606] ====Pushing takes 0.01812291145324707 s
2021-08-18:16:01:50,994 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:50,999 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:01:51,0 INFO     [param_server.py:410] Lock worker 2 with localStep 136 , while globalStep is 135

2021-08-18:16:01:51,480 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:01:51,500 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:01:52,603 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:01:52,614 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:01:53,195 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:01:53,204 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:01:53,748 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:01:53,757 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:01:54,314 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:01:54,328 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:01:54,966 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:01:55,8 INFO     [learner.py:606] ====Pushing takes 0.04013562202453613 s
2021-08-18:16:01:55,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:01:55,65 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:01:55,66 INFO     [param_server.py:381] ====After aggregation in epoch: 135, virtual_clock: 4370.515065654501, top_1: : 61.6328 % (1910.0), top_5: : 100.0 % (3099.0), test loss: 3.016970678612038, test len: 3099.0
2021-08-18:16:01:55,68 INFO     [param_server.py:410] Lock worker 3 with localStep 136 , while globalStep is 136

2021-08-18:16:01:55,69 INFO     [param_server.py:441] ====Epoch 137 completes 20 clients with loss 5.65242798370532, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:01:55,69 INFO     [param_server.py:450] ====Start to sample for epoch 137, global virtualClock: 4370.515065654501, round_duration: 27.34830796796159
2021-08-18:16:01:55,70 INFO     [oort.py:208] Training selector: Pacer 135: lastExploitationUtil 2861.1983062825357, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:01:55,70 INFO     [oort.py:321] scores are 26,{3: 0.016248524006741878, 5: 0.005589519489135159, 6: 0.03449235974668694, 7: 0.0600568044853625, 11: 0.010328643120274912, 12: 0.002940720440920865, 27: 0.005295727677910589, 36: 0.0026021178758209754, 50: 0.010188914635645517, 51: 0.2389472323648894, 53: 0.03996680687398882, 58: 0.002032803446307838, 60: 0.0013241733154733207, 67: 0.0011102918847608965, 70: 0.004334190434222327, 79: 0.00268047149680778, 81: 0.01574452307903721, 84: 0.15167424988312891, 85: 0.09197009039789589, 87: 0.007150328134635024, 93: 0.1577089823220118, 97: 0.33818275478795506, 103: 0.024905432950799576, 105: 0.010109935372138803, 110: 0.006375130294418331, 113: 0.0600568044853625, 119: 0.00812851050901281},[97, 51, 93, 84, 85, 7, 113, 53, 6, 103, 3, 81, 11, 50, 105, 119, 87, 110, 5, 27, 70, 12, 79, 36, 58, 60, 67]
2021-08-18:16:01:55,71 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:01:55,72 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:01:55,73 INFO     [oort.py:398] At round 135, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 16022.677747658883, 'duration': 15.972045438625893, 'time_stamp': 136, 'count': 132, 'status': True, 'gradient': 20.37917631317245}, [1.0, -2.205898572783625e-06]), ({'reward': 4318.601857426448, 'duration': 13.298442137908651, 'time_stamp': 136, 'count': 133, 'status': True, 'gradient': 16.98420810799955}, [0.26953013897215394, -2.205898572783625e-06]), ({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 136, 'count': 132, 'status': True, 'gradient': 13.587803818381083}, [6.241157934027286e-10, -2.205898572783625e-06])]
2021-08-18:16:01:55,82 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:01:55,371 INFO     [param_server.py:553] For epoch: 137, median_reward: 1244.0556290761845, dev: 6220.278145380922
2021-08-18:16:01:56,7 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4155, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:01:56,7 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1951.1467, eval_time 0.5916, test_loss 2.4155, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:01:56,70 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5123, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:01:56,72 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1951.2076, eval_time 0.6556, test_loss 2.5123, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:01:56,77 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:56,94 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:01:56,113 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6758, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:01:56,114 INFO     [learner.py:656] After aggregation epoch 136, CumulTime 1951.2387, eval_time 0.6979, test_loss 2.6758, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:01:56,142 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:56,151 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:01:56,184 INFO     [learner.py:526] ====Start train round 137
2021-08-18:16:01:56,199 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:01:57,190 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:01:57,203 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:01:57,785 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:01:57,797 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:01:58,412 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:01:58,431 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:01:58,990 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:01:59,16 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:01:59,32 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:01:59,41 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:00,114 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:00,134 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:00,301 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:00,311 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:00,650 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:00,670 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:00,751 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:00,765 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:00,943 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:00,952 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:01,174 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:01,195 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:01,319 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:01,339 INFO     [learner.py:606] ====Pushing takes 0.019720792770385742 s
2021-08-18:16:02:01,357 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:01,370 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:01,376 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:01,377 INFO     [param_server.py:410] Lock worker 1 with localStep 137 , while globalStep is 136

2021-08-18:16:02:01,376 INFO     [learner.py:606] ====Pushing takes 0.018233060836791992 s
2021-08-18:16:02:01,399 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:01,405 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:01,406 INFO     [param_server.py:410] Lock worker 2 with localStep 137 , while globalStep is 136

2021-08-18:16:02:01,565 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:01,579 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:02,59 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:02,69 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:03,188 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:03,197 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:03,747 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:03,756 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:04,363 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:04,372 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:04,973 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:04,983 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:05,583 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:05,625 INFO     [learner.py:606] ====Pushing takes 0.040848731994628906 s
2021-08-18:16:02:05,678 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:05,688 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:05,689 INFO     [param_server.py:381] ====After aggregation in epoch: 136, virtual_clock: 4399.198468677517, top_1: : 60.9874 % (1890.0), top_5: : 100.0 % (3099.0), test loss: 2.534542049522753, test len: 3099.0
2021-08-18:16:02:05,691 INFO     [param_server.py:410] Lock worker 3 with localStep 137 , while globalStep is 137

2021-08-18:16:02:05,692 INFO     [param_server.py:441] ====Epoch 138 completes 20 clients with loss 6.06150356726545, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:05,692 INFO     [param_server.py:450] ====Start to sample for epoch 138, global virtualClock: 4399.198468677517, round_duration: 28.683403023015895
2021-08-18:16:02:05,693 INFO     [oort.py:208] Training selector: Pacer 136: lastExploitationUtil 2172.5785575129576, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:02:05,693 INFO     [oort.py:321] scores are 26,{3: 0.028961893374756235, 5: 0.01626673566905533, 6: 0.03439208732269489, 7: 0.15166330615102266, 11: 0.06427676733407296, 12: 0.004462380759782238, 27: 0.0052803325163453705, 36: 0.002594553282709984, 50: 0.007408135603677012, 51: 0.03367878383790405, 53: 0.03985061973475252, 58: 0.0014780066498139178, 60: 0.0011468840259011024, 67: 0.0008072687951663996, 70: 0.0031512944819999996, 79: 0.006687175856060318, 81: 0.0156987523197929, 84: 0.1663960107241948, 85: 0.006667532787819186, 87: 0.1261889585140787, 93: 0.010411595824231786, 97: 0.03341486281199416, 103: 0.0038816290136830397, 105: 0.00735071151928147, 110: 0.006356597211365124, 113: 0.29681872919968344, 119: 0.005910061106608289},[113, 84, 7, 87, 11, 53, 6, 51, 97, 3, 5, 81, 93, 50, 105, 79, 85, 110, 119, 27, 12, 103, 70, 36, 58, 60, 67]
2021-08-18:16:02:05,694 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:02:05,695 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:05,695 INFO     [oort.py:398] At round 136, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6001.5012633483975, 'duration': 21.753601635627824, 'time_stamp': 137, 'count': 129, 'status': True, 'gradient': 21.658820099411027}, [0.31386070752815576, -2.1897970058175624e-06]), ({'reward': 1755.0032533945612, 'duration': 5.8943907365129, 'time_stamp': 137, 'count': 134, 'status': True, 'gradient': 21.65938505328074}, [0.0917810927764366, -2.1897970058175624e-06]), ({'reward': 857.7807979045842, 'duration': 15.972045438625893, 'time_stamp': 137, 'count': 133, 'status': True, 'gradient': 21.451843830868796}, [0.04485894262006066, -2.1897970058175624e-06])]
2021-08-18:16:02:05,696 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:05,977 INFO     [param_server.py:553] For epoch: 138, median_reward: 1094.8541096596518, dev: 5474.270548298259
2021-08-18:16:02:06,573 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7892, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:02:06,576 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1961.7156, eval_time 0.5655, test_loss 2.7892, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:02:06,644 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:02:06,659 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:06,678 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7796, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:02:06,679 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1961.815, eval_time 0.6656, test_loss 2.7796, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:02:06,683 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4902, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:02:06,685 INFO     [learner.py:656] After aggregation epoch 137, CumulTime 1961.8092, eval_time 0.6709, test_loss 2.4902, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:02:06,750 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:02:06,754 INFO     [learner.py:526] ====Start train round 138
2021-08-18:16:02:06,758 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:06,762 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:07,941 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:07,959 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:08,545 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:08,557 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:09,113 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:09,122 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:09,536 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:09,556 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:09,657 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:09,666 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:10,180 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:10,200 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:10,712 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:10,733 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:10,862 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:10,876 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:11,255 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:11,282 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:11,349 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:11,359 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:11,444 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:11,464 INFO     [learner.py:606] ====Pushing takes 0.018929004669189453 s
2021-08-18:16:02:11,494 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:11,500 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:11,501 INFO     [param_server.py:410] Lock worker 1 with localStep 138 , while globalStep is 137

2021-08-18:16:02:11,509 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:11,523 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:12,4 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:12,23 INFO     [learner.py:606] ====Pushing takes 0.017348051071166992 s
2021-08-18:16:02:12,47 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:12,53 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:12,54 INFO     [param_server.py:410] Lock worker 2 with localStep 138 , while globalStep is 137

2021-08-18:16:02:12,192 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:12,206 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:12,751 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:12,762 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:13,863 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:13,872 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:14,436 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:14,445 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:15,43 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:15,52 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:15,534 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:15,542 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:16,52 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:16,95 INFO     [learner.py:606] ====Pushing takes 0.04236125946044922 s
2021-08-18:16:02:16,152 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:16,165 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:16,175 INFO     [param_server.py:381] ====After aggregation in epoch: 137, virtual_clock: 4426.8926344234405, top_1: : 61.2133 % (1897.0), top_5: : 100.0 % (3099.0), test loss: 2.6863001894067833, test len: 3099.0
2021-08-18:16:02:16,177 INFO     [param_server.py:410] Lock worker 3 with localStep 138 , while globalStep is 138

2021-08-18:16:02:16,178 INFO     [param_server.py:441] ====Epoch 139 completes 20 clients with loss 4.468484848122411, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:16,178 INFO     [param_server.py:450] ====Start to sample for epoch 139, global virtualClock: 4426.8926344234405, round_duration: 27.694165745923776
2021-08-18:16:02:16,179 INFO     [oort.py:208] Training selector: Pacer 137: lastExploitationUtil 1440.1723237548479, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:02:16,179 INFO     [oort.py:321] scores are 26,{3: 0.11348709783156265, 5: 0.0055571795487143, 6: 0.17060777974205257, 7: 0.059709326766982755, 11: 0.010268883474783509, 12: 0.0029237059687397334, 27: 0.005265087563331577, 36: 0.00811752001773576, 50: 0.009425057405046407, 51: 0.5959986945471738, 53: 0.6361034276378538, 58: 0.0018804053090796858, 60: 0.0008391066904147348, 67: 0.001409097263995553, 70: 0.004009258601896256, 79: 0.0026649627775564965, 81: 0.015653428139781586, 84: 0.12914424179966036, 85: 0.006648282821315451, 87: 0.052206885180275504, 93: 0.010381536298880363, 97: 0.019048662806597554, 103: 0.003870422285366708, 105: 0.009351999172744128, 110: 0.006338244953147503, 113: 0.059709326766982755, 119: 0.007519120623206104},[53, 51, 6, 84, 3, 7, 113, 87, 97, 81, 93, 11, 50, 105, 36, 119, 85, 110, 5, 27, 70, 103, 12, 79, 58, 67, 60]
2021-08-18:16:02:16,180 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:02:16,181 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:16,181 INFO     [oort.py:398] At round 137, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 8014.658035386811, 'duration': 11.058674649423494, 'time_stamp': 138, 'count': 135, 'status': True, 'gradient': 18.697710234830158}, [0.8961423466291838, -2.1739287965854843e-06]), ({'reward': 0.01, 'duration': 17.619275735353515, 'time_stamp': 138, 'count': 134, 'status': True, 'gradient': 13.598913176418657}, [1.118130629759796e-09, -2.1739287965854843e-06]), ({'reward': 8943.508838741724, 'duration': 12.029357192292537, 'time_stamp': 138, 'count': 135, 'status': True, 'gradient': 27.722988557011146}, [1.0, -2.1739287965854843e-06])]
2021-08-18:16:02:16,182 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:16,459 INFO     [param_server.py:553] For epoch: 139, median_reward: 915.8073776176498, dev: 4579.036888088249
2021-08-18:16:02:17,95 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0302, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:02:17,96 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1972.2356, eval_time 0.5938, test_loss 3.0302, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:02:17,164 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:02:17,174 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5339, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:02:17,175 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1972.311, eval_time 0.6697, test_loss 2.5339, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:02:17,179 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4775, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:02:17,180 INFO     [learner.py:656] After aggregation epoch 138, CumulTime 1972.305, eval_time 0.6729, test_loss 2.4775, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:02:17,185 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:17,246 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:02:17,251 INFO     [learner.py:526] ====Start train round 139
2021-08-18:16:02:17,256 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:17,259 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:18,409 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:18,422 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:19,13 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:19,27 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:19,533 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:19,551 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:20,109 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:20,129 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:20,224 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:20,233 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:21,166 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:21,187 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:21,349 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:21,358 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:21,362 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:21,376 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:21,695 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:21,715 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:21,949 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:21,970 INFO     [learner.py:606] ====Pushing takes 0.018906354904174805 s
2021-08-18:16:02:21,990 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:22,2 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:22,4 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:22,8 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:22,9 INFO     [param_server.py:410] Lock worker 2 with localStep 139 , while globalStep is 138

2021-08-18:16:02:22,202 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:22,222 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:22,357 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:22,378 INFO     [learner.py:606] ====Pushing takes 0.01959848403930664 s
2021-08-18:16:02:22,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:22,407 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:22,407 INFO     [param_server.py:410] Lock worker 1 with localStep 139 , while globalStep is 138

2021-08-18:16:02:22,584 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:22,594 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:23,162 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:23,176 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:24,501 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:24,515 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:25,175 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:25,189 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:25,770 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:25,784 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:26,354 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:26,363 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:26,925 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:26,968 INFO     [learner.py:606] ====Pushing takes 0.0416867733001709 s
2021-08-18:16:02:27,27 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:27,37 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:27,38 INFO     [param_server.py:381] ====After aggregation in epoch: 138, virtual_clock: 4454.240942391402, top_1: : 61.9877 % (1921.0), top_5: : 100.0 % (3099.0), test loss: 2.680564129794085, test len: 3099.0
2021-08-18:16:02:27,41 INFO     [param_server.py:410] Lock worker 3 with localStep 139 , while globalStep is 139

2021-08-18:16:02:27,42 INFO     [param_server.py:441] ====Epoch 140 completes 20 clients with loss 5.1679810198325296, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:27,42 INFO     [param_server.py:450] ====Start to sample for epoch 140, global virtualClock: 4454.240942391402, round_duration: 27.34830796796159
2021-08-18:16:02:27,43 INFO     [oort.py:208] Training selector: Pacer 138: lastExploitationUtil 2603.7691661029958, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:02:27,44 INFO     [oort.py:321] scores are 26,{3: 0.05735103950468696, 5: 0.09433430953472968, 6: 0.5630717204596482, 7: 0.05953811350069364, 11: 0.01023943800661199, 12: 0.0029153223999460265, 27: 0.07364043270819418, 36: 0.02281283114759967, 50: 0.015180673576151006, 51: 0.25201277723641863, 53: 0.5378798358591885, 58: 0.0030287156842902538, 60: 0.0008495020874216515, 67: 0.0016542467259307641, 70: 0.006457599513948312, 79: 0.0026573211408744252, 81: 0.015608542780901341, 84: 0.04843642650038744, 85: 0.006629219229768131, 87: 0.06270163315726726, 93: 0.18421968508335682, 97: 0.018994041795875306, 103: 0.0038593240587197737, 105: 0.015063000746271192, 110: 0.006320070378424798, 113: 0.05953811350069364, 119: 0.012110835070296843},[6, 53, 51, 93, 5, 27, 87, 7, 113, 3, 84, 36, 97, 81, 50, 105, 119, 11, 85, 70, 110, 103, 58, 12, 79, 67, 60]
2021-08-18:16:02:27,45 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:02:27,46 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:27,46 INFO     [oort.py:398] At round 138, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6586.109522525144, 'duration': 11.058674649423494, 'time_stamp': 139, 'count': 136, 'status': True, 'gradient': 18.70626512672757}, [0.7487162032901877, -2.1582889085533007e-06]), ({'reward': 3417.9044373455326, 'duration': 12.029357192292537, 'time_stamp': 139, 'count': 136, 'status': True, 'gradient': 27.73531155096945}, [0.38855060437904065, -2.1582889085533007e-06]), ({'reward': 8100.387622927654, 'duration': 11.90395711384456, 'time_stamp': 139, 'count': 137, 'status': True, 'gradient': 21.36121394181034}, [0.920861271013474, -2.1582889085533007e-06])]
2021-08-18:16:02:27,47 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:27,399 INFO     [param_server.py:553] For epoch: 140, median_reward: 1161.8175877012407, dev: 5809.0879385062035
2021-08-18:16:02:27,989 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4499, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:02:27,989 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1983.1139, eval_time 0.555, test_loss 2.4499, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:02:27,986 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9985, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:02:27,990 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1983.1259, eval_time 0.556, test_loss 2.9985, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:02:28,1 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7858, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:02:28,4 INFO     [learner.py:656] After aggregation epoch 139, CumulTime 1983.1429, eval_time 0.5697, test_loss 2.7858, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:02:28,48 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:02:28,57 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:28,59 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:02:28,67 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:28,72 INFO     [learner.py:526] ====Start train round 140
2021-08-18:16:02:28,93 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:29,235 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:29,246 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:29,824 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:29,834 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:30,227 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:30,237 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:31,18 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:31,38 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:31,67 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:31,81 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:31,961 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:31,970 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:32,68 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:32,89 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:32,609 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:32,620 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:32,629 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:32,633 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:32,934 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:32,948 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:33,153 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:33,174 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:33,220 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:33,229 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:33,300 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:33,317 INFO     [learner.py:606] ====Pushing takes 0.016333580017089844 s
2021-08-18:16:02:33,348 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:33,356 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:33,357 INFO     [param_server.py:410] Lock worker 1 with localStep 140 , while globalStep is 139

2021-08-18:16:02:33,661 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:33,680 INFO     [learner.py:606] ====Pushing takes 0.017825841903686523 s
2021-08-18:16:02:33,706 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:33,712 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:33,713 INFO     [param_server.py:410] Lock worker 2 with localStep 140 , while globalStep is 139

2021-08-18:16:02:33,794 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:33,804 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:34,966 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:34,975 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:35,511 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:35,523 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:36,105 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:36,118 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:36,588 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:36,601 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:37,220 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:37,261 INFO     [learner.py:606] ====Pushing takes 0.039335012435913086 s
2021-08-18:16:02:37,301 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:37,311 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:37,312 INFO     [param_server.py:381] ====After aggregation in epoch: 139, virtual_clock: 4482.256797886891, top_1: : 61.2778 % (1899.0), top_5: : 100.0 % (3099.0), test loss: 2.744724812331023, test len: 3099.0
2021-08-18:16:02:37,314 INFO     [param_server.py:410] Lock worker 3 with localStep 140 , while globalStep is 140

2021-08-18:16:02:37,315 INFO     [param_server.py:441] ====Epoch 141 completes 20 clients with loss 6.125481411996797, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:37,315 INFO     [param_server.py:450] ====Start to sample for epoch 141, global virtualClock: 4482.256797886891, round_duration: 28.015855495488744
2021-08-18:16:02:37,316 INFO     [oort.py:208] Training selector: Pacer 139: lastExploitationUtil 1295.1251115841742, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:02:37,325 INFO     [oort.py:321] scores are 26,{3: 0.25212207950869486, 5: 0.005525463036721897, 6: 0.03409707385403919, 7: 0.059368547499035314, 11: 0.08205805112109942, 12: 0.0029070194905349307, 27: 0.005235038109039229, 36: 0.004010350196122733, 50: 0.011579020828118743, 51: 0.4865371762142385, 53: 0.03950878326970404, 58: 0.0023101453183171925, 60: 0.0010308726438232405, 67: 0.0022586021099704283, 70: 0.004925517889346203, 79: 0.013019685449532964, 81: 0.14601144459505788, 84: 0.027321106325255032, 85: 0.013318885018904401, 87: 0.007068384659031126, 93: 0.18419020290906768, 97: 0.01893994630085059, 103: 0.024395654915196897, 105: 0.011489266171235624, 110: 0.006302070663599164, 113: 0.059368547499035314, 119: 0.009237509180434745},[51, 3, 93, 81, 11, 7, 113, 53, 6, 84, 103, 97, 85, 79, 50, 105, 119, 87, 110, 5, 27, 70, 36, 12, 58, 67, 60]
2021-08-18:16:02:37,326 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:02:37,327 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:37,328 INFO     [oort.py:398] At round 139, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 5334.823921274201, 'duration': 17.343863580585587, 'time_stamp': 140, 'count': 31, 'status': True, 'gradient': 13.609586306471206}, [0.8725097237697017, -2.142872449088924e-06]), ({'reward': 4926.411831697768, 'duration': 12.029357192292537, 'time_stamp': 140, 'count': 137, 'status': True, 'gradient': 27.743727093486832}, [0.805713857212566, -2.142872449088924e-06]), ({'reward': 1295.1300928346036, 'duration': 43.65853298740619, 'time_stamp': 140, 'count': 120, 'status': True, 'gradient': 16.58015558725717}, [0.21181711259851008, -2.142872449088924e-06])]
2021-08-18:16:02:37,328 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:37,669 INFO     [param_server.py:541] Handle Wight 0.04392838478088379 | Send 0.3540349006652832
2021-08-18:16:02:37,672 INFO     [param_server.py:553] For epoch: 141, median_reward: 887.9736296664561, dev: 4439.868148332281
2021-08-18:16:02:38,267 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5844, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,268 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1993.4069, eval_time 0.5599, test_loss 2.5844, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:02:38,346 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:38,364 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:38,395 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7134, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,396 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1993.5323, eval_time 0.6886, test_loss 2.7134, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:02:38,429 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4848, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:02:38,432 INFO     [learner.py:656] After aggregation epoch 140, CumulTime 1993.5571, eval_time 0.7245, test_loss 2.4848, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:02:38,468 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:38,475 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:38,505 INFO     [learner.py:526] ====Start train round 141
2021-08-18:16:02:38,521 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:39,460 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:39,470 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:40,34 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:40,44 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:40,504 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:40,514 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:41,305 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:41,326 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:41,378 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:41,389 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:42,265 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:42,276 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:42,352 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:42,373 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:42,895 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:42,915 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:42,994 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:43,4 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:43,89 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:43,98 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:43,405 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:43,426 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:43,546 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:43,547 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:43,555 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:43,567 INFO     [learner.py:606] ====Pushing takes 0.01912522315979004 s
2021-08-18:16:02:43,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:43,606 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:43,607 INFO     [param_server.py:410] Lock worker 1 with localStep 141 , while globalStep is 140

2021-08-18:16:02:43,643 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:43,662 INFO     [learner.py:606] ====Pushing takes 0.017246723175048828 s
2021-08-18:16:02:43,684 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:43,690 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:43,690 INFO     [param_server.py:410] Lock worker 2 with localStep 141 , while globalStep is 140

2021-08-18:16:02:44,49 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:44,62 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:45,563 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:45,584 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:46,170 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:46,191 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:46,739 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:46,753 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:47,330 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:47,342 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:47,839 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:47,881 INFO     [learner.py:606] ====Pushing takes 0.04118633270263672 s
2021-08-18:16:02:47,925 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:47,935 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:47,935 INFO     [param_server.py:381] ====After aggregation in epoch: 140, virtual_clock: 4510.27265338238, top_1: : 61.6005 % (1909.0), top_5: : 100.0 % (3099.0), test loss: 2.594215331254182, test len: 3099.0
2021-08-18:16:02:47,938 INFO     [param_server.py:410] Lock worker 3 with localStep 141 , while globalStep is 141

2021-08-18:16:02:47,939 INFO     [param_server.py:441] ====Epoch 142 completes 20 clients with loss 7.965350638267057, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:47,940 INFO     [param_server.py:450] ====Start to sample for epoch 142, global virtualClock: 4510.27265338238, round_duration: 28.015855495488744
2021-08-18:16:02:47,940 INFO     [oort.py:208] Training selector: Pacer 140: lastExploitationUtil 2872.9950710602952, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:02:47,941 INFO     [oort.py:321] scores are 26,{3: 0.2539226978551259, 5: 0.018078751656024232, 6: 0.03400061684811175, 7: 0.4326005429256809, 11: 0.07344799393980235, 12: 0.051487636688745196, 27: 0.022848112230424798, 36: 0.002565020588303167, 50: 0.015267762155273807, 51: 0.033295432592930115, 53: 0.0393970171117532, 58: 0.00165191992085361, 60: 0.0013592788692503527, 67: 0.0016637368184590814, 70: 0.006494645509528994, 79: 0.002642257155050109, 81: 0.06289354288949098, 84: 0.3040591041682788, 85: 0.006591639103313919, 87: 0.007048388948435191, 93: 0.18416100236124489, 97: 0.1337123879794551, 103: 0.011764019533473776, 105: 0.015149414259198532, 110: 0.06691594870280138, 113: 0.2432596056150082, 119: 0.012180312581487105},[7, 84, 3, 113, 93, 97, 11, 110, 81, 12, 53, 6, 51, 27, 5, 50, 105, 119, 103, 87, 85, 70, 79, 36, 67, 58, 60]
2021-08-18:16:02:47,942 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:02:47,943 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:47,943 INFO     [oort.py:398] At round 140, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3465.6842167523396, 'duration': 15.972045438625893, 'time_stamp': 141, 'count': 137, 'status': True, 'gradient': 21.4845767993412}, [0.35992995862158456, -2.1276746643593236e-06]), ({'reward': 1772.267451979646, 'duration': 8.009219946401625, 'time_stamp': 141, 'count': 62, 'status': True, 'gradient': 21.48445940289266}, [0.18405900647935095, -2.1276746643593236e-06]), ({'reward': 8466.88434641159, 'duration': 17.343863580585587, 'time_stamp': 141, 'count': 32, 'status': True, 'gradient': 13.614078216841378}, [0.8793330063262045, -2.1276746643593236e-06])]
2021-08-18:16:02:47,944 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:48,261 INFO     [param_server.py:553] For epoch: 142, median_reward: 1218.9413600465389, dev: 6094.706800232694
2021-08-18:16:02:48,856 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5851, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:02:48,860 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 2003.9988, eval_time 0.5653, test_loss 2.5851, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:02:48,892 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7594, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:02:48,896 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 2004.0321, eval_time 0.6018, test_loss 2.7594, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:02:48,901 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4723, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:02:48,902 INFO     [learner.py:656] After aggregation epoch 141, CumulTime 2004.0262, eval_time 0.6071, test_loss 2.4723, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:02:48,918 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:48,930 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:48,953 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:48,961 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:02:48,970 INFO     [learner.py:526] ====Start train round 142
2021-08-18:16:02:48,986 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:50,39 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:02:50,49 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:02:50,626 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:02:50,635 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:02:51,351 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:02:51,365 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:02:51,615 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:02:51,636 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:02:51,901 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:02:51,915 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:02:52,712 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:02:52,739 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:02:53,129 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:02:53,139 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:02:53,267 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:02:53,288 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:02:53,488 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:02:53,498 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:02:53,764 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:02:53,774 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:02:53,786 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:02:53,807 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:02:53,961 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:02:53,978 INFO     [learner.py:606] ====Pushing takes 0.016713619232177734 s
2021-08-18:16:02:54,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:54,15 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:02:54,16 INFO     [param_server.py:410] Lock worker 1 with localStep 142 , while globalStep is 141

2021-08-18:16:02:54,143 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:02:54,162 INFO     [learner.py:606] ====Pushing takes 0.016983509063720703 s
2021-08-18:16:02:54,186 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:54,191 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:02:54,192 INFO     [param_server.py:410] Lock worker 2 with localStep 142 , while globalStep is 141

2021-08-18:16:02:54,313 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:02:54,322 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:02:55,37 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:02:55,48 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:02:56,297 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:02:56,307 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:02:56,883 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:02:56,893 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:02:57,452 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:02:57,466 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:02:57,984 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:02:58,3 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:02:58,531 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:02:58,574 INFO     [learner.py:606] ====Pushing takes 0.0403287410736084 s
2021-08-18:16:02:58,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:02:58,640 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:02:58,641 INFO     [param_server.py:381] ====After aggregation in epoch: 141, virtual_clock: 4538.872251861329, top_1: : 61.181 % (1896.0), top_5: : 100.0 % (3099.0), test loss: 2.605589716522782, test len: 3099.0
2021-08-18:16:02:58,643 INFO     [param_server.py:410] Lock worker 3 with localStep 142 , while globalStep is 142

2021-08-18:16:02:58,644 INFO     [param_server.py:441] ====Epoch 143 completes 20 clients with loss 6.093984694670468, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:02:58,645 INFO     [param_server.py:450] ====Start to sample for epoch 143, global virtualClock: 4538.872251861329, round_duration: 28.599598478948877
2021-08-18:16:02:58,645 INFO     [oort.py:208] Training selector: Pacer 141: lastExploitationUtil 2648.3384318665553, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:02:58,646 INFO     [oort.py:321] scores are 26,{3: 0.0509292545764686, 5: 0.005494349482575829, 6: 0.412060833047393, 7: 0.7951900009385134, 11: 0.01015278238029248, 12: 0.0028906502364613226, 27: 0.0052055599204096385, 36: 0.0025578128911453875, 50: 0.013170221441993653, 51: 0.3651801513958875, 53: 0.2612549279489692, 58: 0.0026276077966400505, 60: 0.0012537597268337598, 67: 0.001435166601199332, 70: 0.005602387480093187, 79: 0.0026348324234618235, 81: 0.015476448807605103, 84: 0.02716726279841722, 85: 0.010094019330488821, 87: 0.12608799998807343, 93: 0.010264161539515516, 97: 0.18419448470714134, 103: 0.003826662877191807, 105: 0.013068132610463943, 110: 0.11144096213858515, 113: 0.059034246734572964, 119: 0.010506936923658781},[7, 6, 51, 53, 97, 87, 110, 113, 3, 84, 81, 50, 105, 119, 93, 11, 85, 70, 5, 27, 103, 12, 79, 58, 36, 67, 60]
2021-08-18:16:02:58,647 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:02:58,647 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:02:58,648 INFO     [oort.py:398] At round 141, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2648.3486177836016, 'duration': 43.65853298740619, 'time_stamp': 142, 'count': 122, 'status': True, 'gradient': 17.0144732081463}, [0.24941801686872736, -2.112690934443202e-06]), ({'reward': 6991.274353796726, 'duration': 11.90395711384456, 'time_stamp': 142, 'count': 140, 'status': True, 'gradient': 21.379958681151702}, [0.6584306382611385, -2.112690934443202e-06]), ({'reward': 3541.614301909006, 'duration': 11.058674649423494, 'time_stamp': 142, 'count': 139, 'status': True, 'gradient': 20.425079505303426}, [0.3335449306757824, -2.112690934443202e-06])]
2021-08-18:16:02:58,648 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:02:58,941 INFO     [param_server.py:553] For epoch: 143, median_reward: 1183.414534575752, dev: 5917.0726728787595
2021-08-18:16:02:59,490 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5323, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:02:59,491 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2014.63, eval_time 0.5165, test_loss 2.5323, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:02:59,546 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:59,568 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:02:59,641 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.498, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:02:59,641 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2014.766, eval_time 0.6615, test_loss 2.498, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:02:59,666 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.4512, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:02:59,668 INFO     [learner.py:656] After aggregation epoch 142, CumulTime 2014.8036, eval_time 0.6907, test_loss 2.4512, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:02:59,712 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:59,720 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:02:59,725 INFO     [learner.py:526] ====Start train round 143
2021-08-18:16:02:59,740 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:00,939 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:00,949 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:01,671 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:01,682 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:01,929 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:01,938 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:02,317 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:02,331 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:03,52 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:03,64 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:03,297 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:03,312 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:03,783 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:03,798 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:03,806 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:03,820 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:04,296 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:04,310 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:04,394 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:04,414 INFO     [learner.py:606] ====Pushing takes 0.019092321395874023 s
2021-08-18:16:03:04,444 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:04,449 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:04,450 INFO     [param_server.py:410] Lock worker 1 with localStep 143 , while globalStep is 142

2021-08-18:16:03:04,537 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:04,552 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:04,785 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:04,795 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:05,187 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:05,199 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:05,462 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:05,481 INFO     [learner.py:606] ====Pushing takes 0.018140077590942383 s
2021-08-18:16:03:05,504 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:05,509 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:05,510 INFO     [param_server.py:410] Lock worker 2 with localStep 143 , while globalStep is 142

2021-08-18:16:03:05,712 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:05,721 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:06,841 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:06,850 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:07,393 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:07,405 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:08,20 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:08,33 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:08,680 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:08,690 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:09,293 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:09,346 INFO     [learner.py:606] ====Pushing takes 0.036534786224365234 s
2021-08-18:16:03:09,399 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:09,411 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:09,412 INFO     [param_server.py:381] ====After aggregation in epoch: 142, virtual_clock: 4566.888107356817, top_1: : 61.9555 % (1920.0), top_5: : 100.0 % (3099.0), test loss: 2.4938134370302714, test len: 3099.0
2021-08-18:16:03:09,414 INFO     [param_server.py:410] Lock worker 3 with localStep 143 , while globalStep is 143

2021-08-18:16:03:09,415 INFO     [param_server.py:441] ====Epoch 144 completes 20 clients with loss 6.581485104241915, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:09,415 INFO     [param_server.py:450] ====Start to sample for epoch 144, global virtualClock: 4566.888107356817, round_duration: 28.015855495488744
2021-08-18:16:03:09,417 INFO     [oort.py:208] Training selector: Pacer 142: lastExploitationUtil 2695.346522286903, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:03:09,417 INFO     [oort.py:321] scores are 26,{3: 0.28647987499699396, 5: 0.06412504738004922, 6: 0.15133676543519098, 7: 0.058869460677462085, 11: 0.018230363306239974, 12: 0.01543283221923379, 27: 0.005191029309081683, 36: 0.0025506731049285106, 50: 0.00969416111262484, 51: 0.033109194062230805, 53: 0.19625772125908333, 58: 0.0019340945354341665, 60: 0.0008630648173247704, 67: 0.0010436943828594598, 70: 0.004123730727427644, 79: 0.002627477647713395, 81: 0.01543324840922363, 84: 0.02709142908550182, 85: 0.020272037723627255, 87: 0.0070089636729746595, 93: 0.052218016560274506, 97: 0.04790543201613733, 103: 0.0038159812691031967, 105: 0.009619016925793398, 110: 0.04125662649413244, 113: 0.26233112800361125, 119: 0.007733806131259437},[3, 113, 53, 6, 5, 7, 93, 97, 110, 51, 84, 85, 11, 81, 12, 50, 105, 119, 87, 27, 70, 103, 79, 36, 58, 67, 60]
2021-08-18:16:03:09,419 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:16:03:09,419 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:09,420 INFO     [oort.py:398] At round 142, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 12.029357192292537, 'time_stamp': 143, 'count': 140, 'status': True, 'gradient': 27.770805420610067}, [6.239344239563414e-10, -2.0979167686487338e-06]), ({'reward': 5285.627554516638, 'duration': 27.689063957948644, 'time_stamp': 143, 'count': 135, 'status': True, 'gradient': 20.963700004387675}, [0.32978787503703433, -2.0979167686487338e-06]), ({'reward': 16027.335324271546, 'duration': 17.343863580585587, 'time_stamp': 143, 'count': 34, 'status': True, 'gradient': 15.32628371225317}, [1.0, -2.0979167686487338e-06])]
2021-08-18:16:03:09,421 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:09,747 INFO     [param_server.py:553] For epoch: 144, median_reward: 1191.727514146421, dev: 5958.637570732106
2021-08-18:16:03:10,389 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.4762, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:03:10,392 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2025.531, eval_time 0.5993, test_loss 2.4762, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:03:10,412 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.303, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:03:10,413 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2025.5374, eval_time 0.6176, test_loss 2.303, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:03:10,416 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.154, Top-1 Accuracy: 621.0/1033 (0.6012), Top-5 Accuracy: 1.0
2021-08-18:16:03:10,418 INFO     [learner.py:656] After aggregation epoch 143, CumulTime 2025.5542, eval_time 0.6234, test_loss 3.154, test_accuracy 0.6012, test_5_accuracy 1.0 

2021-08-18:16:03:10,460 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:03:10,480 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:03:10,484 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:10,486 INFO     [learner.py:526] ====Start train round 144
2021-08-18:16:03:10,493 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:10,502 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:11,743 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:11,753 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:12,340 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:12,352 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:12,882 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:12,896 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:13,534 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:13,548 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:13,624 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:13,634 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:14,522 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:14,536 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:14,626 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:14,637 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:15,27 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:15,41 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:15,216 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:15,225 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:15,384 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:15,393 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:15,540 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:15,561 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:15,681 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:15,699 INFO     [learner.py:606] ====Pushing takes 0.017209291458129883 s
2021-08-18:16:03:15,730 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:15,738 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:15,739 INFO     [param_server.py:410] Lock worker 1 with localStep 144 , while globalStep is 143

2021-08-18:16:03:15,891 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:15,905 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:16,43 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:16,61 INFO     [learner.py:606] ====Pushing takes 0.01680445671081543 s
2021-08-18:16:03:16,82 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:16,87 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:16,88 INFO     [param_server.py:410] Lock worker 2 with localStep 144 , while globalStep is 143

2021-08-18:16:03:16,558 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:16,572 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:17,855 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:17,873 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:18,541 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:18,555 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:19,14 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:19,23 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:19,546 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:19,555 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:20,30 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:20,72 INFO     [learner.py:606] ====Pushing takes 0.03990435600280762 s
2021-08-18:16:03:20,111 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:20,123 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:20,124 INFO     [param_server.py:381] ====After aggregation in epoch: 143, virtual_clock: 4594.903962852306, top_1: : 60.7615 % (1883.0), top_5: : 100.0 % (3099.0), test loss: 2.644388855607421, test len: 3099.0
2021-08-18:16:03:20,126 INFO     [param_server.py:410] Lock worker 3 with localStep 144 , while globalStep is 144

2021-08-18:16:03:20,127 INFO     [param_server.py:441] ====Epoch 145 completes 20 clients with loss 5.76080686757033, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:20,127 INFO     [param_server.py:450] ====Start to sample for epoch 145, global virtualClock: 4594.903962852306, round_duration: 28.015855495488744
2021-08-18:16:03:20,128 INFO     [oort.py:208] Training selector: Pacer 143: lastExploitationUtil 3637.596079412345, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:03:20,129 INFO     [oort.py:321] scores are 26,{3: 0.07608742958332596, 5: 0.08349025049554144, 6: 0.033716678620048256, 7: 0.2934462704348812, 11: 0.010096367520953144, 12: 0.0028745880753333806, 27: 0.0930597106410465, 36: 0.0025436001710194833, 50: 0.015630677902811876, 51: 0.03301738333943343, 53: 0.03906801369161909, 58: 0.0031184966255192017, 60: 0.001089708777032205, 67: 0.001703283956083905, 70: 0.0066490236761597415, 79: 0.002620191737294763, 81: 0.1183167025825094, 84: 0.20291022415622711, 85: 0.006536592504148087, 87: 0.006989528043715099, 93: 0.09871493303829161, 97: 0.33775188610548246, 103: 0.017314543518748896, 105: 0.015509516869176761, 110: 0.05467660115458146, 113: 0.9652003269946692, 119: 0.012469839442123381},[113, 97, 7, 84, 81, 93, 27, 5, 3, 110, 53, 6, 51, 103, 50, 105, 119, 11, 87, 70, 85, 58, 12, 79, 36, 67, 60]
2021-08-18:16:03:20,130 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:03:20,130 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:20,131 INFO     [oort.py:398] At round 143, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 27.035726288496562, 'time_stamp': 144, 'count': 137, 'status': True, 'gradient': 11.924609604837038}, [8.449829281813763e-10, -2.083347801026398e-06]), ({'reward': 10727.967680470334, 'duration': 8.009219946401625, 'time_stamp': 144, 'count': 65, 'status': True, 'gradient': 21.507567542131326}, [0.9064941102699906, -2.083347801026398e-06]), ({'reward': 6024.4153364927815, 'duration': 21.635252629006885, 'time_stamp': 144, 'count': 95, 'status': True, 'gradient': 22.140737021927524}, [0.5090519670231217, -2.083347801026398e-06])]
2021-08-18:16:03:20,132 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:20,436 INFO     [param_server.py:553] For epoch: 145, median_reward: 1396.2741056584039, dev: 6981.370528292019
2021-08-18:16:03:21,102 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8953, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:03:21,103 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2036.228, eval_time 0.6082, test_loss 2.8953, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:03:21,132 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5979, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:03:21,133 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2036.2725, eval_time 0.642, test_loss 2.5979, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:03:21,142 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9425, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:03:21,143 INFO     [learner.py:656] After aggregation epoch 144, CumulTime 2036.2786, eval_time 0.649, test_loss 2.9425, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:03:21,174 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:03:21,182 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:21,191 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:03:21,220 INFO     [learner.py:526] ====Start train round 145
2021-08-18:16:03:21,220 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:21,237 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:22,439 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:22,457 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:23,50 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:23,63 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:23,418 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:23,432 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:24,272 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:24,281 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:24,337 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:24,358 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:25,387 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:25,408 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:25,430 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:25,443 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:25,840 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:25,853 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:25,951 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:25,972 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:26,106 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:26,121 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:26,424 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:26,438 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:26,486 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:26,507 INFO     [learner.py:606] ====Pushing takes 0.02007293701171875 s
2021-08-18:16:03:26,521 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:26,537 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:26,541 INFO     [learner.py:606] ====Pushing takes 0.019652605056762695 s
2021-08-18:16:03:26,542 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:26,542 INFO     [param_server.py:410] Lock worker 2 with localStep 145 , while globalStep is 144

2021-08-18:16:03:26,564 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:26,569 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:26,571 INFO     [param_server.py:410] Lock worker 1 with localStep 145 , while globalStep is 144

2021-08-18:16:03:26,704 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:26,713 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:27,231 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:27,242 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:28,573 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:28,584 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:29,307 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:29,320 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:30,7 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:30,21 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:30,634 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:30,655 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:31,224 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:31,262 INFO     [learner.py:606] ====Pushing takes 0.03679609298706055 s
2021-08-18:16:03:31,303 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:31,316 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:31,317 INFO     [param_server.py:381] ====After aggregation in epoch: 144, virtual_clock: 4622.919818347795, top_1: : 61.536 % (1907.0), top_5: : 100.0 % (3099.0), test loss: 2.8119280338287354, test len: 3099.0
2021-08-18:16:03:31,319 INFO     [param_server.py:410] Lock worker 3 with localStep 145 , while globalStep is 145

2021-08-18:16:03:31,319 INFO     [param_server.py:441] ====Epoch 146 completes 20 clients with loss 6.5481155145990515, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:31,320 INFO     [param_server.py:450] ====Start to sample for epoch 146, global virtualClock: 4622.919818347795, round_duration: 28.015855495488744
2021-08-18:16:03:31,321 INFO     [oort.py:208] Training selector: Pacer 144: lastExploitationUtil 4482.933134672877, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:03:31,321 INFO     [oort.py:321] scores are 26,{3: 0.07101569656309079, 5: 0.09068279605411633, 6: 0.36395152791529634, 7: 0.05854449174039855, 11: 0.07895309649242827, 12: 0.01899088893009211, 27: 0.0051623739883529885, 36: 0.014285581969457903, 50: 0.013151463784217653, 51: 0.29604868482626906, 53: 0.06812958738835038, 58: 0.0026238654322435213, 60: 0.0007942708883900904, 67: 0.0014331225684489784, 70: 0.005594408292534118, 79: 0.0185280519210284, 81: 0.01534805438377704, 84: 0.48713683948758646, 85: 0.008866180921507663, 87: 0.006970273060753789, 93: 0.01017900885860485, 97: 0.1476062270865753, 103: 0.0037949164357820794, 105: 0.01304952035247283, 110: 0.006214595765855387, 113: 0.05854449174039855, 119: 0.010491972442768612},[84, 6, 51, 97, 5, 11, 3, 53, 7, 113, 12, 79, 81, 36, 50, 105, 119, 93, 85, 87, 110, 70, 27, 103, 58, 67, 60]
2021-08-18:16:03:31,331 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:03:31,332 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:31,332 INFO     [oort.py:398] At round 144, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 10335.514245833814, 'duration': 11.90395711384456, 'time_stamp': 145, 'count': 143, 'status': True, 'gradient': 21.407129457741288}, [0.5751542732578944, -2.0689797860674918e-06]), ({'reward': 8407.1127612705, 'duration': 12.029357192292537, 'time_stamp': 145, 'count': 142, 'status': True, 'gradient': 27.794576917800537}, [0.46784181641502515, -2.0689797860674918e-06]), ({'reward': 16456.911872078777, 'duration': 29.570969934622333, 'time_stamp': 145, 'count': 127, 'status': True, 'gradient': 11.930220568369396}, [0.915800255872459, -2.0689797860674918e-06])]
2021-08-18:16:03:31,333 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:31,612 INFO     [param_server.py:553] For epoch: 146, median_reward: 1579.4311720790656, dev: 7897.155860395328
2021-08-18:16:03:32,202 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6725, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:03:32,215 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2047.3542, eval_time 0.5688, test_loss 2.6725, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:03:32,283 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:32,286 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3222, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:03:32,287 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2047.4112, eval_time 0.639, test_loss 2.3222, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:03:32,286 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5904, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:03:32,288 INFO     [learner.py:656] After aggregation epoch 145, CumulTime 2047.4245, eval_time 0.6423, test_loss 2.5904, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:03:32,305 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:32,346 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:32,355 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:32,356 INFO     [learner.py:526] ====Start train round 146
2021-08-18:16:03:32,364 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:33,321 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:33,331 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:34,54 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:34,68 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:34,348 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:34,366 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:35,342 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:35,345 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:35,352 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:35,366 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:35,991 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:36,11 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:36,196 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:36,211 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:36,552 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:36,580 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:36,808 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:36,823 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:36,909 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:36,923 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:37,104 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:37,131 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:37,448 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:37,462 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:37,579 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:37,599 INFO     [learner.py:606] ====Pushing takes 0.019092559814453125 s
2021-08-18:16:03:37,631 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:37,637 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:37,638 INFO     [param_server.py:410] Lock worker 2 with localStep 146 , while globalStep is 145

2021-08-18:16:03:37,860 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:37,889 INFO     [learner.py:606] ====Pushing takes 0.026572704315185547 s
2021-08-18:16:03:37,909 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:37,915 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:37,915 INFO     [param_server.py:410] Lock worker 1 with localStep 146 , while globalStep is 145

2021-08-18:16:03:38,67 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:38,81 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:39,476 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:39,490 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:40,152 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:40,166 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:40,799 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:40,812 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:41,292 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:41,313 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:41,873 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:41,914 INFO     [learner.py:606] ====Pushing takes 0.03947567939758301 s
2021-08-18:16:03:41,967 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:41,977 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:41,978 INFO     [param_server.py:381] ====After aggregation in epoch: 145, virtual_clock: 4650.65020150063, top_1: : 61.9232 % (1919.0), top_5: : 100.0 % (3099.0), test loss: 2.5283532076411777, test len: 3099.0
2021-08-18:16:03:41,980 INFO     [param_server.py:410] Lock worker 3 with localStep 146 , while globalStep is 146

2021-08-18:16:03:41,980 INFO     [param_server.py:441] ====Epoch 147 completes 20 clients with loss 7.180566248660153, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:41,980 INFO     [param_server.py:450] ====Start to sample for epoch 147, global virtualClock: 4650.65020150063, round_duration: 27.730383152835458
2021-08-18:16:03:41,981 INFO     [oort.py:208] Training selector: Pacer 145: lastExploitationUtil 2872.2249030838398, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:03:41,981 INFO     [oort.py:321] scores are 26,{3: 0.08326611537719895, 5: 0.08349087176488842, 6: 0.03353176939936161, 7: 0.05838426056249027, 11: 0.010040996958772226, 12: 0.0028588232413532936, 27: 0.06758282370228509, 36: 0.0062837047999871, 50: 0.017201260458718247, 51: 0.1715033335702595, 53: 0.49229441195357926, 58: 0.003431845568613489, 60: 0.0014530919015913236, 67: 0.0018744312400221998, 70: 0.007317122696849453, 79: 0.04081221624340592, 81: 0.19973711398087798, 84: 0.11226683051246547, 85: 0.006500744482475825, 87: 0.12601061298264193, 93: 0.07876908678732998, 97: 0.1387186747628125, 103: 0.0037845300798245423, 105: 0.017067925071093747, 110: 0.014706241645650823, 113: 0.5408852372995987, 119: 0.01372281851472195},[113, 53, 81, 51, 97, 87, 84, 5, 3, 93, 27, 7, 79, 6, 50, 105, 110, 119, 11, 70, 85, 36, 103, 58, 12, 67, 60]
2021-08-18:16:03:41,982 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:03:41,983 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:41,983 INFO     [oort.py:398] At round 145, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 3138.734614202473, 'duration': 15.972045438625893, 'time_stamp': 146, 'count': 142, 'status': True, 'gradient': 20.460201717903733}, [0.37643884418964857, -2.0548085945794165e-06]), ({'reward': 4023.0743576291993, 'duration': 8.009219946401625, 'time_stamp': 146, 'count': 67, 'status': True, 'gradient': 21.524106129404334}, [0.4825009779364454, -2.0548085945794165e-06]), ({'reward': 2055.7748080200313, 'duration': 12.029357192292537, 'time_stamp': 146, 'count': 143, 'status': True, 'gradient': 27.80564834392512}, [0.24655547226218946, -2.0548085945794165e-06])]
2021-08-18:16:03:41,984 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:42,268 INFO     [param_server.py:553] For epoch: 147, median_reward: 1230.4430463112476, dev: 6152.215231556238
2021-08-18:16:03:42,862 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5414, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:03:42,863 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2058.0022, eval_time 0.5602, test_loss 2.5414, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:03:42,941 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:42,952 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8726, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:03:42,953 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2058.089, eval_time 0.6485, test_loss 3.8726, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:03:42,957 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:43,0 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7577, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:03:43,2 INFO     [learner.py:656] After aggregation epoch 146, CumulTime 2058.1261, eval_time 0.6968, test_loss 2.7577, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:03:43,59 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:43,69 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:43,94 INFO     [learner.py:526] ====Start train round 147
2021-08-18:16:03:43,110 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:44,38 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:44,47 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:44,672 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:44,692 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:45,187 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:45,197 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:45,864 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:45,878 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:45,892 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:45,910 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:46,904 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:46,913 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:46,943 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:46,970 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:47,114 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:47,132 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:47,515 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:47,540 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:47,589 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:47,598 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:47,693 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:47,720 INFO     [learner.py:606] ====Pushing takes 0.01958751678466797 s
2021-08-18:16:03:47,750 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:47,758 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:47,759 INFO     [param_server.py:410] Lock worker 2 with localStep 147 , while globalStep is 146

2021-08-18:16:03:48,53 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:48,80 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:48,225 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:48,235 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:48,243 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:48,262 INFO     [learner.py:606] ====Pushing takes 0.01870417594909668 s
2021-08-18:16:03:48,285 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:48,290 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:48,291 INFO     [param_server.py:410] Lock worker 1 with localStep 147 , while globalStep is 146

2021-08-18:16:03:48,793 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:48,805 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:03:49,896 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:03:49,905 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:03:50,500 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:03:50,514 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:03:51,16 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:03:51,29 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:03:51,771 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:03:51,792 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:03:52,361 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:03:52,401 INFO     [learner.py:606] ====Pushing takes 0.03924274444580078 s
2021-08-18:16:03:52,450 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:52,460 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:03:52,460 INFO     [param_server.py:381] ====After aggregation in epoch: 146, virtual_clock: 4678.666056996119, top_1: : 61.6973 % (1912.0), top_5: : 100.0 % (3099.0), test loss: 3.0572274216899165, test len: 3099.0
2021-08-18:16:03:52,463 INFO     [param_server.py:410] Lock worker 3 with localStep 147 , while globalStep is 147

2021-08-18:16:03:52,464 INFO     [param_server.py:441] ====Epoch 148 completes 20 clients with loss 6.169850594022494, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:03:52,464 INFO     [param_server.py:450] ====Start to sample for epoch 148, global virtualClock: 4678.666056996119, round_duration: 28.015855495488744
2021-08-18:16:03:52,465 INFO     [oort.py:208] Training selector: Pacer 146: lastExploitationUtil 4273.548403542874, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:03:52,465 INFO     [oort.py:321] scores are 26,{3: 0.18996281390774478, 5: 0.00541907883113427, 6: 0.5066192659453402, 7: 0.17666075175249205, 11: 0.010013692840005223, 12: 0.009544319128962177, 27: 0.02843756195203793, 36: 0.00252277175603145, 50: 0.013950625712935715, 51: 0.03274701861393608, 53: 0.2106396282344225, 58: 0.0027833072551411934, 60: 0.0012420150740862835, 67: 0.0011114808559545535, 70: 0.005934358141041711, 79: 0.0025987361479004926, 81: 0.11799925405370945, 84: 0.02679508087311271, 85: 0.006483067243835852, 87: 0.03776586687662998, 93: 0.06035344460199829, 97: 0.3375985255756833, 103: 0.0452022442948195, 105: 0.013842487585994219, 110: 0.00618073408480959, 113: 0.6039622482947107, 119: 0.011129527704372408},[113, 6, 97, 53, 3, 7, 81, 93, 103, 87, 51, 27, 84, 50, 105, 119, 11, 12, 85, 110, 70, 5, 58, 79, 36, 60, 67]
2021-08-18:16:03:52,467 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:03:52,467 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:03:52,468 INFO     [oort.py:398] At round 146, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 13113.030158915666, 'duration': 11.90395711384456, 'time_stamp': 147, 'count': 145, 'status': True, 'gradient': 21.420819414258645}, [0.8238809869164663, -2.0408302097293197e-06]), ({'reward': 8686.042476105278, 'duration': 8.009219946401625, 'time_stamp': 147, 'count': 68, 'status': True, 'gradient': 21.5305149318116}, [0.5457367505622212, -2.0408302097293197e-06]), ({'reward': 1885.0442356469464, 'duration': 5.8943907365129, 'time_stamp': 147, 'count': 144, 'status': True, 'gradient': 21.740849205049244}, [0.11843525402000248, -2.0408302097293197e-06])]
2021-08-18:16:03:52,469 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:03:52,790 INFO     [param_server.py:553] For epoch: 148, median_reward: 1535.5382980227753, dev: 7677.691490113876
2021-08-18:16:03:53,365 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4863, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:03:53,368 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2068.4926, eval_time 0.5324, test_loss 2.4863, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:03:53,410 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.5403, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:03:53,411 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2068.5475, eval_time 0.5761, test_loss 2.5403, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:03:53,438 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0989, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:03:53,442 INFO     [learner.py:656] After aggregation epoch 147, CumulTime 2068.5817, eval_time 0.6074, test_loss 3.0989, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:03:53,447 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:53,455 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:03:53,499 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:53,504 INFO     [learner.py:526] ====Start train round 148
2021-08-18:16:03:53,515 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:03:53,528 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:03:54,526 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:03:54,538 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:03:55,158 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:03:55,168 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:03:55,526 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:03:55,541 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:03:56,326 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:03:56,336 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:03:56,441 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:03:56,462 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:03:57,484 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:03:57,505 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:03:57,551 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:03:57,565 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:03:57,926 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:03:57,940 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:03:58,23 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:03:58,43 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:03:58,157 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:03:58,167 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:03:58,546 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:03:58,566 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:03:58,655 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:03:58,674 INFO     [learner.py:606] ====Pushing takes 0.017782211303710938 s
2021-08-18:16:03:58,684 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:03:58,689 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:03:58,694 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:03:58,702 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:58,707 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:03:58,708 INFO     [learner.py:606] ====Pushing takes 0.018344879150390625 s
2021-08-18:16:03:58,708 INFO     [param_server.py:410] Lock worker 2 with localStep 148 , while globalStep is 147

2021-08-18:16:03:58,729 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:03:58,735 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:03:58,735 INFO     [param_server.py:410] Lock worker 1 with localStep 148 , while globalStep is 147

2021-08-18:16:03:59,191 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:03:59,203 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:00,368 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:00,381 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:01,39 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:01,49 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:01,520 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:01,529 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:01,989 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:01,999 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:02,550 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:02,592 INFO     [learner.py:606] ====Pushing takes 0.04065537452697754 s
2021-08-18:16:04:02,637 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:02,647 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:02,647 INFO     [param_server.py:381] ====After aggregation in epoch: 147, virtual_clock: 4706.681912491607, top_1: : 61.7296 % (1913.0), top_5: : 100.0 % (3099.0), test loss: 2.7084811142197363, test len: 3099.0
2021-08-18:16:04:02,650 INFO     [param_server.py:410] Lock worker 3 with localStep 148 , while globalStep is 148

2021-08-18:16:04:02,650 INFO     [param_server.py:441] ====Epoch 149 completes 20 clients with loss 8.398625710873825, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:02,651 INFO     [param_server.py:450] ====Start to sample for epoch 149, global virtualClock: 4706.681912491607, round_duration: 28.015855495488744
2021-08-18:16:04:02,651 INFO     [oort.py:208] Training selector: Pacer 147: lastExploitationUtil 2726.4879194641394, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:04:02,652 INFO     [oort.py:321] scores are 26,{3: 0.18035116841848317, 5: 0.005404437508515626, 6: 0.03335023755343451, 7: 0.05806818411371213, 11: 0.009986637742258319, 12: 0.0028433463527345842, 27: 0.05941022834632487, 36: 0.016896834454510366, 50: 0.012130310396755684, 51: 0.20999766413815352, 53: 0.042164210136102984, 58: 0.0024201338082705916, 60: 0.0010799535932030744, 67: 0.0013799053624654666, 70: 0.005160027065280761, 79: 0.04722398454724763, 81: 0.04776381309101067, 84: 0.2217280983686603, 85: 0.05241411835824775, 87: 0.006913564152362447, 93: 0.010096194243474858, 97: 0.018525100162160513, 103: 0.03449229420247533, 105: 0.012036282424640584, 110: 0.028377047286237213, 113: 0.05806818411371213, 119: 0.009677316874622048},[84, 51, 3, 27, 7, 113, 85, 81, 79, 53, 103, 6, 110, 97, 36, 50, 105, 93, 11, 119, 87, 5, 70, 12, 58, 67, 60]
2021-08-18:16:04:02,653 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:04:02,654 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:04:02,654 INFO     [oort.py:398] At round 147, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 7340.500627047677, 'duration': 17.343863580585587, 'time_stamp': 148, 'count': 39, 'status': True, 'gradient': 13.650333295952015}, [0.6085348174507117, -2.027040723248132e-06]), ({'reward': 5111.464107589471, 'duration': 13.298442137908651, 'time_stamp': 148, 'count': 145, 'status': True, 'gradient': 18.768300895704456}, [0.42374521706440454, -2.027040723248132e-06]), ({'reward': 2726.4984059561375, 'duration': 66.93898235209988, 'time_stamp': 148, 'count': 106, 'status': True, 'gradient': 16.62933316558091}, [0.2260289144858386, -2.027040723248132e-06])]
2021-08-18:16:04:02,655 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:04:02,928 INFO     [param_server.py:553] For epoch: 149, median_reward: 1200.340570588646, dev: 6001.70285294323
2021-08-18:16:04:03,520 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6422, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:04:03,527 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2078.6661, eval_time 0.5648, test_loss 2.6422, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:04:03,541 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8499, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:04:03,545 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2078.6805, eval_time 0.5811, test_loss 2.8499, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:04:03,601 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5552, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:04:03,602 INFO     [learner.py:656] After aggregation epoch 148, CumulTime 2078.7262, eval_time 0.6379, test_loss 2.5552, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:04:03,607 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:04:03,612 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:04:03,623 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:03,629 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:04:03,669 INFO     [learner.py:526] ====Start train round 149
2021-08-18:16:04:03,684 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:04,765 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:04,774 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:05,389 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:05,398 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:05,941 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:05,955 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:06,546 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:06,556 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:06,899 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:04:06,926 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:07,724 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:07,738 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:08,27 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:08,53 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:08,135 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:08,144 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:08,544 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:08,564 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:04:08,604 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:08,631 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:08,764 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:08,783 INFO     [learner.py:606] ====Pushing takes 0.01774454116821289 s
2021-08-18:16:04:08,812 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:08,820 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:08,820 INFO     [param_server.py:410] Lock worker 2 with localStep 149 , while globalStep is 148

2021-08-18:16:04:09,156 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:09,183 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:09,223 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:04:09,237 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:09,344 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:09,364 INFO     [learner.py:606] ====Pushing takes 0.01883840560913086 s
2021-08-18:16:04:09,388 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:09,395 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:09,396 INFO     [param_server.py:410] Lock worker 1 with localStep 149 , while globalStep is 148

2021-08-18:16:04:09,943 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:09,957 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:11,277 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:11,287 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:11,801 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:11,810 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:12,326 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:12,336 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:12,943 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:12,955 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:13,620 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:13,662 INFO     [learner.py:606] ====Pushing takes 0.04094433784484863 s
2021-08-18:16:04:13,705 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:13,714 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:13,715 INFO     [param_server.py:381] ====After aggregation in epoch: 148, virtual_clock: 4735.365315514623, top_1: : 61.8909 % (1918.0), top_5: : 100.0 % (3099.0), test loss: 2.6824238565233016, test len: 3099.0
2021-08-18:16:04:13,717 INFO     [param_server.py:410] Lock worker 3 with localStep 149 , while globalStep is 149

2021-08-18:16:04:13,717 INFO     [param_server.py:441] ====Epoch 150 completes 20 clients with loss 6.803433936769863, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:13,718 INFO     [param_server.py:450] ====Start to sample for epoch 150, global virtualClock: 4735.365315514623, round_duration: 28.683403023015895
2021-08-18:16:04:13,719 INFO     [oort.py:208] Training selector: Pacer 148: lastExploitationUtil 1133.0489572643125, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:04:13,719 INFO     [oort.py:321] scores are 26,{3: 0.01566832140983024, 5: 0.060401827578398605, 6: 0.03326070592444841, 7: 0.05791229499575201, 11: 0.009959827739968953, 12: 0.0028357131408174537, 27: 0.09328527319436022, 36: 0.00250920140239883, 50: 0.00961073229920546, 51: 0.04219611644301421, 53: 0.5712354757330298, 58: 0.001917449545707099, 60: 0.001750098153233182, 67: 0.0010472870232012905, 70: 0.004088241533731216, 79: 0.0025847571708326822, 81: 0.015182317356609607, 84: 0.026650946263157026, 85: 0.03260802308798052, 87: 0.006895004084846611, 93: 0.07602476469825774, 97: 0.12074104139158352, 103: 0.0037539367680868596, 105: 0.009536234809934527, 110: 0.0061474870235011195, 113: 0.05791229499575201, 119: 0.00766724830730227},[53, 97, 27, 93, 5, 7, 113, 51, 6, 85, 84, 3, 81, 11, 50, 105, 119, 87, 110, 70, 103, 12, 79, 36, 58, 60, 67]
2021-08-18:16:04:13,720 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:16:04:13,721 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:04:13,721 INFO     [oort.py:398] At round 148, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 149, 'count': 146, 'status': True, 'gradient': 21.758676851002555}, [1.4754528404483798e-09, -2.0134363317874635e-06]), ({'reward': 5425.22197743658, 'duration': 11.058674649423494, 'time_stamp': 149, 'count': 146, 'status': True, 'gradient': 20.483724375880037}, [0.800464443689823, -2.0134363317874635e-06]), ({'reward': 2172.622281997449, 'duration': 15.972045438625893, 'time_stamp': 149, 'count': 145, 'status': True, 'gradient': 21.547993425453754}, [0.3205586977420832, -2.0134363317874635e-06])]
2021-08-18:16:04:13,722 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:04:13,987 INFO     [param_server.py:553] For epoch: 150, median_reward: 853.8796547116605, dev: 4269.398273558302
2021-08-18:16:04:14,572 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7371, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:04:14,573 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2089.7123, eval_time 0.552, test_loss 2.7371, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:04:14,598 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4176, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:04:14,598 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2089.7229, eval_time 0.577, test_loss 2.4176, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:04:14,642 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:04:14,648 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7811, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:04:14,648 INFO     [learner.py:656] After aggregation epoch 149, CumulTime 2089.7844, eval_time 0.6273, test_loss 2.7811, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:04:14,659 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:04:14,689 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:04:14,702 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:14,720 INFO     [learner.py:526] ====Start train round 150
2021-08-18:16:04:14,734 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:15,794 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:15,804 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:16,435 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:16,445 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:16,806 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:16,820 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:17,415 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:04:17,436 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:17,675 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:17,684 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:18,61 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:18,88 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:18,639 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:18,666 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:18,724 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:18,739 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:19,203 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:19,228 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:19,236 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:19,237 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:19,370 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:19,384 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:04:19,443 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:19,460 INFO     [learner.py:606] ====Pushing takes 0.015501022338867188 s
2021-08-18:16:04:19,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:19,496 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:19,496 INFO     [param_server.py:410] Lock worker 1 with localStep 150 , while globalStep is 149

2021-08-18:16:04:19,770 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:19,792 INFO     [learner.py:606] ====Pushing takes 0.02086329460144043 s
2021-08-18:16:04:19,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:19,823 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:19,823 INFO     [param_server.py:410] Lock worker 2 with localStep 150 , while globalStep is 149

2021-08-18:16:04:19,971 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:04:19,981 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:20,621 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:20,630 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:21,799 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:21,819 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:22,420 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:22,441 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:23,33 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:23,53 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:23,545 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:23,565 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:24,75 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:24,117 INFO     [learner.py:606] ====Pushing takes 0.04019737243652344 s
2021-08-18:16:04:24,161 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:24,171 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:24,172 INFO     [param_server.py:381] ====After aggregation in epoch: 149, virtual_clock: 4763.095698667458, top_1: : 61.4392 % (1904.0), top_5: : 100.0 % (3099.0), test loss: 2.6452592467820204, test len: 3099.0
2021-08-18:16:04:24,174 INFO     [param_server.py:410] Lock worker 3 with localStep 150 , while globalStep is 150

2021-08-18:16:04:24,175 INFO     [param_server.py:441] ====Epoch 151 completes 20 clients with loss 6.14793614586856, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:24,176 INFO     [param_server.py:450] ====Start to sample for epoch 151, global virtualClock: 4763.095698667458, round_duration: 27.730383152835458
2021-08-18:16:04:24,176 INFO     [oort.py:208] Training selector: Pacer 149: lastExploitationUtil 1572.3478841288918, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:04:24,177 INFO     [oort.py:321] scores are 26,{3: 0.015626524563830655, 5: 0.04376632664310249, 6: 0.03317197959780506, 7: 0.6971123729176911, 11: 0.009933258883271344, 12: 0.04119054112297779, 27: 0.0050930052851502865, 36: 0.0025025078516441074, 50: 0.01325453037026907, 51: 0.0324839815585319, 53: 0.038436862886445905, 58: 0.0026444283792125267, 60: 0.0011800421614454142, 67: 0.0011167955150632144, 70: 0.005638251059632118, 79: 0.02214700910948627, 81: 0.015141816976008983, 84: 0.3353225450351071, 85: 0.006430992673692231, 87: 0.006876610957953003, 93: 0.049196235917124354, 97: 0.3374493211826345, 103: 0.0037439227587438124, 105: 0.0131517880189779, 110: 0.09469242748324119, 113: 0.10700418655071663, 119: 0.010574196885489537},[7, 97, 84, 113, 110, 93, 5, 12, 53, 6, 51, 79, 3, 81, 50, 105, 119, 11, 87, 85, 70, 27, 103, 58, 36, 60, 67]
2021-08-18:16:04:24,177 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:04:24,178 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:04:24,178 INFO     [oort.py:398] At round 149, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 4174.951620373769, 'duration': 13.298442137908651, 'time_stamp': 150, 'count': 147, 'status': True, 'gradient': 17.075563914543455}, [0.6708954261782001, -2.0000133334222246e-06]), ({'reward': 6222.949463826195, 'duration': 15.972045438625893, 'time_stamp': 150, 'count': 146, 'status': True, 'gradient': 20.48922141834174}, [1.0, -2.0000133334222246e-06]), ({'reward': 3978.674759547986, 'duration': 5.8943907365129, 'time_stamp': 150, 'count': 147, 'status': True, 'gradient': 21.771957455654825}, [0.6393545664845894, -2.0000133334222246e-06])]
2021-08-18:16:04:24,179 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:04:24,449 INFO     [param_server.py:553] For epoch: 151, median_reward: 935.7827458579984, dev: 4678.913729289992
2021-08-18:16:04:25,36 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.745, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:04:25,38 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2100.1775, eval_time 0.5545, test_loss 2.745, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:04:25,91 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:25,113 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:04:25,115 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8173, Top-1 Accuracy: 622.0/1033 (0.6021), Top-5 Accuracy: 1.0
2021-08-18:16:04:25,118 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2100.2542, eval_time 0.6328, test_loss 2.8173, test_accuracy 0.6021, test_5_accuracy 1.0 

2021-08-18:16:04:25,124 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6177, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:04:25,125 INFO     [learner.py:656] After aggregation epoch 150, CumulTime 2100.2495, eval_time 0.6389, test_loss 2.6177, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:04:25,189 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:25,206 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:25,206 INFO     [learner.py:526] ====Start train round 151
2021-08-18:16:04:25,221 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:26,611 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:26,625 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:27,334 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:27,343 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:27,666 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:27,676 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:27,909 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:04:27,929 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:28,931 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:28,941 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:28,966 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:28,986 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:29,505 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:29,516 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:29,525 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:29,526 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:30,43 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:30,70 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:30,103 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:30,114 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:04:30,246 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:30,266 INFO     [learner.py:606] ====Pushing takes 0.01906442642211914 s
2021-08-18:16:04:30,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:30,302 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:30,302 INFO     [param_server.py:410] Lock worker 1 with localStep 151 , while globalStep is 150

2021-08-18:16:04:30,544 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:30,553 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:30,685 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:04:30,699 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:31,116 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:31,136 INFO     [learner.py:606] ====Pushing takes 0.0181272029876709 s
2021-08-18:16:04:31,159 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:31,164 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:31,165 INFO     [param_server.py:410] Lock worker 2 with localStep 151 , while globalStep is 150

2021-08-18:16:04:31,291 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:31,305 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:32,572 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:32,586 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:33,218 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:33,229 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:33,764 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:33,778 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:34,479 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:34,493 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:35,55 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:35,97 INFO     [learner.py:606] ====Pushing takes 0.0395047664642334 s
2021-08-18:16:04:35,134 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:35,144 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:35,145 INFO     [param_server.py:381] ====After aggregation in epoch: 150, virtual_clock: 4791.779101690474, top_1: : 61.3746 % (1902.0), top_5: : 100.0 % (3099.0), test loss: 2.726680684972692, test len: 3099.0
2021-08-18:16:04:35,148 INFO     [param_server.py:410] Lock worker 3 with localStep 151 , while globalStep is 151

2021-08-18:16:04:35,148 INFO     [param_server.py:441] ====Epoch 152 completes 20 clients with loss 5.784978891962937, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:35,149 INFO     [param_server.py:450] ====Start to sample for epoch 152, global virtualClock: 4791.779101690474, round_duration: 28.683403023015895
2021-08-18:16:04:35,150 INFO     [oort.py:208] Training selector: Pacer 150: lastExploitationUtil 3107.0522356482206, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:04:35,150 INFO     [oort.py:321] scores are 26,{3: 0.06145071010603064, 5: 0.03955314921002768, 6: 0.2680723592982745, 7: 0.444158073640774, 11: 0.03548980613863589, 12: 0.00692870723525368, 27: 0.016452540257372868, 36: 0.002495874094489637, 50: 0.010719355979056763, 51: 0.032397871600903586, 53: 0.2739206793988133, 58: 0.0021386324800675488, 60: 0.0009543372451129843, 67: 0.0011680943828671006, 70: 0.004559831130875726, 79: 0.01009555241632328, 81: 0.025578761465880236, 84: 0.03784950199972181, 85: 0.006413945117325355, 87: 0.01165026849270673, 93: 0.06593176605611982, 97: 0.028365304595586092, 103: 0.0037339982047128292, 105: 0.01063626500511432, 110: 0.11226650874001337, 113: 0.2519541009060634, 119: 0.005303386120932154},[7, 53, 6, 113, 110, 93, 3, 5, 84, 11, 51, 97, 81, 27, 87, 50, 105, 79, 12, 85, 119, 70, 103, 36, 58, 67, 60]
2021-08-18:16:04:35,151 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999997
2021-08-18:16:04:35,152 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:04:35,152 INFO     [oort.py:398] At round 150, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 6208.639798206489, 'duration': 5.8943907365129, 'time_stamp': 151, 'count': 148, 'status': True, 'gradient': 21.77661335689706}, [0.38655337314446864, -1.9867681242922155e-06]), ({'reward': 6571.621424398737, 'duration': 11.90395711384456, 'time_stamp': 151, 'count': 149, 'status': True, 'gradient': 21.45630959157714}, [0.40915284779966804, -1.9867681242922155e-06]), ({'reward': 3121.554295189952, 'duration': 8.009219946401625, 'time_stamp': 151, 'count': 72, 'status': True, 'gradient': 21.564173015332393}, [0.19434940040975807, -1.9867681242922155e-06])]
2021-08-18:16:04:35,153 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 3, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36]
2021-08-18:16:04:35,424 INFO     [param_server.py:553] For epoch: 152, median_reward: 1271.9641394114442, dev: 6359.820697057221
2021-08-18:16:04:36,24 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.149, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:04:36,26 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2111.1615, eval_time 0.555, test_loss 3.149, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:04:36,53 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.483, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:04:36,54 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2111.1785, eval_time 0.5795, test_loss 2.483, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:04:36,67 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7338, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:04:36,68 INFO     [learner.py:656] After aggregation epoch 151, CumulTime 2111.2068, eval_time 0.5992, test_loss 2.7338, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:04:36,94 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:36,107 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:36,125 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:36,142 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:36,142 INFO     [learner.py:526] ====Start train round 152
2021-08-18:16:04:36,169 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:04:37,191 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:37,204 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:37,856 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:37,870 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:38,208 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:38,223 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:39,223 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:39,241 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:39,282 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:04:39,309 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:39,987 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:40,14 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:40,280 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:40,292 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:40,545 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:40,572 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:40,594 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:40,608 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:41,15 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:41,24 INFO     [learner.py:165] Start to run client 3 on rank 3...
2021-08-18:16:04:41,62 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:41,82 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:41,187 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:41,204 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:41,206 INFO     [learner.py:606] ====Pushing takes 0.01749444007873535 s
2021-08-18:16:04:41,234 INFO     [learner.py:606] ====Pushing takes 0.029122591018676758 s
2021-08-18:16:04:41,237 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:41,243 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:41,244 INFO     [param_server.py:410] Lock worker 2 with localStep 152 , while globalStep is 151

2021-08-18:16:04:41,259 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:41,264 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 10 clients
2021-08-18:16:04:41,265 INFO     [param_server.py:410] Lock worker 1 with localStep 152 , while globalStep is 151

2021-08-18:16:04:41,548 INFO     [learner.py:439] Completed to run client 3
2021-08-18:16:04:41,557 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:42,161 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:42,172 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:43,353 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:43,372 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:43,989 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:44,7 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:44,573 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:44,587 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:45,67 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:45,81 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:45,725 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:45,770 INFO     [learner.py:606] ====Pushing takes 0.04418540000915527 s
2021-08-18:16:04:45,812 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:45,822 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:45,823 INFO     [param_server.py:381] ====After aggregation in epoch: 151, virtual_clock: 4819.127409658436, top_1: : 61.0842 % (1893.0), top_5: : 100.0 % (3099.0), test loss: 2.788591627721433, test len: 3099.0
2021-08-18:16:04:45,825 INFO     [param_server.py:410] Lock worker 3 with localStep 152 , while globalStep is 152

2021-08-18:16:04:45,826 INFO     [param_server.py:441] ====Epoch 153 completes 20 clients with loss 7.966304863651325, sampled rewards are: 
 {3: 0, 5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:45,826 INFO     [param_server.py:450] ====Start to sample for epoch 153, global virtualClock: 4819.127409658436, round_duration: 27.34830796796159
2021-08-18:16:04:45,827 INFO     [oort.py:208] Training selector: Pacer 151: lastExploitationUtil 3180.13233872138, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:04:45,827 INFO     [oort.py:321] scores are 26,{3: 0.048125463134210116, 5: 0.09841772217992303, 6: 0.03299689372900427, 7: 0.20416366389454293, 11: 0.00988082989703997, 12: 0.0028132212637349847, 27: 0.027063944168821928, 36: 0.0036535864373087976, 50: 0.008374769043379708, 51: 0.15097660398799104, 53: 0.13906521743388214, 58: 0.0016453291028890181, 60: 0.000745600205173872, 67: 0.0009126033967426764, 70: 0.0035624838537414993, 79: 0.00256425578804555, 81: 0.015061896566898325, 84: 0.05470066445630072, 85: 0.006397049087774935, 87: 0.00760473830546247, 93: 0.017067551939094077, 97: 0.09963300918073197, 103: 0.003724161864854288, 105: 0.008309852110150043, 110: 0.05963918489061376, 113: 0.05745295508514573, 119: 0.0066812217605113225},[7, 51, 53, 97, 5, 110, 113, 84, 3, 6, 27, 93, 81, 11, 50, 105, 87, 119, 85, 103, 36, 70, 12, 79, 58, 67, 60]
2021-08-18:16:04:45,828 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:04:45,829 INFO     [oort.py:365] exploration poss is []
2021-08-18:16:04:45,829 INFO     [oort.py:398] At round 151, UCB exploited 27, augment_factor 1.0384615384615385, exploreLen 0, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 933.5190558767997, 'duration': 21.635252629006885, 'time_stamp': 152, 'count': 103, 'status': True, 'gradient': 22.20940876594484}, [0.04071094002941282, -1.973697195376287e-06]), ({'reward': 3364.1125394116625, 'duration': 5.8943907365129, 'time_stamp': 152, 'count': 149, 'status': True, 'gradient': 21.783211791717058}, [0.14671070924550375, -1.973697195376287e-06]), ({'reward': 5843.845350752004, 'duration': 15.972045438625893, 'time_stamp': 152, 'count': 148, 'status': True, 'gradient': 20.50361892791791}, [0.2548534766396526, -1.973697195376287e-06])]
2021-08-18:16:04:45,830 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:04:46,153 INFO     [param_server.py:553] For epoch: 153, median_reward: 1300.5874747626178, dev: 6502.937373813089
2021-08-18:16:04:46,735 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7329, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:04:46,736 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2121.8605, eval_time 0.5374, test_loss 2.7329, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:04:46,778 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7343, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:04:46,781 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2121.9173, eval_time 0.5837, test_loss 2.7343, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:04:46,792 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5177, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:04:46,795 INFO     [learner.py:656] After aggregation epoch 152, CumulTime 2121.934, eval_time 0.5972, test_loss 2.5177, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:04:46,806 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:46,821 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:46,839 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:46,853 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:46,863 INFO     [learner.py:526] ====Start train round 153
2021-08-18:16:04:46,888 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:04:48,184 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:48,195 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:04:48,914 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:04:48,923 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:04:49,228 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:04:49,242 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:04:49,992 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:04:50,13 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:04:50,623 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:04:50,637 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:04:51,36 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:04:51,57 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:04:51,135 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:04:51,146 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:04:51,578 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:04:51,599 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:04:51,887 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:04:51,901 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:04:52,113 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:04:52,134 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:04:52,256 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:04:52,275 INFO     [learner.py:606] ====Pushing takes 0.018805265426635742 s
2021-08-18:16:04:52,299 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:52,307 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:04:52,308 INFO     [param_server.py:410] Lock worker 1 with localStep 153 , while globalStep is 152

2021-08-18:16:04:52,481 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:04:52,490 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:04:52,544 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:04:52,554 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:04:53,67 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:04:53,77 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:04:53,674 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:04:53,697 INFO     [learner.py:606] ====Pushing takes 0.0216214656829834 s
2021-08-18:16:04:53,724 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:53,730 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:04:53,731 INFO     [param_server.py:410] Lock worker 2 with localStep 153 , while globalStep is 152

2021-08-18:16:04:54,251 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:04:54,270 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:04:54,889 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:04:54,904 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:04:55,568 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:04:55,577 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:04:56,156 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:04:56,171 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:04:56,735 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:04:56,773 INFO     [learner.py:606] ====Pushing takes 0.03729844093322754 s
2021-08-18:16:04:56,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:04:56,826 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:04:56,826 INFO     [param_server.py:381] ====After aggregation in epoch: 152, virtual_clock: 4848.050910645704, top_1: : 61.7296 % (1913.0), top_5: : 100.0 % (3099.0), test loss: 2.6616199402897447, test len: 3099.0
2021-08-18:16:04:56,828 INFO     [param_server.py:410] Lock worker 3 with localStep 153 , while globalStep is 153

2021-08-18:16:04:56,829 INFO     [param_server.py:441] ====Epoch 154 completes 20 clients with loss 5.44655963483337, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 12: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:04:56,829 INFO     [param_server.py:450] ====Start to sample for epoch 154, global virtualClock: 4848.050910645704, round_duration: 28.923500987268568
2021-08-18:16:04:56,830 INFO     [oort.py:208] Training selector: Pacer 152: lastExploitationUtil 1169.1228876564317, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:04:56,830 INFO     [oort.py:321] scores are 25,{5: 0.06480785013354096, 6: 0.03291051153008207, 7: 0.05730254963681497, 11: 0.04889334257155568, 12: 0.0028058565632631182, 27: 0.005052861215759284, 36: 0.0024827825925439755, 50: 0.0024466906528608184, 51: 0.12273721949409708, 53: 0.03813389597310205, 58: 0.0018360774409112155, 60: 0.0018546883958561941, 67: 0.0010028425946143169, 70: 0.003914746059360868, 79: 0.0025575428515070523, 81: 0.2771829856020688, 84: 0.24099239395048958, 85: 0.006380302324538566, 87: 0.07545189464594941, 93: 0.00996307497142878, 97: 0.018280844971670165, 103: 0.003714412423174402, 105: 0.009131539155725808, 110: 0.00608276153330978, 113: 0.15220598563197169, 119: 0.007341868098913118},[81, 84, 113, 51, 87, 5, 7, 11, 53, 6, 97, 93, 105, 119, 85, 110, 27, 70, 103, 12, 79, 36, 50, 60, 58, 67]
2021-08-18:16:04:56,831 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999999
2021-08-18:16:04:56,831 INFO     [oort.py:365] exploration poss is [104.21122692  36.20732891  24.8550604    1.91505738   0.90032832]
2021-08-18:16:04:56,832 INFO     [oort.py:398] At round 152, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 701.2129556047206, 'duration': 8.009219946401625, 'time_stamp': 153, 'count': 74, 'status': True, 'gradient': 21.581788713230807}, [0.0949034373485942, -1.9607971293930042e-06]), ({'reward': 4259.021365014881, 'duration': 26.145070720211294, 'time_stamp': 153, 'count': 146, 'status': True, 'gradient': 15.386168581786448}, [0.5764305615095273, -1.9607971293930042e-06]), ({'reward': 0.01, 'duration': 5.8943907365129, 'time_stamp': 153, 'count': 150, 'status': True, 'gradient': 21.792268841151184}, [1.3534374782163847e-09, -1.9607971293930042e-06])]
2021-08-18:16:04:56,844 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [7, 113, 53, 6, 51, 84, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 79, 36, 50, 105]
2021-08-18:16:04:57,134 INFO     [param_server.py:553] For epoch: 154, median_reward: 878.744954427332, dev: 4393.72477213666
2021-08-18:16:04:57,826 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9067, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:04:57,827 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2132.9658, eval_time 0.6367, test_loss 2.9067, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:04:57,848 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7318, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:04:57,849 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2132.9736, eval_time 0.6548, test_loss 2.7318, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:04:57,850 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8549, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:04:57,851 INFO     [learner.py:656] After aggregation epoch 153, CumulTime 2132.987, eval_time 0.658, test_loss 2.8549, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:04:57,902 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:57,918 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:57,920 INFO     [learner.py:526] ====Start train round 154
2021-08-18:16:04:57,929 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:04:57,929 INFO     [learner.py:165] Start to run client 7 on rank 1...
2021-08-18:16:04:57,933 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:04:59,454 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:04:59,473 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:00,572 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:00,587 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:00,966 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:00,987 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:01,187 INFO     [learner.py:439] Completed to run client 7
2021-08-18:16:05:01,207 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:02,274 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:02,295 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:02,420 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:02,434 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:02,901 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:02,929 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:03,473 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:03,493 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:03,533 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:03,543 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:03,615 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:03,635 INFO     [learner.py:606] ====Pushing takes 0.018321752548217773 s
2021-08-18:16:05:03,664 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:03,670 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:03,671 INFO     [param_server.py:410] Lock worker 1 with localStep 154 , while globalStep is 153

2021-08-18:16:05:04,187 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:04,197 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:04,727 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:04,745 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:04,832 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:04,841 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:05,399 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:05,413 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:06,564 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:06,575 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:07,130 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:07,140 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:07,181 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:07,207 INFO     [learner.py:606] ====Pushing takes 0.02310776710510254 s
2021-08-18:16:05:07,241 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:07,248 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:07,249 INFO     [param_server.py:410] Lock worker 2 with localStep 154 , while globalStep is 153

2021-08-18:16:05:07,694 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:07,708 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:08,217 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:08,230 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:05:08,771 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:05:08,806 INFO     [learner.py:606] ====Pushing takes 0.034029245376586914 s
2021-08-18:16:05:08,846 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:08,855 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:08,856 INFO     [param_server.py:381] ====After aggregation in epoch: 153, virtual_clock: 4881.2062533922945, top_1: : 61.1165 % (1894.0), top_5: : 100.0 % (3099.0), test loss: 2.8311326547905247, test len: 3099.0
2021-08-18:16:05:08,858 INFO     [param_server.py:410] Lock worker 3 with localStep 154 , while globalStep is 154

2021-08-18:16:05:08,859 INFO     [param_server.py:441] ====Epoch 155 completes 20 clients with loss 9.001644648378129, sampled rewards are: 
 {5: 0, 6: 0, 7: 0, 11: 0, 27: 0, 36: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:08,859 INFO     [param_server.py:450] ====Start to sample for epoch 155, global virtualClock: 4881.2062533922945, round_duration: 33.1553427465904
2021-08-18:16:05:08,860 INFO     [oort.py:208] Training selector: Pacer 153: lastExploitationUtil 1426.4531654351601, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:05:08,860 INFO     [oort.py:321] scores are 24,{5: 0.005319303824645987, 6: 0.032824886196077194, 11: 0.019700560012837553, 12: 0.0028076871047678707, 27: 0.04726564114170139, 36: 0.0024763229819556153, 50: 0.0024403249449268557, 51: 0.5945612325761066, 53: 0.03803468063344926, 58: 0.0014365414018989858, 60: 0.0006410381291579941, 67: 0.0007846209940013796, 70: 0.0030628854028084155, 79: 0.002550888732482135, 81: 0.014983381307524146, 84: 0.026301735149369232, 85: 0.006363702293357303, 87: 0.006804657872285697, 93: 0.009937153416810448, 97: 0.018233282555171114, 103: 0.0037047484043068904, 105: 0.012193094552995127, 110: 0.025974175442292958, 113: 0.2542536952741786, 119: 0.0057442552565407255},[51, 113, 27, 53, 6, 84, 110, 11, 97, 81, 105, 93, 87, 85, 119, 5, 103, 70, 12, 79, 36, 50, 58, 67, 60]
2021-08-18:16:05:08,861 INFO     [oort.py:343] exploitation poss sum is 0.9999999999999998
2021-08-18:16:05:08,862 INFO     [oort.py:365] exploration poss is [104.21122692  36.20732891   1.91505738   0.90032832]
2021-08-18:16:05:08,862 INFO     [oort.py:398] At round 153, UCB exploited 25, augment_factor 1.0416666666666667, exploreLen 2, un-explored 62, exploration 0.0, round_threshold 10, sampled score is [({'reward': 12795.48792895331, 'duration': 12.029357192292537, 'time_stamp': 154, 'count': 151, 'status': True, 'gradient': 27.891185460180296}, [1.0, -1.9480645978220656e-06]), ({'reward': 0.01, 'duration': 11.058674649423494, 'time_stamp': 154, 'count': 151, 'status': True, 'gradient': 20.84333649976738}, [7.815261022455882e-10, -1.9480645978220656e-06]), ({'reward': 2522.0016864518516, 'duration': 8.009219946401625, 'time_stamp': 154, 'count': 75, 'status': True, 'gradient': 21.59156350962272}, [0.19710023404238347, -1.9480645978220656e-06])]
2021-08-18:16:05:08,863 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:09,136 INFO     [param_server.py:553] For epoch: 155, median_reward: 905.8545219898017, dev: 4529.272609949008
2021-08-18:16:05:09,728 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6612, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:05:09,729 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2144.8538, eval_time 0.5486, test_loss 2.6612, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:05:09,735 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8503, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:05:09,735 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2144.8746, eval_time 0.5552, test_loss 2.8503, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:05:09,771 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0656, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:16:05:09,771 INFO     [learner.py:656] After aggregation epoch 154, CumulTime 2144.9072, eval_time 0.5907, test_loss 3.0656, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:16:05:09,799 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:05:09,804 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:05:09,813 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:09,825 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:09,843 INFO     [learner.py:526] ====Start train round 155
2021-08-18:16:05:09,859 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:10,488 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:10,509 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:11,72 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:11,90 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:11,727 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:11,754 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:12,76 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:12,88 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:12,334 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:12,354 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:12,561 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:12,572 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:12,888 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:12,909 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:13,238 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:13,258 INFO     [learner.py:606] ====Pushing takes 0.018680334091186523 s
2021-08-18:16:05:13,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:13,299 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:13,300 INFO     [param_server.py:410] Lock worker 1 with localStep 155 , while globalStep is 154

2021-08-18:16:05:14,307 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:14,321 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:15,13 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:15,27 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:16,38 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:16,47 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:16,701 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:16,713 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:17,159 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:17,171 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:17,743 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:17,752 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:18,383 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:18,408 INFO     [learner.py:606] ====Pushing takes 0.023466110229492188 s
2021-08-18:16:05:18,442 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:18,449 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:18,449 INFO     [param_server.py:410] Lock worker 2 with localStep 155 , while globalStep is 154

2021-08-18:16:05:18,863 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:18,873 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:19,414 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:19,423 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:19,923 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:19,933 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:20,526 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:20,535 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:21,76 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:21,113 INFO     [learner.py:606] ====Pushing takes 0.03584599494934082 s
2021-08-18:16:05:21,151 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:21,161 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:21,161 INFO     [param_server.py:381] ====After aggregation in epoch: 154, virtual_clock: 4918.549772665356, top_1: : 61.0842 % (1893.0), top_5: : 100.0 % (3099.0), test loss: 2.8590092217480696, test len: 3099.0
2021-08-18:16:05:21,163 INFO     [param_server.py:410] Lock worker 3 with localStep 155 , while globalStep is 155

2021-08-18:16:05:21,163 INFO     [param_server.py:441] ====Epoch 156 completes 20 clients with loss 8.237195591566525, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:21,164 INFO     [param_server.py:450] ====Start to sample for epoch 156, global virtualClock: 4918.549772665356, round_duration: 37.343519273061496
2021-08-18:16:05:21,164 INFO     [oort.py:208] Training selector: Pacer 154: lastExploitationUtil 2772.556746500246, lastExplorationUtil 6762.134376186189, last_util_record 0
2021-08-18:16:05:21,165 INFO     [oort.py:321] scores are 25,{5: 0.005305549217904364, 6: 0.60706892858967, 11: 0.10486398684165393, 12: 0.0027913199096506096, 27: 0.09272934456498881, 36: 0.02884347730465495, 40: 0.4287552836234749, 50: 0.002434014775204322, 51: 0.5526402335682733, 53: 0.03793633090726285, 58: 0.0021441978581482396, 60: 0.0017366286796171287, 67: 0.00212560729047782, 70: 0.008297625977232282, 79: 0.002544292667938057, 81: 0.21589679416651614, 84: 0.026233724365340376, 85: 0.1159038749756065, 87: 0.10242018749832182, 93: 0.009911458017208323, 97: 0.09755256389321972, 103: 0.004505138034200121, 105: 0.019355047648489016, 110: 0.0060512478064233335, 113: 0.23496050510917835, 119: 0.015561692772710896},[6, 51, 40, 113, 81, 85, 11, 87, 97, 27, 53, 36, 84, 105, 119, 93, 70, 110, 5, 103, 12, 79, 50, 58, 67, 60]
2021-08-18:16:05:21,166 INFO     [oort.py:343] exploitation poss sum is 1.0000000000000002
2021-08-18:16:05:21,166 INFO     [oort.py:365] exploration poss is [1.91505738 0.90032832]
2021-08-18:16:05:21,166 INFO     [oort.py:398] At round 154, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 61, exploration 0.0, round_threshold 10, sampled score is [({'reward': 2932.1779904521754, 'duration': 48.8795967667807, 'time_stamp': 155, 'count': 133, 'status': True, 'gradient': 19.50455780797629}, [0.39983911188153076, -1.9354963580410214e-06]), ({'reward': 6787.854566318164, 'duration': 12.029357192292537, 'time_stamp': 155, 'count': 152, 'status': True, 'gradient': 27.910326770237983}, [0.9256105879903137, -1.9354963580410214e-06]), ({'reward': 7333.37962123546, 'duration': 11.90395711384456, 'time_stamp': 155, 'count': 153, 'status': True, 'gradient': 21.490955054942205}, [1.0, -1.9354963580410214e-06])]
2021-08-18:16:05:21,175 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:21,457 INFO     [param_server.py:553] For epoch: 156, median_reward: 1237.774136421276, dev: 6188.87068210638
2021-08-18:16:05:22,123 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6618, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:05:22,124 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2157.2601, eval_time 0.6119, test_loss 2.6618, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:05:22,178 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.512, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:05:22,179 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2157.3038, eval_time 0.6666, test_loss 2.512, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:05:22,193 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:22,209 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:22,248 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:22,252 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6355, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:05:22,254 INFO     [learner.py:656] After aggregation epoch 155, CumulTime 2157.3928, eval_time 0.7413, test_loss 2.6355, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:05:22,266 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:22,323 INFO     [learner.py:526] ====Start train round 156
2021-08-18:16:05:22,350 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:23,55 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:23,95 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:23,296 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:23,319 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:23,948 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:23,962 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:24,528 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:24,555 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:24,608 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:24,622 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:25,152 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:25,173 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:25,330 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:25,342 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:25,804 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:25,824 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:26,191 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:26,219 INFO     [learner.py:606] ====Pushing takes 0.025402545928955078 s
2021-08-18:16:05:26,248 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:26,254 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:26,255 INFO     [param_server.py:410] Lock worker 1 with localStep 156 , while globalStep is 155

2021-08-18:16:05:26,409 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:26,423 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:26,896 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:26,910 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:27,129 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:27,143 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:27,581 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:27,596 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:27,760 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:27,778 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:28,971 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:28,996 INFO     [learner.py:606] ====Pushing takes 0.02302098274230957 s
2021-08-18:16:05:29,29 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:29,36 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:29,36 INFO     [param_server.py:410] Lock worker 2 with localStep 156 , while globalStep is 155

2021-08-18:16:05:29,104 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:29,114 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:29,701 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:29,716 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:30,292 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:30,302 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:30,822 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:30,831 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:31,432 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:31,473 INFO     [learner.py:606] ====Pushing takes 0.0400543212890625 s
2021-08-18:16:05:31,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:31,531 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:31,532 INFO     [param_server.py:381] ====After aggregation in epoch: 155, virtual_clock: 4946.565628160844, top_1: : 61.2133 % (1897.0), top_5: : 100.0 % (3099.0), test loss: 2.603135133231128, test len: 3099.0
2021-08-18:16:05:31,534 INFO     [param_server.py:410] Lock worker 3 with localStep 156 , while globalStep is 156

2021-08-18:16:05:31,535 INFO     [param_server.py:441] ====Epoch 157 completes 20 clients with loss 8.540190365036281, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:31,535 INFO     [param_server.py:450] ====Start to sample for epoch 157, global virtualClock: 4946.565628160844, round_duration: 28.015855495488744
2021-08-18:16:05:31,536 INFO     [oort.py:208] Training selector: Pacer 155: lastExploitationUtil 2623.8125841906976, lastExplorationUtil 0.0, last_util_record 0
2021-08-18:16:05:31,537 INFO     [oort.py:321] scores are 25,{5: 0.01966063185601398, 6: 0.4294099026901328, 11: 0.009778709525077367, 12: 0.002784146053974336, 27: 0.005013764352506912, 36: 0.0024635718904563514, 40: 0.024896485607993055, 50: 0.022073822692054133, 51: 0.031978570538799905, 53: 0.7033222390648899, 58: 0.0019683186394429592, 60: 0.0009568552689598318, 67: 0.0010750710876481755, 70: 0.004196700784854571, 79: 0.002537753686743217, 81: 0.027057269067441905, 84: 0.026166302157016128, 85: 0.04028381440973681, 87: 0.01929054271132545, 93: 0.021055080713272403, 97: 0.07265755764312688, 103: 0.006255271853820618, 105: 0.009789226928303328, 110: 0.05353384744469186, 113: 0.056859167194373166, 119: 0.007870657035168665},[53, 6, 97, 113, 110, 85, 51, 81, 84, 40, 50, 93, 5, 87, 105, 11, 119, 103, 27, 70, 12, 79, 36, 58, 67, 60]
2021-08-18:16:05:31,538 INFO     [oort.py:343] exploitation poss sum is 1.0
2021-08-18:16:05:31,538 INFO     [oort.py:365] exploration poss is [0.90032832]
2021-08-18:16:05:31,539 INFO     [oort.py:398] At round 155, UCB exploited 26, augment_factor 1.04, exploreLen 1, un-explored 61, exploration 0.0, round_threshold 10, sampled score is [({'reward': 15062.10025740392, 'duration': 11.058674649423494, 'time_stamp': 156, 'count': 153, 'status': True, 'gradient': 18.828510455210694}, [1.0, -1.923089250572121e-06]), ({'reward': 2325.374400494045, 'duration': 29.570969934622333, 'time_stamp': 156, 'count': 138, 'status': True, 'gradient': 11.98237682687563}, [0.15438523931345696, -1.923089250572121e-06]), ({'reward': 6739.625359840591, 'duration': 27.689063957948644, 'time_stamp': 156, 'count': 148, 'status': True, 'gradient': 21.07273584686987}, [0.4474555158141555, -1.923089250572121e-06])]
2021-08-18:16:05:31,540 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:31,821 INFO     [param_server.py:553] For epoch: 157, median_reward: 1186.0811892873246, dev: 5930.405946436623
2021-08-18:16:05:32,448 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6019, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:05:32,449 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2167.5885, eval_time 0.5945, test_loss 2.6019, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:05:32,510 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:32,511 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3185, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:05:32,512 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2167.6479, eval_time 0.6561, test_loss 3.3185, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:05:32,515 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8022, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:05:32,516 INFO     [learner.py:656] After aggregation epoch 156, CumulTime 2167.6404, eval_time 0.6576, test_loss 2.8022, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:05:32,535 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:32,586 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:32,595 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:32,602 INFO     [learner.py:526] ====Start train round 157
2021-08-18:16:05:32,611 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:33,270 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:33,297 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:34,47 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:34,61 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:34,481 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:34,508 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:35,138 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:35,172 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:35,378 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:35,389 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:35,414 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:35,427 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:35,776 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:35,803 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:36,184 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:36,202 INFO     [learner.py:606] ====Pushing takes 0.016814231872558594 s
2021-08-18:16:05:36,236 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:36,246 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:36,247 INFO     [param_server.py:410] Lock worker 1 with localStep 157 , while globalStep is 156

2021-08-18:16:05:37,598 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:37,614 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:38,26 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:38,36 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:39,245 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:39,260 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:40,34 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:40,48 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:40,488 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:40,507 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:41,137 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:41,150 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:41,717 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:41,742 INFO     [learner.py:606] ====Pushing takes 0.02370738983154297 s
2021-08-18:16:05:41,781 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:41,788 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:41,790 INFO     [param_server.py:410] Lock worker 2 with localStep 157 , while globalStep is 156

2021-08-18:16:05:42,374 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:42,385 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:43,69 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:43,84 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:43,783 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:43,792 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:44,990 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:44,999 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:45,652 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:45,689 INFO     [learner.py:606] ====Pushing takes 0.03636908531188965 s
2021-08-18:16:05:45,738 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:45,747 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:45,748 INFO     [param_server.py:381] ====After aggregation in epoch: 156, virtual_clock: 4984.96164971963, top_1: : 61.8587 % (1917.0), top_5: : 100.0 % (3099.0), test loss: 2.907544534515452, test len: 3099.0
2021-08-18:16:05:45,750 INFO     [param_server.py:410] Lock worker 3 with localStep 157 , while globalStep is 157

2021-08-18:16:05:45,751 INFO     [param_server.py:441] ====Epoch 158 completes 20 clients with loss 8.17845223613623, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:45,751 INFO     [param_server.py:450] ====Start to sample for epoch 158, global virtualClock: 4984.96164971963, round_duration: 38.39602155878561
2021-08-18:16:05:45,752 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:46,91 INFO     [param_server.py:553] For epoch: 158, median_reward: 1169.3092508331972, dev: 5846.546254165986
2021-08-18:16:05:46,703 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6929, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:05:46,704 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2181.829, eval_time 0.5527, test_loss 2.6929, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:05:46,747 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8945, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:05:46,751 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2181.8867, eval_time 0.6011, test_loss 2.8945, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:05:46,771 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:46,781 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:46,830 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:46,845 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:46,864 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.5759, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:05:46,867 INFO     [learner.py:656] After aggregation epoch 157, CumulTime 2182.0064, eval_time 0.721, test_loss 2.5759, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:05:46,936 INFO     [learner.py:526] ====Start train round 158
2021-08-18:16:05:46,963 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:47,845 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:47,878 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:48,13 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:48,32 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:48,662 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:05:48,676 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:05:49,111 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:05:49,130 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:05:49,186 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:49,219 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:49,836 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:49,869 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:05:50,451 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:05:50,462 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:05:50,510 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:05:50,544 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:05:50,920 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:05:50,948 INFO     [learner.py:606] ====Pushing takes 0.02640223503112793 s
2021-08-18:16:05:50,989 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:50,998 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:05:50,998 INFO     [param_server.py:410] Lock worker 1 with localStep 158 , while globalStep is 157

2021-08-18:16:05:51,259 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:05:51,280 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:05:51,894 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:05:51,915 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:05:52,304 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:05:52,323 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:05:52,484 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:05:52,498 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:05:52,919 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:05:52,933 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:05:54,78 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:05:54,92 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:05:54,176 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:05:54,201 INFO     [learner.py:606] ====Pushing takes 0.023035526275634766 s
2021-08-18:16:05:54,235 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:54,244 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:05:54,244 INFO     [param_server.py:410] Lock worker 2 with localStep 158 , while globalStep is 157

2021-08-18:16:05:54,633 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:05:54,643 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:05:55,165 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:05:55,174 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:05:55,835 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:05:55,844 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:05:56,427 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:05:56,465 INFO     [learner.py:606] ====Pushing takes 0.03628945350646973 s
2021-08-18:16:05:56,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:05:56,531 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:05:56,532 INFO     [param_server.py:381] ====After aggregation in epoch: 157, virtual_clock: 5014.430463524693, top_1: : 60.5357 % (1876.0), top_5: : 100.0 % (3099.0), test loss: 2.7211050589879355, test len: 3099.0
2021-08-18:16:05:56,535 INFO     [param_server.py:410] Lock worker 3 with localStep 158 , while globalStep is 158

2021-08-18:16:05:56,535 INFO     [param_server.py:441] ====Epoch 159 completes 20 clients with loss 8.871085206499943, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:05:56,536 INFO     [param_server.py:450] ====Start to sample for epoch 159, global virtualClock: 5014.430463524693, round_duration: 29.468813805062297
2021-08-18:16:05:56,537 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:05:56,881 INFO     [param_server.py:553] For epoch: 159, median_reward: 897.4064957544559, dev: 4487.032478772279
2021-08-18:16:05:57,411 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6985, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:05:57,412 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2192.5511, eval_time 0.5083, test_loss 2.6985, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:05:57,469 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:57,483 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:05:57,575 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5567, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:05:57,576 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2192.7004, eval_time 0.6678, test_loss 3.5567, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:05:57,618 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0988, Top-1 Accuracy: 637.0/1033 (0.6167), Top-5 Accuracy: 1.0
2021-08-18:16:05:57,619 INFO     [learner.py:656] After aggregation epoch 158, CumulTime 2192.7553, eval_time 0.714, test_loss 3.0988, test_accuracy 0.6167, test_5_accuracy 1.0 

2021-08-18:16:05:57,648 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:57,655 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:05:57,690 INFO     [learner.py:526] ====Start train round 159
2021-08-18:16:05:57,705 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:05:58,77 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:05:58,90 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:05:59,28 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:05:59,46 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:05:59,206 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:05:59,235 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:05:59,921 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:05:59,955 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:00,310 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:00,319 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:00,353 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:00,365 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:00,560 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:00,587 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:00,968 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:00,986 INFO     [learner.py:606] ====Pushing takes 0.01686406135559082 s
2021-08-18:16:06:01,19 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:01,26 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:01,27 INFO     [param_server.py:410] Lock worker 1 with localStep 159 , while globalStep is 158

2021-08-18:16:06:02,590 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:02,599 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:02,773 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:02,791 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:03,770 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:03,781 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:04,600 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:04,627 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:05,391 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:05,409 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:05,971 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:05,980 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:06,496 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:06,521 INFO     [learner.py:606] ====Pushing takes 0.023218631744384766 s
2021-08-18:16:06:06,557 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:06,564 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:06,565 INFO     [param_server.py:410] Lock worker 2 with localStep 159 , while globalStep is 158

2021-08-18:16:06:07,86 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:07,95 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:07,747 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:07,757 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:08,389 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:08,398 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:09,480 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:09,489 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:10,91 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:10,141 INFO     [learner.py:606] ====Pushing takes 0.03534674644470215 s
2021-08-18:16:06:10,187 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:10,196 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:10,196 INFO     [param_server.py:381] ====After aggregation in epoch: 158, virtual_clock: 5052.8264850834785, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 3.117983171233424, test len: 3099.0
2021-08-18:16:06:10,199 INFO     [param_server.py:410] Lock worker 3 with localStep 159 , while globalStep is 159

2021-08-18:16:06:10,199 INFO     [param_server.py:441] ====Epoch 160 completes 20 clients with loss 7.642724106271875, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:10,200 INFO     [param_server.py:450] ====Start to sample for epoch 160, global virtualClock: 5052.8264850834785, round_duration: 38.39602155878561
2021-08-18:16:06:10,201 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:10,538 INFO     [param_server.py:553] For epoch: 160, median_reward: 852.6542745689987, dev: 4263.2713728449935
2021-08-18:16:06:11,132 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7863, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:06:11,133 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2206.258, eval_time 0.5493, test_loss 2.7863, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:06:11,169 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9922, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:06:11,170 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2206.3064, eval_time 0.5879, test_loss 2.9922, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:06:11,223 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:06:11,232 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:11,233 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7307, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:06:11,237 INFO     [learner.py:656] After aggregation epoch 159, CumulTime 2206.3759, eval_time 0.6543, test_loss 2.7307, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:06:11,244 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:06:11,259 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:11,307 INFO     [learner.py:526] ====Start train round 160
2021-08-18:16:06:11,331 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:12,1 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:12,27 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:12,381 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:12,395 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:13,33 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:13,47 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:13,423 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:13,429 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:13,439 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:13,463 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:14,207 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:14,241 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:14,650 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:14,664 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:14,813 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:14,846 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:15,211 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:15,239 INFO     [learner.py:606] ====Pushing takes 0.026209354400634766 s
2021-08-18:16:06:15,273 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:15,280 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:15,281 INFO     [param_server.py:410] Lock worker 1 with localStep 160 , while globalStep is 159

2021-08-18:16:06:15,404 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:15,417 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:15,982 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:15,996 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:16,480 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:16,493 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:16,616 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:16,629 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:17,80 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:17,94 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:18,219 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:18,240 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:18,262 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:18,288 INFO     [learner.py:606] ====Pushing takes 0.02394723892211914 s
2021-08-18:16:06:18,323 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:18,329 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:18,330 INFO     [param_server.py:410] Lock worker 2 with localStep 160 , while globalStep is 159

2021-08-18:16:06:18,860 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:18,880 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:19,552 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:19,573 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:20,175 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:20,194 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:20,814 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:20,853 INFO     [learner.py:606] ====Pushing takes 0.03693580627441406 s
2021-08-18:16:06:20,902 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:20,912 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:20,913 INFO     [param_server.py:381] ====After aggregation in epoch: 159, virtual_clock: 5082.295298888541, top_1: : 61.9555 % (1920.0), top_5: : 100.0 % (3099.0), test loss: 2.8363889985614352, test len: 3099.0
2021-08-18:16:06:20,915 INFO     [param_server.py:410] Lock worker 3 with localStep 160 , while globalStep is 160

2021-08-18:16:06:20,915 INFO     [param_server.py:441] ====Epoch 161 completes 20 clients with loss 10.131553311027076, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:20,915 INFO     [param_server.py:450] ====Start to sample for epoch 161, global virtualClock: 5082.295298888541, round_duration: 29.468813805062297
2021-08-18:16:06:20,916 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:21,263 INFO     [param_server.py:541] Handle Wight 0.050057172775268555 | Send 0.3475515842437744
2021-08-18:16:06:21,264 INFO     [param_server.py:553] For epoch: 161, median_reward: 986.5419479802785, dev: 4932.709739901392
2021-08-18:16:06:21,798 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7032, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:06:21,799 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2216.9385, eval_time 0.5128, test_loss 2.7032, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:06:21,873 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:21,887 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:21,947 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3879, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:06:21,948 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2217.0731, eval_time 0.6591, test_loss 2.3879, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:06:21,950 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1088, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:06:21,951 INFO     [learner.py:656] After aggregation epoch 160, CumulTime 2217.0867, eval_time 0.6621, test_loss 3.1088, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:06:22,20 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:22,28 INFO     [learner.py:526] ====Start train round 161
2021-08-18:16:06:22,29 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:22,35 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:22,480 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:22,500 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:23,295 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:23,314 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:23,626 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:23,647 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:24,282 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:24,309 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:24,531 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:24,543 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:24,642 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:24,657 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:24,917 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:24,944 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:25,308 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:25,327 INFO     [learner.py:606] ====Pushing takes 0.017482995986938477 s
2021-08-18:16:06:25,367 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:25,373 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:25,374 INFO     [param_server.py:410] Lock worker 1 with localStep 161 , while globalStep is 160

2021-08-18:16:06:26,939 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:26,948 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:26,972 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:26,986 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:28,97 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:28,112 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:28,751 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:28,772 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:29,757 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:29,766 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:30,402 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:30,411 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:30,945 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:30,967 INFO     [learner.py:606] ====Pushing takes 0.02015376091003418 s
2021-08-18:16:06:31,6 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:31,14 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:31,15 INFO     [param_server.py:410] Lock worker 2 with localStep 161 , while globalStep is 160

2021-08-18:16:06:31,95 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:31,113 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:31,784 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:31,804 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:32,477 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:32,498 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:33,656 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:33,670 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:34,285 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:34,323 INFO     [learner.py:606] ====Pushing takes 0.03632235527038574 s
2021-08-18:16:06:34,370 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:34,382 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:34,383 INFO     [param_server.py:381] ====After aggregation in epoch: 160, virtual_clock: 5120.691320447327, top_1: : 62.1491 % (1926.0), top_5: : 100.0 % (3099.0), test loss: 2.733320662268886, test len: 3099.0
2021-08-18:16:06:34,385 INFO     [param_server.py:410] Lock worker 3 with localStep 161 , while globalStep is 161

2021-08-18:16:06:34,386 INFO     [param_server.py:441] ====Epoch 162 completes 20 clients with loss 6.635781432056714, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:34,386 INFO     [param_server.py:450] ====Start to sample for epoch 162, global virtualClock: 5120.691320447327, round_duration: 38.39602155878561
2021-08-18:16:06:34,387 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:34,735 INFO     [param_server.py:553] For epoch: 162, median_reward: 1239.0132891834185, dev: 6195.066445917092
2021-08-18:16:06:35,344 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.587, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:06:35,346 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2230.4705, eval_time 0.5766, test_loss 2.587, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:06:35,412 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:35,420 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:35,421 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7381, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:06:35,421 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2230.5575, eval_time 0.6523, test_loss 2.7381, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:06:35,422 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8725, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:06:35,426 INFO     [learner.py:656] After aggregation epoch 161, CumulTime 2230.5647, eval_time 0.6573, test_loss 2.8725, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:06:35,491 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:35,498 INFO     [learner.py:526] ====Start train round 162
2021-08-18:16:06:35,503 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:35,517 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:36,148 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:36,168 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:36,673 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:36,691 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:37,392 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:37,406 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:37,464 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:37,492 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:37,570 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:37,580 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:38,130 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:38,157 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:38,832 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:38,859 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:39,152 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:39,166 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:39,236 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:39,263 INFO     [learner.py:606] ====Pushing takes 0.025461912155151367 s
2021-08-18:16:06:39,299 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:39,305 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:39,305 INFO     [param_server.py:410] Lock worker 1 with localStep 162 , while globalStep is 161

2021-08-18:16:06:39,434 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:39,444 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:40,75 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:40,89 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:40,782 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:40,796 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:41,86 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:41,101 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:41,817 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:41,831 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:42,442 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:42,457 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:43,85 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:43,103 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:43,178 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:43,206 INFO     [learner.py:606] ====Pushing takes 0.024714231491088867 s
2021-08-18:16:06:43,241 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:43,248 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:43,248 INFO     [param_server.py:410] Lock worker 2 with localStep 162 , while globalStep is 161

2021-08-18:16:06:43,671 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:43,690 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:44,194 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:44,209 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:44,876 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:44,914 INFO     [learner.py:606] ====Pushing takes 0.036342620849609375 s
2021-08-18:16:06:44,960 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:44,969 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:44,969 INFO     [param_server.py:381] ====After aggregation in epoch: 161, virtual_clock: 5150.160134252389, top_1: : 60.9874 % (1890.0), top_5: : 100.0 % (3099.0), test loss: 2.732520717161673, test len: 3099.0
2021-08-18:16:06:44,971 INFO     [param_server.py:410] Lock worker 3 with localStep 162 , while globalStep is 162

2021-08-18:16:06:44,972 INFO     [param_server.py:441] ====Epoch 163 completes 20 clients with loss 7.770806548849336, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:44,973 INFO     [param_server.py:450] ====Start to sample for epoch 163, global virtualClock: 5150.160134252389, round_duration: 29.468813805062297
2021-08-18:16:06:44,974 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:45,322 INFO     [param_server.py:553] For epoch: 163, median_reward: 1171.67022256663, dev: 5858.35111283315
2021-08-18:16:06:45,968 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3414, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:06:45,969 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2241.1082, eval_time 0.6027, test_loss 3.3414, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:06:46,18 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4822, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:06:46,19 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2241.1436, eval_time 0.6504, test_loss 2.4822, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:06:46,22 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0143, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:06:46,23 INFO     [learner.py:656] After aggregation epoch 162, CumulTime 2241.1594, eval_time 0.6563, test_loss 3.0143, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:06:46,38 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:46,60 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:06:46,88 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:46,95 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:46,153 INFO     [learner.py:526] ====Start train round 163
2021-08-18:16:06:46,162 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:46,721 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:06:46,741 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:06:47,342 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:06:47,356 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:06:47,872 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:06:47,899 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:06:48,534 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:06:48,561 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:06:48,568 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:06:48,588 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:06:48,918 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:06:48,927 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:06:49,123 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:06:49,144 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:06:49,470 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:06:49,490 INFO     [learner.py:606] ====Pushing takes 0.018354177474975586 s
2021-08-18:16:06:49,521 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:49,532 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:06:49,533 INFO     [param_server.py:410] Lock worker 1 with localStep 163 , while globalStep is 162

2021-08-18:16:06:50,736 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:06:50,745 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:06:51,269 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:06:51,279 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:06:52,276 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:06:52,286 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:06:52,982 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:06:52,991 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:06:53,614 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:06:53,624 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:06:54,284 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:06:54,294 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:06:54,754 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:06:54,778 INFO     [learner.py:606] ====Pushing takes 0.0224301815032959 s
2021-08-18:16:06:54,816 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:54,826 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:06:54,827 INFO     [param_server.py:410] Lock worker 2 with localStep 163 , while globalStep is 162

2021-08-18:16:06:55,362 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:06:55,376 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:06:55,962 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:06:55,971 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:06:56,571 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:06:56,585 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:06:57,708 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:06:57,721 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:06:58,306 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:06:58,342 INFO     [learner.py:606] ====Pushing takes 0.03498649597167969 s
2021-08-18:16:06:58,398 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:06:58,409 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:06:58,410 INFO     [param_server.py:381] ====After aggregation in epoch: 162, virtual_clock: 5188.556155811175, top_1: : 61.8264 % (1916.0), top_5: : 100.0 % (3099.0), test loss: 2.9459583450246742, test len: 3099.0
2021-08-18:16:06:58,412 INFO     [param_server.py:410] Lock worker 3 with localStep 163 , while globalStep is 163

2021-08-18:16:06:58,413 INFO     [param_server.py:441] ====Epoch 164 completes 20 clients with loss 6.723040742949681, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:06:58,413 INFO     [param_server.py:450] ====Start to sample for epoch 164, global virtualClock: 5188.556155811175, round_duration: 38.39602155878561
2021-08-18:16:06:58,415 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:06:58,836 INFO     [param_server.py:553] For epoch: 164, median_reward: 1087.9526519679964, dev: 5439.763259839982
2021-08-18:16:06:59,440 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1253, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:06:59,441 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2254.5651, eval_time 0.5577, test_loss 3.1253, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:06:59,474 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1853, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:16:06:59,475 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2254.6114, eval_time 0.5949, test_loss 3.1853, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:16:06:59,516 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:59,524 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:06:59,540 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8568, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:06:59,543 INFO     [learner.py:656] After aggregation epoch 163, CumulTime 2254.6827, eval_time 0.663, test_loss 2.8568, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:06:59,576 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:59,590 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:06:59,613 INFO     [learner.py:526] ====Start train round 164
2021-08-18:16:06:59,638 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:00,350 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:00,377 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:00,818 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:00,836 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:01,488 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:01,502 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:01,641 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:01,668 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:01,952 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:01,966 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:02,272 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:02,292 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:03,4 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:03,29 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:03,224 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:03,243 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:03,468 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:03,495 INFO     [learner.py:606] ====Pushing takes 0.024799346923828125 s
2021-08-18:16:07:03,525 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:03,531 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:03,532 INFO     [param_server.py:410] Lock worker 1 with localStep 164 , while globalStep is 163

2021-08-18:16:07:03,758 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:03,770 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:04,407 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:04,417 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:05,70 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:05,81 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:05,206 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:05,225 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:05,816 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:05,835 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:06,885 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:06,900 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:07,185 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:07,219 INFO     [learner.py:606] ====Pushing takes 0.03188967704772949 s
2021-08-18:16:07:07,256 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:07,263 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:07,264 INFO     [param_server.py:410] Lock worker 2 with localStep 164 , while globalStep is 163

2021-08-18:16:07:07,588 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:07,602 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:08,286 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:08,306 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:08,901 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:08,921 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:09,515 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:09,552 INFO     [learner.py:606] ====Pushing takes 0.036002159118652344 s
2021-08-18:16:07:09,601 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:09,611 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:09,612 INFO     [param_server.py:381] ====After aggregation in epoch: 163, virtual_clock: 5218.024969616237, top_1: : 60.6002 % (1878.0), top_5: : 100.0 % (3099.0), test loss: 3.055807175459685, test len: 3099.0
2021-08-18:16:07:09,614 INFO     [param_server.py:410] Lock worker 3 with localStep 164 , while globalStep is 164

2021-08-18:16:07:09,615 INFO     [param_server.py:441] ====Epoch 165 completes 20 clients with loss 7.429442635021451, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:09,615 INFO     [param_server.py:450] ====Start to sample for epoch 165, global virtualClock: 5218.024969616237, round_duration: 29.468813805062297
2021-08-18:16:07:09,616 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:07:09,958 INFO     [param_server.py:553] For epoch: 165, median_reward: 1510.4497506522953, dev: 7552.248753261476
2021-08-18:16:07:10,541 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8486, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:07:10,542 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2265.6782, eval_time 0.5402, test_loss 2.8486, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:07:10,567 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6201, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:07:10,568 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2265.6927, eval_time 0.5635, test_loss 2.6201, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:07:10,597 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0581, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:07:10,598 INFO     [learner.py:656] After aggregation epoch 164, CumulTime 2265.7376, eval_time 0.5965, test_loss 3.0581, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:07:10,636 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:07:10,637 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:07:10,647 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:10,648 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:10,664 INFO     [learner.py:526] ====Start train round 165
2021-08-18:16:07:10,691 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:11,422 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:11,450 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:11,988 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:12,2 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:12,566 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:12,593 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:13,220 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:13,247 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:13,342 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:13,360 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:13,440 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:13,463 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:13,847 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:13,868 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:14,194 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:14,212 INFO     [learner.py:606] ====Pushing takes 0.016438007354736328 s
2021-08-18:16:07:14,245 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:14,253 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:14,254 INFO     [param_server.py:410] Lock worker 1 with localStep 165 , while globalStep is 164

2021-08-18:16:07:15,542 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:15,555 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:15,738 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:15,753 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:17,2 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:17,12 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:17,650 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:17,660 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:18,633 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:18,645 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:19,234 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:19,243 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:19,773 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:19,781 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:19,792 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:19,816 INFO     [learner.py:606] ====Pushing takes 0.03371739387512207 s
2021-08-18:16:07:19,850 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:19,857 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:19,858 INFO     [param_server.py:410] Lock worker 2 with localStep 165 , while globalStep is 164

2021-08-18:16:07:20,518 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:20,531 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:21,71 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:21,84 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:22,117 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:22,130 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:22,841 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:22,890 INFO     [learner.py:606] ====Pushing takes 0.0419917106628418 s
2021-08-18:16:07:22,938 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:22,947 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:22,948 INFO     [param_server.py:381] ====After aggregation in epoch: 164, virtual_clock: 5256.420991175023, top_1: : 62.859 % (1948.0), top_5: : 100.0 % (3099.0), test loss: 2.8422669834560814, test len: 3099.0
2021-08-18:16:07:22,951 INFO     [param_server.py:410] Lock worker 3 with localStep 165 , while globalStep is 165

2021-08-18:16:07:22,951 INFO     [param_server.py:441] ====Epoch 166 completes 20 clients with loss 6.5073087791605255, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:22,951 INFO     [param_server.py:450] ====Start to sample for epoch 166, global virtualClock: 5256.420991175023, round_duration: 38.39602155878561
2021-08-18:16:07:22,952 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:07:23,302 INFO     [param_server.py:553] For epoch: 166, median_reward: 1459.6031480446725, dev: 7298.015740223363
2021-08-18:16:07:23,971 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6767, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:07:23,972 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2279.0966, eval_time 0.6182, test_loss 2.6767, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:07:24,1 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7308, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:16:07:24,4 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2279.14, eval_time 0.6548, test_loss 2.7308, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:16:07:24,34 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7956, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:07:24,36 INFO     [learner.py:656] After aggregation epoch 165, CumulTime 2279.1756, eval_time 0.6891, test_loss 2.7956, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:07:24,45 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:24,55 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:24,94 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:24,98 INFO     [learner.py:526] ====Start train round 166
2021-08-18:16:07:24,114 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:24,123 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:24,845 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:24,871 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:25,370 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:25,384 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:26,23 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:26,35 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:26,37 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:26,62 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:26,292 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:26,301 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:26,651 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:26,679 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:27,291 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:27,318 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:27,621 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:27,631 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:27,828 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:27,853 INFO     [learner.py:606] ====Pushing takes 0.023869752883911133 s
2021-08-18:16:07:27,887 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:27,893 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:27,893 INFO     [param_server.py:410] Lock worker 1 with localStep 166 , while globalStep is 165

2021-08-18:16:07:28,146 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:28,156 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:28,893 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:28,907 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:29,467 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:29,480 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:29,514 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:29,532 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:30,55 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:30,73 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:31,53 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:31,63 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:31,602 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:31,631 INFO     [learner.py:606] ====Pushing takes 0.027142763137817383 s
2021-08-18:16:07:31,664 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:31,673 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:31,674 INFO     [param_server.py:410] Lock worker 2 with localStep 166 , while globalStep is 165

2021-08-18:16:07:31,755 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:31,769 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:32,335 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:32,353 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:32,935 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:32,949 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:33,546 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:33,584 INFO     [learner.py:606] ====Pushing takes 0.03672146797180176 s
2021-08-18:16:07:33,630 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:33,644 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:33,645 INFO     [param_server.py:381] ====After aggregation in epoch: 165, virtual_clock: 5285.8898049800855, top_1: : 61.181 % (1896.0), top_5: : 100.0 % (3099.0), test loss: 2.734326495064629, test len: 3099.0
2021-08-18:16:07:33,648 INFO     [param_server.py:410] Lock worker 3 with localStep 166 , while globalStep is 166

2021-08-18:16:07:33,649 INFO     [param_server.py:441] ====Epoch 167 completes 20 clients with loss 7.367069993121325, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:33,649 INFO     [param_server.py:450] ====Start to sample for epoch 167, global virtualClock: 5285.8898049800855, round_duration: 29.468813805062297
2021-08-18:16:07:33,651 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:07:34,14 INFO     [param_server.py:553] For epoch: 167, median_reward: 1363.8333103553612, dev: 6819.166551776806
2021-08-18:16:07:34,656 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6768, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:07:34,657 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2289.7963, eval_time 0.5994, test_loss 2.6768, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:07:34,675 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9839, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:07:34,676 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2289.8117, eval_time 0.6179, test_loss 2.9839, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:07:34,718 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:34,743 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:34,744 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:34,753 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:34,757 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4184, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:07:34,758 INFO     [learner.py:656] After aggregation epoch 166, CumulTime 2289.8822, eval_time 0.6958, test_loss 2.4184, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:07:34,826 INFO     [learner.py:526] ====Start train round 167
2021-08-18:16:07:34,843 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:35,439 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:35,460 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:36,78 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:36,92 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:36,590 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:36,610 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:37,199 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:37,226 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:37,241 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:37,259 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:37,728 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:37,737 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:37,840 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:37,868 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:38,234 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:38,256 INFO     [learner.py:606] ====Pushing takes 0.020144939422607422 s
2021-08-18:16:07:38,286 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:38,292 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:38,293 INFO     [param_server.py:410] Lock worker 1 with localStep 167 , while globalStep is 166

2021-08-18:16:07:39,439 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:39,451 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:40,114 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:40,126 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:41,237 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:41,247 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:41,945 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:41,956 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:42,337 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:42,356 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:42,982 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:42,997 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:43,618 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:43,645 INFO     [learner.py:606] ====Pushing takes 0.02428269386291504 s
2021-08-18:16:07:43,680 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:43,687 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:43,688 INFO     [param_server.py:410] Lock worker 2 with localStep 167 , while globalStep is 166

2021-08-18:16:07:44,329 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:44,348 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:45,38 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:45,47 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:45,828 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:45,843 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:47,43 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:47,58 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:47,754 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:47,794 INFO     [learner.py:606] ====Pushing takes 0.037413597106933594 s
2021-08-18:16:07:47,841 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:47,851 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:47,851 INFO     [param_server.py:381] ====After aggregation in epoch: 166, virtual_clock: 5324.285826538871, top_1: : 62.5686 % (1939.0), top_5: : 100.0 % (3099.0), test loss: 2.693036256013093, test len: 3099.0
2021-08-18:16:07:47,863 INFO     [param_server.py:410] Lock worker 3 with localStep 167 , while globalStep is 167

2021-08-18:16:07:47,863 INFO     [param_server.py:441] ====Epoch 168 completes 20 clients with loss 6.964521721953958, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:47,864 INFO     [param_server.py:450] ====Start to sample for epoch 168, global virtualClock: 5324.285826538871, round_duration: 38.39602155878561
2021-08-18:16:07:47,865 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:07:48,209 INFO     [param_server.py:553] For epoch: 168, median_reward: 1226.1558514576634, dev: 6130.779257288317
2021-08-18:16:07:48,852 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7337, Top-1 Accuracy: 632.0/1033 (0.6118), Top-5 Accuracy: 1.0
2021-08-18:16:07:48,853 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2303.9889, eval_time 0.5995, test_loss 2.7337, test_accuracy 0.6118, test_5_accuracy 1.0 

2021-08-18:16:07:48,856 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4719, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:07:48,857 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2303.9816, eval_time 0.6035, test_loss 2.4719, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:07:48,922 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:48,923 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:48,933 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8544, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:07:48,936 INFO     [learner.py:656] After aggregation epoch 167, CumulTime 2304.0753, eval_time 0.6827, test_loss 2.8544, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:07:48,938 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:07:48,939 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:49,26 INFO     [learner.py:526] ====Start train round 168
2021-08-18:16:07:49,51 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:49,711 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:07:49,732 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:07:50,135 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:07:50,153 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:07:50,899 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:07:50,917 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:07:50,962 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:07:50,983 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:07:51,130 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:07:51,141 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:07:51,664 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:07:51,685 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:07:52,260 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:07:52,280 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:07:52,651 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:07:52,662 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:07:52,708 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:07:52,734 INFO     [learner.py:606] ====Pushing takes 0.024512529373168945 s
2021-08-18:16:07:52,768 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:52,774 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:07:52,775 INFO     [param_server.py:410] Lock worker 1 with localStep 168 , while globalStep is 167

2021-08-18:16:07:52,835 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:07:52,845 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:07:53,416 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:07:53,426 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:07:54,88 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:07:54,100 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:07:54,454 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:07:54,473 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:07:55,116 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:07:55,130 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:07:55,735 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:07:55,745 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:07:56,326 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:07:56,340 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:07:56,612 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:07:56,636 INFO     [learner.py:606] ====Pushing takes 0.022289037704467773 s
2021-08-18:16:07:56,670 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:56,677 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:07:56,678 INFO     [param_server.py:410] Lock worker 2 with localStep 168 , while globalStep is 167

2021-08-18:16:07:56,998 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:07:57,12 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:07:57,629 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:07:57,643 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:07:58,270 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:07:58,309 INFO     [learner.py:606] ====Pushing takes 0.03726816177368164 s
2021-08-18:16:07:58,359 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:07:58,370 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:07:58,371 INFO     [param_server.py:381] ====After aggregation in epoch: 167, virtual_clock: 5353.754640343934, top_1: : 62.375 % (1933.0), top_5: : 100.0 % (3099.0), test loss: 2.6866594155629477, test len: 3099.0
2021-08-18:16:07:58,373 INFO     [param_server.py:410] Lock worker 3 with localStep 168 , while globalStep is 168

2021-08-18:16:07:58,374 INFO     [param_server.py:441] ====Epoch 169 completes 20 clients with loss 5.612433430963023, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:07:58,374 INFO     [param_server.py:450] ====Start to sample for epoch 169, global virtualClock: 5353.754640343934, round_duration: 29.468813805062297
2021-08-18:16:07:58,375 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 27, 103, 12, 79, 36, 50]
2021-08-18:16:07:58,715 INFO     [param_server.py:553] For epoch: 169, median_reward: 1163.627430448877, dev: 5818.137152244385
2021-08-18:16:07:59,353 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0212, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:07:59,354 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2314.4936, eval_time 0.5951, test_loss 3.0212, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:07:59,408 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:59,434 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:07:59,518 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0345, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:07:59,519 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2314.6554, eval_time 0.76, test_loss 3.0345, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:07:59,590 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:59,599 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9871, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:07:59,599 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:07:59,600 INFO     [learner.py:656] After aggregation epoch 168, CumulTime 2314.7243, eval_time 0.8402, test_loss 2.9871, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:07:59,669 INFO     [learner.py:526] ====Start train round 169
2021-08-18:16:07:59,691 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:00,174 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:00,201 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:00,892 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:00,906 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:01,400 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:01,428 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:02,67 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:02,80 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:02,115 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:02,141 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:02,663 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:02,675 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:02,708 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:02,729 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:03,52 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:03,73 INFO     [learner.py:606] ====Pushing takes 0.019578218460083008 s
2021-08-18:16:08:03,105 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:03,111 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:03,112 INFO     [param_server.py:410] Lock worker 1 with localStep 169 , while globalStep is 168

2021-08-18:16:08:04,276 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:04,287 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:05,10 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:05,22 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:06,222 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:06,232 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:06,836 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:06,845 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:07,242 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:07,256 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:07,903 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:07,913 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:08,554 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:08,579 INFO     [learner.py:606] ====Pushing takes 0.023300886154174805 s
2021-08-18:16:08:08,616 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:08,624 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:08,624 INFO     [param_server.py:410] Lock worker 2 with localStep 169 , while globalStep is 168

2021-08-18:16:08:09,25 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:09,35 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:09,690 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:09,700 INFO     [learner.py:165] Start to run client 27 on rank 3...
2021-08-18:16:08:10,252 INFO     [learner.py:439] Completed to run client 27
2021-08-18:16:08:10,261 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:11,472 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:11,486 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:12,27 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:12,67 INFO     [learner.py:606] ====Pushing takes 0.03789877891540527 s
2021-08-18:16:08:12,113 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:12,122 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:12,123 INFO     [param_server.py:381] ====After aggregation in epoch: 168, virtual_clock: 5392.15066190272, top_1: : 61.9555 % (1920.0), top_5: : 100.0 % (3099.0), test loss: 3.0142533558386346, test len: 3099.0
2021-08-18:16:08:12,125 INFO     [param_server.py:410] Lock worker 3 with localStep 169 , while globalStep is 169

2021-08-18:16:08:12,126 INFO     [param_server.py:441] ====Epoch 170 completes 20 clients with loss 6.974653010133138, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 27: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:12,127 INFO     [param_server.py:450] ====Start to sample for epoch 170, global virtualClock: 5392.15066190272, round_duration: 38.39602155878561
2021-08-18:16:08:12,128 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:12,465 INFO     [param_server.py:553] For epoch: 170, median_reward: 1168.0370185910708, dev: 5840.185092955354
2021-08-18:16:08:13,109 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.155, Top-1 Accuracy: 634.0/1033 (0.6137), Top-5 Accuracy: 1.0
2021-08-18:16:08:13,110 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2328.2462, eval_time 0.5796, test_loss 3.155, test_accuracy 0.6137, test_5_accuracy 1.0 

2021-08-18:16:08:13,178 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:08:13,193 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:13,248 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6616, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:08:13,249 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2328.3737, eval_time 0.7107, test_loss 2.6616, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:08:13,316 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:08:13,330 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6375, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:08:13,332 INFO     [learner.py:656] After aggregation epoch 169, CumulTime 2328.4713, eval_time 0.8015, test_loss 2.6375, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:08:13,334 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:13,386 INFO     [learner.py:526] ====Start train round 170
2021-08-18:16:08:13,415 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:14,278 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:14,312 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:14,376 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:14,397 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:15,121 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:15,136 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:15,656 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:15,666 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:15,673 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:15,694 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:16,381 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:16,402 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:16,909 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:16,923 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:16,965 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:16,976 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:17,252 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:17,281 INFO     [learner.py:606] ====Pushing takes 0.026310205459594727 s
2021-08-18:16:08:17,317 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:17,323 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:17,324 INFO     [param_server.py:410] Lock worker 1 with localStep 170 , while globalStep is 169

2021-08-18:16:08:17,507 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:17,519 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:18,80 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:18,92 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:18,666 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:18,676 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:19,107 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:19,122 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:19,763 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:19,777 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:20,214 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:20,224 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:20,757 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:20,766 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:21,207 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:21,231 INFO     [learner.py:606] ====Pushing takes 0.022487163543701172 s
2021-08-18:16:08:21,239 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:21,253 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:21,264 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:21,271 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:21,272 INFO     [param_server.py:410] Lock worker 2 with localStep 170 , while globalStep is 169

2021-08-18:16:08:21,727 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:21,736 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:22,317 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:22,354 INFO     [learner.py:606] ====Pushing takes 0.03483462333679199 s
2021-08-18:16:08:22,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:22,411 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:22,412 INFO     [param_server.py:381] ====After aggregation in epoch: 169, virtual_clock: 5422.256464739578, top_1: : 62.6331 % (1941.0), top_5: : 100.0 % (3099.0), test loss: 2.818045496940613, test len: 3099.0
2021-08-18:16:08:22,415 INFO     [param_server.py:410] Lock worker 3 with localStep 170 , while globalStep is 170

2021-08-18:16:08:22,415 INFO     [param_server.py:441] ====Epoch 171 completes 20 clients with loss 11.635011554139943, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:22,416 INFO     [param_server.py:450] ====Start to sample for epoch 171, global virtualClock: 5422.256464739578, round_duration: 30.105802836858544
2021-08-18:16:08:22,416 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:22,727 INFO     [param_server.py:553] For epoch: 171, median_reward: 1112.1243839076412, dev: 5560.621919538206
2021-08-18:16:08:23,383 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7005, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:08:23,387 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2338.5229, eval_time 0.6043, test_loss 2.7005, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:08:23,389 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5525, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:08:23,393 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2338.5171, eval_time 0.6097, test_loss 2.5525, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:08:23,430 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8268, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:08:23,438 INFO     [learner.py:656] After aggregation epoch 170, CumulTime 2338.5769, eval_time 0.6552, test_loss 2.8268, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:08:23,442 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:23,451 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:23,461 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:23,471 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:23,499 INFO     [learner.py:526] ====Start train round 171
2021-08-18:16:08:23,532 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:24,338 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:24,371 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:24,539 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:24,548 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:25,674 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:25,708 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:25,725 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:25,743 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:26,407 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:26,447 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:26,502 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:26,528 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:27,74 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:27,108 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:27,509 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:27,531 INFO     [learner.py:606] ====Pushing takes 0.019715309143066406 s
2021-08-18:16:08:27,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:27,587 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:27,588 INFO     [param_server.py:410] Lock worker 1 with localStep 171 , while globalStep is 170

2021-08-18:16:08:28,44 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:28,57 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:29,95 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:29,104 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:30,246 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:30,256 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:30,845 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:30,859 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:30,946 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:30,956 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:31,534 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:31,548 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:32,26 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:32,50 INFO     [learner.py:606] ====Pushing takes 0.022733211517333984 s
2021-08-18:16:08:32,88 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:32,95 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:32,95 INFO     [param_server.py:410] Lock worker 2 with localStep 171 , while globalStep is 170

2021-08-18:16:08:33,77 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:33,88 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:33,748 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:33,758 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:34,807 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:34,817 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:35,305 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:35,314 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:35,802 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:35,839 INFO     [learner.py:606] ====Pushing takes 0.03522300720214844 s
2021-08-18:16:08:35,910 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:35,920 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:35,921 INFO     [param_server.py:381] ====After aggregation in epoch: 170, virtual_clock: 5460.652486298364, top_1: : 62.6331 % (1941.0), top_5: : 100.0 % (3099.0), test loss: 2.6932624181111655, test len: 3099.0
2021-08-18:16:08:35,923 INFO     [param_server.py:410] Lock worker 3 with localStep 171 , while globalStep is 171

2021-08-18:16:08:35,924 INFO     [param_server.py:441] ====Epoch 172 completes 20 clients with loss 7.335898540383216, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:35,925 INFO     [param_server.py:450] ====Start to sample for epoch 172, global virtualClock: 5460.652486298364, round_duration: 38.39602155878561
2021-08-18:16:08:35,926 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:36,276 INFO     [param_server.py:553] For epoch: 172, median_reward: 1326.5223423279122, dev: 6632.611711639561
2021-08-18:16:08:36,896 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5582, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:08:36,897 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2352.0215, eval_time 0.564, test_loss 2.5582, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:08:36,902 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0116, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:08:36,903 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2352.0393, eval_time 0.5705, test_loss 3.0116, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:08:36,965 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:36,972 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:36,979 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:36,980 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:37,88 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9645, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:16:08:37,91 INFO     [learner.py:656] After aggregation epoch 171, CumulTime 2352.2307, eval_time 0.7598, test_loss 2.9645, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:16:08:37,161 INFO     [learner.py:526] ====Start train round 172
2021-08-18:16:08:37,198 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:38,54 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:38,71 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:38,85 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:38,94 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:38,679 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:38,693 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:39,331 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:39,371 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:39,458 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:39,484 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:39,981 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:40,14 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:40,383 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:40,397 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:40,736 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:40,757 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:41,134 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:41,162 INFO     [learner.py:606] ====Pushing takes 0.026354312896728516 s
2021-08-18:16:08:41,190 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:41,197 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:41,197 INFO     [param_server.py:410] Lock worker 1 with localStep 172 , while globalStep is 171

2021-08-18:16:08:41,393 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:41,403 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:42,32 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:42,46 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:42,56 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:42,67 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:42,776 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:42,791 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:42,805 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:42,824 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:44,226 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:44,251 INFO     [learner.py:606] ====Pushing takes 0.02305293083190918 s
2021-08-18:16:08:44,287 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:44,296 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:44,296 INFO     [param_server.py:410] Lock worker 2 with localStep 172 , while globalStep is 171

2021-08-18:16:08:44,493 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:44,502 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:45,116 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:45,125 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:45,651 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:45,661 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:46,309 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:46,318 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:08:46,986 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:08:47,21 INFO     [learner.py:606] ====Pushing takes 0.03343629837036133 s
2021-08-18:16:08:47,68 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:47,77 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:08:47,78 INFO     [param_server.py:381] ====After aggregation in epoch: 171, virtual_clock: 5490.121300103427, top_1: : 60.4711 % (1874.0), top_5: : 100.0 % (3099.0), test loss: 2.8447608241328486, test len: 3099.0
2021-08-18:16:08:47,80 INFO     [param_server.py:410] Lock worker 3 with localStep 172 , while globalStep is 172

2021-08-18:16:08:47,81 INFO     [param_server.py:441] ====Epoch 173 completes 20 clients with loss 10.479114546146189, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:08:47,81 INFO     [param_server.py:450] ====Start to sample for epoch 173, global virtualClock: 5490.121300103427, round_duration: 29.468813805062297
2021-08-18:16:08:47,82 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:08:47,423 INFO     [param_server.py:553] For epoch: 173, median_reward: 1201.9733898651202, dev: 6009.866949325601
2021-08-18:16:08:48,24 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8138, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:08:48,25 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2363.1499, eval_time 0.5574, test_loss 2.8138, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:08:48,41 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9785, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:08:48,43 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2363.1788, eval_time 0.5751, test_loss 2.9785, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:08:48,63 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8242, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:08:48,64 INFO     [learner.py:656] After aggregation epoch 172, CumulTime 2363.203, eval_time 0.5961, test_loss 2.8242, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:08:48,96 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:48,105 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:08:48,114 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:48,122 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:08:48,143 INFO     [learner.py:526] ====Start train round 173
2021-08-18:16:08:48,171 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:08:48,990 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:08:49,24 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:08:49,252 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:08:49,270 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:08:50,320 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:08:50,333 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:08:50,340 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:08:50,380 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:08:50,821 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:08:50,842 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:08:51,81 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:08:51,114 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:08:51,731 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:08:51,765 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:08:52,188 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:08:52,208 INFO     [learner.py:606] ====Pushing takes 0.01846790313720703 s
2021-08-18:16:08:52,242 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:52,250 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:08:52,251 INFO     [param_server.py:410] Lock worker 1 with localStep 173 , while globalStep is 172

2021-08-18:16:08:52,455 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:08:52,464 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:08:53,417 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:08:53,435 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:08:54,674 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:08:54,688 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:08:55,409 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:08:55,411 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:08:55,423 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:08:55,424 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:08:55,950 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:08:55,962 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:08:56,522 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:08:56,548 INFO     [learner.py:606] ====Pushing takes 0.024222373962402344 s
2021-08-18:16:08:56,584 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:08:56,591 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:08:56,592 INFO     [param_server.py:410] Lock worker 2 with localStep 173 , while globalStep is 172

2021-08-18:16:08:57,407 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:08:57,417 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:08:58,148 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:08:58,160 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:08:59,170 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:08:59,179 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:08:59,712 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:08:59,721 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:00,379 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:00,415 INFO     [learner.py:606] ====Pushing takes 0.034836530685424805 s
2021-08-18:16:09:00,466 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:00,474 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:00,476 INFO     [param_server.py:381] ====After aggregation in epoch: 172, virtual_clock: 5528.517321662212, top_1: : 62.6976 % (1943.0), top_5: : 100.0 % (3099.0), test loss: 2.8721622449380377, test len: 3099.0
2021-08-18:16:09:00,478 INFO     [param_server.py:410] Lock worker 3 with localStep 173 , while globalStep is 173

2021-08-18:16:09:00,479 INFO     [param_server.py:441] ====Epoch 174 completes 20 clients with loss 9.761919504412461, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:00,479 INFO     [param_server.py:450] ====Start to sample for epoch 174, global virtualClock: 5528.517321662212, round_duration: 38.39602155878561
2021-08-18:16:09:00,481 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:00,826 INFO     [param_server.py:553] For epoch: 174, median_reward: 1212.1499189131966, dev: 6060.749594565983
2021-08-18:16:09:01,529 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4803, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:09:01,530 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2376.6544, eval_time 0.645, test_loss 2.4803, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:09:01,564 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6765, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:09:01,565 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2376.7014, eval_time 0.6813, test_loss 3.6765, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:09:01,598 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:09:01,606 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:01,634 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:09:01,649 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:01,678 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7499, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:09:01,682 INFO     [learner.py:656] After aggregation epoch 173, CumulTime 2376.8209, eval_time 0.8011, test_loss 2.7499, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:09:01,751 INFO     [learner.py:526] ====Start train round 174
2021-08-18:16:09:01,784 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:02,690 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:02,730 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:02,780 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:02,798 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:03,445 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:03,463 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:03,984 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:04,5 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:04,124 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:04,164 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:04,888 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:04,927 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:05,87 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:05,107 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:05,611 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:05,651 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:06,85 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:06,113 INFO     [learner.py:606] ====Pushing takes 0.025997638702392578 s
2021-08-18:16:09:06,152 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:06,165 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:06,165 INFO     [param_server.py:410] Lock worker 1 with localStep 174 , while globalStep is 173

2021-08-18:16:09:06,312 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:06,339 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:07,130 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:07,157 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:07,315 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:07,349 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:07,885 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:07,919 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:08,0 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:08,33 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:09,530 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:09,554 INFO     [learner.py:606] ====Pushing takes 0.02269601821899414 s
2021-08-18:16:09:09,590 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:09,596 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:09,597 INFO     [param_server.py:410] Lock worker 2 with localStep 174 , while globalStep is 173

2021-08-18:16:09:09,628 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:09,649 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:10,234 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:10,248 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:10,751 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:10,761 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:11,427 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:11,436 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:12,18 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:12,57 INFO     [learner.py:606] ====Pushing takes 0.037108421325683594 s
2021-08-18:16:09:12,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:12,111 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:12,112 INFO     [param_server.py:381] ====After aggregation in epoch: 173, virtual_clock: 5557.986135467275, top_1: : 62.2459 % (1929.0), top_5: : 100.0 % (3099.0), test loss: 2.968896667162577, test len: 3099.0
2021-08-18:16:09:12,114 INFO     [param_server.py:410] Lock worker 3 with localStep 174 , while globalStep is 174

2021-08-18:16:09:12,115 INFO     [param_server.py:441] ====Epoch 175 completes 20 clients with loss 8.153429798998458, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:12,115 INFO     [param_server.py:450] ====Start to sample for epoch 175, global virtualClock: 5557.986135467275, round_duration: 29.468813805062297
2021-08-18:16:09:12,116 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:12,460 INFO     [param_server.py:553] For epoch: 175, median_reward: 1396.886189178065, dev: 6984.430945890325
2021-08-18:16:09:12,946 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3669, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:09:12,947 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2388.0866, eval_time 0.4757, test_loss 3.3669, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:09:13,22 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:09:13,31 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:13,77 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8567, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:09:13,78 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2388.2142, eval_time 0.6042, test_loss 2.8567, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:09:13,85 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4647, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:09:13,90 INFO     [learner.py:656] After aggregation epoch 174, CumulTime 2388.215, eval_time 0.6153, test_loss 2.4647, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:09:13,160 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:09:13,160 INFO     [learner.py:526] ====Start train round 175
2021-08-18:16:09:13,168 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:13,170 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:13,620 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:13,634 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:14,467 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:14,477 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:14,696 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:14,729 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:15,415 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:15,449 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:15,641 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:15,651 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:15,898 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:15,907 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:16,66 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:16,99 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:16,531 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:16,549 INFO     [learner.py:606] ====Pushing takes 0.01666259765625 s
2021-08-18:16:09:16,572 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:16,577 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:16,578 INFO     [param_server.py:410] Lock worker 1 with localStep 175 , while globalStep is 174

2021-08-18:16:09:17,933 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:17,951 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:18,186 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:18,201 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:19,502 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:19,522 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:20,316 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:20,343 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:20,787 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:20,796 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:21,375 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:21,388 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:21,970 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:21,993 INFO     [learner.py:606] ====Pushing takes 0.021738529205322266 s
2021-08-18:16:09:22,35 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:22,41 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:22,42 INFO     [param_server.py:410] Lock worker 2 with localStep 175 , while globalStep is 174

2021-08-18:16:09:22,669 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:22,682 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:23,273 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:23,291 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:24,236 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:24,247 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:24,765 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:24,774 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:25,378 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:25,419 INFO     [learner.py:606] ====Pushing takes 0.0385587215423584 s
2021-08-18:16:09:25,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:25,476 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:25,477 INFO     [param_server.py:381] ====After aggregation in epoch: 174, virtual_clock: 5596.382157026061, top_1: : 63.2462 % (1960.0), top_5: : 100.0 % (3099.0), test loss: 2.896122429105971, test len: 3099.0
2021-08-18:16:09:25,479 INFO     [param_server.py:410] Lock worker 3 with localStep 175 , while globalStep is 175

2021-08-18:16:09:25,479 INFO     [param_server.py:441] ====Epoch 176 completes 20 clients with loss 8.386140732425508, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:25,480 INFO     [param_server.py:450] ====Start to sample for epoch 176, global virtualClock: 5596.382157026061, round_duration: 38.39602155878561
2021-08-18:16:09:25,481 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:25,803 INFO     [param_server.py:553] For epoch: 176, median_reward: 1212.2729883127759, dev: 6061.364941563879
2021-08-18:16:09:26,517 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3368, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:09:26,518 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2401.643, eval_time 0.6798, test_loss 3.3368, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:09:26,520 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6719, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:16:09:26,523 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2401.6594, eval_time 0.685, test_loss 2.6719, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:16:09:26,580 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:26,589 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:26,593 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:26,595 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7497, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:09:26,598 INFO     [learner.py:656] After aggregation epoch 175, CumulTime 2401.737, eval_time 0.7604, test_loss 2.7497, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:09:26,600 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:26,654 INFO     [learner.py:526] ====Start train round 176
2021-08-18:16:09:26,677 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:27,325 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:27,346 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:27,724 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:27,733 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:28,552 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:28,566 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:28,621 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:28,654 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:28,741 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:28,753 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:29,338 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:29,372 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:30,10 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:30,44 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:30,292 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:30,312 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:30,345 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:30,354 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:30,511 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:30,539 INFO     [learner.py:606] ====Pushing takes 0.026135921478271484 s
2021-08-18:16:09:30,571 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:30,576 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:30,577 INFO     [param_server.py:410] Lock worker 1 with localStep 176 , while globalStep is 175

2021-08-18:16:09:31,6 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:31,20 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:31,578 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:31,598 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:32,279 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:32,297 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:32,819 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:32,833 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:33,363 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:33,384 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:33,980 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:33,995 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:34,60 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:34,86 INFO     [learner.py:606] ====Pushing takes 0.024007320404052734 s
2021-08-18:16:09:34,120 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:34,127 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:34,128 INFO     [param_server.py:410] Lock worker 2 with localStep 176 , while globalStep is 175

2021-08-18:16:09:34,522 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:34,531 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:35,33 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:35,42 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:35,636 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:35,670 INFO     [learner.py:606] ====Pushing takes 0.032723188400268555 s
2021-08-18:16:09:35,718 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:35,729 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:35,730 INFO     [param_server.py:381] ====After aggregation in epoch: 175, virtual_clock: 5625.850970831123, top_1: : 60.9229 % (1888.0), top_5: : 100.0 % (3099.0), test loss: 2.919469641314612, test len: 3099.0
2021-08-18:16:09:35,732 INFO     [param_server.py:410] Lock worker 3 with localStep 176 , while globalStep is 176

2021-08-18:16:09:35,733 INFO     [param_server.py:441] ====Epoch 177 completes 20 clients with loss 10.227930836179345, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:35,733 INFO     [param_server.py:450] ====Start to sample for epoch 177, global virtualClock: 5625.850970831123, round_duration: 29.468813805062297
2021-08-18:16:09:35,734 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:36,101 INFO     [param_server.py:553] For epoch: 177, median_reward: 1144.2968193096665, dev: 5721.484096548333
2021-08-18:16:09:36,626 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7832, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:09:36,627 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2411.7661, eval_time 0.5039, test_loss 2.7832, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:09:36,701 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:36,714 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:36,731 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0231, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:09:36,732 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2411.8684, eval_time 0.6091, test_loss 3.0231, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:09:36,766 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5098, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:09:36,767 INFO     [learner.py:656] After aggregation epoch 176, CumulTime 2411.8917, eval_time 0.6389, test_loss 2.5098, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:09:36,802 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:36,812 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:36,836 INFO     [learner.py:526] ====Start train round 177
2021-08-18:16:09:36,853 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:37,381 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:37,402 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:37,998 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:38,12 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:38,474 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:38,495 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:39,75 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:39,91 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:39,96 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:39,102 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:39,595 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:39,605 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:39,630 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:39,651 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:39,988 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:40,7 INFO     [learner.py:606] ====Pushing takes 0.017905235290527344 s
2021-08-18:16:09:40,39 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:40,45 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:40,46 INFO     [param_server.py:410] Lock worker 1 with localStep 177 , while globalStep is 176

2021-08-18:16:09:41,517 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:41,536 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:41,941 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:41,950 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:43,137 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:43,150 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:43,859 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:43,873 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:44,508 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:44,519 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:45,173 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:45,183 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:45,689 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:45,713 INFO     [learner.py:606] ====Pushing takes 0.022731542587280273 s
2021-08-18:16:09:45,755 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:45,764 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:45,765 INFO     [param_server.py:410] Lock worker 2 with localStep 177 , while globalStep is 176

2021-08-18:16:09:46,479 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:46,495 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:47,152 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:47,165 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:48,448 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:48,458 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:49,35 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:49,45 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:49,630 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:49,665 INFO     [learner.py:606] ====Pushing takes 0.034409523010253906 s
2021-08-18:16:09:49,716 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:49,727 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:49,728 INFO     [param_server.py:381] ====After aggregation in epoch: 176, virtual_clock: 5664.246992389909, top_1: : 63.1817 % (1958.0), top_5: : 100.0 % (3099.0), test loss: 2.7720791896184287, test len: 3099.0
2021-08-18:16:09:49,730 INFO     [param_server.py:410] Lock worker 3 with localStep 177 , while globalStep is 177

2021-08-18:16:09:49,731 INFO     [param_server.py:441] ====Epoch 178 completes 20 clients with loss 9.210365101235453, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:49,731 INFO     [param_server.py:450] ====Start to sample for epoch 178, global virtualClock: 5664.246992389909, round_duration: 38.39602155878561
2021-08-18:16:09:49,732 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:09:50,72 INFO     [param_server.py:553] For epoch: 178, median_reward: 1350.8463906544698, dev: 6754.231953272349
2021-08-18:16:09:50,674 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9657, Top-1 Accuracy: 602.0/1033 (0.5828), Top-5 Accuracy: 1.0
2021-08-18:16:09:50,675 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2425.8108, eval_time 0.5561, test_loss 2.9657, test_accuracy 0.5828, test_5_accuracy 1.0 

2021-08-18:16:09:50,711 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8113, Top-1 Accuracy: 609.0/1033 (0.5895), Top-5 Accuracy: 1.0
2021-08-18:16:09:50,712 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2425.8369, eval_time 0.5895, test_loss 2.8113, test_accuracy 0.5895, test_5_accuracy 1.0 

2021-08-18:16:09:50,763 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:50,771 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:09:50,780 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:50,794 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:09:50,794 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2661, Top-1 Accuracy: 618.0/1033 (0.5983), Top-5 Accuracy: 1.0
2021-08-18:16:09:50,797 INFO     [learner.py:656] After aggregation epoch 177, CumulTime 2425.9358, eval_time 0.68, test_loss 3.2661, test_accuracy 0.5983, test_5_accuracy 1.0 

2021-08-18:16:09:50,853 INFO     [learner.py:526] ====Start train round 178
2021-08-18:16:09:50,879 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:09:51,645 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:09:51,665 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:09:51,817 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:09:51,829 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:09:52,359 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:09:52,373 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:09:52,883 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:09:52,892 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:09:52,947 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:09:52,968 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:09:53,605 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:09:53,632 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:09:54,169 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:09:54,189 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:09:54,324 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:09:54,352 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:09:54,667 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:09:54,677 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:09:54,821 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:09:54,848 INFO     [learner.py:606] ====Pushing takes 0.024747133255004883 s
2021-08-18:16:09:54,883 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:54,889 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:09:54,890 INFO     [param_server.py:410] Lock worker 1 with localStep 178 , while globalStep is 177

2021-08-18:16:09:55,249 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:09:55,259 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:09:55,800 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:09:55,810 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:09:56,234 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:09:56,247 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:09:56,860 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:09:56,874 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:09:57,403 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:09:57,422 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:09:58,32 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:09:58,52 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:09:58,174 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:09:58,199 INFO     [learner.py:606] ====Pushing takes 0.02318120002746582 s
2021-08-18:16:09:58,234 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:58,240 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:09:58,241 INFO     [param_server.py:410] Lock worker 2 with localStep 178 , while globalStep is 177

2021-08-18:16:09:58,596 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:09:58,617 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:09:59,207 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:09:59,221 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:09:59,790 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:09:59,826 INFO     [learner.py:606] ====Pushing takes 0.03358340263366699 s
2021-08-18:16:09:59,873 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:09:59,882 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:09:59,883 INFO     [param_server.py:381] ====After aggregation in epoch: 177, virtual_clock: 5693.715806194971, top_1: : 59.019 % (1829.0), top_5: : 100.0 % (3099.0), test loss: 3.0143670859160245, test len: 3099.0
2021-08-18:16:09:59,885 INFO     [param_server.py:410] Lock worker 3 with localStep 178 , while globalStep is 178

2021-08-18:16:09:59,885 INFO     [param_server.py:441] ====Epoch 179 completes 20 clients with loss 9.97829266162923, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:09:59,885 INFO     [param_server.py:450] ====Start to sample for epoch 179, global virtualClock: 5693.715806194971, round_duration: 29.468813805062297
2021-08-18:16:09:59,886 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:00,223 INFO     [param_server.py:553] For epoch: 179, median_reward: 1250.3508602977029, dev: 6251.754301488514
2021-08-18:16:10:00,769 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8772, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:10:00,770 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2435.9094, eval_time 0.5144, test_loss 2.8772, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:10:00,830 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:10:00,844 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:00,955 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.635, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:10:00,956 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2436.0804, eval_time 0.6998, test_loss 2.635, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:10:00,962 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6861, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:10:00,964 INFO     [learner.py:656] After aggregation epoch 178, CumulTime 2436.0995, eval_time 0.7077, test_loss 2.6861, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:10:01,22 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:10:01,22 INFO     [learner.py:526] ====Start train round 179
2021-08-18:16:10:01,30 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:01,30 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:01,508 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:01,529 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:02,199 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:02,208 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:02,648 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:02,669 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:03,300 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:03,313 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:03,326 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:03,327 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:03,670 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:03,689 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:03,908 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:03,935 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:04,311 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:04,332 INFO     [learner.py:606] ====Pushing takes 0.02003931999206543 s
2021-08-18:16:10:04,364 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:04,372 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:04,373 INFO     [param_server.py:410] Lock worker 1 with localStep 179 , while globalStep is 178

2021-08-18:16:10:05,519 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:05,540 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:06,214 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:06,233 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:07,485 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:07,494 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:08,148 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:08,157 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:08,492 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:08,502 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:09,144 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:09,154 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:09,743 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:09,768 INFO     [learner.py:606] ====Pushing takes 0.0231478214263916 s
2021-08-18:16:10:09,802 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:09,809 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:09,809 INFO     [param_server.py:410] Lock worker 2 with localStep 179 , while globalStep is 178

2021-08-18:16:10:10,479 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:10,500 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:11,214 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:11,235 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:12,455 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:12,469 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:13,104 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:13,119 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:13,689 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:13,727 INFO     [learner.py:606] ====Pushing takes 0.03667259216308594 s
2021-08-18:16:10:13,774 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:13,783 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:13,783 INFO     [param_server.py:381] ====After aggregation in epoch: 178, virtual_clock: 5732.111827753757, top_1: : 62.6331 % (1941.0), top_5: : 100.0 % (3099.0), test loss: 2.732797545139436, test len: 3099.0
2021-08-18:16:10:13,785 INFO     [param_server.py:410] Lock worker 3 with localStep 179 , while globalStep is 179

2021-08-18:16:10:13,786 INFO     [param_server.py:441] ====Epoch 180 completes 20 clients with loss 10.51049410784646, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:13,786 INFO     [param_server.py:450] ====Start to sample for epoch 180, global virtualClock: 5732.111827753757, round_duration: 38.39602155878561
2021-08-18:16:10:13,787 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:14,126 INFO     [param_server.py:553] For epoch: 180, median_reward: 1043.1367687522545, dev: 5215.683843761272
2021-08-18:16:10:14,857 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5768, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:16:10:14,858 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.014, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:10:14,872 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2449.997, eval_time 0.6994, test_loss 2.5768, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:16:10:14,873 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2450.0085, eval_time 0.7019, test_loss 3.014, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:10:14,942 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:10:14,942 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:10:14,949 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:14,950 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:14,979 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8323, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:10:14,982 INFO     [learner.py:656] After aggregation epoch 179, CumulTime 2450.1216, eval_time 0.8118, test_loss 2.8323, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:10:15,53 INFO     [learner.py:526] ====Start train round 180
2021-08-18:16:10:15,77 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:15,797 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:15,824 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:15,975 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:15,989 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:16,581 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:16,594 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:17,5 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:17,14 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:17,42 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:17,69 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:17,663 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:17,690 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:18,352 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:18,356 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:18,373 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:18,383 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:18,847 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:18,862 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:18,871 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:18,898 INFO     [learner.py:606] ====Pushing takes 0.024463891983032227 s
2021-08-18:16:10:18,927 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:18,933 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:18,934 INFO     [param_server.py:410] Lock worker 1 with localStep 180 , while globalStep is 179

2021-08-18:16:10:19,547 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:19,561 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:20,129 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:20,139 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:20,348 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:20,363 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:20,979 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:20,993 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:21,694 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:21,708 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:22,262 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:22,274 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:22,287 INFO     [learner.py:606] ====Pushing takes 0.023463010787963867 s
2021-08-18:16:10:22,288 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:22,314 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:22,320 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:22,321 INFO     [param_server.py:410] Lock worker 2 with localStep 180 , while globalStep is 179

2021-08-18:16:10:22,915 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:22,933 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:23,430 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:23,448 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:23,940 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:23,977 INFO     [learner.py:606] ====Pushing takes 0.03612565994262695 s
2021-08-18:16:10:24,25 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:24,36 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:24,37 INFO     [param_server.py:381] ====After aggregation in epoch: 179, virtual_clock: 5761.5806415588195, top_1: : 61.1488 % (1895.0), top_5: : 100.0 % (3099.0), test loss: 2.807692602828697, test len: 3099.0
2021-08-18:16:10:24,40 INFO     [param_server.py:410] Lock worker 3 with localStep 180 , while globalStep is 180

2021-08-18:16:10:24,40 INFO     [param_server.py:441] ====Epoch 181 completes 20 clients with loss 7.88911888292627, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:24,41 INFO     [param_server.py:450] ====Start to sample for epoch 181, global virtualClock: 5761.5806415588195, round_duration: 29.468813805062297
2021-08-18:16:10:24,42 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:24,414 INFO     [param_server.py:541] Handle Wight 0.04943275451660156 | Send 0.37367677688598633
2021-08-18:16:10:24,415 INFO     [param_server.py:553] For epoch: 181, median_reward: 1266.8389327413668, dev: 6334.194663706834
2021-08-18:16:10:25,46 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9139, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:10:25,47 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2460.1862, eval_time 0.5988, test_loss 2.9139, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:10:25,95 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6761, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:10:25,98 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2460.2344, eval_time 0.6492, test_loss 2.6761, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:10:25,114 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:25,125 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4541, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:10:25,126 INFO     [learner.py:656] After aggregation epoch 180, CumulTime 2460.2509, eval_time 0.6726, test_loss 2.4541, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:10:25,136 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:25,183 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:25,191 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:25,198 INFO     [learner.py:526] ====Start train round 181
2021-08-18:16:10:25,212 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:25,802 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:25,822 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:26,416 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:26,427 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:26,909 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:26,936 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:27,472 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:27,484 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:27,572 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:27,599 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:27,883 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:27,893 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:28,182 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:28,209 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:28,566 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:28,585 INFO     [learner.py:606] ====Pushing takes 0.017993927001953125 s
2021-08-18:16:10:28,619 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:28,625 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:28,626 INFO     [param_server.py:410] Lock worker 1 with localStep 181 , while globalStep is 180

2021-08-18:16:10:29,769 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:29,790 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:30,194 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:30,204 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:31,385 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:31,395 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:32,28 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:32,49 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:32,590 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:32,600 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:33,259 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:33,273 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:33,841 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:33,865 INFO     [learner.py:606] ====Pushing takes 0.02333545684814453 s
2021-08-18:16:10:33,902 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:33,909 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:33,910 INFO     [param_server.py:410] Lock worker 2 with localStep 181 , while globalStep is 180

2021-08-18:16:10:34,365 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:34,374 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:35,66 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:35,84 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:36,421 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:36,442 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:37,37 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:37,58 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:37,594 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:37,633 INFO     [learner.py:606] ====Pushing takes 0.03728508949279785 s
2021-08-18:16:10:37,672 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:37,681 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:37,681 INFO     [param_server.py:381] ====After aggregation in epoch: 180, virtual_clock: 5799.976663117605, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 2.6813639049176814, test len: 3099.0
2021-08-18:16:10:37,684 INFO     [param_server.py:410] Lock worker 3 with localStep 181 , while globalStep is 181

2021-08-18:16:10:37,684 INFO     [param_server.py:441] ====Epoch 182 completes 20 clients with loss 6.8242861654022136, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:37,684 INFO     [param_server.py:450] ====Start to sample for epoch 182, global virtualClock: 5799.976663117605, round_duration: 38.39602155878561
2021-08-18:16:10:37,685 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:38,19 INFO     [param_server.py:553] For epoch: 182, median_reward: 1214.511586212107, dev: 6072.557931060535
2021-08-18:16:10:38,658 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.973, Top-1 Accuracy: 623.0/1033 (0.6031), Top-5 Accuracy: 1.0
2021-08-18:16:10:38,659 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2473.795, eval_time 0.5836, test_loss 2.973, test_accuracy 0.6031, test_5_accuracy 1.0 

2021-08-18:16:10:38,686 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7631, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:16:10:38,687 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2473.8116, eval_time 0.6093, test_loss 2.7631, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:16:10:38,726 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:38,734 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:38,754 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:38,753 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4147, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:10:38,757 INFO     [learner.py:656] After aggregation epoch 181, CumulTime 2473.896, eval_time 0.683, test_loss 3.4147, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:10:38,770 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:38,826 INFO     [learner.py:526] ====Start train round 182
2021-08-18:16:10:38,849 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:39,657 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:39,684 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:39,891 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:39,903 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:40,476 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:40,489 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:41,15 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:41,36 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:41,56 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:41,66 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:41,731 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:41,758 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:42,227 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:42,247 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:42,341 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:42,369 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:42,826 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:42,839 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:42,856 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:42,885 INFO     [learner.py:606] ====Pushing takes 0.02687859535217285 s
2021-08-18:16:10:42,908 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:42,916 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:42,917 INFO     [param_server.py:410] Lock worker 1 with localStep 182 , while globalStep is 181

2021-08-18:16:10:43,586 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:43,595 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:44,158 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:44,168 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:44,427 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:44,447 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:45,65 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:45,78 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:45,934 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:45,956 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:46,412 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:46,436 INFO     [learner.py:606] ====Pushing takes 0.022718429565429688 s
2021-08-18:16:10:46,470 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:46,476 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:46,477 INFO     [param_server.py:410] Lock worker 2 with localStep 182 , while globalStep is 181

2021-08-18:16:10:46,602 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:46,615 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:10:47,116 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:10:47,130 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:10:47,651 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:10:47,660 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:10:48,148 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:10:48,184 INFO     [learner.py:606] ====Pushing takes 0.033850908279418945 s
2021-08-18:16:10:48,231 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:48,241 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:10:48,242 INFO     [param_server.py:381] ====After aggregation in epoch: 181, virtual_clock: 5829.445476922668, top_1: : 60.7293 % (1882.0), top_5: : 100.0 % (3099.0), test loss: 3.050265073776245, test len: 3099.0
2021-08-18:16:10:48,244 INFO     [param_server.py:410] Lock worker 3 with localStep 182 , while globalStep is 182

2021-08-18:16:10:48,245 INFO     [param_server.py:441] ====Epoch 183 completes 20 clients with loss 8.256767460920813, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:10:48,245 INFO     [param_server.py:450] ====Start to sample for epoch 183, global virtualClock: 5829.445476922668, round_duration: 29.468813805062297
2021-08-18:16:10:48,246 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:10:48,585 INFO     [param_server.py:553] For epoch: 183, median_reward: 1256.4907136684917, dev: 6282.453568342458
2021-08-18:16:10:49,179 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0033, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:10:49,180 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2484.3192, eval_time 0.5597, test_loss 3.0033, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:10:49,239 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:49,245 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8615, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:10:49,246 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2484.3821, eval_time 0.6255, test_loss 2.8615, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:10:49,262 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:10:49,281 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4055, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:10:49,282 INFO     [learner.py:656] After aggregation epoch 182, CumulTime 2484.4068, eval_time 0.6614, test_loss 2.4055, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:10:49,317 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:49,327 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:10:49,352 INFO     [learner.py:526] ====Start train round 183
2021-08-18:16:10:49,367 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:10:50,3 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:10:50,29 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:10:50,449 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:10:50,459 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:10:51,269 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:10:51,302 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:10:51,614 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:10:51,623 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:10:51,926 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:10:51,953 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:10:52,269 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:10:52,283 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:10:52,523 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:10:52,549 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:10:52,899 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:10:52,923 INFO     [learner.py:606] ====Pushing takes 0.01881098747253418 s
2021-08-18:16:10:52,956 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:52,963 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:10:52,963 INFO     [param_server.py:410] Lock worker 1 with localStep 183 , while globalStep is 182

2021-08-18:16:10:53,974 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:10:53,988 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:10:54,439 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:10:54,449 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:10:55,631 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:10:55,641 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:10:56,250 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:10:56,259 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:10:56,989 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:10:57,3 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:10:57,657 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:10:57,667 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:10:58,231 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:10:58,255 INFO     [learner.py:606] ====Pushing takes 0.022576332092285156 s
2021-08-18:16:10:58,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:10:58,302 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:10:58,302 INFO     [param_server.py:410] Lock worker 2 with localStep 183 , while globalStep is 182

2021-08-18:16:10:58,439 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:10:58,450 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:10:59,44 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:10:59,53 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:00,380 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:00,394 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:01,20 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:01,35 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:01,655 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:01,692 INFO     [learner.py:606] ====Pushing takes 0.035248517990112305 s
2021-08-18:16:11:01,733 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:01,742 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:01,742 INFO     [param_server.py:381] ====After aggregation in epoch: 182, virtual_clock: 5867.8414984814535, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 2.756767624506244, test len: 3099.0
2021-08-18:16:11:01,744 INFO     [param_server.py:410] Lock worker 3 with localStep 183 , while globalStep is 183

2021-08-18:16:11:01,745 INFO     [param_server.py:441] ====Epoch 184 completes 20 clients with loss 6.616041879133509, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:01,745 INFO     [param_server.py:450] ====Start to sample for epoch 184, global virtualClock: 5867.8414984814535, round_duration: 38.39602155878561
2021-08-18:16:11:01,746 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:02,87 INFO     [param_server.py:553] For epoch: 184, median_reward: 934.8420050664596, dev: 4674.210025332298
2021-08-18:16:11:02,668 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1888, Top-1 Accuracy: 612.0/1033 (0.5924), Top-5 Accuracy: 1.0
2021-08-18:16:11:02,669 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2497.8051, eval_time 0.5241, test_loss 3.1888, test_accuracy 0.5924, test_5_accuracy 1.0 

2021-08-18:16:11:02,675 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.652, Top-1 Accuracy: 627.0/1033 (0.607), Top-5 Accuracy: 1.0
2021-08-18:16:11:02,679 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2497.8036, eval_time 0.5338, test_loss 2.652, test_accuracy 0.607, test_5_accuracy 1.0 

2021-08-18:16:11:02,735 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:11:02,743 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:11:02,747 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:02,760 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:02,829 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.758, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:11:02,832 INFO     [learner.py:656] After aggregation epoch 183, CumulTime 2497.971, eval_time 0.6893, test_loss 2.758, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:11:02,899 INFO     [learner.py:526] ====Start train round 184
2021-08-18:16:11:02,935 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:03,851 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:03,885 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:03,890 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:03,900 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:04,598 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:04,612 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:05,250 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:05,278 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:05,292 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:05,306 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:05,881 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:05,908 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:06,390 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:06,404 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:06,623 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:06,644 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:07,86 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:07,113 INFO     [learner.py:606] ====Pushing takes 0.024677753448486328 s
2021-08-18:16:11:07,129 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:07,139 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:07,145 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:07,154 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:07,155 INFO     [param_server.py:410] Lock worker 1 with localStep 184 , while globalStep is 183

2021-08-18:16:11:07,805 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:07,815 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:08,453 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:08,462 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:08,537 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:08,557 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:09,252 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:09,272 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:10,43 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:10,53 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:10,677 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:10,686 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:10,703 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:10,725 INFO     [learner.py:606] ====Pushing takes 0.02006983757019043 s
2021-08-18:16:11:10,761 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:10,769 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:10,782 INFO     [param_server.py:410] Lock worker 2 with localStep 184 , while globalStep is 183

2021-08-18:16:11:11,299 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:11,308 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:11,871 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:11,880 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:12,473 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:12,509 INFO     [learner.py:606] ====Pushing takes 0.03432416915893555 s
2021-08-18:16:11:12,553 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:12,562 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:12,563 INFO     [param_server.py:381] ====After aggregation in epoch: 183, virtual_clock: 5897.310312286516, top_1: : 60.5679 % (1877.0), top_5: : 100.0 % (3099.0), test loss: 2.8662821782959838, test len: 3099.0
2021-08-18:16:11:12,565 INFO     [param_server.py:410] Lock worker 3 with localStep 184 , while globalStep is 184

2021-08-18:16:11:12,572 INFO     [param_server.py:441] ====Epoch 185 completes 20 clients with loss 7.182502379459191, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:12,573 INFO     [param_server.py:450] ====Start to sample for epoch 185, global virtualClock: 5897.310312286516, round_duration: 29.468813805062297
2021-08-18:16:11:12,574 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:12,919 INFO     [param_server.py:553] For epoch: 185, median_reward: 1217.5789512077288, dev: 6087.894756038644
2021-08-18:16:11:13,520 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9054, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:11:13,521 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4391, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:11:13,521 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2508.657, eval_time 0.5671, test_loss 2.9054, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:11:13,521 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2508.6461, eval_time 0.5674, test_loss 2.4391, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:11:13,557 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4731, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:11:13,558 INFO     [learner.py:656] After aggregation epoch 184, CumulTime 2508.697, eval_time 0.6042, test_loss 3.4731, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:11:13,581 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:11:13,590 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:13,593 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:11:13,601 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:13,643 INFO     [learner.py:526] ====Start train round 185
2021-08-18:16:11:13,673 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:14,476 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:14,510 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:14,664 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:14,675 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:15,791 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:15,825 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:15,888 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:15,904 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:16,510 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:16,536 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:16,543 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:16,557 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:17,161 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:17,195 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:17,612 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:17,632 INFO     [learner.py:606] ====Pushing takes 0.018471479415893555 s
2021-08-18:16:11:17,667 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:17,673 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:17,674 INFO     [param_server.py:410] Lock worker 1 with localStep 185 , while globalStep is 184

2021-08-18:16:11:18,205 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:18,223 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:19,102 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:19,116 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:20,250 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:20,260 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:20,903 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:20,913 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:21,196 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:21,214 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:21,835 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:21,844 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:22,317 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:22,342 INFO     [learner.py:606] ====Pushing takes 0.02344346046447754 s
2021-08-18:16:11:22,377 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:22,384 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:22,385 INFO     [param_server.py:410] Lock worker 2 with localStep 185 , while globalStep is 184

2021-08-18:16:11:23,262 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:23,271 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:23,939 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:23,949 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:24,995 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:25,5 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:25,583 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:25,592 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:26,68 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:26,103 INFO     [learner.py:606] ====Pushing takes 0.033919334411621094 s
2021-08-18:16:11:26,155 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:26,167 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:26,168 INFO     [param_server.py:381] ====After aggregation in epoch: 184, virtual_clock: 5935.706333845302, top_1: : 63.4398 % (1966.0), top_5: : 100.0 % (3099.0), test loss: 2.939195178173206, test len: 3099.0
2021-08-18:16:11:26,171 INFO     [param_server.py:410] Lock worker 3 with localStep 185 , while globalStep is 185

2021-08-18:16:11:26,171 INFO     [param_server.py:441] ====Epoch 186 completes 20 clients with loss 8.79582497689374, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:26,172 INFO     [param_server.py:450] ====Start to sample for epoch 186, global virtualClock: 5935.706333845302, round_duration: 38.39602155878561
2021-08-18:16:11:26,173 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:26,518 INFO     [param_server.py:553] For epoch: 186, median_reward: 1246.9296501240556, dev: 6234.648250620277
2021-08-18:16:11:27,130 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8036, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:11:27,131 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2522.256, eval_time 0.5471, test_loss 2.8036, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:11:27,131 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7457, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:16:11:27,132 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2522.2681, eval_time 0.548, test_loss 2.7457, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:16:11:27,200 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:27,209 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:27,222 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:27,238 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:27,328 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8816, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:11:27,330 INFO     [learner.py:656] After aggregation epoch 185, CumulTime 2522.4695, eval_time 0.7463, test_loss 2.8816, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:11:27,418 INFO     [learner.py:526] ====Start train round 186
2021-08-18:16:11:27,452 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:28,334 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:28,352 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:28,361 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:28,374 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:28,946 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:28,956 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:29,755 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:29,795 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:29,967 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:29,994 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:30,454 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:30,481 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:30,898 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:30,912 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:31,82 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:31,109 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:31,494 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:31,520 INFO     [learner.py:606] ====Pushing takes 0.02396988868713379 s
2021-08-18:16:11:31,549 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:31,555 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:31,556 INFO     [param_server.py:410] Lock worker 1 with localStep 186 , while globalStep is 185

2021-08-18:16:11:32,25 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:32,39 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:32,721 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:32,745 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:32,930 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:32,951 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:33,357 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:33,366 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:33,586 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:33,600 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:34,938 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:34,949 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:34,952 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:34,977 INFO     [learner.py:606] ====Pushing takes 0.022860050201416016 s
2021-08-18:16:11:35,12 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:35,19 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:35,19 INFO     [param_server.py:410] Lock worker 2 with localStep 186 , while globalStep is 185

2021-08-18:16:11:35,524 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:35,534 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:36,86 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:36,96 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:36,861 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:36,871 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:37,433 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:37,468 INFO     [learner.py:606] ====Pushing takes 0.03448486328125 s
2021-08-18:16:11:37,514 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:37,522 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:37,523 INFO     [param_server.py:381] ====After aggregation in epoch: 185, virtual_clock: 5965.175147650364, top_1: : 61.7941 % (1915.0), top_5: : 100.0 % (3099.0), test loss: 2.8103137943479752, test len: 3099.0
2021-08-18:16:11:37,526 INFO     [param_server.py:410] Lock worker 3 with localStep 186 , while globalStep is 186

2021-08-18:16:11:37,526 INFO     [param_server.py:441] ====Epoch 187 completes 20 clients with loss 8.348862122201805, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:37,527 INFO     [param_server.py:450] ====Start to sample for epoch 187, global virtualClock: 5965.175147650364, round_duration: 29.468813805062297
2021-08-18:16:11:37,528 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:37,874 INFO     [param_server.py:553] For epoch: 187, median_reward: 1715.5320139605078, dev: 8577.66006980254
2021-08-18:16:11:38,502 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8575, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:11:38,502 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2533.6416, eval_time 0.5839, test_loss 2.8575, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:11:38,536 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8592, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:11:38,536 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.974, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:11:38,540 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2533.6761, eval_time 0.6215, test_loss 2.8592, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:11:38,540 INFO     [learner.py:656] After aggregation epoch 186, CumulTime 2533.6649, eval_time 0.6216, test_loss 2.974, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:11:38,568 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:38,593 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:38,612 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:38,620 INFO     [learner.py:526] ====Start train round 187
2021-08-18:16:11:38,620 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:38,629 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:39,418 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:39,452 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:39,821 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:39,830 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:40,756 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:40,790 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:41,22 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:41,40 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:41,406 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:41,420 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:41,550 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:41,590 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:42,261 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:42,301 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:42,767 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:42,788 INFO     [learner.py:606] ====Pushing takes 0.016167640686035156 s
2021-08-18:16:11:42,820 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:42,828 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:42,829 INFO     [param_server.py:410] Lock worker 1 with localStep 187 , while globalStep is 186

2021-08-18:16:11:43,359 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:43,372 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:44,178 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:44,192 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:45,462 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:45,472 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:46,124 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:46,135 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:46,156 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:46,166 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:11:46,801 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:46,810 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:47,329 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:11:47,354 INFO     [learner.py:606] ====Pushing takes 0.023538589477539062 s
2021-08-18:16:11:47,392 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:47,403 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:11:47,404 INFO     [param_server.py:410] Lock worker 2 with localStep 187 , while globalStep is 186

2021-08-18:16:11:48,407 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:11:48,420 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:11:49,72 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:11:49,82 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:11:50,229 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:11:50,238 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:11:50,880 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:11:50,889 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:11:51,420 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:11:51,456 INFO     [learner.py:606] ====Pushing takes 0.0350193977355957 s
2021-08-18:16:11:51,510 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:51,521 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:11:51,522 INFO     [param_server.py:381] ====After aggregation in epoch: 186, virtual_clock: 6003.57116920915, top_1: : 63.3107 % (1962.0), top_5: : 100.0 % (3099.0), test loss: 2.8968931304083934, test len: 3099.0
2021-08-18:16:11:51,524 INFO     [param_server.py:410] Lock worker 3 with localStep 187 , while globalStep is 187

2021-08-18:16:11:51,525 INFO     [param_server.py:441] ====Epoch 188 completes 20 clients with loss 7.923402902385755, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:11:51,525 INFO     [param_server.py:450] ====Start to sample for epoch 188, global virtualClock: 6003.57116920915, round_duration: 38.39602155878561
2021-08-18:16:11:51,527 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:11:51,906 INFO     [param_server.py:553] For epoch: 188, median_reward: 1813.5659448430602, dev: 9067.8297242153
2021-08-18:16:11:52,590 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8867, Top-1 Accuracy: 619.0/1033 (0.5992), Top-5 Accuracy: 1.0
2021-08-18:16:11:52,591 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2547.7269, eval_time 0.6279, test_loss 2.8867, test_accuracy 0.5992, test_5_accuracy 1.0 

2021-08-18:16:11:52,622 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5323, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:11:52,623 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2547.7479, eval_time 0.6588, test_loss 2.5323, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:11:52,659 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:52,668 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:11:52,690 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:52,705 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:11:52,745 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9976, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:11:52,746 INFO     [learner.py:656] After aggregation epoch 187, CumulTime 2547.8855, eval_time 0.7847, test_loss 2.9976, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:11:52,802 INFO     [learner.py:526] ====Start train round 188
2021-08-18:16:11:52,832 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:11:53,666 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:11:53,706 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:11:53,809 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:11:53,823 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:11:54,479 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:11:54,492 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:11:55,113 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:11:55,153 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:11:55,219 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:11:55,240 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:11:55,798 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:11:55,838 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:11:56,185 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:11:56,203 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:11:56,490 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:11:56,523 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:11:56,994 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:11:57,23 INFO     [learner.py:606] ====Pushing takes 0.02639150619506836 s
2021-08-18:16:11:57,58 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:11:57,64 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:11:57,65 INFO     [param_server.py:410] Lock worker 1 with localStep 188 , while globalStep is 187

2021-08-18:16:11:57,421 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:11:57,442 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:11:58,29 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:11:58,48 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:11:58,155 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:11:58,173 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:11:58,679 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:11:58,693 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:11:58,800 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:11:58,809 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:00,162 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:00,187 INFO     [learner.py:606] ====Pushing takes 0.02299642562866211 s
2021-08-18:16:12:00,223 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:00,229 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:12:00,230 INFO     [param_server.py:410] Lock worker 2 with localStep 188 , while globalStep is 187

2021-08-18:16:12:00,518 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:00,528 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:01,121 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:01,131 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:01,715 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:01,724 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:12:02,308 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:12:02,319 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:02,939 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:02,974 INFO     [learner.py:606] ====Pushing takes 0.033423662185668945 s
2021-08-18:16:12:03,23 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:03,37 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:03,38 INFO     [param_server.py:381] ====After aggregation in epoch: 187, virtual_clock: 6033.039983014212, top_1: : 61.181 % (1896.0), top_5: : 100.0 % (3099.0), test loss: 2.8055267113226434, test len: 3099.0
2021-08-18:16:12:03,41 INFO     [param_server.py:410] Lock worker 3 with localStep 188 , while globalStep is 188

2021-08-18:16:12:03,42 INFO     [param_server.py:441] ====Epoch 189 completes 20 clients with loss 7.9152167488829726, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:12:03,42 INFO     [param_server.py:450] ====Start to sample for epoch 189, global virtualClock: 6033.039983014212, round_duration: 29.468813805062297
2021-08-18:16:12:03,44 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:12:03,452 INFO     [param_server.py:553] For epoch: 189, median_reward: 1530.7970387318967, dev: 7653.985193659483
2021-08-18:16:12:04,37 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7072, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:12:04,41 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2559.1798, eval_time 0.5553, test_loss 2.7072, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:12:04,88 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8578, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:12:04,89 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2559.2254, eval_time 0.604, test_loss 2.8578, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:12:04,98 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3492, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:12:04,98 INFO     [learner.py:656] After aggregation epoch 188, CumulTime 2559.2231, eval_time 0.613, test_loss 2.3492, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:12:04,116 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:12:04,134 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:04,156 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:12:04,165 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:04,183 INFO     [learner.py:526] ====Start train round 189
2021-08-18:16:12:04,191 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:04,794 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:04,815 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:05,438 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:05,447 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:06,107 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:06,141 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:06,591 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:06,605 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:06,826 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:06,859 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:06,995 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:07,11 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:07,438 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:07,493 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:07,922 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:07,943 INFO     [learner.py:606] ====Pushing takes 0.01629948616027832 s
2021-08-18:16:12:07,973 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:07,981 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:07,981 INFO     [param_server.py:410] Lock worker 1 with localStep 189 , while globalStep is 188

2021-08-18:16:12:08,762 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:08,861 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:09,456 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:09,470 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:10,711 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:10,732 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:11,419 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:11,428 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:11,451 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:11,461 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:12,23 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:12,33 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:12,519 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:12,544 INFO     [learner.py:606] ====Pushing takes 0.023311853408813477 s
2021-08-18:16:12:12,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:12,585 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:12:12,586 INFO     [param_server.py:410] Lock worker 2 with localStep 189 , while globalStep is 188

2021-08-18:16:12:13,512 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:13,524 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:14,126 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:14,136 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:15,357 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:15,366 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:12:15,982 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:12:15,992 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:16,599 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:16,634 INFO     [learner.py:606] ====Pushing takes 0.034150123596191406 s
2021-08-18:16:12:16,684 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:16,693 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:16,694 INFO     [param_server.py:381] ====After aggregation in epoch: 188, virtual_clock: 6071.436004572998, top_1: : 63.3107 % (1962.0), top_5: : 100.0 % (3099.0), test loss: 2.638026434514258, test len: 3099.0
2021-08-18:16:12:16,696 INFO     [param_server.py:410] Lock worker 3 with localStep 189 , while globalStep is 189

2021-08-18:16:12:16,697 INFO     [param_server.py:441] ====Epoch 190 completes 20 clients with loss 8.998452646131613, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:12:16,697 INFO     [param_server.py:450] ====Start to sample for epoch 190, global virtualClock: 6071.436004572998, round_duration: 38.39602155878561
2021-08-18:16:12:16,698 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:12:17,69 INFO     [param_server.py:553] For epoch: 190, median_reward: 1534.7670933363033, dev: 7673.835466681517
2021-08-18:16:12:17,776 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8408, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:12:17,777 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2572.9013, eval_time 0.6744, test_loss 2.8408, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:12:17,812 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6657, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:12:17,816 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2572.9518, eval_time 0.7137, test_loss 2.6657, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:12:17,844 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:17,853 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:17,861 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6026, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:12:17,861 INFO     [learner.py:656] After aggregation epoch 189, CumulTime 2573.0007, eval_time 0.7598, test_loss 2.6026, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:12:17,885 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:17,900 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:17,916 INFO     [learner.py:526] ====Start train round 190
2021-08-18:16:12:17,944 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:18,680 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:18,714 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:19,22 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:19,36 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:19,640 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:19,649 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:20,58 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:20,91 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:20,239 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:20,252 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:20,904 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:20,931 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:21,372 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:21,381 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:21,584 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:21,611 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:22,118 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:22,145 INFO     [learner.py:606] ====Pushing takes 0.024615764617919922 s
2021-08-18:16:12:22,161 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:22,174 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:22,175 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:22,180 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:22,181 INFO     [param_server.py:410] Lock worker 1 with localStep 190 , while globalStep is 189

2021-08-18:16:12:22,783 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:22,797 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:23,80 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:23,89 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:23,350 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:23,371 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:23,613 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:23,622 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:25,140 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:25,165 INFO     [learner.py:606] ====Pushing takes 0.02256464958190918 s
2021-08-18:16:12:25,180 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:25,195 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:25,200 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:25,209 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:12:25,210 INFO     [param_server.py:410] Lock worker 2 with localStep 190 , while globalStep is 189

2021-08-18:16:12:25,845 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:25,855 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:26,427 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:26,438 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:12:26,994 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:12:27,8 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:27,560 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:27,595 INFO     [learner.py:606] ====Pushing takes 0.03306984901428223 s
2021-08-18:16:12:27,639 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:27,648 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:27,649 INFO     [param_server.py:381] ====After aggregation in epoch: 189, virtual_clock: 6100.904818378061, top_1: : 62.2136 % (1928.0), top_5: : 100.0 % (3099.0), test loss: 2.7030234712141534, test len: 3099.0
2021-08-18:16:12:27,652 INFO     [param_server.py:410] Lock worker 3 with localStep 190 , while globalStep is 190

2021-08-18:16:12:27,653 INFO     [param_server.py:441] ====Epoch 191 completes 20 clients with loss 6.150400846975713, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:12:27,653 INFO     [param_server.py:450] ====Start to sample for epoch 191, global virtualClock: 6100.904818378061, round_duration: 29.468813805062297
2021-08-18:16:12:27,654 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 36, 50, 105]
2021-08-18:16:12:27,959 INFO     [param_server.py:553] For epoch: 191, median_reward: 1154.4954968834943, dev: 5772.477484417472
2021-08-18:16:12:28,546 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5438, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:12:28,547 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2583.672, eval_time 0.5533, test_loss 2.5438, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:12:28,550 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9024, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:12:28,551 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2583.6872, eval_time 0.5577, test_loss 2.9024, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:12:28,558 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8496, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:12:28,561 INFO     [learner.py:656] After aggregation epoch 190, CumulTime 2583.7003, eval_time 0.569, test_loss 2.8496, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:12:28,641 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:28,646 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:28,646 INFO     [learner.py:526] ====Start train round 191
2021-08-18:16:12:28,651 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:28,654 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:28,667 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:29,331 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:29,352 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:29,771 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:29,781 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:30,458 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:30,478 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:30,961 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:30,971 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:31,68 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:31,95 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:31,237 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:31,250 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:31,682 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:31,709 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:32,83 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:32,100 INFO     [learner.py:606] ====Pushing takes 0.016101837158203125 s
2021-08-18:16:12:32,134 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:32,140 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:32,140 INFO     [param_server.py:410] Lock worker 1 with localStep 191 , while globalStep is 190

2021-08-18:16:12:33,252 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:33,261 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:33,794 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:33,806 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:34,933 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:34,947 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:35,612 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:35,625 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:35,840 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:35,849 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:36,611 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:36,621 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:37,262 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:37,286 INFO     [learner.py:606] ====Pushing takes 0.02242279052734375 s
2021-08-18:16:12:37,319 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:37,326 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 11 clients
2021-08-18:16:12:37,327 INFO     [param_server.py:410] Lock worker 2 with localStep 191 , while globalStep is 190

2021-08-18:16:12:37,913 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:37,927 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:38,751 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:38,760 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:39,951 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:39,962 INFO     [learner.py:165] Start to run client 36 on rank 3...
2021-08-18:16:12:40,574 INFO     [learner.py:439] Completed to run client 36
2021-08-18:16:12:40,588 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:41,108 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:41,144 INFO     [learner.py:606] ====Pushing takes 0.035097599029541016 s
2021-08-18:16:12:41,190 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:41,198 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:41,199 INFO     [param_server.py:381] ====After aggregation in epoch: 190, virtual_clock: 6139.300839936846, top_1: : 63.1817 % (1958.0), top_5: : 100.0 % (3099.0), test loss: 2.7652573364752313, test len: 3099.0
2021-08-18:16:12:41,202 INFO     [param_server.py:410] Lock worker 3 with localStep 191 , while globalStep is 191

2021-08-18:16:12:41,202 INFO     [param_server.py:441] ====Epoch 192 completes 20 clients with loss 7.1554167378555835, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 36: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:12:41,203 INFO     [param_server.py:450] ====Start to sample for epoch 192, global virtualClock: 6139.300839936846, round_duration: 38.39602155878561
2021-08-18:16:12:41,203 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:41,557 INFO     [param_server.py:553] For epoch: 192, median_reward: 1173.9756811289456, dev: 5869.8784056447275
2021-08-18:16:12:42,261 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9984, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:12:42,265 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2597.4008, eval_time 0.6724, test_loss 2.9984, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:12:42,266 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5255, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:12:42,267 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2597.3912, eval_time 0.6742, test_loss 2.5255, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:12:42,336 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:42,344 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6568, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:12:42,345 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:42,345 INFO     [learner.py:656] After aggregation epoch 191, CumulTime 2597.4841, eval_time 0.7546, test_loss 2.6568, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:12:42,376 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:42,384 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:42,401 INFO     [learner.py:526] ====Start train round 192
2021-08-18:16:12:42,423 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:43,69 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:43,90 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:43,433 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:43,447 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:44,58 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:44,71 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:44,485 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:44,511 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:44,613 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:44,627 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:45,125 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:45,152 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:45,763 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:45,767 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:45,777 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:45,801 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:46,294 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:46,324 INFO     [learner.py:606] ====Pushing takes 0.027448177337646484 s
2021-08-18:16:12:46,360 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:46,368 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:46,369 INFO     [param_server.py:410] Lock worker 1 with localStep 192 , while globalStep is 191

2021-08-18:16:12:46,582 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:46,601 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:47,284 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:47,299 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:47,623 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:47,632 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:12:47,949 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:47,968 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:48,190 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:12:48,200 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:12:49,391 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:12:49,409 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:12:49,688 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:12:49,697 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:12:49,969 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:12:49,996 INFO     [learner.py:606] ====Pushing takes 0.02436351776123047 s
2021-08-18:16:12:50,32 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:50,40 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:12:50,41 INFO     [param_server.py:410] Lock worker 2 with localStep 192 , while globalStep is 191

2021-08-18:16:12:50,244 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:12:50,255 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:12:50,854 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:12:50,864 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:12:51,505 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:12:51,539 INFO     [learner.py:606] ====Pushing takes 0.032617807388305664 s
2021-08-18:16:12:51,575 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:51,583 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:12:51,584 INFO     [param_server.py:381] ====After aggregation in epoch: 191, virtual_clock: 6168.769653741909, top_1: : 63.7948 % (1977.0), top_5: : 100.0 % (3099.0), test loss: 2.726903321566405, test len: 3099.0
2021-08-18:16:12:51,586 INFO     [param_server.py:410] Lock worker 3 with localStep 192 , while globalStep is 192

2021-08-18:16:12:51,587 INFO     [param_server.py:441] ====Epoch 193 completes 20 clients with loss 9.117052117639473, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:12:51,587 INFO     [param_server.py:450] ====Start to sample for epoch 193, global virtualClock: 6168.769653741909, round_duration: 29.468813805062297
2021-08-18:16:12:51,588 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:12:51,882 INFO     [param_server.py:553] For epoch: 193, median_reward: 1284.5977542822754, dev: 6422.9887714113775
2021-08-18:16:12:52,479 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.84, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:12:52,482 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2607.6216, eval_time 0.5656, test_loss 2.84, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:12:52,519 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3894, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:12:52,520 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2607.645, eval_time 0.6006, test_loss 2.3894, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:12:52,524 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9787, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:12:52,524 INFO     [learner.py:656] After aggregation epoch 192, CumulTime 2607.6603, eval_time 0.6046, test_loss 2.9787, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:12:52,553 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:52,582 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:12:52,593 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:52,600 INFO     [learner.py:526] ====Start train round 193
2021-08-18:16:12:52,607 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:12:52,615 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:12:53,313 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:12:53,327 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:12:53,783 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:12:53,794 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:12:54,462 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:12:54,482 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:12:54,861 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:12:54,872 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:12:55,64 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:12:55,85 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:12:55,289 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:12:55,302 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:12:55,628 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:12:55,649 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:12:55,986 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:12:56,6 INFO     [learner.py:606] ====Pushing takes 0.018573999404907227 s
2021-08-18:16:12:56,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:12:56,43 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:12:56,44 INFO     [param_server.py:410] Lock worker 1 with localStep 193 , while globalStep is 192

2021-08-18:16:12:57,106 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:12:57,116 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:12:57,826 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:12:57,840 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:12:59,62 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:12:59,84 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:12:59,791 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:12:59,811 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:12:59,873 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:12:59,889 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:00,503 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:00,513 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:01,121 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:01,131 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:01,820 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:01,846 INFO     [learner.py:606] ====Pushing takes 0.024704694747924805 s
2021-08-18:16:13:01,889 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:01,897 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:01,897 INFO     [param_server.py:410] Lock worker 2 with localStep 193 , while globalStep is 192

2021-08-18:16:13:02,119 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:02,128 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:02,833 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:02,845 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:04,12 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:04,23 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:04,696 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:04,730 INFO     [learner.py:606] ====Pushing takes 0.03235197067260742 s
2021-08-18:16:13:04,770 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:04,781 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:04,781 INFO     [param_server.py:381] ====After aggregation in epoch: 192, virtual_clock: 6207.165675300695, top_1: : 63.7948 % (1977.0), top_5: : 100.0 % (3099.0), test loss: 2.7360198817871235, test len: 3099.0
2021-08-18:16:13:04,784 INFO     [param_server.py:410] Lock worker 3 with localStep 193 , while globalStep is 193

2021-08-18:16:13:04,785 INFO     [param_server.py:441] ====Epoch 194 completes 20 clients with loss 7.813429286801253, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:04,785 INFO     [param_server.py:450] ====Start to sample for epoch 194, global virtualClock: 6207.165675300695, round_duration: 38.39602155878561
2021-08-18:16:13:04,786 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:05,126 INFO     [param_server.py:553] For epoch: 194, median_reward: 1161.5590759150678, dev: 5807.795379575338
2021-08-18:16:13:05,771 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.424, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:13:05,773 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2620.8972, eval_time 0.6127, test_loss 2.424, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:13:05,804 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1409, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:13:05,805 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2620.9411, eval_time 0.6454, test_loss 3.1409, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:13:05,861 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:13:05,873 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:13:05,877 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:05,882 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:05,968 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8109, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:13:05,969 INFO     [learner.py:656] After aggregation epoch 193, CumulTime 2621.1078, eval_time 0.8096, test_loss 2.8109, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:13:06,37 INFO     [learner.py:526] ====Start train round 194
2021-08-18:16:13:06,67 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:07,470 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:07,481 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:07,505 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:07,525 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:08,501 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:08,514 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:08,655 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:08,665 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:09,114 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:09,141 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:09,994 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:10,20 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:10,695 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:10,722 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:11,23 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:11,38 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:11,434 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:11,454 INFO     [learner.py:606] ====Pushing takes 0.01807999610900879 s
2021-08-18:16:13:11,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:11,500 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:11,501 INFO     [param_server.py:410] Lock worker 1 with localStep 194 , while globalStep is 193

2021-08-18:16:13:11,508 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:11,524 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:12,340 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:12,354 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:13,15 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:13,33 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:14,232 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:14,242 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:15,389 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:15,400 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:15,985 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:15,995 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:16,559 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:16,568 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:17,652 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:17,662 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:17,746 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:17,764 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:18,222 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:18,256 INFO     [learner.py:606] ====Pushing takes 0.03226923942565918 s
2021-08-18:16:13:18,304 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:18,312 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:13:18,313 INFO     [param_server.py:410] Lock worker 3 with localStep 194 , while globalStep is 193

2021-08-18:16:13:18,367 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:18,393 INFO     [learner.py:606] ====Pushing takes 0.02465653419494629 s
2021-08-18:16:13:18,423 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:18,430 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:18,431 INFO     [param_server.py:381] ====After aggregation in epoch: 193, virtual_clock: 6251.532312390797, top_1: : 63.0526 % (1954.0), top_5: : 100.0 % (3099.0), test loss: 2.7919278873337636, test len: 3099.0
2021-08-18:16:13:18,433 INFO     [param_server.py:410] Lock worker 2 with localStep 194 , while globalStep is 194

2021-08-18:16:13:18,434 INFO     [param_server.py:441] ====Epoch 195 completes 20 clients with loss 6.735392915374217, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:18,434 INFO     [param_server.py:450] ====Start to sample for epoch 195, global virtualClock: 6251.532312390797, round_duration: 44.36663709010263
2021-08-18:16:13:18,435 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:18,769 INFO     [param_server.py:553] For epoch: 195, median_reward: 1047.3301767947682, dev: 5236.650883973842
2021-08-18:16:13:19,381 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6022, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:13:19,382 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2634.5184, eval_time 0.569, test_loss 2.6022, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:13:19,416 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6313, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:13:19,418 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2634.5423, eval_time 0.6036, test_loss 2.6313, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:13:19,453 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:19,463 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:19,485 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7204, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:13:19,486 INFO     [learner.py:656] After aggregation epoch 194, CumulTime 2634.6253, eval_time 0.673, test_loss 2.7204, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:13:19,487 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:19,500 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:19,543 INFO     [learner.py:526] ====Start train round 195
2021-08-18:16:13:19,568 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:20,312 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:20,332 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:20,480 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:20,489 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:21,717 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:21,737 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:21,822 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:21,832 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:22,276 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:22,290 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:22,512 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:22,539 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:23,154 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:23,181 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:23,790 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:23,811 INFO     [learner.py:606] ====Pushing takes 0.019607067108154297 s
2021-08-18:16:13:23,842 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:23,852 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:23,852 INFO     [param_server.py:410] Lock worker 1 with localStep 195 , while globalStep is 194

2021-08-18:16:13:24,9 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:24,19 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:24,584 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:24,594 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:25,841 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:25,858 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:26,540 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:26,554 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:26,863 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:26,872 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:27,603 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:27,612 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:28,209 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:28,219 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:28,838 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:28,863 INFO     [learner.py:606] ====Pushing takes 0.024367332458496094 s
2021-08-18:16:13:28,909 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:28,917 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:28,917 INFO     [param_server.py:410] Lock worker 2 with localStep 195 , while globalStep is 194

2021-08-18:16:13:29,143 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:29,153 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:29,750 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:29,760 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:30,378 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:30,388 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:30,946 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:30,979 INFO     [learner.py:606] ====Pushing takes 0.030873775482177734 s
2021-08-18:16:13:31,19 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:31,27 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:31,27 INFO     [param_server.py:381] ====After aggregation in epoch: 194, virtual_clock: 6289.928333949583, top_1: : 63.8916 % (1980.0), top_5: : 100.0 % (3099.0), test loss: 2.651303772159197, test len: 3099.0
2021-08-18:16:13:31,30 INFO     [param_server.py:410] Lock worker 3 with localStep 195 , while globalStep is 195

2021-08-18:16:13:31,31 INFO     [param_server.py:441] ====Epoch 196 completes 20 clients with loss 8.009465952694724, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:31,31 INFO     [param_server.py:450] ====Start to sample for epoch 196, global virtualClock: 6289.928333949583, round_duration: 38.39602155878561
2021-08-18:16:13:31,32 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:31,390 INFO     [param_server.py:553] For epoch: 196, median_reward: 1181.271561735139, dev: 5906.357808675694
2021-08-18:16:13:32,55 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5201, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:13:32,56 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2647.1807, eval_time 0.61, test_loss 2.5201, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:13:32,59 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1712, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:13:32,60 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2647.1964, eval_time 0.6144, test_loss 3.1712, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:13:32,127 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:32,137 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:32,144 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:32,152 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:32,209 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1479, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:13:32,225 INFO     [learner.py:656] After aggregation epoch 195, CumulTime 2647.3637, eval_time 0.7795, test_loss 3.1479, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:13:32,293 INFO     [learner.py:526] ====Start train round 196
2021-08-18:16:13:32,328 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:33,598 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:33,618 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:33,844 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:33,857 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:35,76 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:35,94 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:35,98 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:35,110 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:35,259 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:35,286 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:36,68 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:36,89 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:36,848 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:36,868 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:37,347 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:37,356 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:37,557 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:37,577 INFO     [learner.py:606] ====Pushing takes 0.018550634384155273 s
2021-08-18:16:13:37,609 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:37,616 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:37,617 INFO     [param_server.py:410] Lock worker 1 with localStep 196 , while globalStep is 195

2021-08-18:16:13:37,928 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:37,942 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:38,687 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:38,701 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:39,460 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:39,474 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:40,731 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:40,744 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:41,987 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:41,997 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:42,185 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:42,195 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:42,788 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:42,797 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:43,899 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:43,908 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:44,413 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:44,447 INFO     [learner.py:606] ====Pushing takes 0.03249764442443848 s
2021-08-18:16:13:44,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:44,501 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:13:44,501 INFO     [param_server.py:410] Lock worker 3 with localStep 196 , while globalStep is 195

2021-08-18:16:13:44,636 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:44,654 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:45,127 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:45,152 INFO     [learner.py:606] ====Pushing takes 0.02384042739868164 s
2021-08-18:16:13:45,183 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:45,191 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:45,191 INFO     [param_server.py:381] ====After aggregation in epoch: 195, virtual_clock: 6334.294971039686, top_1: : 62.3104 % (1931.0), top_5: : 100.0 % (3099.0), test loss: 2.946416755517324, test len: 3099.0
2021-08-18:16:13:45,193 INFO     [param_server.py:410] Lock worker 2 with localStep 196 , while globalStep is 196

2021-08-18:16:13:45,194 INFO     [param_server.py:441] ====Epoch 197 completes 20 clients with loss 5.51846825182007, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:45,194 INFO     [param_server.py:450] ====Start to sample for epoch 197, global virtualClock: 6334.294971039686, round_duration: 44.36663709010263
2021-08-18:16:13:45,195 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:45,539 INFO     [param_server.py:553] For epoch: 197, median_reward: 1350.8569938483938, dev: 6754.2849692419695
2021-08-18:16:13:46,142 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9765, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:13:46,143 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2661.2792, eval_time 0.5597, test_loss 2.9765, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:13:46,199 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5279, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:13:46,200 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2661.3246, eval_time 0.6132, test_loss 2.5279, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:13:46,213 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:46,222 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:46,263 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9899, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:13:46,264 INFO     [learner.py:656] After aggregation epoch 196, CumulTime 2661.4032, eval_time 0.6806, test_loss 2.9899, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:13:46,271 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:46,290 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:46,332 INFO     [learner.py:526] ====Start train round 197
2021-08-18:16:13:46,355 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:13:47,268 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:13:47,288 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:13:47,458 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:13:47,468 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:13:48,578 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:13:48,587 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:13:48,814 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:13:48,835 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:13:49,209 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:13:49,219 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:13:49,579 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:13:49,600 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:13:50,232 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:13:50,253 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:13:50,806 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:13:50,818 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:13:50,916 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:13:50,937 INFO     [learner.py:606] ====Pushing takes 0.019045591354370117 s
2021-08-18:16:13:50,966 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:50,972 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:13:50,972 INFO     [param_server.py:410] Lock worker 1 with localStep 197 , while globalStep is 196

2021-08-18:16:13:51,719 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:13:51,735 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:13:52,952 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:13:52,967 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:13:53,424 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:13:53,436 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:13:53,518 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:13:53,529 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:13:54,54 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:13:54,64 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:13:54,597 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:13:54,607 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:13:55,292 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:13:55,319 INFO     [learner.py:606] ====Pushing takes 0.024899959564208984 s
2021-08-18:16:13:55,358 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:55,366 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:13:55,367 INFO     [param_server.py:410] Lock worker 2 with localStep 197 , while globalStep is 196

2021-08-18:16:13:55,627 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:13:55,637 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:13:56,305 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:13:56,314 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:13:56,911 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:13:56,920 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:13:57,499 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:13:57,532 INFO     [learner.py:606] ====Pushing takes 0.03211522102355957 s
2021-08-18:16:13:57,572 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:13:57,580 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:13:57,581 INFO     [param_server.py:381] ====After aggregation in epoch: 196, virtual_clock: 6371.638490312747, top_1: : 63.5044 % (1968.0), top_5: : 100.0 % (3099.0), test loss: 2.8314229890152256, test len: 3099.0
2021-08-18:16:13:57,583 INFO     [param_server.py:410] Lock worker 3 with localStep 197 , while globalStep is 197

2021-08-18:16:13:57,583 INFO     [param_server.py:441] ====Epoch 198 completes 20 clients with loss 7.018573306781205, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:13:57,583 INFO     [param_server.py:450] ====Start to sample for epoch 198, global virtualClock: 6371.638490312747, round_duration: 37.343519273061496
2021-08-18:16:13:57,584 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:13:57,940 INFO     [param_server.py:553] For epoch: 198, median_reward: 1571.3952224003117, dev: 7856.976112001558
2021-08-18:16:13:58,602 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8853, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:13:58,603 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2673.7387, eval_time 0.6065, test_loss 2.8853, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:13:58,639 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7118, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:13:58,640 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2673.7644, eval_time 0.6435, test_loss 2.7118, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:13:58,671 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:58,680 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:13:58,709 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:58,718 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2284, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:16:13:58,719 INFO     [learner.py:656] After aggregation epoch 197, CumulTime 2673.8579, eval_time 0.7225, test_loss 3.2284, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:16:13:58,723 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:13:58,776 INFO     [learner.py:526] ====Start train round 198
2021-08-18:16:13:58,802 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:00,135 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:00,163 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:00,174 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:00,184 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:01,360 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:01,373 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:01,630 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:01,640 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:01,704 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:01,725 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:02,439 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:02,460 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:03,160 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:03,181 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:03,865 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:03,884 INFO     [learner.py:606] ====Pushing takes 0.01676774024963379 s
2021-08-18:16:14:03,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:03,923 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:03,924 INFO     [param_server.py:410] Lock worker 1 with localStep 198 , while globalStep is 197

2021-08-18:16:14:04,5 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:04,20 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:04,360 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:04,372 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:05,263 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:05,277 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:05,893 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:05,902 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:07,133 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:07,144 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:08,339 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:08,353 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:08,603 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:08,615 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:09,217 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:09,227 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:10,449 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:10,458 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:10,869 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:10,883 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:11,48 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:11,80 INFO     [learner.py:606] ====Pushing takes 0.030895471572875977 s
2021-08-18:16:14:11,125 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:11,134 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:14:11,135 INFO     [param_server.py:410] Lock worker 3 with localStep 198 , while globalStep is 197

2021-08-18:16:14:11,531 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:11,557 INFO     [learner.py:606] ====Pushing takes 0.024054527282714844 s
2021-08-18:16:14:11,589 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:11,597 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:11,597 INFO     [param_server.py:381] ====After aggregation in epoch: 197, virtual_clock: 6416.00512740285, top_1: : 62.8913 % (1949.0), top_5: : 100.0 % (3099.0), test loss: 2.941839112175836, test len: 3099.0
2021-08-18:16:14:11,600 INFO     [param_server.py:410] Lock worker 2 with localStep 198 , while globalStep is 198

2021-08-18:16:14:11,601 INFO     [param_server.py:441] ====Epoch 199 completes 20 clients with loss 7.344564877562864, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:11,602 INFO     [param_server.py:450] ====Start to sample for epoch 199, global virtualClock: 6416.00512740285, round_duration: 44.36663709010263
2021-08-18:16:14:11,603 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:11,945 INFO     [param_server.py:553] For epoch: 199, median_reward: 923.7796750820779, dev: 4618.898375410389
2021-08-18:16:14:12,633 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0664, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:14:12,634 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2687.7704, eval_time 0.6425, test_loss 3.0664, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:14:12,669 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0729, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:14:12,670 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2687.7944, eval_time 0.678, test_loss 3.0729, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:14:12,703 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:14:12,711 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:12,741 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:14:12,760 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:12,760 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0565, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:14:12,763 INFO     [learner.py:656] After aggregation epoch 198, CumulTime 2687.9018, eval_time 0.7731, test_loss 3.0565, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:14:12,839 INFO     [learner.py:526] ====Start train round 199
2021-08-18:16:14:12,868 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:13,761 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:13,788 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:13,861 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:13,871 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:14,849 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:14,860 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:15,120 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:15,140 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:15,463 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:15,472 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:15,939 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:15,960 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:16,652 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:16,672 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:17,55 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:17,65 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:17,295 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:17,317 INFO     [learner.py:606] ====Pushing takes 0.019855976104736328 s
2021-08-18:16:14:17,348 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:17,354 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:17,354 INFO     [param_server.py:410] Lock worker 1 with localStep 199 , while globalStep is 198

2021-08-18:16:14:17,997 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:18,15 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:19,245 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:19,254 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:19,870 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:19,883 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:19,935 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:19,945 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:20,577 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:20,587 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:21,247 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:21,256 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:21,966 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:21,992 INFO     [learner.py:606] ====Pushing takes 0.024814367294311523 s
2021-08-18:16:14:22,30 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:22,38 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:14:22,39 INFO     [param_server.py:410] Lock worker 2 with localStep 199 , while globalStep is 198

2021-08-18:16:14:22,293 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:22,302 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:23,13 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:23,22 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:23,567 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:23,581 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:24,177 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:24,210 INFO     [learner.py:606] ====Pushing takes 0.03167319297790527 s
2021-08-18:16:14:24,254 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:24,271 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:24,272 INFO     [param_server.py:381] ====After aggregation in epoch: 198, virtual_clock: 6453.348646675911, top_1: : 63.0526 % (1954.0), top_5: : 100.0 % (3099.0), test loss: 3.0652658851058394, test len: 3099.0
2021-08-18:16:14:24,275 INFO     [param_server.py:410] Lock worker 3 with localStep 199 , while globalStep is 199

2021-08-18:16:14:24,275 INFO     [param_server.py:441] ====Epoch 200 completes 20 clients with loss 6.170213412996475, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:24,276 INFO     [param_server.py:450] ====Start to sample for epoch 200, global virtualClock: 6453.348646675911, round_duration: 37.343519273061496
2021-08-18:16:14:24,277 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:24,606 INFO     [param_server.py:553] For epoch: 200, median_reward: 937.0854900842706, dev: 4685.427450421354
2021-08-18:16:14:25,286 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.174, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:14:25,287 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2700.4233, eval_time 0.6231, test_loss 3.174, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:14:25,317 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7557, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:14:25,318 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2700.443, eval_time 0.6528, test_loss 2.7557, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:14:25,357 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:25,366 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:25,409 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:25,410 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0165, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:14:25,411 INFO     [learner.py:656] After aggregation epoch 199, CumulTime 2700.5498, eval_time 0.7487, test_loss 3.0165, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:14:25,424 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:25,481 INFO     [learner.py:526] ====Start train round 200
2021-08-18:16:14:25,506 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:26,918 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:26,928 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:26,986 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:27,13 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:28,97 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:28,110 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:28,129 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:28,140 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:28,436 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:28,463 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:29,285 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:29,305 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:30,28 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:30,42 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:30,596 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:30,610 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:30,644 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:30,664 INFO     [learner.py:606] ====Pushing takes 0.01898050308227539 s
2021-08-18:16:14:30,699 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:30,705 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:30,705 INFO     [param_server.py:410] Lock worker 1 with localStep 200 , while globalStep is 199

2021-08-18:16:14:30,938 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:30,950 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:31,840 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:31,851 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:32,502 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:32,511 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:33,671 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:33,683 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:34,887 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:34,897 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:35,137 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:35,148 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:35,796 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:35,806 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:36,773 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:36,787 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:37,266 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:37,278 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:37,462 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:37,495 INFO     [learner.py:606] ====Pushing takes 0.031891584396362305 s
2021-08-18:16:14:37,540 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:37,549 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:14:37,550 INFO     [param_server.py:410] Lock worker 3 with localStep 200 , while globalStep is 199

2021-08-18:16:14:37,935 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:37,964 INFO     [learner.py:606] ====Pushing takes 0.0248262882232666 s
2021-08-18:16:14:37,994 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:38,1 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:38,2 INFO     [param_server.py:381] ====After aggregation in epoch: 199, virtual_clock: 6497.715283766014, top_1: : 63.9238 % (1981.0), top_5: : 100.0 % (3099.0), test loss: 2.982060061560736, test len: 3099.0
2021-08-18:16:14:38,4 INFO     [param_server.py:410] Lock worker 2 with localStep 200 , while globalStep is 200

2021-08-18:16:14:38,5 INFO     [param_server.py:441] ====Epoch 201 completes 20 clients with loss 6.020541273870888, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:38,5 INFO     [param_server.py:450] ====Start to sample for epoch 201, global virtualClock: 6497.715283766014, round_duration: 44.36663709010263
2021-08-18:16:14:38,6 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:38,318 INFO     [param_server.py:541] Handle Wight 0.033589839935302734 | Send 0.31272435188293457
2021-08-18:16:14:38,328 INFO     [param_server.py:553] For epoch: 201, median_reward: 975.7625446106106, dev: 4878.812723053053
2021-08-18:16:14:38,866 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3285, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:16:14:38,867 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2714.0027, eval_time 0.5134, test_loss 3.3285, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:16:14:38,868 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6656, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:14:38,869 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2713.9939, eval_time 0.5156, test_loss 2.6656, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:14:38,939 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:38,947 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:38,948 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:38,956 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9882, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:14:38,957 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:38,957 INFO     [learner.py:656] After aggregation epoch 200, CumulTime 2714.0963, eval_time 0.6061, test_loss 2.9882, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:14:39,28 INFO     [learner.py:526] ====Start train round 201
2021-08-18:16:14:39,50 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:39,896 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:39,923 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:40,29 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:40,39 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:41,178 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:41,189 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:41,284 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:41,311 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:41,633 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:41,647 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:42,80 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:42,101 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:42,826 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:42,846 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:43,350 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:43,364 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:43,564 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:43,584 INFO     [learner.py:606] ====Pushing takes 0.019150733947753906 s
2021-08-18:16:14:43,617 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:43,626 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:43,627 INFO     [param_server.py:410] Lock worker 1 with localStep 201 , while globalStep is 200

2021-08-18:16:14:44,170 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:44,179 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:45,300 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:45,310 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:46,16 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:46,26 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:46,178 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:46,187 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:14:46,849 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:14:46,858 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:14:47,454 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:14:47,464 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:14:48,135 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:14:48,163 INFO     [learner.py:606] ====Pushing takes 0.024036169052124023 s
2021-08-18:16:14:48,199 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:48,201 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:14:48,206 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:14:48,207 INFO     [param_server.py:410] Lock worker 2 with localStep 201 , while globalStep is 200

2021-08-18:16:14:48,219 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:14:48,836 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:14:48,850 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:14:49,557 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:14:49,571 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:14:50,243 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:14:50,276 INFO     [learner.py:606] ====Pushing takes 0.03174471855163574 s
2021-08-18:16:14:50,316 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:50,324 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:14:50,325 INFO     [param_server.py:381] ====After aggregation in epoch: 200, virtual_clock: 6535.058803039075, top_1: : 63.2139 % (1959.0), top_5: : 100.0 % (3099.0), test loss: 2.994073929610076, test len: 3099.0
2021-08-18:16:14:50,362 INFO     [param_server.py:410] Lock worker 3 with localStep 201 , while globalStep is 201

2021-08-18:16:14:50,362 INFO     [param_server.py:441] ====Epoch 202 completes 20 clients with loss 7.192846667084817, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:14:50,363 INFO     [param_server.py:450] ====Start to sample for epoch 202, global virtualClock: 6535.058803039075, round_duration: 37.343519273061496
2021-08-18:16:14:50,364 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:14:50,660 INFO     [param_server.py:553] For epoch: 202, median_reward: 1101.0604125769512, dev: 5505.302062884756
2021-08-18:16:14:51,358 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5926, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:14:51,359 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2726.4837, eval_time 0.6319, test_loss 2.5926, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:14:51,363 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0884, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:14:51,364 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2726.5003, eval_time 0.6372, test_loss 3.0884, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:14:51,430 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:51,438 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:14:51,448 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:51,457 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:14:51,484 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7623, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:14:51,487 INFO     [learner.py:656] After aggregation epoch 201, CumulTime 2726.6261, eval_time 0.7625, test_loss 2.7623, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:14:51,555 INFO     [learner.py:526] ====Start train round 202
2021-08-18:16:14:51,582 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:14:52,950 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:14:52,978 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:14:52,984 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:14:52,993 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:14:54,72 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:14:54,92 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:14:54,195 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:14:54,214 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:14:54,652 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:14:54,679 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:14:55,399 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:14:55,420 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:14:56,65 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:14:56,79 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:14:56,675 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:14:56,684 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:14:56,714 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:14:56,732 INFO     [learner.py:606] ====Pushing takes 0.016692638397216797 s
2021-08-18:16:14:56,762 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:14:56,769 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:14:56,769 INFO     [param_server.py:410] Lock worker 1 with localStep 202 , while globalStep is 201

2021-08-18:16:14:56,811 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:14:56,820 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:14:57,798 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:14:57,810 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:14:58,472 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:14:58,482 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:14:59,456 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:14:59,465 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:00,536 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:00,546 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:01,76 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:01,90 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:01,848 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:01,861 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:02,840 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:02,858 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:03,89 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:03,99 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:03,419 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:03,446 INFO     [learner.py:606] ====Pushing takes 0.02506279945373535 s
2021-08-18:16:15:03,485 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:03,495 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:15:03,496 INFO     [param_server.py:410] Lock worker 2 with localStep 202 , while globalStep is 201

2021-08-18:16:15:03,720 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:03,752 INFO     [learner.py:606] ====Pushing takes 0.03082585334777832 s
2021-08-18:16:15:03,784 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:03,793 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:03,794 INFO     [param_server.py:381] ====After aggregation in epoch: 201, virtual_clock: 6579.425440129178, top_1: : 64.1175 % (1987.0), top_5: : 100.0 % (3099.0), test loss: 2.8144448333316383, test len: 3099.0
2021-08-18:16:15:03,796 INFO     [param_server.py:410] Lock worker 3 with localStep 202 , while globalStep is 202

2021-08-18:16:15:03,797 INFO     [param_server.py:441] ====Epoch 203 completes 20 clients with loss 7.872003289643151, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:03,797 INFO     [param_server.py:450] ====Start to sample for epoch 203, global virtualClock: 6579.425440129178, round_duration: 44.36663709010263
2021-08-18:16:15:03,798 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:15:04,78 INFO     [param_server.py:553] For epoch: 203, median_reward: 1199.208234664706, dev: 5996.04117332353
2021-08-18:16:15:04,761 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.642, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:15:04,762 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2739.887, eval_time 0.6392, test_loss 2.642, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:15:04,777 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2297, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:15:04,778 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2739.9142, eval_time 0.6551, test_loss 3.2297, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:15:04,839 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:15:04,848 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:04,853 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:15:04,863 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:04,900 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7531, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:15:04,901 INFO     [learner.py:656] After aggregation epoch 202, CumulTime 2740.04, eval_time 0.7778, test_loss 2.7531, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:15:04,958 INFO     [learner.py:526] ====Start train round 203
2021-08-18:16:15:04,984 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:05,811 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:05,838 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:06,43 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:06,53 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:07,113 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:07,124 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:07,195 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:07,222 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:07,615 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:07,636 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:07,875 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:07,902 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:08,579 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:08,606 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:09,118 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:09,140 INFO     [learner.py:606] ====Pushing takes 0.019885540008544922 s
2021-08-18:16:15:09,172 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:09,178 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:15:09,179 INFO     [param_server.py:410] Lock worker 1 with localStep 203 , while globalStep is 202

2021-08-18:16:15:09,340 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:09,354 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:10,159 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:10,172 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:15:11,316 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:15:11,327 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:12,7 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:12,17 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:12,31 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:12,40 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:12,701 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:12,712 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:13,240 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:13,251 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:13,846 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:13,872 INFO     [learner.py:606] ====Pushing takes 0.024554967880249023 s
2021-08-18:16:15:13,906 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:13,913 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:15:13,914 INFO     [param_server.py:410] Lock worker 2 with localStep 203 , while globalStep is 202

2021-08-18:16:15:14,372 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:14,386 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:14,943 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:14,964 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:15,610 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:15,624 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:16,118 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:16,151 INFO     [learner.py:606] ====Pushing takes 0.03134584426879883 s
2021-08-18:16:15:16,186 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:16,196 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:16,197 INFO     [param_server.py:381] ====After aggregation in epoch: 202, virtual_clock: 6616.7689594022395, top_1: : 62.4395 % (1935.0), top_5: : 100.0 % (3099.0), test loss: 2.874962793456183, test len: 3099.0
2021-08-18:16:15:16,199 INFO     [param_server.py:410] Lock worker 3 with localStep 203 , while globalStep is 203

2021-08-18:16:15:16,200 INFO     [param_server.py:441] ====Epoch 204 completes 20 clients with loss 7.979041583410705, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:16,200 INFO     [param_server.py:450] ====Start to sample for epoch 204, global virtualClock: 6616.7689594022395, round_duration: 37.343519273061496
2021-08-18:16:15:16,201 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:15:16,533 INFO     [param_server.py:553] For epoch: 204, median_reward: 1170.711810161362, dev: 5853.559050806811
2021-08-18:16:15:17,201 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6859, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:15:17,202 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2752.3267, eval_time 0.6341, test_loss 2.6859, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:15:17,205 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8851, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:16:15:17,205 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2752.3415, eval_time 0.6375, test_loss 2.8851, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:16:15:17,270 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:17,275 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:17,279 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:17,283 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:17,306 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9549, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:15:17,307 INFO     [learner.py:656] After aggregation epoch 203, CumulTime 2752.4464, eval_time 0.7394, test_loss 2.9549, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:15:17,378 INFO     [learner.py:526] ====Start train round 204
2021-08-18:16:15:17,398 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:18,849 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:18,877 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:19,46 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:19,57 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:20,181 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:20,194 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:20,255 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:20,266 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:20,385 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:20,412 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:21,206 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:21,234 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:21,945 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:21,966 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:22,691 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:22,709 INFO     [learner.py:606] ====Pushing takes 0.01607346534729004 s
2021-08-18:16:15:22,739 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:22,748 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:15:22,749 INFO     [param_server.py:410] Lock worker 1 with localStep 204 , while globalStep is 203

2021-08-18:16:15:22,767 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:22,781 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:15:22,891 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:22,902 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:23,892 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:15:23,907 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:24,565 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:24,574 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:25,490 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:25,500 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:26,675 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:26,685 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:27,408 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:27,423 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:28,86 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:28,98 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:29,199 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:29,210 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:29,248 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:29,261 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:29,923 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:29,929 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:29,962 INFO     [learner.py:606] ====Pushing takes 0.03126645088195801 s
2021-08-18:16:15:29,965 INFO     [learner.py:606] ====Pushing takes 0.04065585136413574 s
2021-08-18:16:15:30,13 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:30,21 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:15:30,22 INFO     [param_server.py:410] Lock worker 2 with localStep 204 , while globalStep is 203

2021-08-18:16:15:30,46 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:30,55 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:30,56 INFO     [param_server.py:381] ====After aggregation in epoch: 203, virtual_clock: 6661.135596492342, top_1: : 62.4718 % (1936.0), top_5: : 100.0 % (3099.0), test loss: 2.8419560326470266, test len: 3099.0
2021-08-18:16:15:30,58 INFO     [param_server.py:410] Lock worker 3 with localStep 204 , while globalStep is 204

2021-08-18:16:15:30,59 INFO     [param_server.py:441] ====Epoch 205 completes 20 clients with loss 7.533932526554893, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:30,59 INFO     [param_server.py:450] ====Start to sample for epoch 205, global virtualClock: 6661.135596492342, round_duration: 44.36663709010263
2021-08-18:16:15:30,60 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 84, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119]
2021-08-18:16:15:30,339 INFO     [param_server.py:553] For epoch: 205, median_reward: 956.7057960957616, dev: 4783.528980478808
2021-08-18:16:15:30,982 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8743, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:15:30,983 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2766.1192, eval_time 0.6106, test_loss 2.8743, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:15:30,988 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.446, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:15:30,989 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2766.1136, eval_time 0.6163, test_loss 2.446, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:15:31,56 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:31,62 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:31,64 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:31,70 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:31,70 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.832, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:15:31,73 INFO     [learner.py:656] After aggregation epoch 204, CumulTime 2766.2125, eval_time 0.7007, test_loss 2.832, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:15:31,134 INFO     [learner.py:526] ====Start train round 205
2021-08-18:16:15:31,157 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:31,952 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:31,978 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:32,227 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:32,236 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:33,355 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:33,368 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:33,493 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:33,520 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:33,852 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:33,862 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:34,328 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:34,355 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:35,64 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:35,92 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:35,504 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:35,522 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:35,782 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:35,803 INFO     [learner.py:606] ====Pushing takes 0.019075632095336914 s
2021-08-18:16:15:35,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:35,841 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 5 clients
2021-08-18:16:15:35,853 INFO     [param_server.py:410] Lock worker 1 with localStep 205 , while globalStep is 204

2021-08-18:16:15:36,510 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:36,527 INFO     [learner.py:165] Start to run client 84 on rank 3...
2021-08-18:16:15:37,559 INFO     [learner.py:439] Completed to run client 84
2021-08-18:16:15:37,573 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:37,993 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:38,6 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:38,131 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:38,145 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:38,644 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:38,654 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:39,288 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:39,298 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:40,30 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:40,56 INFO     [learner.py:606] ====Pushing takes 0.02491903305053711 s
2021-08-18:16:15:40,87 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:40,97 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 12 clients
2021-08-18:16:15:40,98 INFO     [param_server.py:410] Lock worker 2 with localStep 205 , while globalStep is 204

2021-08-18:16:15:40,447 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:40,458 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:41,157 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:41,171 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:41,821 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:41,835 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:42,453 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:42,486 INFO     [learner.py:606] ====Pushing takes 0.0319523811340332 s
2021-08-18:16:15:42,536 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:42,544 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:42,544 INFO     [param_server.py:381] ====After aggregation in epoch: 204, virtual_clock: 6698.479115765404, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 2.717432546118895, test len: 3099.0
2021-08-18:16:15:42,546 INFO     [param_server.py:410] Lock worker 3 with localStep 205 , while globalStep is 205

2021-08-18:16:15:42,547 INFO     [param_server.py:441] ====Epoch 206 completes 20 clients with loss 7.45724451804941, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 79: 0, 81: 0, 84: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:42,547 INFO     [param_server.py:450] ====Start to sample for epoch 206, global virtualClock: 6698.479115765404, round_duration: 37.343519273061496
2021-08-18:16:15:42,548 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:42,832 INFO     [param_server.py:553] For epoch: 206, median_reward: 909.3672718779392, dev: 4546.836359389696
2021-08-18:16:15:43,493 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7902, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:15:43,494 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2778.6303, eval_time 0.6396, test_loss 2.7902, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:15:43,502 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5236, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:15:43,503 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2778.6277, eval_time 0.646, test_loss 2.5236, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:15:43,564 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:43,571 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:43,572 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:43,579 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:43,579 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9336, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:15:43,580 INFO     [learner.py:656] After aggregation epoch 205, CumulTime 2778.7194, eval_time 0.7255, test_loss 2.9336, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:15:43,650 INFO     [learner.py:526] ====Start train round 206
2021-08-18:16:15:43,669 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:45,292 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:45,319 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:15:45,423 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:45,432 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:46,539 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:15:46,549 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:15:46,886 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:15:46,897 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:15:47,432 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:15:47,459 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:15:48,943 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:15:48,958 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:15:48,976 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:15:48,976 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:15:49,491 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:15:49,505 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:15:49,734 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:15:49,747 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:15:49,842 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:15:49,869 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:15:50,719 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:15:50,740 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:15:51,244 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:15:51,267 INFO     [learner.py:606] ====Pushing takes 0.021915435791015625 s
2021-08-18:16:15:51,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:51,304 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:15:51,305 INFO     [param_server.py:410] Lock worker 1 with localStep 206 , while globalStep is 205

2021-08-18:16:15:52,263 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:15:52,273 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:15:52,601 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:15:52,610 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:15:53,506 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:15:53,524 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:15:53,937 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:15:53,947 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:15:55,611 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:15:55,621 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:15:55,806 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:15:55,817 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:15:56,284 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:15:56,311 INFO     [learner.py:606] ====Pushing takes 0.025806665420532227 s
2021-08-18:16:15:56,348 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:56,357 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:15:56,358 INFO     [param_server.py:410] Lock worker 3 with localStep 206 , while globalStep is 205

2021-08-18:16:15:56,567 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:15:56,595 INFO     [learner.py:606] ====Pushing takes 0.026662111282348633 s
2021-08-18:16:15:56,624 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:15:56,631 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:15:56,632 INFO     [param_server.py:381] ====After aggregation in epoch: 205, virtual_clock: 6762.901787745593, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 2.749140028600339, test len: 3099.0
2021-08-18:16:15:56,634 INFO     [param_server.py:410] Lock worker 2 with localStep 206 , while globalStep is 206

2021-08-18:16:15:56,635 INFO     [param_server.py:441] ====Epoch 207 completes 20 clients with loss 207.9236182454962, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:15:56,635 INFO     [param_server.py:450] ====Start to sample for epoch 207, global virtualClock: 6762.901787745593, round_duration: 64.42267198018864
2021-08-18:16:15:56,636 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:15:56,975 INFO     [param_server.py:553] For epoch: 207, median_reward: 1160.6137502850347, dev: 5803.068751425173
2021-08-18:16:15:57,605 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5786, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:15:57,606 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2792.7303, eval_time 0.5957, test_loss 2.5786, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:15:57,614 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8125, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:15:57,615 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2792.7508, eval_time 0.6049, test_loss 2.8125, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:15:57,686 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:57,691 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:57,695 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:15:57,702 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:15:57,704 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7095, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:15:57,705 INFO     [learner.py:656] After aggregation epoch 206, CumulTime 2792.8442, eval_time 0.6954, test_loss 2.7095, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:15:57,763 INFO     [learner.py:526] ====Start train round 207
2021-08-18:16:15:57,788 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:15:59,244 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:15:59,255 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:15:59,370 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:15:59,398 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:00,330 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:00,340 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:00,448 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:00,459 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:01,432 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:01,466 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:02,472 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:02,506 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:02,999 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:03,13 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:03,183 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:03,203 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:03,222 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:03,234 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:03,726 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:03,739 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:03,949 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:03,971 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:04,605 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:04,626 INFO     [learner.py:606] ====Pushing takes 0.020215749740600586 s
2021-08-18:16:16:04,655 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:04,664 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:04,665 INFO     [param_server.py:410] Lock worker 1 with localStep 207 , while globalStep is 206

2021-08-18:16:16:05,941 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:05,950 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:06,540 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:06,549 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:07,275 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:07,289 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:07,311 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:07,323 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:08,574 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:08,590 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:09,117 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:09,130 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:09,208 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:09,237 INFO     [learner.py:606] ====Pushing takes 0.026970863342285156 s
2021-08-18:16:16:09,276 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:09,286 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:09,287 INFO     [param_server.py:410] Lock worker 3 with localStep 207 , while globalStep is 206

2021-08-18:16:16:09,719 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:09,747 INFO     [learner.py:606] ====Pushing takes 0.026643753051757812 s
2021-08-18:16:16:09,777 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:09,784 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:09,785 INFO     [param_server.py:381] ====After aggregation in epoch: 206, virtual_clock: 6809.553649136566, top_1: : 63.2139 % (1959.0), top_5: : 100.0 % (3099.0), test loss: 2.7001791993776956, test len: 3099.0
2021-08-18:16:16:09,788 INFO     [param_server.py:410] Lock worker 2 with localStep 207 , while globalStep is 207

2021-08-18:16:16:09,789 INFO     [param_server.py:441] ====Epoch 208 completes 20 clients with loss 168.93380902484796, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:09,789 INFO     [param_server.py:450] ====Start to sample for epoch 208, global virtualClock: 6809.553649136566, round_duration: 46.65186139097271
2021-08-18:16:16:09,791 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:10,177 INFO     [param_server.py:553] For epoch: 208, median_reward: 1118.7424852044564, dev: 5593.712426022283
2021-08-18:16:16:10,833 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1172, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:16:10,834 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2805.9702, eval_time 0.6125, test_loss 3.1172, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:16:10,878 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6666, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:16:10,880 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2806.0048, eval_time 0.654, test_loss 2.6666, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:16:10,904 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:16:10,912 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:10,948 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9694, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:16:10,951 INFO     [learner.py:656] After aggregation epoch 207, CumulTime 2806.0901, eval_time 0.7293, test_loss 2.9694, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:16:10,968 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:16:10,981 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:11,7 INFO     [learner.py:526] ====Start train round 208
2021-08-18:16:16:11,30 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:12,355 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:12,376 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:12,566 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:12,576 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:13,684 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:13,695 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:13,831 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:13,843 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:14,44 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:14,71 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:14,935 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:14,962 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:15,797 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:15,818 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:16,174 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:16,187 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:16,468 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:16,488 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:16,685 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:16,696 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:16,867 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:16,882 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:17,105 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:17,127 INFO     [learner.py:606] ====Pushing takes 0.020792007446289062 s
2021-08-18:16:16:17,155 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:17,163 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:17,163 INFO     [param_server.py:410] Lock worker 1 with localStep 208 , while globalStep is 207

2021-08-18:16:16:19,393 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:19,402 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:19,588 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:19,600 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:20,325 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:20,341 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:20,649 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:20,661 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:21,521 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:21,535 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:22,29 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:22,39 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:22,155 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:22,180 INFO     [learner.py:606] ====Pushing takes 0.023724794387817383 s
2021-08-18:16:16:22,210 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:22,218 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:22,219 INFO     [param_server.py:410] Lock worker 3 with localStep 208 , while globalStep is 207

2021-08-18:16:16:23,223 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:23,248 INFO     [learner.py:606] ====Pushing takes 0.02351665496826172 s
2021-08-18:16:16:23,279 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:23,289 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:23,289 INFO     [param_server.py:381] ====After aggregation in epoch: 207, virtual_clock: 6856.2055105275385, top_1: : 64.0207 % (1984.0), top_5: : 100.0 % (3099.0), test loss: 2.9177233069031328, test len: 3099.0
2021-08-18:16:16:23,291 INFO     [param_server.py:410] Lock worker 2 with localStep 208 , while globalStep is 208

2021-08-18:16:16:23,292 INFO     [param_server.py:441] ====Epoch 209 completes 20 clients with loss 187.4638352828847, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:23,292 INFO     [param_server.py:450] ====Start to sample for epoch 209, global virtualClock: 6856.2055105275385, round_duration: 46.65186139097271
2021-08-18:16:16:23,293 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:23,637 INFO     [param_server.py:553] For epoch: 209, median_reward: 1294.2357981732346, dev: 6471.178990866173
2021-08-18:16:16:24,274 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0211, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:16:24,275 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2819.411, eval_time 0.6019, test_loss 3.0211, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:16:24,277 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9506, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:16:24,278 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2819.4026, eval_time 0.6048, test_loss 2.9506, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:16:24,343 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:24,346 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:24,352 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:24,355 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:24,404 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8203, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:16:24,406 INFO     [learner.py:656] After aggregation epoch 208, CumulTime 2819.5449, eval_time 0.7336, test_loss 2.8203, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:16:24,463 INFO     [learner.py:526] ====Start train round 209
2021-08-18:16:16:24,485 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:26,22 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:26,36 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:26,45 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:26,49 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:27,59 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:27,69 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:27,129 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:27,142 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:27,902 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:27,947 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:28,788 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:28,815 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:29,602 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:29,623 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:29,767 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:29,785 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:29,848 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:29,867 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:30,254 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:30,267 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:30,381 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:30,390 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:30,875 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:30,901 INFO     [learner.py:606] ====Pushing takes 0.02490401268005371 s
2021-08-18:16:16:30,936 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:30,942 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:30,943 INFO     [param_server.py:410] Lock worker 1 with localStep 209 , while globalStep is 208

2021-08-18:16:16:32,360 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:32,369 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:33,45 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:33,63 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:33,604 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:33,616 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:33,896 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:33,909 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:34,886 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:34,895 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:35,136 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:35,149 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:35,562 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:35,588 INFO     [learner.py:606] ====Pushing takes 0.024831295013427734 s
2021-08-18:16:16:35,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:35,636 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:35,636 INFO     [param_server.py:410] Lock worker 2 with localStep 209 , while globalStep is 208

2021-08-18:16:16:35,741 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:35,769 INFO     [learner.py:606] ====Pushing takes 0.026129961013793945 s
2021-08-18:16:16:35,800 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:35,807 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:35,808 INFO     [param_server.py:381] ====After aggregation in epoch: 208, virtual_clock: 6902.8573719185115, top_1: : 63.3753 % (1964.0), top_5: : 100.0 % (3099.0), test loss: 2.9307054943508573, test len: 3099.0
2021-08-18:16:16:35,810 INFO     [param_server.py:410] Lock worker 3 with localStep 209 , while globalStep is 209

2021-08-18:16:16:35,811 INFO     [param_server.py:441] ====Epoch 210 completes 20 clients with loss 218.7698612975033, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:35,811 INFO     [param_server.py:450] ====Start to sample for epoch 210, global virtualClock: 6902.8573719185115, round_duration: 46.65186139097271
2021-08-18:16:16:35,813 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:36,126 INFO     [param_server.py:553] For epoch: 210, median_reward: 1501.219823424992, dev: 7506.09911712496
2021-08-18:16:16:36,806 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9598, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:16:36,809 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2831.9433, eval_time 0.6468, test_loss 2.9598, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:16:36,809 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6594, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:16:36,810 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2831.9346, eval_time 0.6487, test_loss 2.6594, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:16:36,846 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8471, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:16:36,847 INFO     [learner.py:656] After aggregation epoch 209, CumulTime 2831.9862, eval_time 0.6865, test_loss 2.8471, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:16:36,879 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:36,879 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:36,888 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:36,888 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:36,917 INFO     [learner.py:526] ====Start train round 210
2021-08-18:16:16:36,938 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:38,347 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:38,374 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:38,504 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:38,513 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:39,522 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:39,532 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:39,658 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:39,670 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:39,938 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:39,966 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:40,848 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:40,881 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:41,791 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:41,817 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:42,223 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:42,230 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:42,234 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:42,244 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:42,371 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:42,391 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:42,875 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:42,890 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:42,893 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:42,915 INFO     [learner.py:606] ====Pushing takes 0.021737098693847656 s
2021-08-18:16:16:42,950 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:42,960 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:42,961 INFO     [param_server.py:410] Lock worker 1 with localStep 210 , while globalStep is 209

2021-08-18:16:16:44,872 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:44,881 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:45,495 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:45,505 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:46,154 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:46,155 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:46,163 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:46,165 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:16:47,105 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:16:47,118 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:16:47,185 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:16:47,196 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:16:47,660 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:16:47,692 INFO     [learner.py:606] ====Pushing takes 0.030835866928100586 s
2021-08-18:16:16:47,729 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:47,736 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:16:47,737 INFO     [param_server.py:410] Lock worker 3 with localStep 210 , while globalStep is 209

2021-08-18:16:16:48,404 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:16:48,433 INFO     [learner.py:606] ====Pushing takes 0.024747371673583984 s
2021-08-18:16:16:48,463 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:48,470 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:16:48,471 INFO     [param_server.py:381] ====After aggregation in epoch: 209, virtual_clock: 6949.509233309484, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 2.822120957904392, test len: 3099.0
2021-08-18:16:16:48,473 INFO     [param_server.py:410] Lock worker 2 with localStep 210 , while globalStep is 210

2021-08-18:16:16:48,474 INFO     [param_server.py:441] ====Epoch 211 completes 20 clients with loss 94.80707925735973, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:16:48,474 INFO     [param_server.py:450] ====Start to sample for epoch 211, global virtualClock: 6949.509233309484, round_duration: 46.65186139097271
2021-08-18:16:16:48,475 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:16:48,818 INFO     [param_server.py:553] For epoch: 211, median_reward: 1115.9327033696002, dev: 5579.663516848001
2021-08-18:16:16:49,420 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1346, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:16:16:49,421 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2844.5567, eval_time 0.5688, test_loss 3.1346, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:16:16:49,416 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0238, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:16:49,422 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2844.5467, eval_time 0.5678, test_loss 3.0238, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:16:49,491 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:49,491 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:49,498 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.152, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:16:49,500 INFO     [learner.py:656] After aggregation epoch 210, CumulTime 2844.6393, eval_time 0.649, test_loss 3.152, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:16:49,501 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:16:49,501 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:16:49,568 INFO     [learner.py:526] ====Start train round 211
2021-08-18:16:16:49,590 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:16:50,917 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:16:50,944 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:16:51,129 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:16:51,138 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:16:52,146 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:16:52,160 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:16:52,353 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:16:52,365 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:16:52,941 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:16:52,975 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:16:53,770 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:16:53,804 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:16:54,546 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:16:54,567 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:16:54,798 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:16:54,807 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:16:55,53 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:16:55,65 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:16:55,236 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:16:55,256 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:16:55,473 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:16:55,483 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:16:55,909 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:16:55,934 INFO     [learner.py:606] ====Pushing takes 0.023934364318847656 s
2021-08-18:16:16:55,970 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:16:55,976 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:16:55,977 INFO     [param_server.py:410] Lock worker 1 with localStep 211 , while globalStep is 210

2021-08-18:16:16:57,798 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:16:57,809 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:16:58,312 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:16:58,326 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:16:58,985 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:16:58,994 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:16:59,141 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:16:59,154 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:00,180 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:00,190 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:00,393 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:00,408 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:00,792 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:00,817 INFO     [learner.py:606] ====Pushing takes 0.02419257164001465 s
2021-08-18:16:17:00,848 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:00,855 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:00,856 INFO     [param_server.py:410] Lock worker 2 with localStep 211 , while globalStep is 210

2021-08-18:16:17:00,980 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:01,8 INFO     [learner.py:606] ====Pushing takes 0.02655172348022461 s
2021-08-18:16:17:01,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:01,45 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:01,46 INFO     [param_server.py:381] ====After aggregation in epoch: 210, virtual_clock: 6996.161094700457, top_1: : 62.3427 % (1932.0), top_5: : 100.0 % (3099.0), test loss: 3.1034554022329828, test len: 3099.0
2021-08-18:16:17:01,48 INFO     [param_server.py:410] Lock worker 3 with localStep 211 , while globalStep is 211

2021-08-18:16:17:01,49 INFO     [param_server.py:441] ====Epoch 212 completes 20 clients with loss 194.42655161188566, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:01,49 INFO     [param_server.py:450] ====Start to sample for epoch 212, global virtualClock: 6996.161094700457, round_duration: 46.65186139097271
2021-08-18:16:17:01,50 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:01,337 INFO     [param_server.py:553] For epoch: 212, median_reward: 1214.3773649157342, dev: 6071.886824578671
2021-08-18:16:17:02,31 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8781, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:17:02,32 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2857.1679, eval_time 0.6726, test_loss 2.8781, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:17:02,32 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4318, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:17:02,33 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2857.1574, eval_time 0.671, test_loss 2.4318, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:17:02,82 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7943, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:17:02,83 INFO     [learner.py:656] After aggregation epoch 211, CumulTime 2857.2222, eval_time 0.7237, test_loss 2.7943, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:17:02,101 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:17:02,101 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:17:02,110 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:02,109 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:02,153 INFO     [learner.py:526] ====Start train round 212
2021-08-18:16:17:02,170 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:03,601 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:03,628 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:03,760 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:03,770 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:04,795 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:04,810 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:04,950 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:04,960 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:05,176 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:05,202 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:06,110 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:06,143 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:06,832 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:06,859 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:07,259 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:07,269 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:07,590 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:07,602 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:07,611 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:07,632 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:07,909 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:07,922 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:08,154 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:08,177 INFO     [learner.py:606] ====Pushing takes 0.02190876007080078 s
2021-08-18:16:17:08,213 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:08,221 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:08,222 INFO     [param_server.py:410] Lock worker 1 with localStep 212 , while globalStep is 211

2021-08-18:16:17:10,270 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:10,285 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:10,775 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:10,785 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:11,376 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:11,388 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:11,477 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:11,491 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:12,522 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:12,533 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:12,736 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:12,750 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:13,437 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:13,467 INFO     [learner.py:606] ====Pushing takes 0.029195308685302734 s
2021-08-18:16:17:13,509 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:13,517 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:13,518 INFO     [param_server.py:410] Lock worker 3 with localStep 212 , while globalStep is 211

2021-08-18:16:17:13,747 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:13,772 INFO     [learner.py:606] ====Pushing takes 0.023762941360473633 s
2021-08-18:16:17:13,802 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:13,809 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:13,809 INFO     [param_server.py:381] ====After aggregation in epoch: 211, virtual_clock: 7042.81295609143, top_1: : 64.2788 % (1992.0), top_5: : 100.0 % (3099.0), test loss: 2.7013806656554897, test len: 3099.0
2021-08-18:16:17:13,812 INFO     [param_server.py:410] Lock worker 2 with localStep 212 , while globalStep is 212

2021-08-18:16:17:13,812 INFO     [param_server.py:441] ====Epoch 213 completes 20 clients with loss 201.90424796233498, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:13,812 INFO     [param_server.py:450] ====Start to sample for epoch 213, global virtualClock: 7042.81295609143, round_duration: 46.65186139097271
2021-08-18:16:17:13,813 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:14,95 INFO     [param_server.py:553] For epoch: 213, median_reward: 1397.7231678625917, dev: 6988.615839312959
2021-08-18:16:17:14,808 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7016, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:17:14,809 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2869.9446, eval_time 0.6796, test_loss 2.7016, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:17:14,809 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6645, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:16:17:14,810 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2869.9344, eval_time 0.6808, test_loss 2.6645, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:16:17:14,877 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:17:14,877 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:17:14,885 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:14,885 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:14,889 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1117, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:17:14,889 INFO     [learner.py:656] After aggregation epoch 212, CumulTime 2870.0286, eval_time 0.7604, test_loss 3.1117, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:17:14,958 INFO     [learner.py:526] ====Start train round 213
2021-08-18:16:17:14,976 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:16,432 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:16,454 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:16,577 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:16,589 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:17,758 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:17,773 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:17,854 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:17,865 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:18,549 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:18,582 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:19,218 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:19,238 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:19,952 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:19,973 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:20,113 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:20,123 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:20,545 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:20,557 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:20,799 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:20,809 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:20,819 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:20,845 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:21,412 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:21,433 INFO     [learner.py:606] ====Pushing takes 0.019316911697387695 s
2021-08-18:16:17:21,469 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:21,475 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:21,476 INFO     [param_server.py:410] Lock worker 1 with localStep 213 , while globalStep is 212

2021-08-18:16:17:23,254 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:23,266 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:23,409 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:23,437 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:24,341 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:24,362 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:24,406 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:24,419 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:25,623 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:25,638 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:25,662 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:25,673 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:26,228 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:26,254 INFO     [learner.py:606] ====Pushing takes 0.024881362915039062 s
2021-08-18:16:17:26,288 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:26,291 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:26,300 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:26,301 INFO     [param_server.py:410] Lock worker 2 with localStep 213 , while globalStep is 212

2021-08-18:16:17:26,316 INFO     [learner.py:606] ====Pushing takes 0.026581287384033203 s
2021-08-18:16:17:26,345 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:26,351 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:26,352 INFO     [param_server.py:381] ====After aggregation in epoch: 212, virtual_clock: 7089.464817482403, top_1: : 62.7299 % (1944.0), top_5: : 100.0 % (3099.0), test loss: 2.8259186711576247, test len: 3099.0
2021-08-18:16:17:26,355 INFO     [param_server.py:410] Lock worker 3 with localStep 213 , while globalStep is 213

2021-08-18:16:17:26,356 INFO     [param_server.py:441] ====Epoch 214 completes 20 clients with loss 282.66367848280134, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:26,356 INFO     [param_server.py:450] ====Start to sample for epoch 214, global virtualClock: 7089.464817482403, round_duration: 46.65186139097271
2021-08-18:16:17:26,357 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:26,659 INFO     [param_server.py:553] For epoch: 214, median_reward: 1438.3113485720285, dev: 7191.556742860143
2021-08-18:16:17:27,267 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0283, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:17:27,267 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5479, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:17:27,267 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2882.4035, eval_time 0.5747, test_loss 3.0283, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:17:27,268 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2882.3926, eval_time 0.5745, test_loss 2.5479, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:17:27,338 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:27,338 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:27,346 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:27,347 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:27,344 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0839, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:17:27,347 INFO     [learner.py:656] After aggregation epoch 213, CumulTime 2882.4865, eval_time 0.6545, test_loss 3.0839, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:17:27,426 INFO     [learner.py:526] ====Start train round 214
2021-08-18:16:17:27,445 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:28,798 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:28,818 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:29,65 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:29,80 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:30,226 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:30,240 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:30,326 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:30,335 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:30,459 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:30,479 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:31,187 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:31,207 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:31,930 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:31,958 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:32,632 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:32,653 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:32,714 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:32,723 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:33,107 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:33,116 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:33,332 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:33,354 INFO     [learner.py:606] ====Pushing takes 0.021113157272338867 s
2021-08-18:16:17:33,363 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:33,373 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:33,390 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:33,395 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:33,396 INFO     [param_server.py:410] Lock worker 1 with localStep 214 , while globalStep is 213

2021-08-18:16:17:35,963 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:35,975 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:36,73 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:36,83 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:36,934 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:36,955 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:37,66 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:37,78 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:38,270 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:38,284 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:38,303 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:38,315 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:38,924 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:38,953 INFO     [learner.py:606] ====Pushing takes 0.02749800682067871 s
2021-08-18:16:17:38,989 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:38,997 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:38,998 INFO     [param_server.py:410] Lock worker 3 with localStep 214 , while globalStep is 213

2021-08-18:16:17:39,586 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:39,614 INFO     [learner.py:606] ====Pushing takes 0.025811195373535156 s
2021-08-18:16:17:39,645 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:39,652 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:39,653 INFO     [param_server.py:381] ====After aggregation in epoch: 213, virtual_clock: 7136.116678873376, top_1: : 64.2788 % (1992.0), top_5: : 100.0 % (3099.0), test loss: 2.886713835928175, test len: 3099.0
2021-08-18:16:17:39,655 INFO     [param_server.py:410] Lock worker 2 with localStep 214 , while globalStep is 214

2021-08-18:16:17:39,656 INFO     [param_server.py:441] ====Epoch 215 completes 20 clients with loss 242.5063426575719, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:39,656 INFO     [param_server.py:450] ====Start to sample for epoch 215, global virtualClock: 7136.116678873376, round_duration: 46.65186139097271
2021-08-18:16:17:39,657 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:39,940 INFO     [param_server.py:553] For epoch: 215, median_reward: 1467.682485275057, dev: 7338.412426375285
2021-08-18:16:17:40,537 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8422, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:17:40,538 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2895.6736, eval_time 0.5611, test_loss 2.8422, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:17:40,540 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7358, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:17:40,541 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2895.6656, eval_time 0.5634, test_loss 2.7358, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:17:40,604 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:40,608 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:40,612 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:40,616 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:40,617 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4081, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:17:40,618 INFO     [learner.py:656] After aggregation epoch 214, CumulTime 2895.757, eval_time 0.6429, test_loss 3.4081, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:17:40,687 INFO     [learner.py:526] ====Start train round 215
2021-08-18:16:17:40,709 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:41,961 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:41,982 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:42,207 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:42,217 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:43,425 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:43,443 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:43,507 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:43,519 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:43,808 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:43,828 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:44,526 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:44,553 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:45,306 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:45,333 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:45,926 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:45,936 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:46,61 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:46,88 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:46,319 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:46,329 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:46,524 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:46,533 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:46,736 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:46,759 INFO     [learner.py:606] ====Pushing takes 0.02167963981628418 s
2021-08-18:16:17:46,792 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:46,800 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:46,801 INFO     [param_server.py:410] Lock worker 1 with localStep 215 , while globalStep is 214

2021-08-18:16:17:49,32 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:17:49,44 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:17:49,212 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:17:49,233 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:17:50,55 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:17:50,76 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:17:50,244 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:17:50,254 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:17:51,304 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:17:51,325 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:17:51,602 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:17:51,618 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:17:51,942 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:17:51,969 INFO     [learner.py:606] ====Pushing takes 0.02581644058227539 s
2021-08-18:16:17:52,0 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:52,7 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:17:52,8 INFO     [param_server.py:410] Lock worker 3 with localStep 215 , while globalStep is 214

2021-08-18:16:17:52,166 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:17:52,192 INFO     [learner.py:606] ====Pushing takes 0.024649858474731445 s
2021-08-18:16:17:52,224 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:52,231 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:17:52,232 INFO     [param_server.py:381] ====After aggregation in epoch: 214, virtual_clock: 7182.768540264349, top_1: : 62.504 % (1937.0), top_5: : 100.0 % (3099.0), test loss: 2.995361893265336, test len: 3099.0
2021-08-18:16:17:52,234 INFO     [param_server.py:410] Lock worker 2 with localStep 215 , while globalStep is 215

2021-08-18:16:17:52,235 INFO     [param_server.py:441] ====Epoch 216 completes 20 clients with loss 235.35264658556946, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:17:52,235 INFO     [param_server.py:450] ====Start to sample for epoch 216, global virtualClock: 7182.768540264349, round_duration: 46.65186139097271
2021-08-18:16:17:52,236 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:17:52,521 INFO     [param_server.py:553] For epoch: 216, median_reward: 973.7994409419723, dev: 4868.997204709862
2021-08-18:16:17:53,88 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.533, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:17:53,90 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2908.215, eval_time 0.5323, test_loss 2.533, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:17:53,95 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8142, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:17:53,96 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2908.2322, eval_time 0.5381, test_loss 2.8142, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:17:53,158 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:53,166 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:53,166 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:17:53,174 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:17:53,177 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9058, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:17:53,178 INFO     [learner.py:656] After aggregation epoch 215, CumulTime 2908.3174, eval_time 0.6223, test_loss 2.9058, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:17:53,249 INFO     [learner.py:526] ====Start train round 216
2021-08-18:16:17:53,269 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:17:54,594 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:17:54,603 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:17:54,633 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:17:54,654 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:17:55,766 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:17:55,776 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:17:55,814 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:17:55,825 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:17:56,51 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:17:56,64 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:17:56,759 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:17:56,773 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:17:57,557 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:17:57,577 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:17:58,117 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:17:58,127 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:17:58,320 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:17:58,341 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:17:58,631 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:17:58,641 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:17:58,786 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:17:58,795 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:17:58,875 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:17:58,896 INFO     [learner.py:606] ====Pushing takes 0.0196230411529541 s
2021-08-18:16:17:58,924 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:17:58,932 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:17:58,932 INFO     [param_server.py:410] Lock worker 1 with localStep 216 , while globalStep is 215

2021-08-18:16:18:01,343 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:01,353 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:01,483 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:01,492 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:02,245 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:02,264 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:02,612 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:02,622 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:03,401 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:03,421 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:03,878 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:03,890 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:04,81 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:04,108 INFO     [learner.py:606] ====Pushing takes 0.025394439697265625 s
2021-08-18:16:18:04,146 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:04,156 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:04,157 INFO     [param_server.py:410] Lock worker 3 with localStep 216 , while globalStep is 215

2021-08-18:16:18:05,198 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:05,224 INFO     [learner.py:606] ====Pushing takes 0.0238649845123291 s
2021-08-18:16:18:05,252 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:05,259 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:05,260 INFO     [param_server.py:381] ====After aggregation in epoch: 215, virtual_clock: 7229.420401655322, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 2.751022824534663, test len: 3099.0
2021-08-18:16:18:05,262 INFO     [param_server.py:410] Lock worker 2 with localStep 216 , while globalStep is 216

2021-08-18:16:18:05,262 INFO     [param_server.py:441] ====Epoch 217 completes 20 clients with loss 224.75146935266287, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:05,263 INFO     [param_server.py:450] ====Start to sample for epoch 217, global virtualClock: 7229.420401655322, round_duration: 46.65186139097271
2021-08-18:16:18:05,263 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:05,552 INFO     [param_server.py:553] For epoch: 217, median_reward: 963.8365719850754, dev: 4819.182859925377
2021-08-18:16:18:06,203 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8399, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:18:06,204 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2921.3402, eval_time 0.6191, test_loss 2.8399, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:18:06,225 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9126, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:18:06,226 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2921.3505, eval_time 0.6408, test_loss 2.9126, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:18:06,275 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:18:06,283 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:06,281 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7041, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:18:06,284 INFO     [learner.py:656] After aggregation epoch 216, CumulTime 2921.4234, eval_time 0.7, test_loss 2.7041, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:18:06,295 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:18:06,310 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:06,353 INFO     [learner.py:526] ====Start train round 217
2021-08-18:16:18:06,370 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:07,763 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:07,784 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:08,107 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:08,125 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:09,240 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:09,248 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:09,250 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:09,259 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:09,344 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:09,365 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:10,131 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:10,158 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:10,821 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:10,842 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:11,597 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:11,606 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:11,636 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:11,663 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:12,12 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:12,24 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:12,291 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:12,301 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:12,330 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:12,355 INFO     [learner.py:606] ====Pushing takes 0.02379131317138672 s
2021-08-18:16:18:12,383 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:12,390 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:12,391 INFO     [param_server.py:410] Lock worker 1 with localStep 217 , while globalStep is 216

2021-08-18:16:18:14,526 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:14,540 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:15,127 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:15,141 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:15,731 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:15,740 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:15,880 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:15,894 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:17,48 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:17,58 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:17,130 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:17,143 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:17,601 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:17,626 INFO     [learner.py:606] ====Pushing takes 0.02322983741760254 s
2021-08-18:16:18:17,655 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:17,662 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:17,663 INFO     [param_server.py:410] Lock worker 2 with localStep 217 , while globalStep is 216

2021-08-18:16:18:17,687 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:17,712 INFO     [learner.py:606] ====Pushing takes 0.02381420135498047 s
2021-08-18:16:18:17,742 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:17,749 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:17,750 INFO     [param_server.py:381] ====After aggregation in epoch: 216, virtual_clock: 7276.072263046295, top_1: : 63.2462 % (1960.0), top_5: : 100.0 % (3099.0), test loss: 2.8188687231805587, test len: 3099.0
2021-08-18:16:18:17,753 INFO     [param_server.py:410] Lock worker 3 with localStep 217 , while globalStep is 217

2021-08-18:16:18:17,753 INFO     [param_server.py:441] ====Epoch 218 completes 20 clients with loss 190.5752692696586, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:17,771 INFO     [param_server.py:450] ====Start to sample for epoch 218, global virtualClock: 7276.072263046295, round_duration: 46.65186139097271
2021-08-18:16:18:17,773 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:18,80 INFO     [param_server.py:553] For epoch: 218, median_reward: 1254.1204047407793, dev: 6270.6020237038965
2021-08-18:16:18:18,698 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0127, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:18:18,699 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2933.8351, eval_time 0.5858, test_loss 3.0127, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:18:18,702 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.526, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:18:18,703 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2933.8277, eval_time 0.5898, test_loss 2.526, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:18:18,734 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9689, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:18:18,735 INFO     [learner.py:656] After aggregation epoch 217, CumulTime 2933.874, eval_time 0.6216, test_loss 2.9689, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:18:18,775 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:18,782 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:18,794 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:18,805 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:18,805 INFO     [learner.py:526] ====Start train round 218
2021-08-18:16:18:18,820 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:20,85 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:20,99 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:20,501 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:20,510 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:21,452 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:21,473 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:21,547 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:21,561 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:21,564 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:21,575 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:22,338 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:22,365 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:22,987 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:23,15 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:23,785 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:23,813 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:24,57 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:24,71 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:24,280 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:24,293 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:24,540 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:24,562 INFO     [learner.py:606] ====Pushing takes 0.021108627319335938 s
2021-08-18:16:18:24,592 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:24,601 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:24,602 INFO     [param_server.py:410] Lock worker 1 with localStep 218 , while globalStep is 217

2021-08-18:16:18:24,756 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:24,765 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:26,874 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:26,888 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:27,414 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:27,433 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:28,7 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:28,17 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:28,182 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:28,196 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:29,161 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:29,171 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:29,200 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:29,211 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:29,828 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:29,856 INFO     [learner.py:606] ====Pushing takes 0.026251554489135742 s
2021-08-18:16:18:29,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:29,902 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:29,903 INFO     [param_server.py:410] Lock worker 3 with localStep 218 , while globalStep is 217

2021-08-18:16:18:30,479 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:30,506 INFO     [learner.py:606] ====Pushing takes 0.025295257568359375 s
2021-08-18:16:18:30,542 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:30,549 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:30,550 INFO     [param_server.py:381] ====After aggregation in epoch: 217, virtual_clock: 7322.724124437268, top_1: : 65.2469 % (2022.0), top_5: : 100.0 % (3099.0), test loss: 2.8358681555147522, test len: 3099.0
2021-08-18:16:18:30,553 INFO     [param_server.py:410] Lock worker 2 with localStep 218 , while globalStep is 218

2021-08-18:16:18:30,553 INFO     [param_server.py:441] ====Epoch 219 completes 20 clients with loss 184.85281967391415, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:30,554 INFO     [param_server.py:450] ====Start to sample for epoch 219, global virtualClock: 7322.724124437268, round_duration: 46.65186139097271
2021-08-18:16:18:30,555 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:30,861 INFO     [param_server.py:553] For epoch: 219, median_reward: 1365.8438786584288, dev: 6829.219393292144
2021-08-18:16:18:31,536 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8308, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:18:31,537 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2946.673, eval_time 0.6502, test_loss 2.8308, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:18:31,567 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8185, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:18:31,581 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2946.7051, eval_time 0.6928, test_loss 2.8185, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:18:31,613 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:31,620 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0298, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:18:31,621 INFO     [learner.py:656] After aggregation epoch 218, CumulTime 2946.7599, eval_time 0.736, test_loss 3.0298, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:18:31,630 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:31,647 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:31,663 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:31,687 INFO     [learner.py:526] ====Start train round 219
2021-08-18:16:18:31,709 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:33,84 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:33,119 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:33,376 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:33,385 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:34,496 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:34,508 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:34,535 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:34,545 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:35,102 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:35,129 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:36,39 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:36,66 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:36,848 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:36,869 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:36,948 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:36,958 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:37,276 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:37,286 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:37,537 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:37,546 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:37,561 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:37,582 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:38,158 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:38,183 INFO     [learner.py:606] ====Pushing takes 0.02312159538269043 s
2021-08-18:16:18:38,213 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:38,220 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:38,221 INFO     [param_server.py:410] Lock worker 1 with localStep 219 , while globalStep is 218

2021-08-18:16:18:40,113 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:40,124 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:40,432 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:40,446 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:41,136 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:41,149 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:41,358 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:41,372 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:42,515 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:42,525 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:42,565 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:42,602 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:43,161 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:43,190 INFO     [learner.py:606] ====Pushing takes 0.024033308029174805 s
2021-08-18:16:18:43,222 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:43,232 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:43,233 INFO     [param_server.py:410] Lock worker 3 with localStep 219 , while globalStep is 218

2021-08-18:16:18:43,250 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:43,278 INFO     [learner.py:606] ====Pushing takes 0.023903369903564453 s
2021-08-18:16:18:43,307 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:43,313 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:43,314 INFO     [param_server.py:381] ====After aggregation in epoch: 218, virtual_clock: 7369.375985828241, top_1: : 63.9884 % (1983.0), top_5: : 100.0 % (3099.0), test loss: 2.8930370454434993, test len: 3099.0
2021-08-18:16:18:43,317 INFO     [param_server.py:410] Lock worker 2 with localStep 219 , while globalStep is 219

2021-08-18:16:18:43,317 INFO     [param_server.py:441] ====Epoch 220 completes 20 clients with loss 184.88415996424337, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:43,318 INFO     [param_server.py:450] ====Start to sample for epoch 220, global virtualClock: 7369.375985828241, round_duration: 46.65186139097271
2021-08-18:16:18:43,319 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:43,611 INFO     [param_server.py:553] For epoch: 220, median_reward: 1638.6180732534333, dev: 8193.090366267166
2021-08-18:16:18:44,252 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7235, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:18:44,252 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2959.3883, eval_time 0.5967, test_loss 2.7235, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:18:44,288 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7874, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:16:18:44,289 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2959.4138, eval_time 0.6336, test_loss 2.7874, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:16:18:44,337 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:44,345 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:44,356 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:44,370 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:44,368 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9392, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:18:44,371 INFO     [learner.py:656] After aggregation epoch 219, CumulTime 2959.5099, eval_time 0.7151, test_loss 2.9392, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:18:44,437 INFO     [learner.py:526] ====Start train round 220
2021-08-18:16:18:44,463 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:45,847 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:45,857 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:18:45,905 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:45,926 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:47,53 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:18:47,64 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:18:47,277 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:18:47,287 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:18:47,368 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:18:47,388 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:18:48,126 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:18:48,146 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:18:48,939 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:18:48,966 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:18:49,664 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:18:49,723 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:18:49,741 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:18:49,750 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:18:49,919 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:18:49,931 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:18:50,338 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:18:50,358 INFO     [learner.py:606] ====Pushing takes 0.018994808197021484 s
2021-08-18:16:18:50,396 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:50,403 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:18:50,404 INFO     [param_server.py:410] Lock worker 1 with localStep 220 , while globalStep is 219

2021-08-18:16:18:50,417 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:18:50,427 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:18:52,726 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:18:52,736 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:18:53,250 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:18:53,268 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:18:54,35 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:18:54,48 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:18:54,79 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:18:54,89 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:18:55,309 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:18:55,319 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:18:55,319 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:18:55,328 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:18:55,834 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:18:55,861 INFO     [learner.py:606] ====Pushing takes 0.026133060455322266 s
2021-08-18:16:18:55,902 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:55,909 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:18:55,910 INFO     [param_server.py:410] Lock worker 3 with localStep 220 , while globalStep is 219

2021-08-18:16:18:56,430 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:18:56,455 INFO     [learner.py:606] ====Pushing takes 0.02391338348388672 s
2021-08-18:16:18:56,485 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:18:56,492 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:18:56,493 INFO     [param_server.py:381] ====After aggregation in epoch: 219, virtual_clock: 7416.027847219214, top_1: : 63.2785 % (1961.0), top_5: : 100.0 % (3099.0), test loss: 2.8166966217535516, test len: 3099.0
2021-08-18:16:18:56,496 INFO     [param_server.py:410] Lock worker 2 with localStep 220 , while globalStep is 220

2021-08-18:16:18:56,496 INFO     [param_server.py:441] ====Epoch 221 completes 20 clients with loss 131.37335485428014, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:18:56,496 INFO     [param_server.py:450] ====Start to sample for epoch 221, global virtualClock: 7416.027847219214, round_duration: 46.65186139097271
2021-08-18:16:18:56,497 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:18:56,771 INFO     [param_server.py:541] Handle Wight 0.03331136703491211 | Send 0.2743816375732422
2021-08-18:16:18:56,772 INFO     [param_server.py:553] For epoch: 221, median_reward: 1303.895960600535, dev: 6519.479803002676
2021-08-18:16:18:57,566 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0382, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:18:57,567 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2972.7027, eval_time 0.7503, test_loss 3.0382, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:18:57,612 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.3986, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:18:57,613 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2972.7376, eval_time 0.794, test_loss 2.3986, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:18:57,635 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:57,644 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:18:57,684 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:57,685 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7227, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:18:57,686 INFO     [learner.py:656] After aggregation epoch 220, CumulTime 2972.8252, eval_time 0.8695, test_loss 2.7227, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:18:57,700 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:18:57,743 INFO     [learner.py:526] ====Start train round 221
2021-08-18:16:18:57,769 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:18:59,140 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:18:59,160 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:18:59,448 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:18:59,458 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:00,489 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:00,499 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:00,668 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:00,678 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:01,257 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:01,284 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:01,968 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:01,988 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:02,642 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:02,662 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:02,870 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:02,886 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:03,298 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:03,319 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:03,318 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:03,334 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:03,521 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:03,530 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:04,20 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:04,45 INFO     [learner.py:606] ====Pushing takes 0.02360677719116211 s
2021-08-18:16:19:04,83 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:04,92 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:04,92 INFO     [param_server.py:410] Lock worker 1 with localStep 221 , while globalStep is 220

2021-08-18:16:19:06,83 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:06,94 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:06,509 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:06,527 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:07,192 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:07,203 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:07,297 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:07,306 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:08,384 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:08,394 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:08,668 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:08,678 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:08,984 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:09,12 INFO     [learner.py:606] ====Pushing takes 0.026801347732543945 s
2021-08-18:16:19:09,41 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:09,49 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:09,49 INFO     [param_server.py:410] Lock worker 3 with localStep 221 , while globalStep is 220

2021-08-18:16:19:09,283 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:09,310 INFO     [learner.py:606] ====Pushing takes 0.025525569915771484 s
2021-08-18:16:19:09,341 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:09,349 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:09,350 INFO     [param_server.py:381] ====After aggregation in epoch: 220, virtual_clock: 7462.679708610187, top_1: : 65.0532 % (2016.0), top_5: : 100.0 % (3099.0), test loss: 2.7198466658592224, test len: 3099.0
2021-08-18:16:19:09,352 INFO     [param_server.py:410] Lock worker 2 with localStep 221 , while globalStep is 221

2021-08-18:16:19:09,353 INFO     [param_server.py:441] ====Epoch 222 completes 20 clients with loss 102.92951102827134, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:09,353 INFO     [param_server.py:450] ====Start to sample for epoch 222, global virtualClock: 7462.679708610187, round_duration: 46.65186139097271
2021-08-18:16:19:09,354 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:09,643 INFO     [param_server.py:553] For epoch: 222, median_reward: 1245.7661251026352, dev: 6228.830625513176
2021-08-18:16:19:10,287 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8063, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:19:10,288 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2985.4241, eval_time 0.5991, test_loss 2.8063, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:19:10,335 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7373, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:19:10,336 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2985.461, eval_time 0.6474, test_loss 2.7373, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:19:10,374 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:19:10,383 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:10,407 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:19:10,410 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8411, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:19:10,420 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:10,411 INFO     [learner.py:656] After aggregation epoch 221, CumulTime 2985.5503, eval_time 0.7221, test_loss 2.8411, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:19:10,510 INFO     [learner.py:526] ====Start train round 222
2021-08-18:16:19:10,534 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:11,923 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:11,943 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:12,63 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:12,77 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:13,168 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:13,180 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:13,226 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:13,235 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:13,412 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:13,433 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:14,320 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:14,347 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:15,103 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:15,123 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:15,542 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:15,551 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:15,748 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:15,760 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:15,853 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:15,874 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:16,113 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:16,123 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:16,476 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:16,497 INFO     [learner.py:606] ====Pushing takes 0.02004075050354004 s
2021-08-18:16:19:16,532 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:16,539 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:16,540 INFO     [param_server.py:410] Lock worker 1 with localStep 222 , while globalStep is 221

2021-08-18:16:19:18,515 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:18,525 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:18,968 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:18,986 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:19,672 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:19,678 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:19,681 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:19,687 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:20,876 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:20,892 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:20,908 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:20,918 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:21,574 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:21,601 INFO     [learner.py:606] ====Pushing takes 0.025830745697021484 s
2021-08-18:16:19:21,631 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:21,638 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:21,639 INFO     [param_server.py:410] Lock worker 3 with localStep 222 , while globalStep is 221

2021-08-18:16:19:22,147 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:22,173 INFO     [learner.py:606] ====Pushing takes 0.02413153648376465 s
2021-08-18:16:19:22,203 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:22,216 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:22,217 INFO     [param_server.py:381] ====After aggregation in epoch: 221, virtual_clock: 7509.33157000116, top_1: : 63.6657 % (1973.0), top_5: : 100.0 % (3099.0), test loss: 2.794897909517642, test len: 3099.0
2021-08-18:16:19:22,234 INFO     [param_server.py:410] Lock worker 2 with localStep 222 , while globalStep is 222

2021-08-18:16:19:22,235 INFO     [param_server.py:441] ====Epoch 223 completes 20 clients with loss 104.47319396948964, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:22,235 INFO     [param_server.py:450] ====Start to sample for epoch 223, global virtualClock: 7509.33157000116, round_duration: 46.65186139097271
2021-08-18:16:19:22,236 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:22,505 INFO     [param_server.py:553] For epoch: 223, median_reward: 1062.8912027685521, dev: 5314.4560138427605
2021-08-18:16:19:23,98 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9425, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:19:23,103 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 2998.2272, eval_time 0.5625, test_loss 3.9425, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:19:23,109 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7159, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:19:23,112 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 2998.2475, eval_time 0.5716, test_loss 2.7159, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:19:23,170 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:23,178 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:23,179 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:23,181 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9944, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:19:23,185 INFO     [learner.py:656] After aggregation epoch 222, CumulTime 2998.3239, eval_time 0.645, test_loss 2.9944, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:19:23,187 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:23,251 INFO     [learner.py:526] ====Start train round 223
2021-08-18:16:19:23,271 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:24,683 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:24,694 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:24,763 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:24,791 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:25,734 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:25,749 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:25,823 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:25,834 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:26,745 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:26,772 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:27,604 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:27,625 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:28,26 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:28,36 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:28,344 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:28,364 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:28,459 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:28,470 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:28,778 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:28,787 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:29,28 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:29,49 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:29,741 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:29,765 INFO     [learner.py:606] ====Pushing takes 0.0228118896484375 s
2021-08-18:16:19:29,807 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:29,816 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:29,817 INFO     [param_server.py:410] Lock worker 1 with localStep 223 , while globalStep is 222

2021-08-18:16:19:31,178 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:31,187 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:31,711 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:31,722 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:32,387 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:32,398 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:32,424 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:32,434 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:33,643 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:33,649 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:33,654 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:33,662 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:34,219 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:34,245 INFO     [learner.py:606] ====Pushing takes 0.024524688720703125 s
2021-08-18:16:19:34,268 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:34,284 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:34,291 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:34,292 INFO     [param_server.py:410] Lock worker 2 with localStep 223 , while globalStep is 222

2021-08-18:16:19:34,296 INFO     [learner.py:606] ====Pushing takes 0.02637505531311035 s
2021-08-18:16:19:34,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:34,332 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:34,333 INFO     [param_server.py:381] ====After aggregation in epoch: 222, virtual_clock: 7555.983431392133, top_1: : 65.5695 % (2032.0), top_5: : 100.0 % (3099.0), test loss: 3.2176221167599715, test len: 3099.0
2021-08-18:16:19:34,335 INFO     [param_server.py:410] Lock worker 3 with localStep 223 , while globalStep is 223

2021-08-18:16:19:34,336 INFO     [param_server.py:441] ====Epoch 224 completes 20 clients with loss 59.74607309750032, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:34,346 INFO     [param_server.py:450] ====Start to sample for epoch 224, global virtualClock: 7555.983431392133, round_duration: 46.65186139097271
2021-08-18:16:19:34,347 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:34,681 INFO     [param_server.py:553] For epoch: 224, median_reward: 991.5473168364375, dev: 4957.7365841821875
2021-08-18:16:19:35,241 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6536, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:19:35,242 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3010.3663, eval_time 0.5237, test_loss 2.6536, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:19:35,246 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7228, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:16:19:35,247 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3010.3827, eval_time 0.5308, test_loss 2.7228, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:16:19:35,312 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:35,316 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:35,321 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:35,325 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:35,330 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7177, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:19:35,331 INFO     [learner.py:656] After aggregation epoch 223, CumulTime 3010.4701, eval_time 0.6166, test_loss 2.7177, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:19:35,404 INFO     [learner.py:526] ====Start train round 224
2021-08-18:16:19:35,427 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:36,880 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:36,901 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:37,3 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:37,15 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:38,35 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:38,46 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:38,140 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:38,150 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:38,473 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:38,507 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:39,337 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:39,371 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:40,174 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:40,194 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:40,743 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:40,752 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:40,813 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:40,833 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:40,962 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:40,972 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:41,389 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:41,413 INFO     [learner.py:606] ====Pushing takes 0.02243185043334961 s
2021-08-18:16:19:41,421 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:41,431 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:41,449 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:41,456 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:41,457 INFO     [param_server.py:410] Lock worker 1 with localStep 224 , while globalStep is 223

2021-08-18:16:19:43,550 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:43,569 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:44,251 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:44,262 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:44,699 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:44,708 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:44,868 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:44,882 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:46,29 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:46,43 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:46,84 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:46,102 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:46,569 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:46,597 INFO     [learner.py:606] ====Pushing takes 0.02593374252319336 s
2021-08-18:16:19:46,634 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:46,642 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:46,643 INFO     [param_server.py:410] Lock worker 3 with localStep 224 , while globalStep is 223

2021-08-18:16:19:47,356 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:47,383 INFO     [learner.py:606] ====Pushing takes 0.025031328201293945 s
2021-08-18:16:19:47,412 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:47,419 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:47,420 INFO     [param_server.py:381] ====After aggregation in epoch: 223, virtual_clock: 7602.635292783106, top_1: : 63.5689 % (1970.0), top_5: : 100.0 % (3099.0), test loss: 2.6980316318847515, test len: 3099.0
2021-08-18:16:19:47,423 INFO     [param_server.py:410] Lock worker 2 with localStep 224 , while globalStep is 224

2021-08-18:16:19:47,424 INFO     [param_server.py:441] ====Epoch 225 completes 20 clients with loss 131.55655638576354, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:47,424 INFO     [param_server.py:450] ====Start to sample for epoch 225, global virtualClock: 7602.635292783106, round_duration: 46.65186139097271
2021-08-18:16:19:47,425 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:19:47,779 INFO     [param_server.py:553] For epoch: 225, median_reward: 975.4587547056011, dev: 4877.293773528006
2021-08-18:16:19:48,408 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7125, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:19:48,409 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3023.5332, eval_time 0.5933, test_loss 2.7125, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:19:48,414 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9314, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:19:48,414 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3023.5505, eval_time 0.5991, test_loss 3.9314, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:19:48,446 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7669, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:19:48,449 INFO     [learner.py:656] After aggregation epoch 224, CumulTime 3023.588, eval_time 0.636, test_loss 2.7669, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:19:48,477 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:48,484 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:48,487 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:19:48,493 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:19:48,530 INFO     [learner.py:526] ====Start train round 225
2021-08-18:16:19:48,551 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:19:49,839 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:19:49,872 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:19:50,90 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:19:50,101 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:19:51,123 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:19:51,133 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:19:51,221 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:19:51,231 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:19:51,968 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:19:52,1 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:19:52,755 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:19:52,782 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:19:53,612 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:19:53,632 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:19:53,674 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:19:53,688 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:19:53,944 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:19:53,953 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:19:54,223 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:19:54,244 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:19:54,412 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:19:54,427 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:19:54,805 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:19:54,832 INFO     [learner.py:606] ====Pushing takes 0.02565765380859375 s
2021-08-18:16:19:54,871 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:54,877 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:19:54,878 INFO     [param_server.py:410] Lock worker 1 with localStep 225 , while globalStep is 224

2021-08-18:16:19:56,723 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:19:56,733 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:19:57,398 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:19:57,413 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:19:58,4 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:19:58,15 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:19:58,102 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:19:58,111 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:19:59,136 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:19:59,147 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:19:59,206 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:19:59,217 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:19:59,709 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:19:59,738 INFO     [learner.py:606] ====Pushing takes 0.027582168579101562 s
2021-08-18:16:19:59,776 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:59,783 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:19:59,784 INFO     [param_server.py:410] Lock worker 3 with localStep 225 , while globalStep is 224

2021-08-18:16:19:59,835 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:19:59,862 INFO     [learner.py:606] ====Pushing takes 0.02571558952331543 s
2021-08-18:16:19:59,894 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:19:59,901 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:19:59,902 INFO     [param_server.py:381] ====After aggregation in epoch: 224, virtual_clock: 7649.287154174079, top_1: : 64.0207 % (1984.0), top_5: : 100.0 % (3099.0), test loss: 3.1369341633937977, test len: 3099.0
2021-08-18:16:19:59,905 INFO     [param_server.py:410] Lock worker 2 with localStep 225 , while globalStep is 225

2021-08-18:16:19:59,906 INFO     [param_server.py:441] ====Epoch 226 completes 20 clients with loss 119.27579396226467, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:19:59,906 INFO     [param_server.py:450] ====Start to sample for epoch 226, global virtualClock: 7649.287154174079, round_duration: 46.65186139097271
2021-08-18:16:19:59,907 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:00,245 INFO     [param_server.py:553] For epoch: 226, median_reward: 1037.0907880040102, dev: 5185.453940020051
2021-08-18:16:20:00,913 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8798, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:20:00,913 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.794, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:20:00,914 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3036.0388, eval_time 0.6326, test_loss 2.8798, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:20:00,914 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3036.0504, eval_time 0.6332, test_loss 2.794, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:20:00,933 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0258, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:20:00,934 INFO     [learner.py:656] After aggregation epoch 225, CumulTime 3036.0732, eval_time 0.655, test_loss 3.0258, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:20:01,9 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:20:01,9 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:20:01,10 INFO     [learner.py:526] ====Start train round 226
2021-08-18:16:20:01,17 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:01,19 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:01,32 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:02,266 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:02,292 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:02,593 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:02,603 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:03,637 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:03,656 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:03,768 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:03,781 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:03,834 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:03,861 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:04,629 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:04,656 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:05,431 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:05,451 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:06,40 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:06,60 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:06,92 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:06,111 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:06,302 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:06,314 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:06,726 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:06,748 INFO     [learner.py:606] ====Pushing takes 0.021236896514892578 s
2021-08-18:16:20:06,782 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:06,790 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:06,790 INFO     [param_server.py:410] Lock worker 1 with localStep 226 , while globalStep is 225

2021-08-18:16:20:06,869 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:06,883 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:09,86 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:09,96 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:09,743 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:09,763 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:10,37 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:10,47 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:10,523 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:10,537 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:11,238 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:11,249 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:11,756 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:11,767 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:12,398 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:12,426 INFO     [learner.py:606] ====Pushing takes 0.026137113571166992 s
2021-08-18:16:20:12,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:12,471 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:12,472 INFO     [param_server.py:410] Lock worker 3 with localStep 226 , while globalStep is 225

2021-08-18:16:20:12,557 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:12,583 INFO     [learner.py:606] ====Pushing takes 0.02437448501586914 s
2021-08-18:16:20:12,612 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:12,619 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:12,619 INFO     [param_server.py:381] ====After aggregation in epoch: 225, virtual_clock: 7695.939015565052, top_1: : 63.6334 % (1972.0), top_5: : 100.0 % (3099.0), test loss: 2.8998499004929155, test len: 3099.0
2021-08-18:16:20:12,622 INFO     [param_server.py:410] Lock worker 2 with localStep 226 , while globalStep is 226

2021-08-18:16:20:12,622 INFO     [param_server.py:441] ====Epoch 227 completes 20 clients with loss 217.46574029781505, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:12,623 INFO     [param_server.py:450] ====Start to sample for epoch 227, global virtualClock: 7695.939015565052, round_duration: 46.65186139097271
2021-08-18:16:20:12,624 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:12,896 INFO     [param_server.py:553] For epoch: 227, median_reward: 1148.6805253624632, dev: 5743.402626812316
2021-08-18:16:20:13,488 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7424, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:20:13,489 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3048.6135, eval_time 0.5676, test_loss 2.7424, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:20:13,501 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8408, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:20:13,501 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3048.6375, eval_time 0.5824, test_loss 2.8408, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:20:13,546 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1359, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:20:13,547 INFO     [learner.py:656] After aggregation epoch 226, CumulTime 3048.6864, eval_time 0.6281, test_loss 3.1359, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:20:13,570 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:20:13,581 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:20:13,578 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:13,588 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:13,619 INFO     [learner.py:526] ====Start train round 227
2021-08-18:16:20:13,633 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:14,915 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:14,943 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:15,328 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:15,337 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:16,273 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:16,282 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:16,614 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:16,624 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:16,943 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:16,970 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:17,709 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:17,732 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:18,426 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:18,453 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:18,651 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:18,662 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:19,138 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:19,165 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:19,356 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:19,366 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:19,369 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:19,384 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:19,836 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:19,858 INFO     [learner.py:606] ====Pushing takes 0.020894527435302734 s
2021-08-18:16:20:19,884 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:19,890 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:19,891 INFO     [param_server.py:410] Lock worker 1 with localStep 227 , while globalStep is 226

2021-08-18:16:20:22,78 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:22,88 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:22,345 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:22,363 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:23,166 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:23,189 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:23,289 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:23,309 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:24,350 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:24,360 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:24,508 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:24,520 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:24,958 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:24,986 INFO     [learner.py:606] ====Pushing takes 0.026376724243164062 s
2021-08-18:16:20:25,28 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:25,39 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:25,40 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:25,41 INFO     [param_server.py:410] Lock worker 3 with localStep 227 , while globalStep is 226

2021-08-18:16:20:25,65 INFO     [learner.py:606] ====Pushing takes 0.02456378936767578 s
2021-08-18:16:20:25,94 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:25,101 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:25,102 INFO     [param_server.py:381] ====After aggregation in epoch: 226, virtual_clock: 7742.590876956025, top_1: : 64.8274 % (2009.0), top_5: : 100.0 % (3099.0), test loss: 2.9063858411930226, test len: 3099.0
2021-08-18:16:20:25,104 INFO     [param_server.py:410] Lock worker 2 with localStep 227 , while globalStep is 227

2021-08-18:16:20:25,104 INFO     [param_server.py:441] ====Epoch 228 completes 20 clients with loss 75.0811731729717, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:25,105 INFO     [param_server.py:450] ====Start to sample for epoch 228, global virtualClock: 7742.590876956025, round_duration: 46.65186139097271
2021-08-18:16:20:25,105 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:25,435 INFO     [param_server.py:553] For epoch: 228, median_reward: 1065.555901066337, dev: 5327.779505331684
2021-08-18:16:20:26,41 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7679, Top-1 Accuracy: 639.0/1033 (0.6186), Top-5 Accuracy: 1.0
2021-08-18:16:20:26,42 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3061.1778, eval_time 0.5834, test_loss 2.7679, test_accuracy 0.6186, test_5_accuracy 1.0 

2021-08-18:16:20:26,51 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1038, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:16:20:26,52 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3061.177, eval_time 0.5939, test_loss 3.1038, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:16:20:26,86 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.224, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:20:26,89 INFO     [learner.py:656] After aggregation epoch 227, CumulTime 3061.2281, eval_time 0.6305, test_loss 3.224, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:20:26,114 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:26,122 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:26,124 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:26,132 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:26,146 INFO     [learner.py:526] ====Start train round 228
2021-08-18:16:20:26,162 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:27,550 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:27,570 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:27,745 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:27,754 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:28,697 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:28,706 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:28,986 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:28,998 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:29,169 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:29,196 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:30,77 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:30,105 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:30,821 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:30,848 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:31,189 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:31,198 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:31,586 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:31,596 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:31,606 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:31,613 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:31,735 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:31,744 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:32,324 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:32,347 INFO     [learner.py:606] ====Pushing takes 0.02184605598449707 s
2021-08-18:16:20:32,382 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:32,389 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:32,390 INFO     [param_server.py:410] Lock worker 1 with localStep 228 , while globalStep is 227

2021-08-18:16:20:34,548 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:34,557 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:34,661 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:34,675 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:35,363 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:35,377 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:35,719 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:35,730 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:36,580 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:36,589 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:36,997 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:37,8 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:37,153 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:37,183 INFO     [learner.py:606] ====Pushing takes 0.0284726619720459 s
2021-08-18:16:20:37,224 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:37,231 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:37,232 INFO     [param_server.py:410] Lock worker 3 with localStep 228 , while globalStep is 227

2021-08-18:16:20:38,140 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:38,165 INFO     [learner.py:606] ====Pushing takes 0.024351119995117188 s
2021-08-18:16:20:38,194 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:38,201 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:38,202 INFO     [param_server.py:381] ====After aggregation in epoch: 227, virtual_clock: 7789.242738346998, top_1: : 62.5686 % (1939.0), top_5: : 100.0 % (3099.0), test loss: 3.031887350259004, test len: 3099.0
2021-08-18:16:20:38,204 INFO     [param_server.py:410] Lock worker 2 with localStep 228 , while globalStep is 228

2021-08-18:16:20:38,205 INFO     [param_server.py:441] ====Epoch 229 completes 20 clients with loss 306.507080946518, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:38,205 INFO     [param_server.py:450] ====Start to sample for epoch 229, global virtualClock: 7789.242738346998, round_duration: 46.65186139097271
2021-08-18:16:20:38,206 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:38,483 INFO     [param_server.py:553] For epoch: 229, median_reward: 944.9681120629508, dev: 4724.840560314754
2021-08-18:16:20:39,35 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8416, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:20:39,36 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3074.172, eval_time 0.5284, test_loss 2.8416, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:20:39,83 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8304, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:20:39,84 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3074.2235, eval_time 0.5788, test_loss 2.8304, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:20:39,105 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:39,112 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:39,149 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5902, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:20:39,150 INFO     [learner.py:656] After aggregation epoch 228, CumulTime 3074.2746, eval_time 0.6419, test_loss 2.5902, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:20:39,153 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:39,166 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:39,219 INFO     [learner.py:526] ====Start train round 229
2021-08-18:16:20:39,228 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:40,537 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:40,563 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:40,832 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:40,844 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:41,960 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:41,970 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:42,19 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:42,32 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:42,525 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:42,559 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:43,318 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:43,345 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:44,151 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:44,168 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:44,169 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:44,201 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:44,722 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:44,734 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:44,861 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:44,875 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:44,963 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:44,997 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:45,546 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:45,568 INFO     [learner.py:606] ====Pushing takes 0.020747661590576172 s
2021-08-18:16:20:45,605 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:45,613 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:45,614 INFO     [param_server.py:410] Lock worker 1 with localStep 229 , while globalStep is 228

2021-08-18:16:20:47,391 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:47,403 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:20:48,12 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:20:48,24 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:20:48,704 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:20:48,714 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:20:48,728 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:20:48,740 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:20:49,917 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:20:49,927 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:20:50,99 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:20:50,109 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:20:50,479 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:20:50,506 INFO     [learner.py:606] ====Pushing takes 0.02573537826538086 s
2021-08-18:16:20:50,544 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:50,551 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:20:50,552 INFO     [param_server.py:410] Lock worker 3 with localStep 229 , while globalStep is 228

2021-08-18:16:20:50,711 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:20:50,738 INFO     [learner.py:606] ====Pushing takes 0.025698423385620117 s
2021-08-18:16:20:50,766 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:50,775 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:20:50,775 INFO     [param_server.py:381] ====After aggregation in epoch: 228, virtual_clock: 7835.894599737971, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 2.7540752313755177, test len: 3099.0
2021-08-18:16:20:50,778 INFO     [param_server.py:410] Lock worker 2 with localStep 229 , while globalStep is 229

2021-08-18:16:20:50,779 INFO     [param_server.py:441] ====Epoch 230 completes 20 clients with loss 84.6482052407935, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:20:50,779 INFO     [param_server.py:450] ====Start to sample for epoch 230, global virtualClock: 7835.894599737971, round_duration: 46.65186139097271
2021-08-18:16:20:50,780 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:20:51,104 INFO     [param_server.py:553] For epoch: 230, median_reward: 1065.4768821013115, dev: 5327.384410506557
2021-08-18:16:20:51,866 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1779, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:16:20:51,868 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3087.0035, eval_time 0.7382, test_loss 3.1779, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:16:20:51,870 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2972, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:16:20:51,871 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3086.9958, eval_time 0.7419, test_loss 3.2972, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:16:20:51,906 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0817, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:16:20:51,907 INFO     [learner.py:656] After aggregation epoch 229, CumulTime 3087.0463, eval_time 0.7803, test_loss 3.0817, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:16:20:51,935 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:51,940 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:51,943 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:20:51,947 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:20:51,963 INFO     [learner.py:526] ====Start train round 230
2021-08-18:16:20:51,977 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:20:53,317 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:20:53,344 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:20:53,671 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:20:53,681 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:20:54,709 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:20:54,718 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:20:54,725 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:20:54,737 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:20:55,31 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:20:55,65 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:20:55,980 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:20:56,13 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:20:56,763 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:20:56,796 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:20:57,13 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:20:57,28 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:20:57,249 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:20:57,259 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:20:57,570 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:20:57,603 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:20:57,713 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:20:57,727 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:20:58,160 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:20:58,183 INFO     [learner.py:606] ====Pushing takes 0.021158933639526367 s
2021-08-18:16:20:58,210 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:20:58,217 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:20:58,217 INFO     [param_server.py:410] Lock worker 1 with localStep 230 , while globalStep is 229

2021-08-18:16:20:59,968 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:20:59,977 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:00,726 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:00,736 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:01,274 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:01,284 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:01,408 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:01,418 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:02,377 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:02,389 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:02,614 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:02,624 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:03,365 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:03,397 INFO     [learner.py:606] ====Pushing takes 0.026534557342529297 s
2021-08-18:16:21:03,432 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:03,442 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:03,442 INFO     [param_server.py:410] Lock worker 3 with localStep 230 , while globalStep is 229

2021-08-18:16:21:03,674 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:03,705 INFO     [learner.py:606] ====Pushing takes 0.027107715606689453 s
2021-08-18:16:21:03,734 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:03,741 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:03,742 INFO     [param_server.py:381] ====After aggregation in epoch: 229, virtual_clock: 7882.5464611289435, top_1: : 61.6328 % (1910.0), top_5: : 100.0 % (3099.0), test loss: 3.1856202284495034, test len: 3099.0
2021-08-18:16:21:03,744 INFO     [param_server.py:410] Lock worker 2 with localStep 230 , while globalStep is 230

2021-08-18:16:21:03,745 INFO     [param_server.py:441] ====Epoch 231 completes 20 clients with loss 108.00202075227575, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:03,745 INFO     [param_server.py:450] ====Start to sample for epoch 231, global virtualClock: 7882.5464611289435, round_duration: 46.65186139097271
2021-08-18:16:21:03,746 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:04,46 INFO     [param_server.py:553] For epoch: 231, median_reward: 1170.3303849839822, dev: 5851.651924919911
2021-08-18:16:21:04,735 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0515, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:21:04,736 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3099.8719, eval_time 0.6657, test_loss 3.0515, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:21:04,742 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7038, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:21:04,742 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3099.867, eval_time 0.6717, test_loss 2.7038, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:21:04,778 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1707, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:21:04,781 INFO     [learner.py:656] After aggregation epoch 230, CumulTime 3099.9207, eval_time 0.7135, test_loss 3.1707, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:21:04,804 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:21:04,808 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:21:04,814 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:04,816 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:04,856 INFO     [learner.py:526] ====Start train round 231
2021-08-18:16:21:04,871 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:06,338 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:06,365 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:06,546 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:06,557 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:07,560 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:07,575 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:07,738 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:07,750 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:08,481 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:08,515 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:09,382 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:09,415 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:10,143 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:10,153 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:10,230 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:10,256 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:10,330 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:10,340 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:10,909 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:10,929 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:11,0 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:11,27 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:11,668 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:11,693 INFO     [learner.py:606] ====Pushing takes 0.024215221405029297 s
2021-08-18:16:21:11,724 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:11,735 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:11,735 INFO     [param_server.py:410] Lock worker 1 with localStep 231 , while globalStep is 230

2021-08-18:16:21:13,217 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:13,236 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:13,876 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:13,885 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:14,401 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:14,410 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:14,527 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:14,538 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:15,617 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:15,626 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:15,824 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:15,835 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:16,207 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:16,232 INFO     [learner.py:606] ====Pushing takes 0.023557424545288086 s
2021-08-18:16:21:16,261 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:16,268 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:16,268 INFO     [param_server.py:410] Lock worker 2 with localStep 231 , while globalStep is 230

2021-08-18:16:21:16,399 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:16,425 INFO     [learner.py:606] ====Pushing takes 0.024232149124145508 s
2021-08-18:16:21:16,453 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:16,460 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:16,461 INFO     [param_server.py:381] ====After aggregation in epoch: 230, virtual_clock: 7929.1983225199165, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 2.9753325956839105, test len: 3099.0
2021-08-18:16:21:16,463 INFO     [param_server.py:410] Lock worker 3 with localStep 231 , while globalStep is 231

2021-08-18:16:21:16,464 INFO     [param_server.py:441] ====Epoch 232 completes 20 clients with loss 227.91891367956538, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:16,464 INFO     [param_server.py:450] ====Start to sample for epoch 232, global virtualClock: 7929.1983225199165, round_duration: 46.65186139097271
2021-08-18:16:21:16,465 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:16,748 INFO     [param_server.py:553] For epoch: 232, median_reward: 1239.3942862962692, dev: 6196.971431481346
2021-08-18:16:21:17,402 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6498, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:21:17,402 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8306, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:21:17,403 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3112.528, eval_time 0.6327, test_loss 2.6498, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:21:17,404 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3112.5401, eval_time 0.6334, test_loss 2.8306, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:21:17,446 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9483, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:21:17,447 INFO     [learner.py:656] After aggregation epoch 231, CumulTime 3112.5858, eval_time 0.676, test_loss 2.9483, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:21:17,471 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:21:17,480 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:17,487 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:21:17,496 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:17,515 INFO     [learner.py:526] ====Start train round 232
2021-08-18:16:21:17,531 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:18,713 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:18,740 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:18,969 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:18,982 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:20,23 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:20,51 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:20,130 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:20,142 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:20,544 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:20,577 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:21,509 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:21,549 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:22,349 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:22,376 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:22,468 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:22,478 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:22,749 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:22,760 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:23,83 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:23,118 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:23,119 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:23,138 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:23,763 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:23,787 INFO     [learner.py:606] ====Pushing takes 0.022606849670410156 s
2021-08-18:16:21:23,820 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:23,828 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:23,829 INFO     [param_server.py:410] Lock worker 1 with localStep 232 , while globalStep is 231

2021-08-18:16:21:25,647 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:25,657 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:26,276 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:26,295 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:26,770 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:26,784 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:26,967 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:26,982 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:28,102 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:28,114 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:28,146 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:28,157 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:28,775 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:28,804 INFO     [learner.py:606] ====Pushing takes 0.02688312530517578 s
2021-08-18:16:21:28,836 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:28,845 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:28,853 INFO     [param_server.py:410] Lock worker 3 with localStep 232 , while globalStep is 231

2021-08-18:16:21:29,461 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:29,489 INFO     [learner.py:606] ====Pushing takes 0.024449586868286133 s
2021-08-18:16:21:29,519 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:29,526 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:29,527 INFO     [param_server.py:381] ====After aggregation in epoch: 231, virtual_clock: 7975.850183910889, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 2.809558943465904, test len: 3099.0
2021-08-18:16:21:29,529 INFO     [param_server.py:410] Lock worker 2 with localStep 232 , while globalStep is 232

2021-08-18:16:21:29,529 INFO     [param_server.py:441] ====Epoch 233 completes 20 clients with loss 88.46433304578326, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:29,529 INFO     [param_server.py:450] ====Start to sample for epoch 233, global virtualClock: 7975.850183910889, round_duration: 46.65186139097271
2021-08-18:16:21:29,530 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:29,886 INFO     [param_server.py:553] For epoch: 233, median_reward: 1144.959022339245, dev: 5724.795111696225
2021-08-18:16:21:30,686 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9769, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:21:30,687 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3125.8233, eval_time 0.7792, test_loss 2.9769, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:21:30,688 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5282, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:21:30,689 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3125.8134, eval_time 0.7807, test_loss 2.5282, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:21:30,758 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:30,758 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:30,765 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:30,766 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:30,812 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1985, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:21:30,813 INFO     [learner.py:656] After aggregation epoch 232, CumulTime 3125.9523, eval_time 0.905, test_loss 3.1985, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:21:30,892 INFO     [learner.py:526] ====Start train round 233
2021-08-18:16:21:30,915 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:32,367 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:32,376 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:32,381 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:32,408 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:33,633 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:33,648 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:33,712 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:33,731 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:34,433 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:34,460 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:35,164 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:35,191 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:36,3 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:36,17 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:36,70 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:36,97 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:36,407 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:36,428 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:36,686 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:36,695 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:36,721 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:36,735 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:37,291 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:37,317 INFO     [learner.py:606] ====Pushing takes 0.02409839630126953 s
2021-08-18:16:21:37,352 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:37,359 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:37,360 INFO     [param_server.py:410] Lock worker 1 with localStep 233 , while globalStep is 232

2021-08-18:16:21:39,110 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:39,124 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:39,249 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:39,264 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:40,33 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:40,47 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:40,287 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:40,296 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:41,275 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:41,284 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:41,525 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:41,536 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:42,3 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:42,30 INFO     [learner.py:606] ====Pushing takes 0.026151180267333984 s
2021-08-18:16:21:42,59 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:42,67 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:42,68 INFO     [param_server.py:410] Lock worker 3 with localStep 233 , while globalStep is 232

2021-08-18:16:21:42,90 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:42,117 INFO     [learner.py:606] ====Pushing takes 0.025340557098388672 s
2021-08-18:16:21:42,147 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:42,154 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:42,155 INFO     [param_server.py:381] ====After aggregation in epoch: 232, virtual_clock: 8022.502045301862, top_1: : 64.9242 % (2012.0), top_5: : 100.0 % (3099.0), test loss: 2.9011730441340693, test len: 3099.0
2021-08-18:16:21:42,158 INFO     [param_server.py:410] Lock worker 2 with localStep 233 , while globalStep is 233

2021-08-18:16:21:42,158 INFO     [param_server.py:441] ====Epoch 234 completes 20 clients with loss 93.98230109004325, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:42,159 INFO     [param_server.py:450] ====Start to sample for epoch 234, global virtualClock: 8022.502045301862, round_duration: 46.65186139097271
2021-08-18:16:21:42,160 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:42,501 INFO     [param_server.py:553] For epoch: 234, median_reward: 1151.498664071948, dev: 5757.49332035974
2021-08-18:16:21:43,95 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.6753, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:21:43,96 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3138.2318, eval_time 0.5604, test_loss 2.6753, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:21:43,140 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5486, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:21:43,145 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3138.2691, eval_time 0.609, test_loss 2.5486, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:21:43,166 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:43,175 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:43,214 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:43,216 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7687, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:21:43,220 INFO     [learner.py:656] After aggregation epoch 233, CumulTime 3138.359, eval_time 0.6848, test_loss 2.7687, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:21:43,221 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:43,292 INFO     [learner.py:526] ====Start train round 234
2021-08-18:16:21:43,316 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:44,809 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:44,842 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:44,843 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:44,852 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:46,144 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:46,158 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:46,203 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:46,215 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:21:46,489 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:21:46,517 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:21:47,372 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:21:47,399 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:21:48,134 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:21:48,161 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:21:48,651 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:21:48,661 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:21:48,690 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:21:48,705 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:21:48,992 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:21:49,1 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:21:49,204 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:21:49,225 INFO     [learner.py:606] ====Pushing takes 0.019610166549682617 s
2021-08-18:16:21:49,231 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:21:49,241 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:21:49,255 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:49,265 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:21:49,265 INFO     [param_server.py:410] Lock worker 1 with localStep 234 , while globalStep is 233

2021-08-18:16:21:51,614 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:21:51,625 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:21:51,981 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:21:51,992 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:21:52,710 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:21:52,724 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:21:52,784 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:21:52,795 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:21:53,923 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:21:53,937 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:21:54,51 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:21:54,62 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:21:54,558 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:21:54,585 INFO     [learner.py:606] ====Pushing takes 0.02534651756286621 s
2021-08-18:16:21:54,625 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:54,633 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:21:54,634 INFO     [param_server.py:410] Lock worker 3 with localStep 234 , while globalStep is 233

2021-08-18:16:21:55,168 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:21:55,195 INFO     [learner.py:606] ====Pushing takes 0.025712966918945312 s
2021-08-18:16:21:55,227 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:21:55,235 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:21:55,236 INFO     [param_server.py:381] ====After aggregation in epoch: 233, virtual_clock: 8069.153906692835, top_1: : 64.6015 % (2002.0), top_5: : 100.0 % (3099.0), test loss: 2.6642348457265785, test len: 3099.0
2021-08-18:16:21:55,238 INFO     [param_server.py:410] Lock worker 2 with localStep 234 , while globalStep is 234

2021-08-18:16:21:55,239 INFO     [param_server.py:441] ====Epoch 235 completes 20 clients with loss 148.96995859709583, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:21:55,239 INFO     [param_server.py:450] ====Start to sample for epoch 235, global virtualClock: 8069.153906692835, round_duration: 46.65186139097271
2021-08-18:16:21:55,240 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:21:55,578 INFO     [param_server.py:553] For epoch: 235, median_reward: 1021.0936477000894, dev: 5105.468238500447
2021-08-18:16:21:56,307 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0268, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:21:56,308 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3151.4437, eval_time 0.6854, test_loss 3.0268, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:21:56,342 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5866, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:21:56,343 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3151.468, eval_time 0.7211, test_loss 2.5866, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:21:56,379 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:56,388 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:21:56,413 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:56,422 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3934, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:21:56,423 INFO     [learner.py:656] After aggregation epoch 234, CumulTime 3151.5619, eval_time 0.8004, test_loss 3.3934, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:21:56,425 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:21:56,482 INFO     [learner.py:526] ====Start train round 235
2021-08-18:16:21:56,507 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:21:58,43 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:21:58,58 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:21:58,73 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:21:58,100 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:21:59,139 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:21:59,154 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:21:59,306 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:21:59,315 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:00,178 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:00,200 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:01,31 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:01,45 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:01,683 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:01,693 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:01,697 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:01,703 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:01,984 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:01,994 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:02,356 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:02,358 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:02,366 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:02,372 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:02,983 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:03,12 INFO     [learner.py:606] ====Pushing takes 0.025087833404541016 s
2021-08-18:16:22:03,57 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:03,64 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:03,64 INFO     [param_server.py:410] Lock worker 1 with localStep 235 , while globalStep is 234

2021-08-18:16:22:04,574 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:04,585 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:05,13 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:05,27 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:05,781 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:05,790 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:05,859 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:05,870 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:06,986 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:06,997 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:07,203 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:07,213 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:07,660 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:07,686 INFO     [learner.py:606] ====Pushing takes 0.024171829223632812 s
2021-08-18:16:22:07,723 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:07,730 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:07,732 INFO     [param_server.py:410] Lock worker 2 with localStep 235 , while globalStep is 234

2021-08-18:16:22:07,905 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:07,933 INFO     [learner.py:606] ====Pushing takes 0.026317596435546875 s
2021-08-18:16:22:07,962 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:07,969 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:07,970 INFO     [param_server.py:381] ====After aggregation in epoch: 234, virtual_clock: 8115.805768083808, top_1: : 64.666 % (2004.0), top_5: : 100.0 % (3099.0), test loss: 3.0022803368391813, test len: 3099.0
2021-08-18:16:22:07,973 INFO     [param_server.py:410] Lock worker 3 with localStep 235 , while globalStep is 235

2021-08-18:16:22:07,973 INFO     [param_server.py:441] ====Epoch 236 completes 20 clients with loss 90.62380956750978, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:07,974 INFO     [param_server.py:450] ====Start to sample for epoch 236, global virtualClock: 8115.805768083808, round_duration: 46.65186139097271
2021-08-18:16:22:07,975 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:08,305 INFO     [param_server.py:553] For epoch: 236, median_reward: 1088.6065277359023, dev: 5443.032638679511
2021-08-18:16:22:08,936 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7728, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:22:08,937 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3164.0727, eval_time 0.5958, test_loss 2.7728, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:22:08,982 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6113, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:22:08,983 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3164.1079, eval_time 0.6415, test_loss 2.6113, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:22:09,26 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:22:09,35 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:09,57 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9375, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:22:09,58 INFO     [learner.py:656] After aggregation epoch 235, CumulTime 3164.1969, eval_time 0.7184, test_loss 2.9375, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:22:09,77 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:22:09,90 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:09,127 INFO     [learner.py:526] ====Start train round 236
2021-08-18:16:22:09,160 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:10,567 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:10,594 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:10,783 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:10,794 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:11,932 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:11,943 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:12,45 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:12,65 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:12,145 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:12,172 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:12,908 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:12,926 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:13,597 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:13,612 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:14,298 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:14,307 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:14,417 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:14,427 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:14,593 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:14,606 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:14,924 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:14,947 INFO     [learner.py:606] ====Pushing takes 0.021889925003051758 s
2021-08-18:16:22:14,990 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:14,997 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:14,997 INFO     [param_server.py:410] Lock worker 1 with localStep 236 , while globalStep is 235

2021-08-18:16:22:15,50 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:15,59 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:17,335 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:17,346 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:17,750 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:17,762 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:18,353 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:18,363 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:18,401 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:18,411 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:19,593 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:19,602 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:19,633 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:19,642 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:20,294 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:20,323 INFO     [learner.py:606] ====Pushing takes 0.02756977081298828 s
2021-08-18:16:22:20,379 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:20,387 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:20,388 INFO     [param_server.py:410] Lock worker 3 with localStep 236 , while globalStep is 235

2021-08-18:16:22:20,873 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:20,904 INFO     [learner.py:606] ====Pushing takes 0.029447555541992188 s
2021-08-18:16:22:20,936 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:20,943 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:20,944 INFO     [param_server.py:381] ====After aggregation in epoch: 235, virtual_clock: 8162.457629474781, top_1: : 64.5692 % (2001.0), top_5: : 100.0 % (3099.0), test loss: 2.773866289191776, test len: 3099.0
2021-08-18:16:22:20,946 INFO     [param_server.py:410] Lock worker 2 with localStep 236 , while globalStep is 236

2021-08-18:16:22:20,947 INFO     [param_server.py:441] ====Epoch 237 completes 20 clients with loss 204.2470064073361, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:20,947 INFO     [param_server.py:450] ====Start to sample for epoch 237, global virtualClock: 8162.457629474781, round_duration: 46.65186139097271
2021-08-18:16:22:20,948 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:21,278 INFO     [param_server.py:553] For epoch: 237, median_reward: 1075.9182176413167, dev: 5379.591088206584
2021-08-18:16:22:21,960 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8805, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:22:21,961 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3177.0971, eval_time 0.6178, test_loss 2.8805, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:22:21,989 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5585, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:22:21,991 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3177.1151, eval_time 0.647, test_loss 2.5585, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:22:22,42 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:22,50 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:22,69 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:22,82 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:22,99 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9106, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:22:22,100 INFO     [learner.py:656] After aggregation epoch 236, CumulTime 3177.2395, eval_time 0.7569, test_loss 2.9106, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:22:22,169 INFO     [learner.py:526] ====Start train round 237
2021-08-18:16:22:22,199 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:23,504 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:23,515 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:23,552 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:23,579 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:24,558 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:24,569 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:25,34 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:25,47 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:25,324 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:25,338 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:25,962 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:25,976 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:26,682 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:26,696 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:27,263 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:27,272 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:27,375 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:27,385 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:27,450 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:27,462 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:27,986 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:28,10 INFO     [learner.py:606] ====Pushing takes 0.022815942764282227 s
2021-08-18:16:22:28,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:28,57 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:28,58 INFO     [param_server.py:410] Lock worker 1 with localStep 237 , while globalStep is 236

2021-08-18:16:22:28,132 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:28,143 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:29,969 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:29,979 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:30,740 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:30,751 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:31,124 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:31,133 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:31,337 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:31,347 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:32,471 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:32,481 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:32,725 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:32,740 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:32,983 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:33,12 INFO     [learner.py:606] ====Pushing takes 0.024483680725097656 s
2021-08-18:16:22:33,63 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:33,71 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:33,72 INFO     [param_server.py:410] Lock worker 2 with localStep 237 , while globalStep is 236

2021-08-18:16:22:33,365 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:33,393 INFO     [learner.py:606] ====Pushing takes 0.026726484298706055 s
2021-08-18:16:22:33,422 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:33,428 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:33,429 INFO     [param_server.py:381] ====After aggregation in epoch: 236, virtual_clock: 8209.109490865754, top_1: : 64.6338 % (2003.0), top_5: : 100.0 % (3099.0), test loss: 2.7831997297428273, test len: 3099.0
2021-08-18:16:22:33,431 INFO     [param_server.py:410] Lock worker 3 with localStep 237 , while globalStep is 237

2021-08-18:16:22:33,432 INFO     [param_server.py:441] ====Epoch 238 completes 20 clients with loss 213.84026085914724, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:33,432 INFO     [param_server.py:450] ====Start to sample for epoch 238, global virtualClock: 8209.109490865754, round_duration: 46.65186139097271
2021-08-18:16:22:33,433 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:33,769 INFO     [param_server.py:553] For epoch: 238, median_reward: 1151.8435354354867, dev: 5759.217677177434
2021-08-18:16:22:34,453 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2309, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:22:34,454 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3189.5901, eval_time 0.6301, test_loss 3.2309, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:22:34,500 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6612, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:22:34,501 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3189.6257, eval_time 0.6768, test_loss 2.6612, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:22:34,523 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:34,532 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:34,572 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:34,585 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:34,616 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0043, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:22:34,617 INFO     [learner.py:656] After aggregation epoch 237, CumulTime 3189.7561, eval_time 0.793, test_loss 3.0043, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:22:34,677 INFO     [learner.py:526] ====Start train round 238
2021-08-18:16:22:34,713 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:36,30 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:36,44 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:36,143 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:36,163 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:37,140 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:37,151 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:37,201 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:37,215 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:37,442 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:37,462 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:38,257 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:38,276 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:38,846 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:38,860 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:39,438 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:39,448 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:39,498 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:39,507 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:39,738 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:39,748 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:40,57 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:40,67 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:40,132 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:40,156 INFO     [learner.py:606] ====Pushing takes 0.022754430770874023 s
2021-08-18:16:22:40,195 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:40,202 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:40,202 INFO     [param_server.py:410] Lock worker 1 with localStep 238 , while globalStep is 237

2021-08-18:16:22:42,478 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:42,489 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:42,733 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:42,742 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:43,382 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:43,394 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:43,684 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:43,693 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:44,614 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:44,628 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:44,921 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:44,931 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:45,313 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:45,340 INFO     [learner.py:606] ====Pushing takes 0.026449203491210938 s
2021-08-18:16:22:45,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:45,389 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:45,389 INFO     [param_server.py:410] Lock worker 3 with localStep 238 , while globalStep is 237

2021-08-18:16:22:46,40 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:46,67 INFO     [learner.py:606] ====Pushing takes 0.02497410774230957 s
2021-08-18:16:22:46,104 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:46,111 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:46,112 INFO     [param_server.py:381] ====After aggregation in epoch: 237, virtual_clock: 8255.761352256726, top_1: : 64.1175 % (1987.0), top_5: : 100.0 % (3099.0), test loss: 2.965465073232297, test len: 3099.0
2021-08-18:16:22:46,115 INFO     [param_server.py:410] Lock worker 2 with localStep 238 , while globalStep is 238

2021-08-18:16:22:46,116 INFO     [param_server.py:441] ====Epoch 239 completes 20 clients with loss 133.14883183812503, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:46,116 INFO     [param_server.py:450] ====Start to sample for epoch 239, global virtualClock: 8255.761352256726, round_duration: 46.65186139097271
2021-08-18:16:22:46,117 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:46,455 INFO     [param_server.py:553] For epoch: 239, median_reward: 1154.5198443686634, dev: 5772.599221843317
2021-08-18:16:22:47,242 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7261, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:22:47,244 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3202.3797, eval_time 0.731, test_loss 2.7261, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:22:47,283 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.4725, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:22:47,284 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3202.4087, eval_time 0.7707, test_loss 2.4725, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:22:47,312 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:47,320 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:47,354 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:47,370 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:47,402 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6233, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:22:47,403 INFO     [learner.py:656] After aggregation epoch 238, CumulTime 3202.5419, eval_time 0.8919, test_loss 2.6233, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:22:47,471 INFO     [learner.py:526] ====Start train round 239
2021-08-18:16:22:47,503 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:22:48,896 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:22:48,922 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:22:48,924 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:22:48,934 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:22:50,84 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:22:50,95 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:22:50,104 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:22:50,113 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:22:50,654 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:22:50,668 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:22:51,403 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:22:51,417 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:22:51,977 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:22:51,991 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:22:52,443 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:22:52,452 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:22:52,569 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:22:52,578 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:22:52,804 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:22:52,818 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:22:53,71 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:22:53,81 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:22:53,161 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:22:53,186 INFO     [learner.py:606] ====Pushing takes 0.02115154266357422 s
2021-08-18:16:22:53,222 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:53,229 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:22:53,230 INFO     [param_server.py:410] Lock worker 1 with localStep 239 , while globalStep is 238

2021-08-18:16:22:55,558 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:22:55,568 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:22:55,833 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:22:55,845 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:22:56,552 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:22:56,566 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:22:56,779 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:22:56,789 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:22:57,749 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:22:57,763 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:22:58,82 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:22:58,118 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:22:58,382 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:22:58,409 INFO     [learner.py:606] ====Pushing takes 0.025804996490478516 s
2021-08-18:16:22:58,444 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:58,451 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:22:58,452 INFO     [param_server.py:410] Lock worker 3 with localStep 239 , while globalStep is 238

2021-08-18:16:22:58,633 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:22:58,659 INFO     [learner.py:606] ====Pushing takes 0.02432990074157715 s
2021-08-18:16:22:58,691 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:22:58,698 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:22:58,699 INFO     [param_server.py:381] ====After aggregation in epoch: 238, virtual_clock: 8302.413213647698, top_1: : 65.8922 % (2042.0), top_5: : 100.0 % (3099.0), test loss: 2.6072779913191444, test len: 3099.0
2021-08-18:16:22:58,701 INFO     [param_server.py:410] Lock worker 2 with localStep 239 , while globalStep is 239

2021-08-18:16:22:58,702 INFO     [param_server.py:441] ====Epoch 240 completes 20 clients with loss 193.3914457820622, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:22:58,702 INFO     [param_server.py:450] ====Start to sample for epoch 240, global virtualClock: 8302.413213647698, round_duration: 46.65186139097271
2021-08-18:16:22:58,703 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:22:59,29 INFO     [param_server.py:553] For epoch: 240, median_reward: 1092.5708258646443, dev: 5462.854129323222
2021-08-18:16:22:59,643 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7705, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:22:59,644 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3214.7799, eval_time 0.5704, test_loss 2.7705, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:22:59,682 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.543, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:22:59,683 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3214.8075, eval_time 0.6093, test_loss 2.543, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:22:59,711 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:59,721 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:22:59,749 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:59,765 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:22:59,793 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.779, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:22:59,794 INFO     [learner.py:656] After aggregation epoch 239, CumulTime 3214.9329, eval_time 0.7201, test_loss 2.779, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:22:59,850 INFO     [learner.py:526] ====Start train round 240
2021-08-18:16:22:59,875 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:01,304 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:01,331 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:01,468 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:01,478 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:02,617 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:02,639 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:02,650 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:02,671 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:02,917 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:02,938 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:03,692 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:03,707 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:04,444 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:04,458 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:05,17 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:05,29 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:05,38 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:05,47 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:05,404 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:05,413 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:05,559 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:05,583 INFO     [learner.py:606] ====Pushing takes 0.022703886032104492 s
2021-08-18:16:23:05,607 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:05,618 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:05,623 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:05,632 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:05,633 INFO     [param_server.py:410] Lock worker 1 with localStep 240 , while globalStep is 239

2021-08-18:16:23:08,123 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:08,138 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:08,308 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:08,319 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:09,111 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:09,125 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:09,253 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:09,267 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:10,304 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:10,314 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:10,538 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:10,549 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:10,955 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:10,981 INFO     [learner.py:606] ====Pushing takes 0.025729656219482422 s
2021-08-18:16:23:11,19 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:11,26 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:11,27 INFO     [param_server.py:410] Lock worker 3 with localStep 240 , while globalStep is 239

2021-08-18:16:23:11,750 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:11,775 INFO     [learner.py:606] ====Pushing takes 0.023786544799804688 s
2021-08-18:16:23:11,804 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:11,812 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:11,813 INFO     [param_server.py:381] ====After aggregation in epoch: 239, virtual_clock: 8349.06507503867, top_1: : 64.8919 % (2011.0), top_5: : 100.0 % (3099.0), test loss: 2.697496321466234, test len: 3099.0
2021-08-18:16:23:11,815 INFO     [param_server.py:410] Lock worker 2 with localStep 240 , while globalStep is 240

2021-08-18:16:23:11,816 INFO     [param_server.py:441] ====Epoch 241 completes 20 clients with loss 126.99719362189013, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:11,816 INFO     [param_server.py:450] ====Start to sample for epoch 241, global virtualClock: 8349.06507503867, round_duration: 46.65186139097271
2021-08-18:16:23:11,817 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:12,164 INFO     [param_server.py:541] Handle Wight 0.03346538543701172 | Send 0.34740614891052246
2021-08-18:16:23:12,165 INFO     [param_server.py:553] For epoch: 241, median_reward: 1005.258287903151, dev: 5026.291439515755
2021-08-18:16:23:13,50 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0221, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:23:13,51 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3228.1874, eval_time 0.8301, test_loss 3.0221, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:23:13,60 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5595, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:23:13,60 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3228.1848, eval_time 0.8378, test_loss 2.5595, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:23:13,120 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:23:13,127 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:23:13,128 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:13,136 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:13,156 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9138, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:23:13,158 INFO     [learner.py:656] After aggregation epoch 240, CumulTime 3228.2974, eval_time 0.9389, test_loss 2.9138, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:23:13,227 INFO     [learner.py:526] ====Start train round 241
2021-08-18:16:23:13,251 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:14,685 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:14,687 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:14,697 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:14,713 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:15,822 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:15,836 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:15,838 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:15,856 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:16,512 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:16,526 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:17,146 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:17,167 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:17,832 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:17,878 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:18,188 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:18,198 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:18,556 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:18,566 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:18,593 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:18,607 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:18,806 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:18,816 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:19,138 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:19,160 INFO     [learner.py:606] ====Pushing takes 0.020608186721801758 s
2021-08-18:16:23:19,190 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:19,197 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:19,198 INFO     [param_server.py:410] Lock worker 1 with localStep 241 , while globalStep is 240

2021-08-18:16:23:21,200 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:21,212 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:21,537 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:21,547 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:22,132 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:22,144 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:22,544 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:22,553 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:23,272 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:23,294 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:23,723 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:23,737 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:23,995 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:24,23 INFO     [learner.py:606] ====Pushing takes 0.026856422424316406 s
2021-08-18:16:23:24,58 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:24,68 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:24,69 INFO     [param_server.py:410] Lock worker 3 with localStep 241 , while globalStep is 240

2021-08-18:16:23:24,441 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:24,468 INFO     [learner.py:606] ====Pushing takes 0.025109529495239258 s
2021-08-18:16:23:24,498 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:24,505 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:24,506 INFO     [param_server.py:381] ====After aggregation in epoch: 240, virtual_clock: 8395.716936429642, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 2.8317832240351923, test len: 3099.0
2021-08-18:16:23:24,508 INFO     [param_server.py:410] Lock worker 2 with localStep 241 , while globalStep is 241

2021-08-18:16:23:24,509 INFO     [param_server.py:441] ====Epoch 242 completes 20 clients with loss 77.9585737936899, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:24,509 INFO     [param_server.py:450] ====Start to sample for epoch 242, global virtualClock: 8395.716936429642, round_duration: 46.65186139097271
2021-08-18:16:23:24,510 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:24,851 INFO     [param_server.py:553] For epoch: 242, median_reward: 1115.1788217386502, dev: 5575.894108693251
2021-08-18:16:23:25,408 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1905, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:23:25,410 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3240.5455, eval_time 0.5241, test_loss 3.1905, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:23:25,435 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9076, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:23:25,436 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3240.561, eval_time 0.5499, test_loss 2.9076, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:23:25,479 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:25,487 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:25,505 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:25,513 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:25,549 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6857, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:23:25,550 INFO     [learner.py:656] After aggregation epoch 241, CumulTime 3240.6895, eval_time 0.6653, test_loss 2.6857, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:23:25,608 INFO     [learner.py:526] ====Start train round 242
2021-08-18:16:23:25,631 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:27,207 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:27,234 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:27,261 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:27,271 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:28,427 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:28,447 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:28,470 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:28,489 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:28,760 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:28,787 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:29,510 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:29,530 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:30,225 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:30,246 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:30,781 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:30,795 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:30,796 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:30,806 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:31,177 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:31,190 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:31,384 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:31,388 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:31,395 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:31,414 INFO     [learner.py:606] ====Pushing takes 0.02436518669128418 s
2021-08-18:16:23:31,451 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:31,463 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:31,464 INFO     [param_server.py:410] Lock worker 1 with localStep 242 , while globalStep is 241

2021-08-18:16:23:33,967 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:33,977 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:33,996 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:34,6 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:34,600 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:34,610 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:35,9 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:35,18 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:35,752 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:35,769 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:36,334 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:36,343 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:36,429 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:36,457 INFO     [learner.py:606] ====Pushing takes 0.027250051498413086 s
2021-08-18:16:23:36,502 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:36,510 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:36,511 INFO     [param_server.py:410] Lock worker 3 with localStep 242 , while globalStep is 241

2021-08-18:16:23:37,474 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:37,500 INFO     [learner.py:606] ====Pushing takes 0.024673938751220703 s
2021-08-18:16:23:37,543 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:37,551 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:37,552 INFO     [param_server.py:381] ====After aggregation in epoch: 241, virtual_clock: 8442.368797820614, top_1: : 66.2149 % (2052.0), top_5: : 100.0 % (3099.0), test loss: 2.9279268891723067, test len: 3099.0
2021-08-18:16:23:37,555 INFO     [param_server.py:410] Lock worker 2 with localStep 242 , while globalStep is 242

2021-08-18:16:23:37,556 INFO     [param_server.py:441] ====Epoch 243 completes 20 clients with loss 90.05272539622624, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:37,556 INFO     [param_server.py:450] ====Start to sample for epoch 243, global virtualClock: 8442.368797820614, round_duration: 46.65186139097271
2021-08-18:16:23:37,557 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:37,909 INFO     [param_server.py:553] For epoch: 243, median_reward: 1298.1236541927024, dev: 6490.618270963512
2021-08-18:16:23:38,590 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6968, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:23:38,591 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3253.7152, eval_time 0.6387, test_loss 2.6968, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:23:38,592 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8675, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:23:38,592 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3253.7283, eval_time 0.6404, test_loss 2.8675, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:23:38,659 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:38,661 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:38,667 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:38,671 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:38,714 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0188, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:23:38,717 INFO     [learner.py:656] After aggregation epoch 242, CumulTime 3253.8558, eval_time 0.7647, test_loss 3.0188, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:23:38,786 INFO     [learner.py:526] ====Start train round 243
2021-08-18:16:23:38,812 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:40,354 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:40,358 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:40,370 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:40,387 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:41,471 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:41,485 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:41,734 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:41,745 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:42,485 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:42,505 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:43,142 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:43,160 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:43,746 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:43,756 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:44,46 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:44,58 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:44,385 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:44,395 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:44,499 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:44,526 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:44,675 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:44,684 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:45,58 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:45,80 INFO     [learner.py:606] ====Pushing takes 0.020569324493408203 s
2021-08-18:16:23:45,122 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:45,132 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:45,133 INFO     [param_server.py:410] Lock worker 1 with localStep 243 , while globalStep is 242

2021-08-18:16:23:47,238 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:47,247 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:23:47,350 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:23:47,365 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:23:48,135 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:23:48,153 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:23:48,462 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:23:48,473 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:23:49,444 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:23:49,454 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:23:49,712 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:23:49,723 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:23:50,98 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:23:50,126 INFO     [learner.py:606] ====Pushing takes 0.02647256851196289 s
2021-08-18:16:23:50,167 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:50,174 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:23:50,175 INFO     [param_server.py:410] Lock worker 3 with localStep 243 , while globalStep is 242

2021-08-18:16:23:50,393 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:23:50,419 INFO     [learner.py:606] ====Pushing takes 0.02461695671081543 s
2021-08-18:16:23:50,448 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:50,455 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:23:50,456 INFO     [param_server.py:381] ====After aggregation in epoch: 242, virtual_clock: 8489.020659211586, top_1: : 63.9884 % (1983.0), top_5: : 100.0 % (3099.0), test loss: 2.8610383625383733, test len: 3099.0
2021-08-18:16:23:50,458 INFO     [param_server.py:410] Lock worker 2 with localStep 243 , while globalStep is 243

2021-08-18:16:23:50,459 INFO     [param_server.py:441] ====Epoch 244 completes 20 clients with loss 109.78365753230796, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:23:50,459 INFO     [param_server.py:450] ====Start to sample for epoch 244, global virtualClock: 8489.020659211586, round_duration: 46.65186139097271
2021-08-18:16:23:50,460 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:23:50,802 INFO     [param_server.py:553] For epoch: 244, median_reward: 1016.201168446341, dev: 5081.005842231705
2021-08-18:16:23:51,458 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8963, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:23:51,459 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3266.5837, eval_time 0.6001, test_loss 2.8963, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:23:51,466 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7439, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:23:51,467 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3266.6033, eval_time 0.61, test_loss 2.7439, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:23:51,526 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:51,534 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:23:51,536 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:51,545 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:23:51,622 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7562, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:23:51,623 INFO     [learner.py:656] After aggregation epoch 243, CumulTime 3266.7623, eval_time 0.7664, test_loss 2.7562, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:23:51,680 INFO     [learner.py:526] ====Start train round 244
2021-08-18:16:23:51,706 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:23:53,47 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:23:53,59 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:23:53,340 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:23:53,374 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:23:54,190 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:23:54,204 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:23:54,282 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:23:54,300 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:23:54,854 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:23:54,868 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:23:55,534 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:23:55,544 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:23:56,67 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:23:56,77 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:23:56,661 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:23:56,672 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:23:56,680 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:23:56,690 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:23:56,973 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:23:56,985 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:23:57,302 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:23:57,324 INFO     [learner.py:606] ====Pushing takes 0.020623445510864258 s
2021-08-18:16:23:57,368 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:23:57,375 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:23:57,376 INFO     [param_server.py:410] Lock worker 1 with localStep 244 , while globalStep is 243

2021-08-18:16:23:57,378 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:23:57,389 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:23:59,737 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:23:59,746 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:00,30 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:00,45 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:00,788 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:00,803 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:01,38 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:01,52 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:01,841 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:01,852 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:02,366 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:02,379 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:02,437 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:02,464 INFO     [learner.py:606] ====Pushing takes 0.026004791259765625 s
2021-08-18:16:24:02,503 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:02,510 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:02,511 INFO     [param_server.py:410] Lock worker 3 with localStep 244 , while globalStep is 243

2021-08-18:16:24:03,509 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:03,543 INFO     [learner.py:606] ====Pushing takes 0.026952266693115234 s
2021-08-18:16:24:03,574 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:03,584 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:03,584 INFO     [param_server.py:381] ====After aggregation in epoch: 243, virtual_clock: 8535.672520602559, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 2.7987962983272694, test len: 3099.0
2021-08-18:16:24:03,587 INFO     [param_server.py:410] Lock worker 2 with localStep 244 , while globalStep is 244

2021-08-18:16:24:03,587 INFO     [param_server.py:441] ====Epoch 245 completes 20 clients with loss 170.33415042140604, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:03,588 INFO     [param_server.py:450] ====Start to sample for epoch 245, global virtualClock: 8535.672520602559, round_duration: 46.65186139097271
2021-08-18:16:24:03,589 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:03,929 INFO     [param_server.py:553] For epoch: 245, median_reward: 1244.5213468627246, dev: 6222.606734313623
2021-08-18:16:24:04,463 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5601, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:24:04,467 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3279.5912, eval_time 0.4913, test_loss 2.5601, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:24:04,475 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2135, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:24:04,476 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3279.6119, eval_time 0.5007, test_loss 3.2135, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:24:04,534 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:24:04,543 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:04,547 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:24:04,555 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:04,620 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6979, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:24:04,625 INFO     [learner.py:656] After aggregation epoch 244, CumulTime 3279.7639, eval_time 0.6516, test_loss 2.6979, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:24:04,682 INFO     [learner.py:526] ====Start train round 245
2021-08-18:16:24:04,712 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:06,35 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:06,50 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:06,262 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:06,282 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:07,233 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:07,244 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:07,260 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:07,274 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:07,942 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:07,975 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:08,669 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:08,679 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:09,338 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:09,347 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:09,658 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:09,668 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:09,954 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:09,967 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:10,40 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:10,50 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:10,256 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:10,265 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:10,553 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:10,577 INFO     [learner.py:606] ====Pushing takes 0.022481679916381836 s
2021-08-18:16:24:10,619 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:10,626 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:10,626 INFO     [param_server.py:410] Lock worker 1 with localStep 245 , while globalStep is 244

2021-08-18:16:24:12,785 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:12,799 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:13,24 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:13,43 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:13,738 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:13,748 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:13,928 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:13,937 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:14,917 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:14,926 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:15,153 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:15,164 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:15,595 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:15,622 INFO     [learner.py:606] ====Pushing takes 0.026003599166870117 s
2021-08-18:16:24:15,659 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:15,666 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:15,666 INFO     [param_server.py:410] Lock worker 3 with localStep 245 , while globalStep is 244

2021-08-18:16:24:15,762 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:15,787 INFO     [learner.py:606] ====Pushing takes 0.02437448501586914 s
2021-08-18:16:24:15,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:15,824 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:15,825 INFO     [param_server.py:381] ====After aggregation in epoch: 244, virtual_clock: 8582.32438199353, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 2.823838496649707, test len: 3099.0
2021-08-18:16:24:15,828 INFO     [param_server.py:410] Lock worker 2 with localStep 245 , while globalStep is 245

2021-08-18:16:24:15,828 INFO     [param_server.py:441] ====Epoch 246 completes 20 clients with loss 155.34570793607529, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:15,829 INFO     [param_server.py:450] ====Start to sample for epoch 246, global virtualClock: 8582.32438199353, round_duration: 46.65186139097271
2021-08-18:16:24:15,830 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:16,162 INFO     [param_server.py:553] For epoch: 246, median_reward: 946.0185860471769, dev: 4730.0929302358845
2021-08-18:16:24:16,834 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9534, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:24:16,835 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3291.9709, eval_time 0.6288, test_loss 2.9534, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:24:16,878 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6438, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:24:16,879 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3292.0036, eval_time 0.6728, test_loss 2.6438, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:24:16,902 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:24:16,911 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:16,948 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:24:16,953 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5165, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:24:16,955 INFO     [learner.py:656] After aggregation epoch 245, CumulTime 3292.0938, eval_time 0.7485, test_loss 3.5165, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:24:16,962 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:17,22 INFO     [learner.py:526] ====Start train round 246
2021-08-18:16:24:17,48 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:18,501 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:18,527 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:18,680 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:18,689 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:19,783 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:19,797 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:19,846 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:19,857 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:19,995 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:20,15 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:20,733 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:20,747 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:21,565 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:21,579 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:22,186 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:22,200 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:22,219 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:22,229 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:22,494 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:22,504 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:22,756 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:22,780 INFO     [learner.py:606] ====Pushing takes 0.023323535919189453 s
2021-08-18:16:24:22,821 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:22,830 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:22,831 INFO     [param_server.py:410] Lock worker 1 with localStep 246 , while globalStep is 245

2021-08-18:16:24:22,861 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:22,875 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:25,291 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:25,305 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:25,744 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:25,756 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:26,369 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:26,379 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:26,428 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:26,438 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:27,507 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:27,518 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:27,601 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:27,612 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:28,205 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:28,232 INFO     [learner.py:606] ====Pushing takes 0.02584052085876465 s
2021-08-18:16:24:28,261 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:28,268 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:28,269 INFO     [param_server.py:410] Lock worker 3 with localStep 246 , while globalStep is 245

2021-08-18:16:24:28,801 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:28,828 INFO     [learner.py:606] ====Pushing takes 0.02530813217163086 s
2021-08-18:16:24:28,856 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:28,870 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:28,871 INFO     [param_server.py:381] ====After aggregation in epoch: 245, virtual_clock: 8628.976243384503, top_1: : 64.9887 % (2014.0), top_5: : 100.0 % (3099.0), test loss: 3.037866327497694, test len: 3099.0
2021-08-18:16:24:28,873 INFO     [param_server.py:410] Lock worker 2 with localStep 246 , while globalStep is 246

2021-08-18:16:24:28,874 INFO     [param_server.py:441] ====Epoch 247 completes 20 clients with loss 304.64957747568013, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:28,874 INFO     [param_server.py:450] ====Start to sample for epoch 247, global virtualClock: 8628.976243384503, round_duration: 46.65186139097271
2021-08-18:16:24:28,875 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:29,194 INFO     [param_server.py:553] For epoch: 247, median_reward: 1215.9132532174954, dev: 6079.566266087477
2021-08-18:16:24:29,847 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8989, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:24:29,848 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3304.9839, eval_time 0.617, test_loss 2.8989, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:24:29,852 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7035, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:24:29,853 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3304.9776, eval_time 0.6196, test_loss 2.7035, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:24:29,916 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:29,922 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:29,921 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7688, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:24:29,925 INFO     [learner.py:656] After aggregation epoch 246, CumulTime 3305.064, eval_time 0.6962, test_loss 2.7688, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:24:29,926 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:29,931 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:29,993 INFO     [learner.py:526] ====Start train round 247
2021-08-18:16:24:30,12 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:31,407 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:31,427 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:31,639 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:31,648 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:32,690 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:32,704 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:33,12 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:33,30 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:33,458 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:33,478 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:34,139 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:34,159 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:34,896 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:34,917 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:35,11 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:35,26 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:35,623 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:35,637 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:35,693 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:35,708 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:35,867 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:35,878 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:36,218 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:36,245 INFO     [learner.py:606] ====Pushing takes 0.025759458541870117 s
2021-08-18:16:24:36,280 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:36,286 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:36,287 INFO     [param_server.py:410] Lock worker 1 with localStep 247 , while globalStep is 246

2021-08-18:16:24:38,456 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:38,472 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:38,538 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:38,548 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:39,79 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:39,89 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:39,791 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:39,807 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:40,522 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:40,531 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:41,85 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:41,96 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:41,139 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:41,166 INFO     [learner.py:606] ====Pushing takes 0.026263952255249023 s
2021-08-18:16:24:41,197 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:41,206 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:41,207 INFO     [param_server.py:410] Lock worker 3 with localStep 247 , while globalStep is 246

2021-08-18:16:24:41,595 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:41,621 INFO     [learner.py:606] ====Pushing takes 0.024622678756713867 s
2021-08-18:16:24:41,650 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:41,657 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:41,658 INFO     [param_server.py:381] ====After aggregation in epoch: 246, virtual_clock: 8675.628104775475, top_1: : 65.021 % (2015.0), top_5: : 100.0 % (3099.0), test loss: 2.790414831704563, test len: 3099.0
2021-08-18:16:24:41,661 INFO     [param_server.py:410] Lock worker 2 with localStep 247 , while globalStep is 247

2021-08-18:16:24:41,662 INFO     [param_server.py:441] ====Epoch 248 completes 20 clients with loss 248.7774349942827, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:41,662 INFO     [param_server.py:450] ====Start to sample for epoch 248, global virtualClock: 8675.628104775475, round_duration: 46.65186139097271
2021-08-18:16:24:41,663 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:41,946 INFO     [param_server.py:553] For epoch: 248, median_reward: 1175.2801556399206, dev: 5876.400778199603
2021-08-18:16:24:42,638 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5753, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:24:42,639 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3317.7632, eval_time 0.656, test_loss 2.5753, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:24:42,641 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.814, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:24:42,642 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3317.7776, eval_time 0.6598, test_loss 2.814, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:24:42,706 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:42,709 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:42,714 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:42,715 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.79, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:24:42,716 INFO     [learner.py:656] After aggregation epoch 247, CumulTime 3317.8556, eval_time 0.7363, test_loss 2.79, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:24:42,717 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:42,786 INFO     [learner.py:526] ====Start train round 248
2021-08-18:16:24:42,805 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:44,194 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:44,208 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:44,517 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:44,528 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:45,574 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:45,589 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:45,730 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:45,741 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:45,763 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:45,796 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:46,462 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:46,482 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:24:47,232 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:24:47,259 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:24:47,925 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:24:47,952 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:24:47,968 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:24:47,989 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:24:48,372 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:24:48,387 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:24:48,573 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:24:48,596 INFO     [learner.py:606] ====Pushing takes 0.020955562591552734 s
2021-08-18:16:24:48,630 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:48,636 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:24:48,637 INFO     [param_server.py:410] Lock worker 1 with localStep 248 , while globalStep is 247

2021-08-18:16:24:48,760 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:24:48,773 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:24:50,986 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:24:51,4 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:24:51,422 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:24:51,432 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:24:52,76 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:24:52,86 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:24:52,253 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:24:52,266 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:24:53,210 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:24:53,226 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:24:53,359 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:24:53,372 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:24:53,879 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:24:53,906 INFO     [learner.py:606] ====Pushing takes 0.02563786506652832 s
2021-08-18:16:24:53,939 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:53,946 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:24:53,947 INFO     [param_server.py:410] Lock worker 3 with localStep 248 , while globalStep is 247

2021-08-18:16:24:54,625 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:24:54,652 INFO     [learner.py:606] ====Pushing takes 0.025562524795532227 s
2021-08-18:16:24:54,681 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:24:54,688 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:24:54,689 INFO     [param_server.py:381] ====After aggregation in epoch: 247, virtual_clock: 8722.279966166447, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 2.726410327134309, test len: 3099.0
2021-08-18:16:24:54,691 INFO     [param_server.py:410] Lock worker 2 with localStep 248 , while globalStep is 248

2021-08-18:16:24:54,691 INFO     [param_server.py:441] ====Epoch 249 completes 20 clients with loss 70.90763907310787, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:24:54,692 INFO     [param_server.py:450] ====Start to sample for epoch 249, global virtualClock: 8722.279966166447, round_duration: 46.65186139097271
2021-08-18:16:24:54,693 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:24:54,990 INFO     [param_server.py:553] For epoch: 249, median_reward: 1409.549009257785, dev: 7047.745046288925
2021-08-18:16:24:55,619 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7244, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:24:55,620 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3330.7561, eval_time 0.5945, test_loss 2.7244, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:24:55,620 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8984, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:24:55,621 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3330.7456, eval_time 0.5952, test_loss 2.8984, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:24:55,687 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7083, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:24:55,688 INFO     [learner.py:656] After aggregation epoch 248, CumulTime 3330.8269, eval_time 0.6641, test_loss 2.7083, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:24:55,690 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:55,691 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:55,699 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:24:55,700 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:24:55,759 INFO     [learner.py:526] ====Start train round 249
2021-08-18:16:24:55,780 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:24:56,848 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:24:56,861 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:24:57,233 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:24:57,243 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:24:58,266 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:24:58,280 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:24:58,295 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:24:58,311 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:24:58,722 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:24:58,750 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:24:59,605 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:24:59,632 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:00,371 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:00,398 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:00,493 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:00,504 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:00,951 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:00,966 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:01,111 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:01,138 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:01,248 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:01,269 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:01,770 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:01,792 INFO     [learner.py:606] ====Pushing takes 0.021350383758544922 s
2021-08-18:16:25:01,822 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:01,830 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:01,831 INFO     [param_server.py:410] Lock worker 1 with localStep 249 , while globalStep is 248

2021-08-18:16:25:03,736 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:03,745 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:04,100 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:04,111 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:04,761 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:04,770 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:04,872 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:04,881 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:05,920 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:05,929 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:05,999 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:06,11 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:06,435 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:06,463 INFO     [learner.py:606] ====Pushing takes 0.02668285369873047 s
2021-08-18:16:25:06,502 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:06,509 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:06,510 INFO     [param_server.py:410] Lock worker 3 with localStep 249 , while globalStep is 248

2021-08-18:16:25:06,600 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:06,626 INFO     [learner.py:606] ====Pushing takes 0.024715662002563477 s
2021-08-18:16:25:06,654 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:06,661 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:06,662 INFO     [param_server.py:381] ====After aggregation in epoch: 248, virtual_clock: 8768.931827557419, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 2.777027783570466, test len: 3099.0
2021-08-18:16:25:06,665 INFO     [param_server.py:410] Lock worker 2 with localStep 249 , while globalStep is 249

2021-08-18:16:25:06,665 INFO     [param_server.py:441] ====Epoch 250 completes 20 clients with loss 76.05768994563405, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:06,666 INFO     [param_server.py:450] ====Start to sample for epoch 250, global virtualClock: 8768.931827557419, round_duration: 46.65186139097271
2021-08-18:16:25:06,666 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:06,995 INFO     [param_server.py:553] For epoch: 250, median_reward: 1497.17191223321, dev: 7485.859561166049
2021-08-18:16:25:07,637 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5287, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:25:07,637 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.13, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:25:07,638 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3342.7629, eval_time 0.6089, test_loss 2.5287, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:25:07,638 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3342.7745, eval_time 0.6092, test_loss 3.13, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:25:07,709 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:25:07,710 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:25:07,714 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9168, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:25:07,715 INFO     [learner.py:656] After aggregation epoch 249, CumulTime 3342.8545, eval_time 0.686, test_loss 2.9168, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:25:07,720 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:07,725 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:07,784 INFO     [learner.py:526] ====Start train round 250
2021-08-18:16:25:07,810 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:09,113 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:09,140 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:09,222 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:09,232 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:10,357 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:10,368 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:10,429 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:10,448 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:10,570 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:10,604 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:11,410 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:11,437 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:12,211 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:12,238 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:12,676 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:12,690 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:12,871 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:12,898 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:13,182 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:13,197 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:13,412 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:13,434 INFO     [learner.py:606] ====Pushing takes 0.020708322525024414 s
2021-08-18:16:25:13,461 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:13,467 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:13,468 INFO     [param_server.py:410] Lock worker 1 with localStep 250 , while globalStep is 249

2021-08-18:16:25:13,481 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:13,490 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:15,947 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:15,959 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:16,37 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:16,48 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:16,592 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:16,601 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:17,38 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:17,49 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:17,628 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:17,637 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:18,161 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:18,168 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:18,182 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:18,186 INFO     [learner.py:606] ====Pushing takes 0.023879289627075195 s
2021-08-18:16:25:18,215 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:18,225 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:18,225 INFO     [param_server.py:410] Lock worker 3 with localStep 250 , while globalStep is 249

2021-08-18:16:25:19,429 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:19,454 INFO     [learner.py:606] ====Pushing takes 0.02303290367126465 s
2021-08-18:16:25:19,482 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:19,489 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:19,491 INFO     [param_server.py:381] ====After aggregation in epoch: 249, virtual_clock: 8815.58368894839, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 2.8585229405650385, test len: 3099.0
2021-08-18:16:25:19,493 INFO     [param_server.py:410] Lock worker 2 with localStep 250 , while globalStep is 250

2021-08-18:16:25:19,493 INFO     [param_server.py:441] ====Epoch 251 completes 20 clients with loss 151.0515590097275, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:19,494 INFO     [param_server.py:450] ====Start to sample for epoch 251, global virtualClock: 8815.58368894839, round_duration: 46.65186139097271
2021-08-18:16:25:19,494 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:19,766 INFO     [param_server.py:553] For epoch: 251, median_reward: 1132.562962191963, dev: 5662.814810959815
2021-08-18:16:25:20,398 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6907, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:25:20,399 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.111, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:25:20,400 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3355.5244, eval_time 0.5967, test_loss 2.6907, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:25:20,400 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3355.5362, eval_time 0.598, test_loss 3.111, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:25:20,471 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:25:20,471 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:25:20,475 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.999, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:25:20,479 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:20,476 INFO     [learner.py:656] After aggregation epoch 250, CumulTime 3355.6155, eval_time 0.6759, test_loss 2.999, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:25:20,480 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:20,537 INFO     [learner.py:526] ====Start train round 251
2021-08-18:16:25:20,570 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:22,45 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:22,59 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:22,83 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:22,110 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:23,156 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:23,176 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:23,350 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:23,375 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:24,19 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:24,46 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:24,695 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:24,715 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:25,350 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:25,365 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:25,619 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:25,628 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:26,6 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:26,20 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:26,26 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:26,37 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:26,276 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:26,286 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:26,638 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:26,661 INFO     [learner.py:606] ====Pushing takes 0.022015094757080078 s
2021-08-18:16:25:26,694 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:26,700 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:26,700 INFO     [param_server.py:410] Lock worker 1 with localStep 251 , while globalStep is 250

2021-08-18:16:25:28,750 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:28,760 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:29,212 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:29,224 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:29,877 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:29,887 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:29,988 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:29,999 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:31,119 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:31,129 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:31,206 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:31,216 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:31,668 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:31,696 INFO     [learner.py:606] ====Pushing takes 0.027092695236206055 s
2021-08-18:16:25:31,735 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:31,742 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:31,742 INFO     [param_server.py:410] Lock worker 3 with localStep 251 , while globalStep is 250

2021-08-18:16:25:31,878 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:31,904 INFO     [learner.py:606] ====Pushing takes 0.02506566047668457 s
2021-08-18:16:25:31,936 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:31,942 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:31,943 INFO     [param_server.py:381] ====After aggregation in epoch: 250, virtual_clock: 8862.235550339363, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 2.9335896571477256, test len: 3099.0
2021-08-18:16:25:31,945 INFO     [param_server.py:410] Lock worker 2 with localStep 251 , while globalStep is 251

2021-08-18:16:25:31,946 INFO     [param_server.py:441] ====Epoch 252 completes 20 clients with loss 168.1986757460389, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:31,946 INFO     [param_server.py:450] ====Start to sample for epoch 252, global virtualClock: 8862.235550339363, round_duration: 46.65186139097271
2021-08-18:16:25:31,947 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:32,220 INFO     [param_server.py:553] For epoch: 252, median_reward: 1373.8038111360866, dev: 6869.019055680433
2021-08-18:16:25:32,807 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9688, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:25:32,808 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3367.9442, eval_time 0.5315, test_loss 2.9688, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:25:32,817 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7659, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:25:32,818 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3367.9424, eval_time 0.541, test_loss 2.7659, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:25:32,875 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:32,883 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:32,885 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:32,892 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:32,973 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0273, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:25:32,974 INFO     [learner.py:656] After aggregation epoch 251, CumulTime 3368.1128, eval_time 0.6975, test_loss 3.0273, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:25:33,40 INFO     [learner.py:526] ====Start train round 252
2021-08-18:16:25:33,69 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:34,514 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:34,528 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:34,528 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:34,555 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:35,612 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:35,640 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:35,780 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:35,794 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:35,974 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:35,994 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:36,680 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:36,690 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:37,511 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:37,525 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:37,961 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:37,973 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:38,70 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:38,88 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:38,373 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:38,386 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:38,553 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:38,562 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:38,720 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:38,742 INFO     [learner.py:606] ====Pushing takes 0.020051240921020508 s
2021-08-18:16:25:38,783 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:38,792 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:38,793 INFO     [param_server.py:410] Lock worker 1 with localStep 252 , while globalStep is 251

2021-08-18:16:25:41,47 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:41,56 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:41,126 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:41,140 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:41,790 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:41,801 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:42,212 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:42,221 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:42,979 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:42,988 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:43,477 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:43,487 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:43,544 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:43,572 INFO     [learner.py:606] ====Pushing takes 0.026433229446411133 s
2021-08-18:16:25:43,615 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:43,625 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:43,626 INFO     [param_server.py:410] Lock worker 3 with localStep 252 , while globalStep is 251

2021-08-18:16:25:44,748 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:44,774 INFO     [learner.py:606] ====Pushing takes 0.024420738220214844 s
2021-08-18:16:25:44,804 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:44,811 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:44,812 INFO     [param_server.py:381] ====After aggregation in epoch: 251, virtual_clock: 8908.887411730335, top_1: : 66.0858 % (2048.0), top_5: : 100.0 % (3099.0), test loss: 2.92065637199967, test len: 3099.0
2021-08-18:16:25:44,814 INFO     [param_server.py:410] Lock worker 2 with localStep 252 , while globalStep is 252

2021-08-18:16:25:44,814 INFO     [param_server.py:441] ====Epoch 253 completes 20 clients with loss 246.56171307610995, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:44,814 INFO     [param_server.py:450] ====Start to sample for epoch 253, global virtualClock: 8908.887411730335, round_duration: 46.65186139097271
2021-08-18:16:25:44,815 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:45,147 INFO     [param_server.py:553] For epoch: 253, median_reward: 1366.8328097308013, dev: 6834.164048654006
2021-08-18:16:25:45,804 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7775, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:25:45,805 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3380.9413, eval_time 0.6017, test_loss 2.7775, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:25:45,806 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.553, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:25:45,808 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3380.9327, eval_time 0.6028, test_loss 2.553, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:25:45,878 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:45,878 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:45,887 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:45,887 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:45,926 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4233, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:25:45,930 INFO     [learner.py:656] After aggregation epoch 252, CumulTime 3381.0695, eval_time 0.7285, test_loss 3.4233, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:25:45,988 INFO     [learner.py:526] ====Start train round 253
2021-08-18:16:25:46,17 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:47,485 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:47,505 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:25:47,613 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:25:47,622 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:25:48,794 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:25:48,806 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:25:48,808 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:25:48,824 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:25:49,180 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:25:49,189 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:25:49,815 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:25:49,825 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:25:50,557 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:25:50,571 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:25:51,82 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:25:51,92 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:25:51,209 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:25:51,223 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:25:51,514 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:25:51,523 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:25:51,796 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:25:51,806 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:25:51,882 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:25:51,906 INFO     [learner.py:606] ====Pushing takes 0.0235598087310791 s
2021-08-18:16:25:51,942 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:51,949 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:25:51,950 INFO     [param_server.py:410] Lock worker 1 with localStep 253 , while globalStep is 252

2021-08-18:16:25:54,208 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:25:54,217 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:25:54,576 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:25:54,590 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:25:55,311 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:25:55,325 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:25:55,531 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:25:55,544 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:25:56,599 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:25:56,614 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:25:56,738 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:25:56,749 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:25:57,215 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:25:57,237 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:25:57,244 INFO     [learner.py:606] ====Pushing takes 0.027616262435913086 s
2021-08-18:16:25:57,280 INFO     [learner.py:606] ====Pushing takes 0.04145216941833496 s
2021-08-18:16:25:57,281 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:57,288 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:25:57,289 INFO     [param_server.py:410] Lock worker 3 with localStep 253 , while globalStep is 252

2021-08-18:16:25:57,322 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:25:57,329 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:25:57,330 INFO     [param_server.py:381] ====After aggregation in epoch: 252, virtual_clock: 8955.539273121307, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 2.917910765718531, test len: 3099.0
2021-08-18:16:25:57,332 INFO     [param_server.py:410] Lock worker 2 with localStep 253 , while globalStep is 253

2021-08-18:16:25:57,333 INFO     [param_server.py:441] ====Epoch 254 completes 20 clients with loss 128.74255391513833, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:25:57,333 INFO     [param_server.py:450] ====Start to sample for epoch 254, global virtualClock: 8955.539273121307, round_duration: 46.65186139097271
2021-08-18:16:25:57,334 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:25:57,665 INFO     [param_server.py:553] For epoch: 254, median_reward: 1236.8872395505553, dev: 6184.436197752776
2021-08-18:16:25:58,296 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6691, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:25:58,299 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3393.4239, eval_time 0.5884, test_loss 2.6691, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:25:58,298 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7912, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:25:58,300 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3393.4363, eval_time 0.5895, test_loss 2.7912, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:25:58,360 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:58,368 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:58,369 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:25:58,382 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:25:58,408 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8584, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:25:58,409 INFO     [learner.py:656] After aggregation epoch 253, CumulTime 3393.5483, eval_time 0.6983, test_loss 2.8584, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:25:58,481 INFO     [learner.py:526] ====Start train round 254
2021-08-18:16:25:58,509 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:25:59,893 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:25:59,907 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:00,1 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:00,12 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:01,158 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:01,164 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:01,168 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:01,178 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:01,276 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:01,290 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:01,894 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:01,904 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:02,447 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:02,456 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:03,6 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:03,18 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:03,342 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:03,351 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:03,664 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:03,687 INFO     [learner.py:606] ====Pushing takes 0.021434307098388672 s
2021-08-18:16:26:03,723 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:03,734 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:03,735 INFO     [param_server.py:410] Lock worker 1 with localStep 254 , while globalStep is 253

2021-08-18:16:26:03,747 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:03,756 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:03,897 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:03,907 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:06,486 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:06,495 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:06,576 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:06,591 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:07,260 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:07,280 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:07,829 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:07,838 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:08,534 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:08,552 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:09,57 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:09,68 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:09,68 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:09,97 INFO     [learner.py:606] ====Pushing takes 0.027261734008789062 s
2021-08-18:16:26:09,137 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:09,146 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:09,147 INFO     [param_server.py:410] Lock worker 3 with localStep 254 , while globalStep is 253

2021-08-18:16:26:10,144 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:10,167 INFO     [learner.py:606] ====Pushing takes 0.020701885223388672 s
2021-08-18:16:26:10,196 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:10,204 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:10,205 INFO     [param_server.py:381] ====After aggregation in epoch: 253, virtual_clock: 9002.191134512279, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 2.772920471650583, test len: 3099.0
2021-08-18:16:26:10,208 INFO     [param_server.py:410] Lock worker 2 with localStep 254 , while globalStep is 254

2021-08-18:16:26:10,208 INFO     [param_server.py:441] ====Epoch 255 completes 20 clients with loss 226.1442128165852, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:10,209 INFO     [param_server.py:450] ====Start to sample for epoch 255, global virtualClock: 9002.191134512279, round_duration: 46.65186139097271
2021-08-18:16:26:10,210 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:10,542 INFO     [param_server.py:553] For epoch: 255, median_reward: 1105.4758289586514, dev: 5527.379144793257
2021-08-18:16:26:11,179 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7417, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:26:11,180 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3406.316, eval_time 0.5929, test_loss 2.7417, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:26:11,183 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5016, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:26:11,184 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3406.3083, eval_time 0.5941, test_loss 2.5016, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:26:11,242 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7924, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:26:11,243 INFO     [learner.py:656] After aggregation epoch 254, CumulTime 3406.382, eval_time 0.6557, test_loss 2.7924, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:26:11,249 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:26:11,252 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:26:11,258 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:11,260 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:11,314 INFO     [learner.py:526] ====Start train round 255
2021-08-18:16:26:11,336 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:12,747 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:12,761 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:12,974 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:12,984 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:14,73 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:14,87 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:14,187 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:14,198 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:14,618 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:14,632 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:15,212 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:15,227 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:15,935 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:15,949 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:16,350 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:16,360 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:16,577 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:16,591 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:16,939 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:16,954 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:17,13 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:17,23 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:17,148 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:17,172 INFO     [learner.py:606] ====Pushing takes 0.022306442260742188 s
2021-08-18:16:26:17,211 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:17,218 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:17,219 INFO     [param_server.py:410] Lock worker 1 with localStep 255 , while globalStep is 254

2021-08-18:16:26:19,733 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:19,747 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:19,750 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:19,757 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:20,493 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:20,502 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:21,4 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:21,14 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:21,591 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:21,612 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:22,182 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:22,192 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:22,227 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:22,254 INFO     [learner.py:606] ====Pushing takes 0.026021480560302734 s
2021-08-18:16:26:22,294 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:22,305 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:22,306 INFO     [param_server.py:410] Lock worker 3 with localStep 255 , while globalStep is 254

2021-08-18:16:26:22,719 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:22,747 INFO     [learner.py:606] ====Pushing takes 0.026005983352661133 s
2021-08-18:16:26:22,776 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:22,784 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:22,784 INFO     [param_server.py:381] ====After aggregation in epoch: 254, virtual_clock: 9048.842995903251, top_1: : 65.0532 % (2016.0), top_5: : 100.0 % (3099.0), test loss: 2.6785419428790056, test len: 3099.0
2021-08-18:16:26:22,786 INFO     [param_server.py:410] Lock worker 2 with localStep 255 , while globalStep is 255

2021-08-18:16:26:22,787 INFO     [param_server.py:441] ====Epoch 256 completes 20 clients with loss 149.68950330765537, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:22,787 INFO     [param_server.py:450] ====Start to sample for epoch 256, global virtualClock: 9048.842995903251, round_duration: 46.65186139097271
2021-08-18:16:26:22,788 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:23,124 INFO     [param_server.py:553] For epoch: 256, median_reward: 1121.7241319361644, dev: 5608.620659680822
2021-08-18:16:26:23,772 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8613, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:26:23,773 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3418.9091, eval_time 0.6157, test_loss 2.8613, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:26:23,774 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5024, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:26:23,775 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3418.8993, eval_time 0.6151, test_loss 2.5024, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:26:23,843 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:23,843 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:23,846 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9696, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:26:23,849 INFO     [learner.py:656] After aggregation epoch 255, CumulTime 3418.9883, eval_time 0.6916, test_loss 2.9696, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:26:23,854 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:23,857 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:23,917 INFO     [learner.py:526] ====Start train round 256
2021-08-18:16:26:23,941 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:25,231 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:25,245 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:25,654 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:25,664 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:26,694 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:26,715 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:26,723 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:26,737 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:26,862 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:26,883 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:27,422 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:27,437 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:28,192 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:28,205 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:28,985 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:28,999 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:29,27 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:29,38 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:29,575 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:29,598 INFO     [learner.py:606] ====Pushing takes 0.0220034122467041 s
2021-08-18:16:26:29,638 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:29,644 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:29,645 INFO     [param_server.py:410] Lock worker 1 with localStep 256 , while globalStep is 255

2021-08-18:16:26:29,697 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:29,707 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:29,878 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:29,888 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:32,304 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:32,314 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:32,494 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:32,504 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:32,967 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:32,977 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:33,804 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:33,816 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:34,207 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:34,221 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:34,805 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:34,834 INFO     [learner.py:606] ====Pushing takes 0.02758049964904785 s
2021-08-18:16:26:34,872 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:34,880 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:34,881 INFO     [param_server.py:410] Lock worker 3 with localStep 256 , while globalStep is 255

2021-08-18:16:26:35,151 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:35,163 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:36,442 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:36,469 INFO     [learner.py:606] ====Pushing takes 0.02530694007873535 s
2021-08-18:16:26:36,498 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:36,506 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:36,507 INFO     [param_server.py:381] ====After aggregation in epoch: 255, virtual_clock: 9095.494857294223, top_1: : 64.8596 % (2010.0), top_5: : 100.0 % (3099.0), test loss: 2.7777496355551263, test len: 3099.0
2021-08-18:16:26:36,510 INFO     [param_server.py:410] Lock worker 2 with localStep 256 , while globalStep is 256

2021-08-18:16:26:36,511 INFO     [param_server.py:441] ====Epoch 257 completes 20 clients with loss 151.75697171968596, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:36,511 INFO     [param_server.py:450] ====Start to sample for epoch 257, global virtualClock: 9095.494857294223, round_duration: 46.65186139097271
2021-08-18:16:26:36,512 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:36,857 INFO     [param_server.py:553] For epoch: 257, median_reward: 1129.2189871841647, dev: 5646.094935920823
2021-08-18:16:26:37,556 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2156, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:26:37,556 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3432.6923, eval_time 0.6638, test_loss 3.2156, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:26:37,592 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5866, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:26:37,593 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3432.7174, eval_time 0.7002, test_loss 2.5866, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:26:37,627 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:37,629 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1335, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:26:37,630 INFO     [learner.py:656] After aggregation epoch 256, CumulTime 3432.7689, eval_time 0.7372, test_loss 3.1335, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:26:37,641 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:37,662 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:37,675 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:37,700 INFO     [learner.py:526] ====Start train round 257
2021-08-18:16:26:37,719 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:39,196 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:39,217 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:39,317 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:39,335 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:40,442 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:40,474 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:40,513 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:40,524 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:41,65 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:41,74 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:41,713 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:41,726 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:42,401 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:42,415 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:42,712 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:42,722 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:43,24 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:43,42 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:43,167 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:43,177 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:43,430 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:43,440 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:43,647 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:43,671 INFO     [learner.py:606] ====Pushing takes 0.0225679874420166 s
2021-08-18:16:26:43,706 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:43,715 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:43,715 INFO     [param_server.py:410] Lock worker 1 with localStep 257 , while globalStep is 256

2021-08-18:16:26:45,933 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:45,944 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:46,47 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:46,61 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:46,729 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:46,739 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:47,56 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:47,65 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:26:47,921 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:26:47,934 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:26:48,308 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:26:48,319 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:26:48,688 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:26:48,716 INFO     [learner.py:606] ====Pushing takes 0.02634739875793457 s
2021-08-18:16:26:48,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:48,761 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:26:48,762 INFO     [param_server.py:410] Lock worker 3 with localStep 257 , while globalStep is 256

2021-08-18:16:26:48,796 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:26:48,823 INFO     [learner.py:606] ====Pushing takes 0.025975942611694336 s
2021-08-18:16:26:48,857 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:48,865 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:26:48,866 INFO     [param_server.py:381] ====After aggregation in epoch: 256, virtual_clock: 9142.146718685195, top_1: : 64.8919 % (2011.0), top_5: : 100.0 % (3099.0), test loss: 2.9785709160345575, test len: 3099.0
2021-08-18:16:26:48,868 INFO     [param_server.py:410] Lock worker 2 with localStep 257 , while globalStep is 257

2021-08-18:16:26:48,869 INFO     [param_server.py:441] ====Epoch 258 completes 20 clients with loss 114.30566363621064, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:26:48,869 INFO     [param_server.py:450] ====Start to sample for epoch 258, global virtualClock: 9142.146718685195, round_duration: 46.65186139097271
2021-08-18:16:26:48,870 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:26:49,213 INFO     [param_server.py:553] For epoch: 258, median_reward: 1109.1553387621664, dev: 5545.776693810832
2021-08-18:16:26:49,848 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1221, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:26:49,849 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3444.9853, eval_time 0.5911, test_loss 3.1221, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:26:49,855 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5214, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:26:49,855 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3444.9799, eval_time 0.5966, test_loss 2.5214, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:26:49,934 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8047, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:26:49,935 INFO     [learner.py:656] After aggregation epoch 257, CumulTime 3445.0742, eval_time 0.6769, test_loss 2.8047, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:26:49,937 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:49,941 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:49,950 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:26:49,953 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:26:50,6 INFO     [learner.py:526] ====Start train round 258
2021-08-18:16:26:50,29 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:26:51,379 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:26:51,393 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:26:51,606 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:26:51,616 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:26:52,634 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:26:52,648 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:26:52,770 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:26:52,779 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:26:52,812 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:26:52,821 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:26:53,450 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:26:53,460 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:26:54,81 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:26:54,95 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:26:54,782 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:26:54,796 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:26:54,998 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:26:55,8 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:26:55,455 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:26:55,457 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:26:55,468 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:26:55,479 INFO     [learner.py:606] ====Pushing takes 0.022447824478149414 s
2021-08-18:16:26:55,521 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:26:55,528 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:26:55,529 INFO     [param_server.py:410] Lock worker 1 with localStep 258 , while globalStep is 257

2021-08-18:16:26:55,618 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:26:55,628 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:26:58,68 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:26:58,86 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:26:58,297 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:26:58,306 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:26:58,873 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:26:58,883 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:26:59,279 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:26:59,290 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:00,60 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:00,69 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:00,628 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:00,647 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:00,759 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:00,787 INFO     [learner.py:606] ====Pushing takes 0.025936365127563477 s
2021-08-18:16:27:00,826 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:00,836 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:00,836 INFO     [param_server.py:410] Lock worker 3 with localStep 258 , while globalStep is 257

2021-08-18:16:27:01,978 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:02,4 INFO     [learner.py:606] ====Pushing takes 0.0239412784576416 s
2021-08-18:16:27:02,41 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:02,49 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:02,49 INFO     [param_server.py:381] ====After aggregation in epoch: 257, virtual_clock: 9188.798580076167, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 2.8161062399546304, test len: 3099.0
2021-08-18:16:27:02,52 INFO     [param_server.py:410] Lock worker 2 with localStep 258 , while globalStep is 258

2021-08-18:16:27:02,52 INFO     [param_server.py:441] ====Epoch 259 completes 20 clients with loss 130.61238988482197, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:02,52 INFO     [param_server.py:450] ====Start to sample for epoch 259, global virtualClock: 9188.798580076167, round_duration: 46.65186139097271
2021-08-18:16:27:02,53 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:02,395 INFO     [param_server.py:553] For epoch: 259, median_reward: 1257.5183327914565, dev: 6287.591663957282
2021-08-18:16:27:03,3 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9166, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:27:03,4 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3458.1399, eval_time 0.5636, test_loss 2.9166, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:27:03,40 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.1984, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:27:03,41 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3458.1653, eval_time 0.6004, test_loss 4.1984, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:27:03,78 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:27:03,83 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2415, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:27:03,85 INFO     [learner.py:656] After aggregation epoch 258, CumulTime 3458.2244, eval_time 0.6449, test_loss 3.2415, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:27:03,86 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:03,106 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:27:03,120 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:03,152 INFO     [learner.py:526] ====Start train round 259
2021-08-18:16:27:03,171 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:04,326 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:04,340 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:04,762 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:04,773 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:05,863 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:05,877 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:06,23 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:06,34 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:06,45 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:06,54 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:06,660 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:06,675 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:07,367 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:07,381 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:08,52 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:08,66 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:08,133 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:08,145 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:08,647 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:08,669 INFO     [learner.py:606] ====Pushing takes 0.021264076232910156 s
2021-08-18:16:27:08,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:08,712 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:08,715 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:08,715 INFO     [param_server.py:410] Lock worker 1 with localStep 259 , while globalStep is 258

2021-08-18:16:27:08,726 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:08,729 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:08,739 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:11,453 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:11,463 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:11,483 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:11,498 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:12,99 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:12,109 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:12,686 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:12,700 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:13,423 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:13,435 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:14,85 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:14,116 INFO     [learner.py:606] ====Pushing takes 0.029824495315551758 s
2021-08-18:16:27:14,106 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:14,128 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:14,156 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:14,163 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:14,163 INFO     [param_server.py:410] Lock worker 3 with localStep 259 , while globalStep is 258

2021-08-18:16:27:14,622 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:14,648 INFO     [learner.py:606] ====Pushing takes 0.024367332458496094 s
2021-08-18:16:27:14,677 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:14,684 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:14,685 INFO     [param_server.py:381] ====After aggregation in epoch: 258, virtual_clock: 9235.45044146714, top_1: : 65.4405 % (2028.0), top_5: : 100.0 % (3099.0), test loss: 3.4521865403210676, test len: 3099.0
2021-08-18:16:27:14,687 INFO     [param_server.py:410] Lock worker 2 with localStep 259 , while globalStep is 259

2021-08-18:16:27:14,688 INFO     [param_server.py:441] ====Epoch 260 completes 20 clients with loss 102.15406627358978, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:14,688 INFO     [param_server.py:450] ====Start to sample for epoch 260, global virtualClock: 9235.45044146714, round_duration: 46.65186139097271
2021-08-18:16:27:14,689 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:15,23 INFO     [param_server.py:553] For epoch: 260, median_reward: 1242.634086414259, dev: 6213.170432071294
2021-08-18:16:27:15,723 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8336, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:27:15,725 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3470.8605, eval_time 0.6565, test_loss 2.8336, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:27:15,790 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:27:15,799 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:15,812 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5895, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:27:15,813 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3470.9376, eval_time 0.7448, test_loss 2.5895, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:27:15,836 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9609, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:27:15,837 INFO     [learner.py:656] After aggregation epoch 259, CumulTime 3470.9762, eval_time 0.7691, test_loss 2.9609, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:27:15,879 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:27:15,896 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:15,901 INFO     [learner.py:526] ====Start train round 260
2021-08-18:16:27:15,922 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:17,200 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:17,213 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:17,516 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:17,526 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:18,456 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:18,475 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:18,714 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:18,723 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:18,815 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:18,833 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:19,250 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:19,264 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:19,953 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:19,967 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:20,619 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:20,629 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:21,2 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:21,12 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:21,152 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:21,174 INFO     [learner.py:606] ====Pushing takes 0.020528078079223633 s
2021-08-18:16:27:21,215 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:21,224 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:21,224 INFO     [param_server.py:410] Lock worker 1 with localStep 260 , while globalStep is 259

2021-08-18:16:27:21,709 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:21,718 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:21,743 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:21,754 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:24,317 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:24,329 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:24,435 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:24,447 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:25,40 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:25,50 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:25,562 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:25,571 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:26,166 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:26,176 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:26,674 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:26,681 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:26,693 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:26,701 INFO     [learner.py:606] ====Pushing takes 0.025884151458740234 s
2021-08-18:16:27:26,738 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:26,746 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:26,746 INFO     [param_server.py:410] Lock worker 3 with localStep 260 , while globalStep is 259

2021-08-18:16:27:27,992 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:28,23 INFO     [learner.py:606] ====Pushing takes 0.024844646453857422 s
2021-08-18:16:27:28,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:28,71 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:28,72 INFO     [param_server.py:381] ====After aggregation in epoch: 259, virtual_clock: 9282.102302858111, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 2.7946759903872453, test len: 3099.0
2021-08-18:16:27:28,74 INFO     [param_server.py:410] Lock worker 2 with localStep 260 , while globalStep is 260

2021-08-18:16:27:28,75 INFO     [param_server.py:441] ====Epoch 261 completes 20 clients with loss 110.46890661179009, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:28,75 INFO     [param_server.py:450] ====Start to sample for epoch 261, global virtualClock: 9282.102302858111, round_duration: 46.65186139097271
2021-08-18:16:27:28,76 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:28,415 INFO     [param_server.py:541] Handle Wight 0.04077959060668945 | Send 0.33942294120788574
2021-08-18:16:27:28,415 INFO     [param_server.py:553] For epoch: 261, median_reward: 1083.3772796271965, dev: 5416.886398135983
2021-08-18:16:27:29,36 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8366, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:27:29,36 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3484.1725, eval_time 0.565, test_loss 2.8366, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:27:29,108 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:29,112 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4625, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:27:29,113 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3484.2378, eval_time 0.6402, test_loss 3.4625, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:27:29,122 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:29,182 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:29,189 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9551, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:27:29,190 INFO     [learner.py:656] After aggregation epoch 260, CumulTime 3484.3293, eval_time 0.7196, test_loss 2.9551, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:27:29,203 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:29,258 INFO     [learner.py:526] ====Start train round 261
2021-08-18:16:27:29,286 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:30,764 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:30,785 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:30,808 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:30,822 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:32,82 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:32,92 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:32,187 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:32,197 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:32,545 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:32,559 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:33,197 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:33,215 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:33,900 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:33,915 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:34,529 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:34,543 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:34,558 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:34,568 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:35,40 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:35,65 INFO     [learner.py:606] ====Pushing takes 0.023050546646118164 s
2021-08-18:16:27:35,103 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:35,106 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:35,113 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:35,114 INFO     [param_server.py:410] Lock worker 1 with localStep 261 , while globalStep is 260

2021-08-18:16:27:35,115 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:35,185 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:35,196 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:37,887 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:37,893 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:37,897 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:37,904 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:38,606 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:38,618 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:39,85 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:39,94 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:39,820 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:39,833 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:40,364 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:40,373 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:40,502 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:40,529 INFO     [learner.py:606] ====Pushing takes 0.026174545288085938 s
2021-08-18:16:27:40,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:40,578 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:40,580 INFO     [param_server.py:410] Lock worker 3 with localStep 261 , while globalStep is 260

2021-08-18:16:27:40,982 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:41,8 INFO     [learner.py:606] ====Pushing takes 0.024549484252929688 s
2021-08-18:16:27:41,48 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:41,55 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:41,56 INFO     [param_server.py:381] ====After aggregation in epoch: 260, virtual_clock: 9328.754164249083, top_1: : 65.3437 % (2025.0), top_5: : 100.0 % (3099.0), test loss: 3.084754972546189, test len: 3099.0
2021-08-18:16:27:41,58 INFO     [param_server.py:410] Lock worker 2 with localStep 261 , while globalStep is 261

2021-08-18:16:27:41,59 INFO     [param_server.py:441] ====Epoch 262 completes 20 clients with loss 123.6965249298283, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:41,59 INFO     [param_server.py:450] ====Start to sample for epoch 262, global virtualClock: 9328.754164249083, round_duration: 46.65186139097271
2021-08-18:16:27:41,60 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:41,395 INFO     [param_server.py:553] For epoch: 262, median_reward: 938.9530789229134, dev: 4694.765394614567
2021-08-18:16:27:42,72 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2402, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:27:42,72 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5503, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:27:42,73 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3497.2089, eval_time 0.6209, test_loss 3.2402, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:27:42,73 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3497.1978, eval_time 0.618, test_loss 2.5503, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:27:42,137 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:42,137 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:42,153 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:42,159 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:42,188 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.865, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:27:42,190 INFO     [learner.py:656] After aggregation epoch 261, CumulTime 3497.3289, eval_time 0.7393, test_loss 2.865, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:27:42,259 INFO     [learner.py:526] ====Start train round 262
2021-08-18:16:27:42,288 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:43,428 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:43,455 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:43,787 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:43,802 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:44,811 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:44,825 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:45,7 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:45,19 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:45,113 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:45,131 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:45,504 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:45,518 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:46,78 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:46,87 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:46,728 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:46,738 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:27:47,360 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:27:47,384 INFO     [learner.py:606] ====Pushing takes 0.021971702575683594 s
2021-08-18:16:27:47,427 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:47,433 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:27:47,434 INFO     [param_server.py:410] Lock worker 1 with localStep 262 , while globalStep is 261

2021-08-18:16:27:47,485 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:27:47,494 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:27:47,895 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:27:47,906 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:27:48,83 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:27:48,92 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:27:50,589 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:27:50,598 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:27:50,751 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:27:50,763 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:27:51,402 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:27:51,412 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:27:51,812 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:27:51,825 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:27:52,452 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:27:52,461 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:27:52,960 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:27:52,987 INFO     [learner.py:606] ====Pushing takes 0.02580714225769043 s
2021-08-18:16:27:52,989 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:27:53,7 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:27:53,27 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:53,35 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:27:53,36 INFO     [param_server.py:410] Lock worker 3 with localStep 262 , while globalStep is 261

2021-08-18:16:27:54,32 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:27:54,58 INFO     [learner.py:606] ====Pushing takes 0.02470111846923828 s
2021-08-18:16:27:54,96 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:27:54,103 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:27:54,104 INFO     [param_server.py:381] ====After aggregation in epoch: 261, virtual_clock: 9375.406025640055, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 2.885164617388337, test len: 3099.0
2021-08-18:16:27:54,106 INFO     [param_server.py:410] Lock worker 2 with localStep 262 , while globalStep is 262

2021-08-18:16:27:54,107 INFO     [param_server.py:441] ====Epoch 263 completes 20 clients with loss 217.6329573876329, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:27:54,107 INFO     [param_server.py:450] ====Start to sample for epoch 263, global virtualClock: 9375.406025640055, round_duration: 46.65186139097271
2021-08-18:16:27:54,108 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:27:54,469 INFO     [param_server.py:553] For epoch: 263, median_reward: 957.4128980425243, dev: 4787.064490212621
2021-08-18:16:27:55,139 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2576, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:27:55,140 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3510.2647, eval_time 0.6137, test_loss 3.2576, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:27:55,187 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0342, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:27:55,188 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3510.3242, eval_time 0.6642, test_loss 3.0342, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:27:55,209 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:55,218 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:27:55,259 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:55,263 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1208, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:27:55,266 INFO     [learner.py:656] After aggregation epoch 262, CumulTime 3510.4052, eval_time 0.742, test_loss 3.1208, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:27:55,275 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:27:55,335 INFO     [learner.py:526] ====Start train round 263
2021-08-18:16:27:55,361 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:27:56,602 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:27:56,628 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:27:56,944 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:27:56,955 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:27:58,121 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:27:58,132 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:27:58,170 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:27:58,180 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:27:58,212 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:27:58,221 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:27:58,698 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:27:58,707 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:27:59,222 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:27:59,232 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:27:59,743 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:27:59,752 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:00,287 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:00,297 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:00,372 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:00,396 INFO     [learner.py:606] ====Pushing takes 0.022401809692382812 s
2021-08-18:16:28:00,433 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:00,448 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:00,449 INFO     [param_server.py:410] Lock worker 1 with localStep 263 , while globalStep is 262

2021-08-18:16:28:00,652 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:00,661 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:00,914 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:00,924 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:03,589 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:03,603 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:03,663 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:03,675 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:04,250 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:04,264 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:04,825 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:04,835 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:05,445 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:05,455 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:06,141 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:06,168 INFO     [learner.py:606] ====Pushing takes 0.025460004806518555 s
2021-08-18:16:28:06,209 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:06,216 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:06,217 INFO     [param_server.py:410] Lock worker 3 with localStep 263 , while globalStep is 262

2021-08-18:16:28:06,237 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:06,253 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:06,946 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:06,971 INFO     [learner.py:606] ====Pushing takes 0.02381610870361328 s
2021-08-18:16:28:07,3 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:07,11 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:07,12 INFO     [param_server.py:381] ====After aggregation in epoch: 262, virtual_clock: 9422.057887031027, top_1: : 64.8919 % (2011.0), top_5: : 100.0 % (3099.0), test loss: 3.137525810135736, test len: 3099.0
2021-08-18:16:28:07,14 INFO     [param_server.py:410] Lock worker 2 with localStep 263 , while globalStep is 263

2021-08-18:16:28:07,15 INFO     [param_server.py:441] ====Epoch 264 completes 20 clients with loss 95.50446524677774, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:07,15 INFO     [param_server.py:450] ====Start to sample for epoch 264, global virtualClock: 9422.057887031027, round_duration: 46.65186139097271
2021-08-18:16:28:07,16 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:07,402 INFO     [param_server.py:553] For epoch: 264, median_reward: 1194.497202594939, dev: 5972.486012974695
2021-08-18:16:28:08,110 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8777, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:28:08,111 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3523.2353, eval_time 0.6631, test_loss 2.8777, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:28:08,108 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9903, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:28:08,112 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3523.2481, eval_time 0.665, test_loss 2.9903, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:28:08,179 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:28:08,181 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:28:08,190 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7059, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:28:08,190 INFO     [learner.py:656] After aggregation epoch 263, CumulTime 3523.3297, eval_time 0.7434, test_loss 3.7059, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:28:08,191 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:08,194 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:08,245 INFO     [learner.py:526] ====Start train round 264
2021-08-18:16:28:08,266 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:09,536 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:09,549 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:09,878 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:09,892 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:10,710 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:10,719 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:10,948 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:10,959 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:11,229 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:11,240 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:11,341 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:11,351 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:12,56 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:12,65 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:12,764 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:12,778 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:13,335 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:13,346 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:13,447 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:13,474 INFO     [learner.py:606] ====Pushing takes 0.022615909576416016 s
2021-08-18:16:28:13,518 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:13,525 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:13,526 INFO     [param_server.py:410] Lock worker 1 with localStep 264 , while globalStep is 263

2021-08-18:16:28:13,961 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:13,966 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:13,970 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:13,981 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:16,565 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:16,576 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:16,683 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:16,697 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:17,259 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:17,268 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:17,861 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:17,871 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:18,506 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:18,518 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:19,64 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:19,93 INFO     [learner.py:606] ====Pushing takes 0.02721548080444336 s
2021-08-18:16:28:19,128 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:19,132 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:19,139 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:19,143 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:19,143 INFO     [param_server.py:410] Lock worker 3 with localStep 264 , while globalStep is 263

2021-08-18:16:28:20,123 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:20,149 INFO     [learner.py:606] ====Pushing takes 0.024246692657470703 s
2021-08-18:16:28:20,187 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:20,194 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:20,195 INFO     [param_server.py:381] ====After aggregation in epoch: 263, virtual_clock: 9468.709748422, top_1: : 66.1181 % (2049.0), top_5: : 100.0 % (3099.0), test loss: 3.191326203169646, test len: 3099.0
2021-08-18:16:28:20,198 INFO     [param_server.py:410] Lock worker 2 with localStep 264 , while globalStep is 264

2021-08-18:16:28:20,198 INFO     [param_server.py:441] ====Epoch 265 completes 20 clients with loss 141.3344455372191, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:20,199 INFO     [param_server.py:450] ====Start to sample for epoch 265, global virtualClock: 9468.709748422, round_duration: 46.65186139097271
2021-08-18:16:28:20,200 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:20,536 INFO     [param_server.py:553] For epoch: 265, median_reward: 998.4909923033069, dev: 4992.454961516534
2021-08-18:16:28:21,111 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1222, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:28:21,111 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3536.2474, eval_time 0.5413, test_loss 3.1222, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:28:21,153 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6046, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:28:21,154 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3536.2789, eval_time 0.5817, test_loss 2.6046, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:28:21,180 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:28:21,188 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:21,189 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8629, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:28:21,190 INFO     [learner.py:656] After aggregation epoch 264, CumulTime 3536.3292, eval_time 0.6212, test_loss 2.8629, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:28:21,224 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:28:21,239 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:21,259 INFO     [learner.py:526] ====Start train round 265
2021-08-18:16:28:21,277 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:22,629 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:22,643 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:22,927 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:22,945 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:24,3 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:24,13 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:24,72 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:24,84 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:24,363 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:24,377 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:25,9 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:25,24 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:25,769 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:25,789 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:26,398 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:26,408 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:26,452 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:26,473 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:27,11 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:27,34 INFO     [learner.py:606] ====Pushing takes 0.022051334381103516 s
2021-08-18:16:28:27,39 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:27,49 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:27,74 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:27,82 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:27,83 INFO     [param_server.py:410] Lock worker 1 with localStep 265 , while globalStep is 264

2021-08-18:16:28:27,121 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:27,135 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:29,704 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:29,716 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:29,842 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:29,851 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:30,387 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:30,397 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:30,922 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:30,934 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:31,429 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:31,438 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:32,24 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:32,53 INFO     [learner.py:606] ====Pushing takes 0.027454853057861328 s
2021-08-18:16:28:32,89 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:32,99 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:32,99 INFO     [param_server.py:410] Lock worker 3 with localStep 265 , while globalStep is 264

2021-08-18:16:28:32,311 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:32,321 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:32,958 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:32,984 INFO     [learner.py:606] ====Pushing takes 0.024014711380004883 s
2021-08-18:16:28:33,22 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:33,29 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:33,30 INFO     [param_server.py:381] ====After aggregation in epoch: 264, virtual_clock: 9515.361609812971, top_1: : 64.182 % (1989.0), top_5: : 100.0 % (3099.0), test loss: 2.8632492710042885, test len: 3099.0
2021-08-18:16:28:33,33 INFO     [param_server.py:410] Lock worker 2 with localStep 265 , while globalStep is 265

2021-08-18:16:28:33,34 INFO     [param_server.py:441] ====Epoch 266 completes 20 clients with loss 98.64326887706132, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:33,34 INFO     [param_server.py:450] ====Start to sample for epoch 266, global virtualClock: 9515.361609812971, round_duration: 46.65186139097271
2021-08-18:16:28:33,36 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:33,373 INFO     [param_server.py:553] For epoch: 266, median_reward: 946.2186000996645, dev: 4731.093000498323
2021-08-18:16:28:34,39 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7464, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:28:34,37 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0674, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:28:34,40 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3549.1755, eval_time 0.6182, test_loss 2.7464, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:28:34,40 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3549.1648, eval_time 0.6168, test_loss 3.0674, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:28:34,112 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:34,113 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:34,113 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0412, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:28:34,116 INFO     [learner.py:656] After aggregation epoch 265, CumulTime 3549.2548, eval_time 0.6965, test_loss 3.0412, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:28:34,121 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:34,127 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:34,205 INFO     [learner.py:526] ====Start train round 266
2021-08-18:16:28:34,225 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:35,422 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:35,442 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:35,725 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:35,736 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:36,814 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:36,816 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:36,823 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:36,830 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:37,40 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:37,58 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:37,679 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:37,693 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:38,328 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:38,342 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:38,938 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:38,954 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:39,199 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:39,215 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:39,620 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:39,644 INFO     [learner.py:606] ====Pushing takes 0.02223968505859375 s
2021-08-18:16:28:39,680 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:39,690 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:39,690 INFO     [param_server.py:410] Lock worker 1 with localStep 266 , while globalStep is 265

2021-08-18:16:28:39,878 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:39,890 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:39,953 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:39,963 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:42,506 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:42,516 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:42,601 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:42,612 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:43,223 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:43,232 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:43,649 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:43,661 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:44,565 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:44,574 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:44,843 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:44,855 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:45,205 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:45,232 INFO     [learner.py:606] ====Pushing takes 0.025875329971313477 s
2021-08-18:16:28:45,269 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:45,276 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:45,277 INFO     [param_server.py:410] Lock worker 3 with localStep 266 , while globalStep is 265

2021-08-18:16:28:46,48 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:46,75 INFO     [learner.py:606] ====Pushing takes 0.02534770965576172 s
2021-08-18:16:28:46,111 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:46,118 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:46,119 INFO     [param_server.py:381] ====After aggregation in epoch: 265, virtual_clock: 9562.013471203943, top_1: : 66.1181 % (2049.0), top_5: : 100.0 % (3099.0), test loss: 2.951664242755484, test len: 3099.0
2021-08-18:16:28:46,122 INFO     [param_server.py:410] Lock worker 2 with localStep 266 , while globalStep is 266

2021-08-18:16:28:46,122 INFO     [param_server.py:441] ====Epoch 267 completes 20 clients with loss 194.29292423233503, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:46,122 INFO     [param_server.py:450] ====Start to sample for epoch 267, global virtualClock: 9562.013471203943, round_duration: 46.65186139097271
2021-08-18:16:28:46,123 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:46,454 INFO     [param_server.py:553] For epoch: 267, median_reward: 1301.324193221387, dev: 6506.620966106935
2021-08-18:16:28:47,102 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0189, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:28:47,103 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3562.2387, eval_time 0.6036, test_loss 3.0189, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:28:47,113 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6852, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:28:47,114 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3562.2383, eval_time 0.612, test_loss 2.6852, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:28:47,184 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:47,188 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.069, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:28:47,188 INFO     [learner.py:656] After aggregation epoch 266, CumulTime 3562.3274, eval_time 0.6891, test_loss 3.069, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:28:47,188 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:47,196 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:47,202 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:47,253 INFO     [learner.py:526] ====Start train round 267
2021-08-18:16:28:47,280 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:28:48,824 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:28:48,844 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:28:48,909 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:28:48,928 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:28:49,931 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:28:49,945 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:28:50,143 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:28:50,154 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:28:50,628 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:28:50,638 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:28:51,195 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:28:51,205 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:28:51,727 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:28:51,736 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:28:52,234 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:28:52,246 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:28:52,259 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:28:52,269 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:28:52,697 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:28:52,709 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:28:52,936 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:28:52,961 INFO     [learner.py:606] ====Pushing takes 0.021783828735351562 s
2021-08-18:16:28:52,990 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:28:52,997 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:53,2 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:28:53,5 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:28:53,6 INFO     [param_server.py:410] Lock worker 1 with localStep 267 , while globalStep is 266

2021-08-18:16:28:55,350 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:28:55,359 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:28:55,586 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:28:55,595 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:28:56,249 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:28:56,260 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:28:56,497 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:28:56,507 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:28:57,491 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:28:57,500 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:28:57,840 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:28:57,858 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:28:58,92 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:28:58,121 INFO     [learner.py:606] ====Pushing takes 0.026602506637573242 s
2021-08-18:16:28:58,159 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:58,171 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:28:58,173 INFO     [param_server.py:410] Lock worker 3 with localStep 267 , while globalStep is 266

2021-08-18:16:28:58,456 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:28:58,481 INFO     [learner.py:606] ====Pushing takes 0.023915529251098633 s
2021-08-18:16:28:58,509 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:28:58,516 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:28:58,517 INFO     [param_server.py:381] ====After aggregation in epoch: 266, virtual_clock: 9608.665332594916, top_1: : 64.2788 % (1992.0), top_5: : 100.0 % (3099.0), test loss: 2.924340089162191, test len: 3099.0
2021-08-18:16:28:58,533 INFO     [param_server.py:410] Lock worker 2 with localStep 267 , while globalStep is 267

2021-08-18:16:28:58,534 INFO     [param_server.py:441] ====Epoch 268 completes 20 clients with loss 154.10923300596593, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:28:58,547 INFO     [param_server.py:450] ====Start to sample for epoch 268, global virtualClock: 9608.665332594916, round_duration: 46.65186139097271
2021-08-18:16:28:58,548 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:28:58,882 INFO     [param_server.py:553] For epoch: 268, median_reward: 1144.92990020348, dev: 5724.6495010174
2021-08-18:16:28:59,712 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0442, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:28:59,713 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3574.8494, eval_time 0.7649, test_loss 3.0442, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:28:59,723 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5694, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:28:59,724 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3574.8485, eval_time 0.7709, test_loss 2.5694, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:28:59,786 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7905, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:28:59,787 INFO     [learner.py:656] After aggregation epoch 267, CumulTime 3574.926, eval_time 0.8383, test_loss 2.7905, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:28:59,800 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:59,808 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:59,822 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:28:59,823 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:28:59,854 INFO     [learner.py:526] ====Start train round 268
2021-08-18:16:28:59,882 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:01,208 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:01,222 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:01,573 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:01,583 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:02,545 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:02,554 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:02,700 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:02,701 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:02,709 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:02,714 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:03,375 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:03,385 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:04,1 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:04,11 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:04,612 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:04,621 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:04,859 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:04,869 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:05,266 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:05,290 INFO     [learner.py:606] ====Pushing takes 0.022640466690063477 s
2021-08-18:16:29:05,327 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:05,334 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:05,335 INFO     [param_server.py:410] Lock worker 1 with localStep 268 , while globalStep is 267

2021-08-18:16:29:05,394 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:05,405 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:05,525 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:05,534 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:08,105 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:08,108 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:08,120 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:08,120 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:08,724 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:08,734 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:09,270 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:09,285 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:09,867 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:09,881 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:10,513 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:10,540 INFO     [learner.py:606] ====Pushing takes 0.025749683380126953 s
2021-08-18:16:29:10,576 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:10,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:10,586 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:10,587 INFO     [param_server.py:410] Lock worker 3 with localStep 268 , while globalStep is 267

2021-08-18:16:29:10,595 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:11,826 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:11,852 INFO     [learner.py:606] ====Pushing takes 0.024303674697875977 s
2021-08-18:16:29:11,881 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:11,889 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:11,890 INFO     [param_server.py:381] ====After aggregation in epoch: 267, virtual_clock: 9655.317193985888, top_1: : 66.4085 % (2058.0), top_5: : 100.0 % (3099.0), test loss: 2.801379766729143, test len: 3099.0
2021-08-18:16:29:11,892 INFO     [param_server.py:410] Lock worker 2 with localStep 268 , while globalStep is 268

2021-08-18:16:29:11,892 INFO     [param_server.py:441] ====Epoch 269 completes 20 clients with loss 136.0731042930319, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:11,893 INFO     [param_server.py:450] ====Start to sample for epoch 269, global virtualClock: 9655.317193985888, round_duration: 46.65186139097271
2021-08-18:16:29:11,894 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:12,242 INFO     [param_server.py:553] For epoch: 269, median_reward: 1111.2587785564813, dev: 5556.293892782406
2021-08-18:16:29:12,935 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0281, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:29:12,939 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3588.0747, eval_time 0.651, test_loss 4.0281, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:29:12,977 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6624, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:29:12,977 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3588.102, eval_time 0.6826, test_loss 2.6624, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:29:13,5 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:29:13,13 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:13,23 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7886, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:29:13,26 INFO     [learner.py:656] After aggregation epoch 268, CumulTime 3588.1653, eval_time 0.7384, test_loss 2.7886, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:29:13,45 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:29:13,60 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:13,110 INFO     [learner.py:526] ====Start train round 269
2021-08-18:16:29:13,128 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:14,329 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:14,343 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:14,770 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:14,780 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:15,892 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:15,901 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:15,908 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:15,919 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:15,943 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:15,953 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:16,489 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:16,501 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:17,49 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:17,63 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:17,592 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:17,606 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:18,38 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:18,47 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:18,228 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:18,250 INFO     [learner.py:606] ====Pushing takes 0.021332263946533203 s
2021-08-18:16:29:18,285 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:18,294 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:18,295 INFO     [param_server.py:410] Lock worker 1 with localStep 269 , while globalStep is 268

2021-08-18:16:29:18,452 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:18,462 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:18,700 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:18,710 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:21,282 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:21,292 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:21,476 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:21,495 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:22,3 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:22,18 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:22,781 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:22,792 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:23,243 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:23,258 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:23,876 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:23,904 INFO     [learner.py:606] ====Pushing takes 0.02699422836303711 s
2021-08-18:16:29:23,941 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:23,949 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:23,950 INFO     [param_server.py:410] Lock worker 3 with localStep 269 , while globalStep is 268

2021-08-18:16:29:24,10 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:24,22 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:24,553 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:24,582 INFO     [learner.py:606] ====Pushing takes 0.02727532386779785 s
2021-08-18:16:29:24,619 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:24,627 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:24,628 INFO     [param_server.py:381] ====After aggregation in epoch: 268, virtual_clock: 9701.96905537686, top_1: : 64.7628 % (2007.0), top_5: : 100.0 % (3099.0), test loss: 3.159725895634404, test len: 3099.0
2021-08-18:16:29:24,631 INFO     [param_server.py:410] Lock worker 2 with localStep 269 , while globalStep is 269

2021-08-18:16:29:24,631 INFO     [param_server.py:441] ====Epoch 270 completes 20 clients with loss 144.4821299930382, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:24,631 INFO     [param_server.py:450] ====Start to sample for epoch 270, global virtualClock: 9701.96905537686, round_duration: 46.65186139097271
2021-08-18:16:29:24,633 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:24,966 INFO     [param_server.py:553] For epoch: 270, median_reward: 1130.2093841239573, dev: 5651.046920619787
2021-08-18:16:29:25,663 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1803, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:29:25,665 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3600.8009, eval_time 0.6511, test_loss 3.1803, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:29:25,689 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5743, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:29:25,690 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3600.8149, eval_time 0.6766, test_loss 2.5743, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:29:25,721 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8977, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:29:25,722 INFO     [learner.py:656] After aggregation epoch 269, CumulTime 3600.8617, eval_time 0.7112, test_loss 2.8977, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:29:25,736 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:25,749 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:25,759 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:25,773 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:25,779 INFO     [learner.py:526] ====Start train round 270
2021-08-18:16:29:25,801 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:27,166 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:27,179 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:27,373 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:27,382 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:28,526 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:28,529 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:28,535 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:28,542 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:28,598 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:28,613 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:29,152 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:29,166 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:29,978 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:29,999 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:30,631 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:30,651 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:30,683 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:30,692 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:31,309 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:31,335 INFO     [learner.py:606] ====Pushing takes 0.024150609970092773 s
2021-08-18:16:29:31,342 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:31,352 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:31,369 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:31,375 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:31,376 INFO     [param_server.py:410] Lock worker 1 with localStep 270 , while globalStep is 269

2021-08-18:16:29:31,490 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:31,510 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:33,966 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:33,977 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:34,350 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:34,360 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:34,673 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:34,682 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:35,508 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:35,518 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:35,852 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:35,862 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:36,501 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:36,528 INFO     [learner.py:606] ====Pushing takes 0.026025056838989258 s
2021-08-18:16:29:36,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:36,578 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:36,578 INFO     [param_server.py:410] Lock worker 3 with localStep 270 , while globalStep is 269

2021-08-18:16:29:36,634 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:36,644 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:37,816 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:37,844 INFO     [learner.py:606] ====Pushing takes 0.023801326751708984 s
2021-08-18:16:29:37,881 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:37,889 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:37,890 INFO     [param_server.py:381] ====After aggregation in epoch: 269, virtual_clock: 9748.620916767832, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 2.8840803128701666, test len: 3099.0
2021-08-18:16:29:37,892 INFO     [param_server.py:410] Lock worker 2 with localStep 270 , while globalStep is 270

2021-08-18:16:29:37,892 INFO     [param_server.py:441] ====Epoch 271 completes 20 clients with loss 108.92330718074653, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:37,893 INFO     [param_server.py:450] ====Start to sample for epoch 271, global virtualClock: 9748.620916767832, round_duration: 46.65186139097271
2021-08-18:16:29:37,894 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:38,235 INFO     [param_server.py:553] For epoch: 271, median_reward: 1040.9535207784031, dev: 5204.767603892015
2021-08-18:16:29:38,819 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7432, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:29:38,820 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3613.9557, eval_time 0.5399, test_loss 2.7432, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:29:38,855 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9084, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:29:38,858 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3613.9824, eval_time 0.5711, test_loss 2.9084, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:29:38,885 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:38,893 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:38,898 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2188, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:29:38,899 INFO     [learner.py:656] After aggregation epoch 270, CumulTime 3614.0381, eval_time 0.6192, test_loss 3.2188, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:29:38,924 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:38,937 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:38,966 INFO     [learner.py:526] ====Start train round 271
2021-08-18:16:29:38,985 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:40,301 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:40,314 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:40,537 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:40,547 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:41,585 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:41,594 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:41,726 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:41,739 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:42,205 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:42,225 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:42,923 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:42,943 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:43,574 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:43,588 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:43,891 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:43,901 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:44,114 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:44,123 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:44,573 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:44,586 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:44,605 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:44,613 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:44,623 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:44,629 INFO     [learner.py:606] ====Pushing takes 0.02231764793395996 s
2021-08-18:16:29:44,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:44,675 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:44,676 INFO     [param_server.py:410] Lock worker 1 with localStep 271 , while globalStep is 270

2021-08-18:16:29:47,238 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:47,243 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:29:47,247 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:29:47,253 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:29:47,886 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:29:47,896 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:29:48,480 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:29:48,491 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:29:49,138 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:29:49,147 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:29:49,778 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:29:49,798 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:29:49,803 INFO     [learner.py:606] ====Pushing takes 0.023282766342163086 s
2021-08-18:16:29:49,807 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:29:49,844 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:49,852 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:29:49,853 INFO     [param_server.py:410] Lock worker 3 with localStep 271 , while globalStep is 270

2021-08-18:16:29:50,364 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:29:50,390 INFO     [learner.py:606] ====Pushing takes 0.02420973777770996 s
2021-08-18:16:29:50,419 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:50,427 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:29:50,427 INFO     [param_server.py:381] ====After aggregation in epoch: 270, virtual_clock: 9795.272778158804, top_1: : 65.7631 % (2038.0), top_5: : 100.0 % (3099.0), test loss: 2.9568183620770774, test len: 3099.0
2021-08-18:16:29:50,430 INFO     [param_server.py:410] Lock worker 2 with localStep 271 , while globalStep is 271

2021-08-18:16:29:50,431 INFO     [param_server.py:441] ====Epoch 272 completes 20 clients with loss 131.37090695481135, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:29:50,431 INFO     [param_server.py:450] ====Start to sample for epoch 272, global virtualClock: 9795.272778158804, round_duration: 46.65186139097271
2021-08-18:16:29:50,432 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:29:50,784 INFO     [param_server.py:553] For epoch: 272, median_reward: 1019.6844307161649, dev: 5098.422153580825
2021-08-18:16:29:51,452 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9301, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:29:51,453 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3626.5887, eval_time 0.6244, test_loss 2.9301, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:29:51,467 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1306, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:29:51,467 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3626.5919, eval_time 0.639, test_loss 3.1306, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:29:51,519 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:51,541 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:29:51,543 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:51,564 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:29:51,577 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8223, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:29:51,590 INFO     [learner.py:656] After aggregation epoch 271, CumulTime 3626.7296, eval_time 0.7621, test_loss 2.8223, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:29:51,659 INFO     [learner.py:526] ====Start train round 272
2021-08-18:16:29:51,694 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:29:53,214 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:29:53,241 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:29:53,249 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:29:53,276 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:29:54,138 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:29:54,159 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:29:54,641 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:29:54,653 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:29:54,703 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:29:54,714 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:29:55,340 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:29:55,350 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:29:56,18 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:29:56,28 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:29:56,456 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:29:56,469 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:29:56,674 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:29:56,683 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:29:57,154 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:29:57,164 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:29:57,225 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:29:57,250 INFO     [learner.py:606] ====Pushing takes 0.023018360137939453 s
2021-08-18:16:29:57,292 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:29:57,301 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:29:57,302 INFO     [param_server.py:410] Lock worker 1 with localStep 272 , while globalStep is 271

2021-08-18:16:29:57,412 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:29:57,423 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:29:59,884 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:29:59,895 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:00,153 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:00,166 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:00,543 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:00,553 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:01,340 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:01,349 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:01,660 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:01,670 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:02,163 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:02,191 INFO     [learner.py:606] ====Pushing takes 0.026427268981933594 s
2021-08-18:16:30:02,230 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:02,237 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:02,238 INFO     [param_server.py:410] Lock worker 3 with localStep 272 , while globalStep is 271

2021-08-18:16:30:02,611 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:02,621 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:03,816 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:03,845 INFO     [learner.py:606] ====Pushing takes 0.024341583251953125 s
2021-08-18:16:30:03,874 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:03,882 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:03,882 INFO     [param_server.py:381] ====After aggregation in epoch: 271, virtual_clock: 9841.924639549776, top_1: : 66.3117 % (2055.0), top_5: : 100.0 % (3099.0), test loss: 2.96098780852777, test len: 3099.0
2021-08-18:16:30:03,885 INFO     [param_server.py:410] Lock worker 2 with localStep 272 , while globalStep is 272

2021-08-18:16:30:03,886 INFO     [param_server.py:441] ====Epoch 273 completes 20 clients with loss 292.5647384442212, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:03,886 INFO     [param_server.py:450] ====Start to sample for epoch 273, global virtualClock: 9841.924639549776, round_duration: 46.65186139097271
2021-08-18:16:30:03,887 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:04,230 INFO     [param_server.py:553] For epoch: 273, median_reward: 1344.7009686578629, dev: 6723.5048432893145
2021-08-18:16:30:04,972 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8608, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:30:04,973 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3640.0976, eval_time 0.6741, test_loss 2.8608, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:30:05,50 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:30:05,55 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8542, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:30:05,56 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3640.1922, eval_time 0.7573, test_loss 2.8542, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:30:05,71 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:05,106 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0056, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:30:05,110 INFO     [learner.py:656] After aggregation epoch 272, CumulTime 3640.2489, eval_time 0.8137, test_loss 3.0056, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:30:05,129 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:30:05,160 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:05,167 INFO     [learner.py:526] ====Start train round 273
2021-08-18:16:30:05,193 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:06,612 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:06,626 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:06,931 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:06,949 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:07,692 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:07,702 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:08,125 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:08,138 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:08,394 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:08,404 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:09,12 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:09,22 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:09,682 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:09,692 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:10,26 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:10,36 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:10,282 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:10,292 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:10,711 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:10,721 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:10,737 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:10,749 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:10,855 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:10,879 INFO     [learner.py:606] ====Pushing takes 0.022568464279174805 s
2021-08-18:16:30:10,915 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:10,922 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:10,923 INFO     [param_server.py:410] Lock worker 1 with localStep 273 , while globalStep is 272

2021-08-18:16:30:13,386 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:13,396 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:13,399 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:13,409 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:14,40 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:14,50 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:14,543 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:14,557 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:15,26 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:15,35 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:15,681 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:15,707 INFO     [learner.py:606] ====Pushing takes 0.024601221084594727 s
2021-08-18:16:30:15,738 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:15,748 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:15,748 INFO     [param_server.py:410] Lock worker 3 with localStep 273 , while globalStep is 272

2021-08-18:16:30:15,833 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:15,854 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:16,562 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:16,588 INFO     [learner.py:606] ====Pushing takes 0.024281978607177734 s
2021-08-18:16:30:16,616 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:16,623 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:16,624 INFO     [param_server.py:381] ====After aggregation in epoch: 272, virtual_clock: 9888.576500940748, top_1: : 65.86 % (2041.0), top_5: : 100.0 % (3099.0), test loss: 2.9068753299889742, test len: 3099.0
2021-08-18:16:30:16,626 INFO     [param_server.py:410] Lock worker 2 with localStep 273 , while globalStep is 273

2021-08-18:16:30:16,627 INFO     [param_server.py:441] ====Epoch 274 completes 20 clients with loss 125.67010676820968, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:16,627 INFO     [param_server.py:450] ====Start to sample for epoch 274, global virtualClock: 9888.576500940748, round_duration: 46.65186139097271
2021-08-18:16:30:16,628 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:16,965 INFO     [param_server.py:553] For epoch: 274, median_reward: 959.6954046745814, dev: 4798.477023372907
2021-08-18:16:30:17,668 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7881, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:30:17,669 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3652.8052, eval_time 0.6604, test_loss 2.7881, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:30:17,708 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5572, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:30:17,709 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3652.8335, eval_time 0.7001, test_loss 2.5572, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:30:17,759 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:30:17,763 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:30:17,768 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:17,779 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:17,793 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9212, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:30:17,794 INFO     [learner.py:656] After aggregation epoch 273, CumulTime 3652.9331, eval_time 0.7851, test_loss 2.9212, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:30:17,863 INFO     [learner.py:526] ====Start train round 274
2021-08-18:16:30:17,889 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:19,307 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:19,321 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:19,533 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:19,547 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:20,462 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:20,474 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:20,612 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:20,626 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:20,733 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:20,751 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:21,205 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:21,215 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:21,826 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:21,835 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:22,476 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:22,486 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:22,853 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:22,864 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:22,975 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:23,0 INFO     [learner.py:606] ====Pushing takes 0.019523143768310547 s
2021-08-18:16:30:23,33 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:23,39 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:23,40 INFO     [param_server.py:410] Lock worker 1 with localStep 274 , while globalStep is 273

2021-08-18:16:30:23,480 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:23,491 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:23,489 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:23,503 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:26,70 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:26,80 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:26,185 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:26,205 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:26,766 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:26,780 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:27,406 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:27,415 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:27,885 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:27,895 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:28,512 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:28,539 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:28,541 INFO     [learner.py:606] ====Pushing takes 0.027030467987060547 s
2021-08-18:16:30:28,551 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:28,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:28,587 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:28,588 INFO     [param_server.py:410] Lock worker 3 with localStep 274 , while globalStep is 273

2021-08-18:16:30:29,713 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:29,739 INFO     [learner.py:606] ====Pushing takes 0.02426910400390625 s
2021-08-18:16:30:29,769 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:29,776 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:29,777 INFO     [param_server.py:381] ====After aggregation in epoch: 273, virtual_clock: 9935.22836233172, top_1: : 65.8277 % (2040.0), top_5: : 100.0 % (3099.0), test loss: 2.7555219103340747, test len: 3099.0
2021-08-18:16:30:29,779 INFO     [param_server.py:410] Lock worker 2 with localStep 274 , while globalStep is 274

2021-08-18:16:30:29,780 INFO     [param_server.py:441] ====Epoch 275 completes 20 clients with loss 174.38486402333513, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:29,780 INFO     [param_server.py:450] ====Start to sample for epoch 275, global virtualClock: 9935.22836233172, round_duration: 46.65186139097271
2021-08-18:16:30:29,781 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:30,102 INFO     [param_server.py:553] For epoch: 275, median_reward: 1073.9264976421457, dev: 5369.632488210728
2021-08-18:16:30:30,701 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9857, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:30:30,702 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3665.8384, eval_time 0.5564, test_loss 2.9857, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:30:30,744 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5484, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:30:30,745 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3665.8692, eval_time 0.5985, test_loss 2.5484, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:30:30,781 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:30,789 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:30,813 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:30,818 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8235, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:30:30,819 INFO     [learner.py:656] After aggregation epoch 274, CumulTime 3665.9584, eval_time 0.6732, test_loss 2.8235, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:30:30,830 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:30,874 INFO     [learner.py:526] ====Start train round 275
2021-08-18:16:30:30,902 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:32,109 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:32,122 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:32,600 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:32,614 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:33,609 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:33,619 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:33,713 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:33,724 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:33,800 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:33,810 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:34,286 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:34,295 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:34,923 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:34,937 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:35,502 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:35,522 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:35,885 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:35,894 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:36,27 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:36,52 INFO     [learner.py:606] ====Pushing takes 0.023357391357421875 s
2021-08-18:16:30:36,95 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:36,104 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:36,105 INFO     [param_server.py:410] Lock worker 1 with localStep 275 , while globalStep is 274

2021-08-18:16:30:36,529 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:36,547 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:36,597 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:36,606 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:39,283 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:39,298 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:39,424 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:39,436 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:39,988 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:39,998 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:40,768 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:40,778 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:41,219 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:41,229 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:41,824 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:41,852 INFO     [learner.py:606] ====Pushing takes 0.026994705200195312 s
2021-08-18:16:30:41,892 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:41,900 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:41,901 INFO     [param_server.py:410] Lock worker 3 with localStep 275 , while globalStep is 274

2021-08-18:16:30:42,58 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:42,70 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:42,724 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:42,749 INFO     [learner.py:606] ====Pushing takes 0.023840904235839844 s
2021-08-18:16:30:42,787 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:42,794 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:42,794 INFO     [param_server.py:381] ====After aggregation in epoch: 274, virtual_clock: 9981.880223722692, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 2.785852047373299, test len: 3099.0
2021-08-18:16:30:42,796 INFO     [param_server.py:410] Lock worker 2 with localStep 275 , while globalStep is 275

2021-08-18:16:30:42,797 INFO     [param_server.py:441] ====Epoch 276 completes 20 clients with loss 132.9114127026943, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:42,797 INFO     [param_server.py:450] ====Start to sample for epoch 276, global virtualClock: 9981.880223722692, round_duration: 46.65186139097271
2021-08-18:16:30:42,798 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:43,140 INFO     [param_server.py:553] For epoch: 276, median_reward: 1102.0205440964469, dev: 5510.102720482235
2021-08-18:16:30:43,777 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0724, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:30:43,778 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3678.9028, eval_time 0.5871, test_loss 3.0724, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:30:43,831 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0866, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:30:43,832 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3678.9682, eval_time 0.6452, test_loss 3.0866, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:30:43,846 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:43,863 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:43,901 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:43,912 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9314, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:30:43,914 INFO     [learner.py:656] After aggregation epoch 275, CumulTime 3679.0534, eval_time 0.7295, test_loss 2.9314, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:30:43,916 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:43,982 INFO     [learner.py:526] ====Start train round 276
2021-08-18:16:30:44,11 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:45,241 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:45,255 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:45,729 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:45,743 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:30:46,516 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:30:46,525 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:30:46,695 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:30:46,722 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:30:47,51 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:30:47,67 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:30:47,630 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:30:47,650 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:30:48,501 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:30:48,516 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:30:48,984 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:30:48,995 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:30:49,138 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:30:49,152 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:30:49,618 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:30:49,641 INFO     [learner.py:606] ====Pushing takes 0.021521806716918945 s
2021-08-18:16:30:49,681 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:49,688 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:30:49,698 INFO     [param_server.py:410] Lock worker 1 with localStep 276 , while globalStep is 275

2021-08-18:16:30:49,747 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:30:49,759 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:30:50,217 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:30:50,226 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:30:52,479 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:30:52,492 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:30:52,844 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:30:52,853 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:30:53,84 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:30:53,93 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:30:54,188 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:30:54,199 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:30:54,512 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:30:54,522 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:30:55,119 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:30:55,149 INFO     [learner.py:606] ====Pushing takes 0.028847217559814453 s
2021-08-18:16:30:55,186 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:55,195 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:30:55,196 INFO     [param_server.py:410] Lock worker 3 with localStep 276 , while globalStep is 275

2021-08-18:16:30:55,351 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:30:55,363 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:30:56,459 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:30:56,487 INFO     [learner.py:606] ====Pushing takes 0.026070833206176758 s
2021-08-18:16:30:56,524 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:30:56,531 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:30:56,532 INFO     [param_server.py:381] ====After aggregation in epoch: 275, virtual_clock: 10028.532085113664, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 3.0301584590364388, test len: 3099.0
2021-08-18:16:30:56,534 INFO     [param_server.py:410] Lock worker 2 with localStep 276 , while globalStep is 276

2021-08-18:16:30:56,535 INFO     [param_server.py:441] ====Epoch 277 completes 20 clients with loss 137.477304817715, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:30:56,535 INFO     [param_server.py:450] ====Start to sample for epoch 277, global virtualClock: 10028.532085113664, round_duration: 46.65186139097271
2021-08-18:16:30:56,536 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:30:56,877 INFO     [param_server.py:553] For epoch: 277, median_reward: 1111.5319078652722, dev: 5557.659539326361
2021-08-18:16:30:57,574 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5619, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:30:57,574 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3692.6991, eval_time 0.6418, test_loss 2.5619, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:30:57,608 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2469, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:30:57,609 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3692.7448, eval_time 0.6739, test_loss 4.2469, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:30:57,640 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:57,641 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1114, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:30:57,642 INFO     [learner.py:656] After aggregation epoch 276, CumulTime 3692.7811, eval_time 0.7098, test_loss 3.1114, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:30:57,654 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:30:57,678 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:57,706 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:30:57,707 INFO     [learner.py:526] ====Start train round 277
2021-08-18:16:30:57,741 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:30:59,248 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:30:59,275 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:30:59,551 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:30:59,578 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:00,138 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:00,149 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:00,796 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:00,808 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:01,197 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:01,207 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:01,848 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:01,857 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:02,375 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:02,384 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:02,493 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:02,502 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:02,995 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:03,5 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:03,83 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:03,101 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:03,407 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:03,416 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:03,697 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:03,720 INFO     [learner.py:606] ====Pushing takes 0.021844148635864258 s
2021-08-18:16:31:03,760 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:03,766 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:03,767 INFO     [param_server.py:410] Lock worker 1 with localStep 277 , while globalStep is 276

2021-08-18:16:31:05,612 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:05,622 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:06,62 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:06,72 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:06,374 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:06,383 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:07,351 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:07,361 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:07,508 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:07,519 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:08,99 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:08,127 INFO     [learner.py:606] ====Pushing takes 0.027178287506103516 s
2021-08-18:16:31:08,166 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:08,174 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:31:08,177 INFO     [param_server.py:410] Lock worker 3 with localStep 277 , while globalStep is 276

2021-08-18:16:31:08,687 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:08,704 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:09,260 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:09,286 INFO     [learner.py:606] ====Pushing takes 0.024480581283569336 s
2021-08-18:16:31:09,324 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:09,331 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:09,332 INFO     [param_server.py:381] ====After aggregation in epoch: 276, virtual_clock: 10075.183946504636, top_1: : 65.3114 % (2024.0), top_5: : 100.0 % (3099.0), test loss: 3.306725794518435, test len: 3099.0
2021-08-18:16:31:09,334 INFO     [param_server.py:410] Lock worker 2 with localStep 277 , while globalStep is 277

2021-08-18:16:31:09,335 INFO     [param_server.py:441] ====Epoch 278 completes 20 clients with loss 135.91024792447186, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:09,335 INFO     [param_server.py:450] ====Start to sample for epoch 278, global virtualClock: 10075.183946504636, round_duration: 46.65186139097271
2021-08-18:16:31:09,336 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:31:09,671 INFO     [param_server.py:553] For epoch: 278, median_reward: 1119.0195078246784, dev: 5595.0975391233915
2021-08-18:16:31:10,389 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5835, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:31:10,390 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3705.5143, eval_time 0.66, test_loss 2.5835, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:31:10,390 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0514, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:31:10,391 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3705.5265, eval_time 0.6608, test_loss 3.0514, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:31:10,456 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:31:10,456 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:31:10,469 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:10,472 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:10,483 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9895, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:31:10,484 INFO     [learner.py:656] After aggregation epoch 277, CumulTime 3705.6232, eval_time 0.7582, test_loss 2.9895, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:31:10,540 INFO     [learner.py:526] ====Start train round 278
2021-08-18:16:31:10,573 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:11,884 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:11,905 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:12,221 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:12,234 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:13,172 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:13,187 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:13,333 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:13,354 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:13,501 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:13,521 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:14,80 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:14,89 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:14,587 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:14,596 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:15,118 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:15,131 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:15,548 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:15,560 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:15,592 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:15,618 INFO     [learner.py:606] ====Pushing takes 0.024183034896850586 s
2021-08-18:16:31:15,653 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:15,662 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:15,663 INFO     [param_server.py:410] Lock worker 1 with localStep 278 , while globalStep is 277

2021-08-18:16:31:16,47 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:16,57 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:16,148 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:16,157 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:18,715 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:18,717 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:18,731 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:18,731 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:19,384 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:19,393 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:19,984 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:19,998 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:20,588 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:20,602 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:21,190 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:21,218 INFO     [learner.py:606] ====Pushing takes 0.026607513427734375 s
2021-08-18:16:31:21,257 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:21,264 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:31:21,264 INFO     [param_server.py:410] Lock worker 3 with localStep 278 , while globalStep is 277

2021-08-18:16:31:21,349 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:21,367 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:22,501 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:22,528 INFO     [learner.py:606] ====Pushing takes 0.02478814125061035 s
2021-08-18:16:31:22,558 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:22,566 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:22,567 INFO     [param_server.py:381] ====After aggregation in epoch: 277, virtual_clock: 10121.835807895608, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 2.8748028344578214, test len: 3099.0
2021-08-18:16:31:22,570 INFO     [param_server.py:410] Lock worker 2 with localStep 278 , while globalStep is 278

2021-08-18:16:31:22,570 INFO     [param_server.py:441] ====Epoch 279 completes 20 clients with loss 159.5529540277633, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:22,571 INFO     [param_server.py:450] ====Start to sample for epoch 279, global virtualClock: 10121.835807895608, round_duration: 46.65186139097271
2021-08-18:16:31:22,572 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:31:22,841 INFO     [param_server.py:553] For epoch: 279, median_reward: 1244.1692708628805, dev: 6220.846354314403
2021-08-18:16:31:23,551 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8183, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:31:23,551 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0507, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:31:23,552 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3718.6764, eval_time 0.6646, test_loss 2.8183, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:31:23,552 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3718.688, eval_time 0.6649, test_loss 3.0507, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:31:23,616 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.073, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:31:23,619 INFO     [learner.py:656] After aggregation epoch 278, CumulTime 3718.7582, eval_time 0.7326, test_loss 3.073, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:31:23,646 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:31:23,647 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:31:23,655 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:23,655 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:23,687 INFO     [learner.py:526] ====Start train round 279
2021-08-18:16:31:23,705 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:24,897 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:24,918 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:25,331 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:25,350 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:26,335 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:26,349 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:26,644 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:26,655 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:26,877 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:26,887 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:27,505 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:27,515 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:28,118 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:28,132 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:28,507 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:28,516 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:28,673 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:28,687 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:29,168 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:29,178 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:29,279 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:29,305 INFO     [learner.py:606] ====Pushing takes 0.024851083755493164 s
2021-08-18:16:31:29,340 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:29,346 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:29,347 INFO     [param_server.py:410] Lock worker 1 with localStep 279 , while globalStep is 278

2021-08-18:16:31:29,509 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:29,521 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:31,776 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:31,785 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:32,326 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:32,336 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:32,421 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:32,440 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:33,554 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:33,558 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:33,571 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:33,570 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:34,144 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:34,172 INFO     [learner.py:606] ====Pushing takes 0.027362346649169922 s
2021-08-18:16:31:34,209 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:34,219 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:31:34,220 INFO     [param_server.py:410] Lock worker 3 with localStep 279 , while globalStep is 278

2021-08-18:16:31:34,891 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:34,901 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:35,528 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:35,560 INFO     [learner.py:606] ====Pushing takes 0.03064131736755371 s
2021-08-18:16:31:35,601 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:35,608 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:35,608 INFO     [param_server.py:381] ====After aggregation in epoch: 278, virtual_clock: 10168.48766928658, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 2.980677944642526, test len: 3099.0
2021-08-18:16:31:35,611 INFO     [param_server.py:410] Lock worker 2 with localStep 279 , while globalStep is 279

2021-08-18:16:31:35,611 INFO     [param_server.py:441] ====Epoch 280 completes 20 clients with loss 79.04806270254792, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:35,612 INFO     [param_server.py:450] ====Start to sample for epoch 280, global virtualClock: 10168.48766928658, round_duration: 46.65186139097271
2021-08-18:16:31:35,613 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:31:35,949 INFO     [param_server.py:553] For epoch: 280, median_reward: 1217.712891799804, dev: 6088.564458999021
2021-08-18:16:31:36,646 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7817, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:31:36,647 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3731.772, eval_time 0.65, test_loss 2.7817, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:31:36,651 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0924, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:31:36,652 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3731.7879, eval_time 0.658, test_loss 3.0924, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:31:36,718 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:36,722 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9139, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:31:36,722 INFO     [learner.py:656] After aggregation epoch 279, CumulTime 3731.8617, eval_time 0.7286, test_loss 3.9139, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:31:36,730 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:36,732 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:36,742 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:36,791 INFO     [learner.py:526] ====Start train round 280
2021-08-18:16:31:36,819 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:38,173 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:38,194 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:38,605 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:38,619 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:39,616 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:39,625 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:39,636 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:39,654 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:39,953 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:39,964 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:40,361 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:40,375 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:41,74 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:41,94 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:41,792 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:41,813 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:41,930 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:41,939 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:42,516 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:42,542 INFO     [learner.py:606] ====Pushing takes 0.0242459774017334 s
2021-08-18:16:31:42,577 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:42,582 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:42,583 INFO     [param_server.py:410] Lock worker 1 with localStep 280 , while globalStep is 279

2021-08-18:16:31:42,752 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:42,763 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:42,861 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:42,875 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:45,347 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:45,358 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:45,632 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:45,643 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:46,91 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:46,100 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:46,696 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:46,708 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:31:47,178 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:31:47,187 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:31:47,695 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:31:47,722 INFO     [learner.py:606] ====Pushing takes 0.025684118270874023 s
2021-08-18:16:31:47,761 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:47,772 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:31:47,772 INFO     [param_server.py:410] Lock worker 3 with localStep 280 , while globalStep is 279

2021-08-18:16:31:47,854 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:31:47,871 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:31:49,183 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:31:49,213 INFO     [learner.py:606] ====Pushing takes 0.02863168716430664 s
2021-08-18:16:31:49,243 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:49,251 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:31:49,252 INFO     [param_server.py:381] ====After aggregation in epoch: 279, virtual_clock: 10215.139530677552, top_1: : 65.9568 % (2044.0), top_5: : 100.0 % (3099.0), test loss: 3.262679122112415, test len: 3099.0
2021-08-18:16:31:49,254 INFO     [param_server.py:410] Lock worker 2 with localStep 280 , while globalStep is 280

2021-08-18:16:31:49,254 INFO     [param_server.py:441] ====Epoch 281 completes 20 clients with loss 176.64395449461597, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:31:49,255 INFO     [param_server.py:450] ====Start to sample for epoch 281, global virtualClock: 10215.139530677552, round_duration: 46.65186139097271
2021-08-18:16:31:49,255 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:31:49,522 INFO     [param_server.py:541] Handle Wight 0.03395342826843262 | Send 0.266815185546875
2021-08-18:16:31:49,523 INFO     [param_server.py:553] For epoch: 281, median_reward: 1028.383987412778, dev: 5141.91993706389
2021-08-18:16:31:50,176 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2971, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:31:50,177 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3745.3125, eval_time 0.6075, test_loss 3.2971, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:31:50,179 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7638, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:31:50,182 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3745.307, eval_time 0.6129, test_loss 2.7638, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:31:50,244 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:50,249 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:50,259 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:31:50,263 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:31:50,263 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3045, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:31:50,264 INFO     [learner.py:656] After aggregation epoch 280, CumulTime 3745.4034, eval_time 0.6978, test_loss 3.3045, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:31:50,339 INFO     [learner.py:526] ====Start train round 281
2021-08-18:16:31:50,368 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:31:51,677 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:31:51,704 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:31:51,983 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:31:52,4 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:31:53,93 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:31:53,103 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:31:53,255 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:31:53,273 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:31:53,694 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:31:53,712 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:31:54,447 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:31:54,460 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:31:55,148 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:31:55,162 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:31:55,442 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:31:55,453 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:31:55,712 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:31:55,721 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:31:55,996 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:31:56,6 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:31:56,179 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:31:56,188 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:31:56,323 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:31:56,344 INFO     [learner.py:606] ====Pushing takes 0.019774198532104492 s
2021-08-18:16:31:56,380 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:31:56,390 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:31:56,391 INFO     [param_server.py:410] Lock worker 1 with localStep 281 , while globalStep is 280

2021-08-18:16:31:58,759 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:31:58,770 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:31:58,790 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:31:58,801 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:31:59,492 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:31:59,501 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:31:59,969 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:31:59,978 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:00,537 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:00,546 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:01,104 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:01,122 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:01,132 INFO     [learner.py:606] ====Pushing takes 0.026803255081176758 s
2021-08-18:16:32:01,133 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:01,170 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:01,178 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:32:01,179 INFO     [param_server.py:410] Lock worker 3 with localStep 281 , while globalStep is 280

2021-08-18:16:32:01,651 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:01,683 INFO     [learner.py:606] ====Pushing takes 0.030633211135864258 s
2021-08-18:16:32:01,714 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:01,722 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:01,723 INFO     [param_server.py:381] ====After aggregation in epoch: 280, virtual_clock: 10261.791392068524, top_1: : 66.3763 % (2057.0), top_5: : 100.0 % (3099.0), test loss: 3.1218252270310014, test len: 3099.0
2021-08-18:16:32:01,725 INFO     [param_server.py:410] Lock worker 2 with localStep 281 , while globalStep is 281

2021-08-18:16:32:01,726 INFO     [param_server.py:441] ====Epoch 282 completes 20 clients with loss 302.7897394966466, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:01,727 INFO     [param_server.py:450] ====Start to sample for epoch 282, global virtualClock: 10261.791392068524, round_duration: 46.65186139097271
2021-08-18:16:32:01,728 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:32:02,99 INFO     [param_server.py:553] For epoch: 282, median_reward: 981.8530155657993, dev: 4909.265077828996
2021-08-18:16:32:02,725 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2143, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:32:02,726 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3757.8506, eval_time 0.568, test_loss 3.2143, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:32:02,787 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:32:02,796 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:02,807 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9845, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:32:02,814 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3757.9499, eval_time 0.6563, test_loss 2.9845, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:32:02,882 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6828, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:32:02,883 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:32:02,883 INFO     [learner.py:656] After aggregation epoch 281, CumulTime 3758.0221, eval_time 0.7275, test_loss 3.6828, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:32:02,900 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:02,950 INFO     [learner.py:526] ====Start train round 282
2021-08-18:16:32:02,980 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:04,454 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:04,487 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:04,675 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:04,702 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:32:05,736 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:05,750 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:05,857 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:32:05,871 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:05,908 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:05,929 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:06,527 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:06,536 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:07,132 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:07,141 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:07,761 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:07,772 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:08,30 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:08,44 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:08,426 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:08,446 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:08,452 INFO     [learner.py:606] ====Pushing takes 0.021870136260986328 s
2021-08-18:16:32:08,456 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:08,487 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:08,493 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:32:08,494 INFO     [param_server.py:410] Lock worker 1 with localStep 282 , while globalStep is 281

2021-08-18:16:32:08,681 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:08,692 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:11,100 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:11,129 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:11,456 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:11,468 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:12,180 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:12,189 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:12,419 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:12,429 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:13,379 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:13,389 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:13,639 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:13,653 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:14,38 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:14,66 INFO     [learner.py:606] ====Pushing takes 0.02643752098083496 s
2021-08-18:16:32:14,101 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:14,111 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:32:14,111 INFO     [param_server.py:410] Lock worker 3 with localStep 282 , while globalStep is 281

2021-08-18:16:32:14,849 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:14,879 INFO     [learner.py:606] ====Pushing takes 0.02820277214050293 s
2021-08-18:16:32:14,918 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:14,925 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:14,926 INFO     [param_server.py:381] ====After aggregation in epoch: 281, virtual_clock: 10308.443253459496, top_1: : 64.9887 % (2014.0), top_5: : 100.0 % (3099.0), test loss: 3.2938924100663924, test len: 3099.0
2021-08-18:16:32:14,928 INFO     [param_server.py:410] Lock worker 2 with localStep 282 , while globalStep is 282

2021-08-18:16:32:14,928 INFO     [param_server.py:441] ====Epoch 283 completes 20 clients with loss 101.67173795453297, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:14,928 INFO     [param_server.py:450] ====Start to sample for epoch 283, global virtualClock: 10308.443253459496, round_duration: 46.65186139097271
2021-08-18:16:32:14,929 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 53, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58]
2021-08-18:16:32:15,233 INFO     [param_server.py:553] For epoch: 283, median_reward: 1291.5846196146804, dev: 6457.923098073402
2021-08-18:16:32:15,971 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8536, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:32:15,972 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3771.0962, eval_time 0.6798, test_loss 2.8536, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:32:16,36 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:32:16,45 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:16,53 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1183, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:32:16,54 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3771.1897, eval_time 0.7624, test_loss 3.1183, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:32:16,122 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:32:16,123 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3225, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:32:16,124 INFO     [learner.py:656] After aggregation epoch 282, CumulTime 3771.2631, eval_time 0.8356, test_loss 3.3225, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:32:16,139 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:16,190 INFO     [learner.py:526] ====Start train round 283
2021-08-18:16:32:16,225 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:17,599 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:17,619 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:18,1 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:18,18 INFO     [learner.py:165] Start to run client 53 on rank 2...
2021-08-18:16:32:19,50 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:19,64 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:19,209 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:19,219 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:19,254 INFO     [learner.py:439] Completed to run client 53
2021-08-18:16:32:19,265 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:19,827 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:19,837 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:20,440 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:20,452 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:21,25 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:21,35 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:21,444 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:21,453 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:21,580 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:21,606 INFO     [learner.py:606] ====Pushing takes 0.02408003807067871 s
2021-08-18:16:32:21,641 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:21,647 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 6 clients
2021-08-18:16:32:21,648 INFO     [param_server.py:410] Lock worker 1 with localStep 283 , while globalStep is 282

2021-08-18:16:32:21,929 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:21,941 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:22,132 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:22,142 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:24,592 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:24,611 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:24,957 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:24,970 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:25,768 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:25,778 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:25,870 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:25,880 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:26,878 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:26,888 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:27,174 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:27,192 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:27,575 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:27,604 INFO     [learner.py:606] ====Pushing takes 0.027646303176879883 s
2021-08-18:16:32:27,648 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:27,656 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 13 clients
2021-08-18:16:32:27,656 INFO     [param_server.py:410] Lock worker 3 with localStep 283 , while globalStep is 282

2021-08-18:16:32:27,707 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:27,733 INFO     [learner.py:606] ====Pushing takes 0.024273157119750977 s
2021-08-18:16:32:27,762 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:27,769 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:27,770 INFO     [param_server.py:381] ====After aggregation in epoch: 282, virtual_clock: 10355.095114850468, top_1: : 66.4408 % (2059.0), top_5: : 100.0 % (3099.0), test loss: 3.098114746588248, test len: 3099.0
2021-08-18:16:32:27,772 INFO     [param_server.py:410] Lock worker 2 with localStep 283 , while globalStep is 283

2021-08-18:16:32:27,772 INFO     [param_server.py:441] ====Epoch 284 completes 20 clients with loss 129.14468816375586, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 53: 0, 58: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:27,773 INFO     [param_server.py:450] ====Start to sample for epoch 284, global virtualClock: 10355.095114850468, round_duration: 46.65186139097271
2021-08-18:16:32:27,773 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:28,37 INFO     [param_server.py:553] For epoch: 284, median_reward: 1069.4417076727107, dev: 5347.208538363553
2021-08-18:16:32:28,628 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7555, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:32:28,629 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3783.7541, eval_time 0.5453, test_loss 2.7555, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:32:28,673 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2997, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:32:28,674 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3783.8099, eval_time 0.5919, test_loss 3.2997, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:32:28,695 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:28,704 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:28,758 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:28,763 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4468, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:32:28,766 INFO     [learner.py:656] After aggregation epoch 283, CumulTime 3783.9052, eval_time 0.6838, test_loss 3.4468, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:32:28,773 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:28,834 INFO     [learner.py:526] ====Start train round 284
2021-08-18:16:32:28,864 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:30,906 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:30,927 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:31,196 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:31,207 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:31,609 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:31,622 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:33,135 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:33,154 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:33,788 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:33,798 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:33,979 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:33,992 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:34,481 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:34,494 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:34,607 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:34,617 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:35,850 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:35,870 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:36,576 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:36,590 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:36,817 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:36,832 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:37,349 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:37,361 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:37,775 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:37,796 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:38,496 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:38,524 INFO     [learner.py:606] ====Pushing takes 0.026302337646484375 s
2021-08-18:16:32:38,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:38,576 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:38,577 INFO     [param_server.py:410] Lock worker 1 with localStep 284 , while globalStep is 283

2021-08-18:16:32:38,620 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:38,632 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:38,666 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:38,676 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:40,315 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:40,326 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:40,869 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:40,878 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:41,381 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:41,409 INFO     [learner.py:606] ====Pushing takes 0.02650141716003418 s
2021-08-18:16:32:41,447 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:41,454 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:41,455 INFO     [param_server.py:410] Lock worker 3 with localStep 284 , while globalStep is 283

2021-08-18:16:32:42,831 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:42,855 INFO     [learner.py:606] ====Pushing takes 0.022917747497558594 s
2021-08-18:16:32:42,881 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:42,904 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:42,904 INFO     [param_server.py:381] ====After aggregation in epoch: 283, virtual_clock: 10432.204663199062, top_1: : 63.9561 % (1982.0), top_5: : 100.0 % (3099.0), test loss: 3.1673157744937472, test len: 3099.0
2021-08-18:16:32:42,909 INFO     [param_server.py:410] Lock worker 2 with localStep 284 , while globalStep is 284

2021-08-18:16:32:42,909 INFO     [param_server.py:441] ====Epoch 285 completes 20 clients with loss 50.536421663580256, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:42,910 INFO     [param_server.py:450] ====Start to sample for epoch 285, global virtualClock: 10432.204663199062, round_duration: 77.10954834859407
2021-08-18:16:32:42,911 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:43,187 INFO     [param_server.py:553] For epoch: 285, median_reward: 1114.9255173340985, dev: 5574.627586670493
2021-08-18:16:32:43,901 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8976, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:32:43,902 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3799.0381, eval_time 0.6818, test_loss 2.8976, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:32:43,935 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1334, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:32:43,935 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3799.0747, eval_time 0.7152, test_loss 3.1334, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:32:43,938 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5419, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:32:43,941 INFO     [learner.py:656] After aggregation epoch 284, CumulTime 3799.0656, eval_time 0.7206, test_loss 2.5419, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:32:43,979 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:43,989 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:43,993 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:44,7 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:44,12 INFO     [learner.py:526] ====Start train round 285
2021-08-18:16:32:44,28 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:45,190 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:45,204 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:45,650 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:45,664 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:46,596 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:46,605 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:32:47,82 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:32:47,100 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:32:48,318 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:32:48,342 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:32:48,403 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:32:48,422 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:32:48,931 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:32:48,941 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:32:49,98 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:32:49,112 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:32:49,589 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:32:49,607 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:32:49,703 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:32:49,712 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:32:50,250 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:32:50,260 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:32:50,916 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:32:50,941 INFO     [learner.py:606] ====Pushing takes 0.023943662643432617 s
2021-08-18:16:32:50,981 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:50,988 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:32:50,989 INFO     [param_server.py:410] Lock worker 1 with localStep 285 , while globalStep is 284

2021-08-18:16:32:51,183 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:32:51,194 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:32:52,280 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:32:52,289 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:32:52,425 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:32:52,435 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:32:53,36 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:32:53,45 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:32:54,681 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:32:54,695 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:32:54,830 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:32:54,849 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:32:55,307 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:32:55,334 INFO     [learner.py:606] ====Pushing takes 0.025954484939575195 s
2021-08-18:16:32:55,365 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:55,375 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:32:55,376 INFO     [param_server.py:410] Lock worker 3 with localStep 285 , while globalStep is 284

2021-08-18:16:32:55,749 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:32:55,772 INFO     [learner.py:606] ====Pushing takes 0.022558212280273438 s
2021-08-18:16:32:55,799 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:32:55,805 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:32:55,806 INFO     [param_server.py:381] ====After aggregation in epoch: 284, virtual_clock: 10494.405983855599, top_1: : 66.2472 % (2053.0), top_5: : 100.0 % (3099.0), test loss: 2.8576474366364657, test len: 3099.0
2021-08-18:16:32:55,809 INFO     [param_server.py:410] Lock worker 2 with localStep 285 , while globalStep is 285

2021-08-18:16:32:55,809 INFO     [param_server.py:441] ====Epoch 286 completes 20 clients with loss 109.06620354202938, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:32:55,809 INFO     [param_server.py:450] ====Start to sample for epoch 286, global virtualClock: 10494.405983855599, round_duration: 62.20132065653664
2021-08-18:16:32:55,810 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:32:56,131 INFO     [param_server.py:553] For epoch: 286, median_reward: 1119.9118629909617, dev: 5599.5593149548085
2021-08-18:16:32:56,758 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7872, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:32:56,759 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3811.8836, eval_time 0.5819, test_loss 2.7872, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:32:56,779 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0516, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:32:56,780 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3811.9158, eval_time 0.604, test_loss 3.0516, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:32:56,825 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0227, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:32:56,826 INFO     [learner.py:656] After aggregation epoch 285, CumulTime 3811.9654, eval_time 0.6503, test_loss 3.0227, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:32:56,829 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:56,842 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:32:56,849 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:56,863 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:32:56,892 INFO     [learner.py:526] ====Start train round 286
2021-08-18:16:32:56,915 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:32:58,354 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:32:58,375 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:32:58,645 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:32:58,654 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:32:59,567 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:32:59,577 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:00,276 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:00,289 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:01,327 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:01,337 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:01,391 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:01,402 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:01,917 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:01,927 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:01,935 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:01,944 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:02,509 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:02,519 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:02,562 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:02,572 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:03,116 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:03,139 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:03,760 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:03,785 INFO     [learner.py:606] ====Pushing takes 0.02402949333190918 s
2021-08-18:16:33:03,820 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:03,827 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:03,828 INFO     [param_server.py:410] Lock worker 1 with localStep 286 , while globalStep is 285

2021-08-18:16:33:03,954 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:03,965 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:05,106 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:05,117 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:05,174 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:05,188 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:06,28 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:06,37 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:07,601 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:07,612 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:07,614 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:07,626 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:08,215 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:08,244 INFO     [learner.py:606] ====Pushing takes 0.026721715927124023 s
2021-08-18:16:33:08,281 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:08,288 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:08,289 INFO     [param_server.py:410] Lock worker 3 with localStep 286 , while globalStep is 285

2021-08-18:16:33:08,529 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:08,553 INFO     [learner.py:606] ====Pushing takes 0.022305011749267578 s
2021-08-18:16:33:08,579 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:08,587 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:08,588 INFO     [param_server.py:381] ====After aggregation in epoch: 285, virtual_clock: 10558.53995857835, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 2.9538510463855885, test len: 3099.0
2021-08-18:16:33:08,591 INFO     [param_server.py:410] Lock worker 2 with localStep 286 , while globalStep is 286

2021-08-18:16:33:08,592 INFO     [param_server.py:441] ====Epoch 287 completes 20 clients with loss 59.98175074989844, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:08,592 INFO     [param_server.py:450] ====Start to sample for epoch 287, global virtualClock: 10558.53995857835, round_duration: 64.13397472275163
2021-08-18:16:33:08,593 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:08,899 INFO     [param_server.py:553] For epoch: 287, median_reward: 1156.1289184025816, dev: 5780.644592012908
2021-08-18:16:33:09,561 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5633, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:33:09,562 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3824.6871, eval_time 0.6007, test_loss 2.5633, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:33:09,565 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8966, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:33:09,567 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3824.7026, eval_time 0.6062, test_loss 2.8966, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:33:09,594 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8264, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:33:09,595 INFO     [learner.py:656] After aggregation epoch 286, CumulTime 3824.7339, eval_time 0.6402, test_loss 2.8264, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:33:09,678 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:33:09,684 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:33:09,684 INFO     [learner.py:526] ====Start train round 287
2021-08-18:16:33:09,693 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:09,693 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:09,701 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:11,1 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:11,22 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:11,397 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:11,410 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:12,348 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:12,358 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:12,731 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:12,809 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:14,5 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:14,15 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:14,32 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:14,47 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:14,723 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:14,743 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:14,859 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:14,868 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:15,411 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:15,425 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:15,572 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:15,582 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:16,49 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:16,69 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:16,678 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:16,704 INFO     [learner.py:606] ====Pushing takes 0.02479863166809082 s
2021-08-18:16:33:16,738 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:16,748 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:16,748 INFO     [param_server.py:410] Lock worker 1 with localStep 287 , while globalStep is 286

2021-08-18:16:33:16,766 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:16,778 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:18,108 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:18,122 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:18,125 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:18,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:18,937 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:18,946 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:20,24 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:20,38 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:20,594 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:20,622 INFO     [learner.py:606] ====Pushing takes 0.027492523193359375 s
2021-08-18:16:33:20,659 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:20,666 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:20,666 INFO     [param_server.py:410] Lock worker 3 with localStep 287 , while globalStep is 286

2021-08-18:16:33:20,716 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:20,737 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:21,546 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:21,569 INFO     [learner.py:606] ====Pushing takes 0.022582292556762695 s
2021-08-18:16:33:21,597 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:21,604 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:21,604 INFO     [param_server.py:381] ====After aggregation in epoch: 286, virtual_clock: 10616.18614648818, top_1: : 66.3117 % (2055.0), top_5: : 100.0 % (3099.0), test loss: 2.7620860205756297, test len: 3099.0
2021-08-18:16:33:21,607 INFO     [param_server.py:410] Lock worker 2 with localStep 287 , while globalStep is 287

2021-08-18:16:33:21,607 INFO     [param_server.py:441] ====Epoch 288 completes 20 clients with loss 104.02241958558255, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:21,608 INFO     [param_server.py:450] ====Start to sample for epoch 288, global virtualClock: 10616.18614648818, round_duration: 57.6461879098304
2021-08-18:16:33:21,608 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:21,880 INFO     [param_server.py:553] For epoch: 288, median_reward: 1195.3465203566107, dev: 5976.732601783053
2021-08-18:16:33:22,630 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1215, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:33:22,632 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3837.7677, eval_time 0.7061, test_loss 3.1215, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:33:22,637 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5796, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:33:22,638 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3837.7626, eval_time 0.7123, test_loss 2.5796, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:33:22,663 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9605, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:33:22,667 INFO     [learner.py:656] After aggregation epoch 287, CumulTime 3837.8062, eval_time 0.7421, test_loss 2.9605, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:33:22,702 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:33:22,710 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:22,711 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:33:22,719 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:22,735 INFO     [learner.py:526] ====Start train round 288
2021-08-18:16:33:22,748 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:23,950 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:23,964 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:24,285 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:24,299 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:25,459 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:25,471 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:25,731 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:25,740 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:26,997 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:27,11 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:27,34 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:27,45 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:27,801 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:27,811 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:27,819 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:27,833 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:28,581 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:28,584 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:28,590 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:28,598 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:29,181 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:29,208 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:29,708 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:29,722 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:29,844 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:29,872 INFO     [learner.py:606] ====Pushing takes 0.026442766189575195 s
2021-08-18:16:33:29,907 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:29,914 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:29,914 INFO     [param_server.py:410] Lock worker 1 with localStep 288 , while globalStep is 287

2021-08-18:16:33:31,20 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:31,35 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:31,253 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:31,268 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:31,981 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:31,990 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:33,195 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:33,223 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:33,507 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:33,534 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:33,895 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:33,922 INFO     [learner.py:606] ====Pushing takes 0.02536630630493164 s
2021-08-18:16:33:33,961 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:33,971 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:33,971 INFO     [param_server.py:410] Lock worker 3 with localStep 288 , while globalStep is 287

2021-08-18:16:33:34,254 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:34,278 INFO     [learner.py:606] ====Pushing takes 0.02237844467163086 s
2021-08-18:16:33:34,303 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:34,310 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:34,311 INFO     [param_server.py:381] ====After aggregation in epoch: 287, virtual_clock: 10673.83233439801, top_1: : 66.5053 % (2061.0), top_5: : 100.0 % (3099.0), test loss: 2.887191816612526, test len: 3099.0
2021-08-18:16:33:34,320 INFO     [param_server.py:410] Lock worker 2 with localStep 288 , while globalStep is 288

2021-08-18:16:33:34,321 INFO     [param_server.py:441] ====Epoch 289 completes 20 clients with loss 80.30660871185408, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:34,321 INFO     [param_server.py:450] ====Start to sample for epoch 289, global virtualClock: 10673.83233439801, round_duration: 57.6461879098304
2021-08-18:16:33:34,322 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:34,630 INFO     [param_server.py:553] For epoch: 289, median_reward: 1117.9892731123086, dev: 5589.946365561544
2021-08-18:16:33:35,163 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6764, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:33:35,164 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3850.2884, eval_time 0.493, test_loss 2.6764, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:33:35,168 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9478, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:33:35,169 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3850.3046, eval_time 0.5002, test_loss 2.9478, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:33:35,199 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9856, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:33:35,201 INFO     [learner.py:656] After aggregation epoch 288, CumulTime 3850.3399, eval_time 0.5367, test_loss 2.9856, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:33:35,235 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:35,241 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:35,243 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:35,251 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:35,270 INFO     [learner.py:526] ====Start train round 289
2021-08-18:16:33:35,282 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:36,652 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:36,667 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:37,18 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:37,32 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:37,952 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:37,961 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:38,550 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:38,568 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:39,719 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:39,737 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:39,817 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:39,828 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:40,68 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:40,77 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:40,463 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:40,476 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:40,737 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:40,747 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:41,237 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:41,258 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:41,850 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:41,877 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:42,398 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:42,426 INFO     [learner.py:606] ====Pushing takes 0.026059389114379883 s
2021-08-18:16:33:42,459 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:42,466 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:42,467 INFO     [param_server.py:410] Lock worker 1 with localStep 289 , while globalStep is 288

2021-08-18:16:33:42,797 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:42,812 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:43,313 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:43,329 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:44,86 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:44,104 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:44,139 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:44,153 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:45,215 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:45,224 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:45,830 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:45,857 INFO     [learner.py:606] ====Pushing takes 0.024961471557617188 s
2021-08-18:16:33:45,887 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:45,894 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:45,895 INFO     [param_server.py:410] Lock worker 3 with localStep 289 , while globalStep is 288

2021-08-18:16:33:46,438 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:46,454 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:47,168 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:33:47,193 INFO     [learner.py:606] ====Pushing takes 0.02278423309326172 s
2021-08-18:16:33:47,219 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:47,226 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:33:47,227 INFO     [param_server.py:381] ====After aggregation in epoch: 288, virtual_clock: 10731.47852230784, top_1: : 65.4082 % (2027.0), top_5: : 100.0 % (3099.0), test loss: 2.869918377311141, test len: 3099.0
2021-08-18:16:33:47,229 INFO     [param_server.py:410] Lock worker 2 with localStep 289 , while globalStep is 289

2021-08-18:16:33:47,229 INFO     [param_server.py:441] ====Epoch 290 completes 20 clients with loss 120.69776992449638, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:33:47,230 INFO     [param_server.py:450] ====Start to sample for epoch 290, global virtualClock: 10731.47852230784, round_duration: 57.6461879098304
2021-08-18:16:33:47,230 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:33:47,508 INFO     [param_server.py:553] For epoch: 290, median_reward: 975.2800961490681, dev: 4876.40048074534
2021-08-18:16:33:48,123 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9896, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:33:48,128 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3863.2642, eval_time 0.5974, test_loss 2.9896, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:33:48,198 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:48,203 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1467, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:33:48,204 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3863.3285, eval_time 0.6731, test_loss 3.1467, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:33:48,206 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:33:48,241 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7811, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:33:48,242 INFO     [learner.py:656] After aggregation epoch 289, CumulTime 3863.3812, eval_time 0.7111, test_loss 2.7811, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:33:48,272 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:48,279 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:33:48,312 INFO     [learner.py:526] ====Start train round 290
2021-08-18:16:33:48,326 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:33:49,543 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:33:49,563 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:33:49,952 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:33:49,963 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:33:50,995 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:33:51,5 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:33:51,264 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:33:51,282 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:33:52,642 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:33:52,644 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:33:52,658 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:33:52,665 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:33:53,321 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:33:53,333 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:33:53,403 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:33:53,424 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:33:54,97 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:33:54,107 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:33:54,116 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:33:54,131 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:33:54,752 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:33:54,779 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:33:55,324 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:33:55,354 INFO     [learner.py:606] ====Pushing takes 0.028229236602783203 s
2021-08-18:16:33:55,395 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:55,404 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:33:55,405 INFO     [param_server.py:410] Lock worker 1 with localStep 290 , while globalStep is 289

2021-08-18:16:33:55,653 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:33:55,663 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:33:56,747 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:33:56,757 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:33:56,769 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:33:56,779 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:33:57,466 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:33:57,475 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:33:58,883 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:33:58,901 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:33:59,226 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:33:59,240 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:33:59,493 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:33:59,522 INFO     [learner.py:606] ====Pushing takes 0.027432680130004883 s
2021-08-18:16:33:59,552 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:33:59,559 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:33:59,560 INFO     [param_server.py:410] Lock worker 3 with localStep 290 , while globalStep is 289

2021-08-18:16:34:00,67 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:00,91 INFO     [learner.py:606] ====Pushing takes 0.022745847702026367 s
2021-08-18:16:34:00,117 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:00,123 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:00,124 INFO     [param_server.py:381] ====After aggregation in epoch: 289, virtual_clock: 10789.12471021767, top_1: : 66.6344 % (2065.0), top_5: : 100.0 % (3099.0), test loss: 2.9724553580637334, test len: 3099.0
2021-08-18:16:34:00,126 INFO     [param_server.py:410] Lock worker 2 with localStep 290 , while globalStep is 290

2021-08-18:16:34:00,126 INFO     [param_server.py:441] ====Epoch 291 completes 20 clients with loss 113.84176021183188, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:00,127 INFO     [param_server.py:450] ====Start to sample for epoch 291, global virtualClock: 10789.12471021767, round_duration: 57.6461879098304
2021-08-18:16:34:00,128 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:00,403 INFO     [param_server.py:553] For epoch: 291, median_reward: 931.5394815940934, dev: 4657.697407970467
2021-08-18:16:34:00,981 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0481, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:34:00,982 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3876.1176, eval_time 0.5525, test_loss 3.0481, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:34:00,988 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5624, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:34:00,988 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3876.113, eval_time 0.5574, test_loss 2.5624, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:34:01,27 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9845, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:34:01,27 INFO     [learner.py:656] After aggregation epoch 290, CumulTime 3876.1666, eval_time 0.6006, test_loss 2.9845, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:34:01,54 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:34:01,63 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:01,83 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:34:01,91 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:01,110 INFO     [learner.py:526] ====Start train round 291
2021-08-18:16:34:01,128 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:02,539 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:02,560 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:02,851 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:02,865 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:03,867 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:03,876 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:04,313 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:04,333 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:05,658 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:05,671 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:05,773 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:05,788 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:06,287 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:06,297 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:06,448 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:06,458 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:06,951 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:06,961 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:07,63 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:07,73 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:07,736 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:07,750 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:08,391 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:08,421 INFO     [learner.py:606] ====Pushing takes 0.026513099670410156 s
2021-08-18:16:34:08,461 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:08,468 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:08,469 INFO     [param_server.py:410] Lock worker 1 with localStep 291 , while globalStep is 290

2021-08-18:16:34:08,517 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:08,527 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:09,783 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:09,793 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:09,809 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:09,820 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:10,422 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:10,436 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:11,560 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:11,574 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:12,141 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:12,155 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:12,210 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:12,237 INFO     [learner.py:606] ====Pushing takes 0.026160717010498047 s
2021-08-18:16:34:12,275 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:12,282 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:12,283 INFO     [param_server.py:410] Lock worker 3 with localStep 291 , while globalStep is 290

2021-08-18:16:34:12,809 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:12,836 INFO     [learner.py:606] ====Pushing takes 0.025478601455688477 s
2021-08-18:16:34:12,862 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:12,871 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:12,871 INFO     [param_server.py:381] ====After aggregation in epoch: 290, virtual_clock: 10846.7708981275, top_1: : 65.989 % (2045.0), top_5: : 100.0 % (3099.0), test loss: 2.8650152109287403, test len: 3099.0
2021-08-18:16:34:12,873 INFO     [param_server.py:410] Lock worker 2 with localStep 291 , while globalStep is 291

2021-08-18:16:34:12,873 INFO     [param_server.py:441] ====Epoch 292 completes 20 clients with loss 158.0375400218747, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:12,874 INFO     [param_server.py:450] ====Start to sample for epoch 292, global virtualClock: 10846.7708981275, round_duration: 57.6461879098304
2021-08-18:16:34:12,874 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:13,180 INFO     [param_server.py:553] For epoch: 292, median_reward: 1083.7976864076004, dev: 5418.988432038002
2021-08-18:16:34:13,791 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7304, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:34:13,792 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3888.9277, eval_time 0.5751, test_loss 3.7304, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:34:13,798 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6131, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:34:13,798 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3888.923, eval_time 0.5804, test_loss 2.6131, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:34:13,862 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:34:13,871 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:13,875 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:34:13,876 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0195, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:34:13,877 INFO     [learner.py:656] After aggregation epoch 291, CumulTime 3889.0163, eval_time 0.663, test_loss 3.0195, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:34:13,883 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:13,948 INFO     [learner.py:526] ====Start train round 292
2021-08-18:16:34:13,966 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:15,466 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:15,493 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:15,671 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:15,692 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:16,619 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:16,629 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:17,345 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:17,359 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:18,412 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:18,429 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:18,559 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:18,568 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:18,923 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:18,935 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:19,187 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:19,197 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:19,580 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:19,589 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:19,844 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:19,854 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:20,506 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:20,520 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:21,51 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:21,80 INFO     [learner.py:606] ====Pushing takes 0.0272371768951416 s
2021-08-18:16:34:21,95 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:21,105 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:21,125 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:21,132 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:21,133 INFO     [param_server.py:410] Lock worker 1 with localStep 292 , while globalStep is 291

2021-08-18:16:34:22,327 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:22,337 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:22,388 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:22,397 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:22,995 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:23,4 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:24,176 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:24,190 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:24,860 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:24,890 INFO     [learner.py:606] ====Pushing takes 0.02846670150756836 s
2021-08-18:16:34:24,929 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:24,936 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:24,938 INFO     [param_server.py:410] Lock worker 3 with localStep 292 , while globalStep is 291

2021-08-18:16:34:24,957 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:24,971 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:25,740 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:25,765 INFO     [learner.py:606] ====Pushing takes 0.023624897003173828 s
2021-08-18:16:34:25,791 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:25,798 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:25,798 INFO     [param_server.py:381] ====After aggregation in epoch: 291, virtual_clock: 10904.417086037329, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.1210075903821877, test len: 3099.0
2021-08-18:16:34:25,801 INFO     [param_server.py:410] Lock worker 2 with localStep 292 , while globalStep is 292

2021-08-18:16:34:25,801 INFO     [param_server.py:441] ====Epoch 293 completes 20 clients with loss 209.0730577832597, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:25,802 INFO     [param_server.py:450] ====Start to sample for epoch 293, global virtualClock: 10904.417086037329, round_duration: 57.6461879098304
2021-08-18:16:34:25,803 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:26,93 INFO     [param_server.py:553] For epoch: 293, median_reward: 1192.2439038366754, dev: 5961.219519183377
2021-08-18:16:34:26,749 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7623, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:34:26,750 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3901.8742, eval_time 0.61, test_loss 2.7623, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:34:26,794 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8068, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:34:26,795 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3901.9314, eval_time 0.6572, test_loss 3.8068, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:34:26,820 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:34:26,830 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:26,864 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:34:26,873 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1041, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:34:26,876 INFO     [learner.py:656] After aggregation epoch 292, CumulTime 3902.0157, eval_time 0.7382, test_loss 3.1041, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:34:26,883 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:26,948 INFO     [learner.py:526] ====Start train round 293
2021-08-18:16:34:26,972 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:28,322 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:28,344 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:28,673 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:28,691 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:29,656 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:29,666 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:30,194 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:30,204 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:31,298 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:31,309 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:31,420 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:31,429 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:31,900 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:31,910 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:32,40 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:32,50 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:32,529 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:32,540 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:32,622 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:32,636 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:33,174 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:33,195 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:33,903 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:33,930 INFO     [learner.py:606] ====Pushing takes 0.025906085968017578 s
2021-08-18:16:34:33,969 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:33,978 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:33,979 INFO     [param_server.py:410] Lock worker 1 with localStep 293 , while globalStep is 292

2021-08-18:16:34:34,48 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:34,61 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:35,211 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:35,221 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:35,228 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:35,240 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:35,940 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:35,950 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:37,130 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:37,143 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:37,708 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:37,736 INFO     [learner.py:606] ====Pushing takes 0.026871681213378906 s
2021-08-18:16:34:37,774 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:37,775 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:37,781 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:37,782 INFO     [param_server.py:410] Lock worker 3 with localStep 293 , while globalStep is 292

2021-08-18:16:34:37,796 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:38,598 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:38,623 INFO     [learner.py:606] ====Pushing takes 0.0234982967376709 s
2021-08-18:16:34:38,656 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:38,662 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:38,662 INFO     [param_server.py:381] ====After aggregation in epoch: 292, virtual_clock: 10962.063273947158, top_1: : 65.1178 % (2018.0), top_5: : 100.0 % (3099.0), test loss: 3.224412935751456, test len: 3099.0
2021-08-18:16:34:38,665 INFO     [param_server.py:410] Lock worker 2 with localStep 293 , while globalStep is 293

2021-08-18:16:34:38,665 INFO     [param_server.py:441] ====Epoch 294 completes 20 clients with loss 125.8308881768416, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:38,666 INFO     [param_server.py:450] ====Start to sample for epoch 294, global virtualClock: 10962.063273947158, round_duration: 57.6461879098304
2021-08-18:16:34:38,666 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:38,932 INFO     [param_server.py:553] For epoch: 294, median_reward: 1092.19299867198, dev: 5460.964993359899
2021-08-18:16:34:39,609 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5694, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:34:39,612 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3914.7365, eval_time 0.6341, test_loss 2.5694, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:34:39,615 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8337, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:34:39,615 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3914.7514, eval_time 0.6376, test_loss 2.8337, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:34:39,648 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8926, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:34:39,650 INFO     [learner.py:656] After aggregation epoch 293, CumulTime 3914.7888, eval_time 0.6717, test_loss 2.8926, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:34:39,680 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:39,685 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:39,689 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:39,693 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:39,720 INFO     [learner.py:526] ====Start train round 294
2021-08-18:16:34:39,733 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:41,27 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:41,41 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:41,339 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:41,353 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:42,376 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:42,385 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:42,621 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:42,631 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:43,808 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:43,821 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:44,50 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:44,59 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:44,553 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:44,567 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:44,801 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:44,811 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:45,224 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:45,244 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:45,549 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:45,558 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:45,981 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:46,2 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:46,689 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:46,701 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:46,826 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:46,854 INFO     [learner.py:606] ====Pushing takes 0.025824308395385742 s
2021-08-18:16:34:46,894 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:46,902 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:46,903 INFO     [param_server.py:410] Lock worker 1 with localStep 294 , while globalStep is 293

2021-08-18:16:34:47,825 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:34:47,839 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:34:48,296 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:34:48,310 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:34:48,945 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:34:48,955 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:34:50,68 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:34:50,88 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:34:50,655 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:34:50,673 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:34:50,741 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:34:50,772 INFO     [learner.py:606] ====Pushing takes 0.029155969619750977 s
2021-08-18:16:34:50,810 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:50,817 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:34:50,818 INFO     [param_server.py:410] Lock worker 3 with localStep 294 , while globalStep is 293

2021-08-18:16:34:51,554 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:34:51,579 INFO     [learner.py:606] ====Pushing takes 0.02334308624267578 s
2021-08-18:16:34:51,613 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:51,619 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:34:51,620 INFO     [param_server.py:381] ====After aggregation in epoch: 293, virtual_clock: 11019.709461856988, top_1: : 67.1184 % (2080.0), top_5: : 100.0 % (3099.0), test loss: 2.765215268841496, test len: 3099.0
2021-08-18:16:34:51,623 INFO     [param_server.py:410] Lock worker 2 with localStep 294 , while globalStep is 294

2021-08-18:16:34:51,623 INFO     [param_server.py:441] ====Epoch 295 completes 20 clients with loss 128.74583939445705, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:34:51,623 INFO     [param_server.py:450] ====Start to sample for epoch 295, global virtualClock: 11019.709461856988, round_duration: 57.6461879098304
2021-08-18:16:34:51,624 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:34:51,897 INFO     [param_server.py:553] For epoch: 295, median_reward: 1016.6816494509274, dev: 5083.408247254637
2021-08-18:16:34:52,478 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6193, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:34:52,479 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3927.6149, eval_time 0.5596, test_loss 3.6193, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:34:52,485 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8048, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:34:52,486 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3927.6109, eval_time 0.5647, test_loss 2.8048, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:34:52,528 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8661, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:34:52,529 INFO     [learner.py:656] After aggregation epoch 294, CumulTime 3927.6685, eval_time 0.61, test_loss 2.8661, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:34:52,552 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:52,556 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:52,561 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:34:52,563 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:34:52,602 INFO     [learner.py:526] ====Start train round 295
2021-08-18:16:34:52,615 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:34:53,847 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:34:53,861 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:34:54,128 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:34:54,147 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:34:55,192 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:34:55,202 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:34:55,568 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:34:55,578 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:34:56,780 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:34:56,792 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:34:56,834 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:34:56,847 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:34:57,517 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:34:57,527 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:34:57,761 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:34:57,782 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:34:58,154 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:34:58,165 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:34:58,508 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:34:58,529 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:34:59,260 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:34:59,294 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:34:59,660 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:34:59,681 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:34:59,833 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:34:59,862 INFO     [learner.py:606] ====Pushing takes 0.02736806869506836 s
2021-08-18:16:34:59,908 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:34:59,918 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:34:59,919 INFO     [param_server.py:410] Lock worker 1 with localStep 295 , while globalStep is 294

2021-08-18:16:35:00,757 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:00,767 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:00,963 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:00,977 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:01,586 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:01,596 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:02,719 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:02,732 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:03,324 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:03,342 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:03,351 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:03,379 INFO     [learner.py:606] ====Pushing takes 0.026773452758789062 s
2021-08-18:16:35:03,417 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:03,424 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:03,425 INFO     [param_server.py:410] Lock worker 3 with localStep 295 , while globalStep is 294

2021-08-18:16:35:04,10 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:04,34 INFO     [learner.py:606] ====Pushing takes 0.022771835327148438 s
2021-08-18:16:35:04,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:04,68 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:04,69 INFO     [param_server.py:381] ====After aggregation in epoch: 294, virtual_clock: 11077.355649766818, top_1: : 64.6983 % (2005.0), top_5: : 100.0 % (3099.0), test loss: 3.0967487808213465, test len: 3099.0
2021-08-18:16:35:04,72 INFO     [param_server.py:410] Lock worker 2 with localStep 295 , while globalStep is 295

2021-08-18:16:35:04,72 INFO     [param_server.py:441] ====Epoch 296 completes 20 clients with loss 151.56214760983934, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:04,73 INFO     [param_server.py:450] ====Start to sample for epoch 296, global virtualClock: 11077.355649766818, round_duration: 57.6461879098304
2021-08-18:16:35:04,73 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:04,338 INFO     [param_server.py:553] For epoch: 296, median_reward: 1018.7954108680657, dev: 5093.977054340328
2021-08-18:16:35:05,19 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.319, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:35:05,20 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3940.1561, eval_time 0.6465, test_loss 3.319, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:35:05,24 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5341, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:35:05,25 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3940.1492, eval_time 0.6499, test_loss 2.5341, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:35:05,65 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1009, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:35:05,69 INFO     [learner.py:656] After aggregation epoch 295, CumulTime 3940.2079, eval_time 0.6974, test_loss 4.1009, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:35:05,91 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:35:05,96 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:35:05,100 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:05,104 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:05,141 INFO     [learner.py:526] ====Start train round 296
2021-08-18:16:35:05,156 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:06,377 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:06,391 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:06,719 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:06,728 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:07,882 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:07,894 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:08,13 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:08,32 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:09,299 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:09,320 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:09,460 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:09,473 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:10,144 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:10,165 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:10,231 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:10,241 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:10,870 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:10,879 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:10,923 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:10,950 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:11,604 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:11,632 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:12,245 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:12,272 INFO     [learner.py:606] ====Pushing takes 0.025568246841430664 s
2021-08-18:16:35:12,320 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:12,329 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:12,329 INFO     [param_server.py:410] Lock worker 1 with localStep 296 , while globalStep is 295

2021-08-18:16:35:12,439 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:12,453 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:13,558 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:13,570 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:13,637 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:13,650 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:14,281 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:14,291 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:15,480 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:15,495 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:16,27 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:16,42 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:16,67 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:16,95 INFO     [learner.py:606] ====Pushing takes 0.026326894760131836 s
2021-08-18:16:35:16,133 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:16,141 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:16,142 INFO     [param_server.py:410] Lock worker 3 with localStep 296 , while globalStep is 295

2021-08-18:16:35:16,796 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:16,820 INFO     [learner.py:606] ====Pushing takes 0.02236175537109375 s
2021-08-18:16:35:16,845 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:16,851 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:16,852 INFO     [param_server.py:381] ====After aggregation in epoch: 295, virtual_clock: 11135.001837676647, top_1: : 66.2472 % (2053.0), top_5: : 100.0 % (3099.0), test loss: 3.317997856272591, test len: 3099.0
2021-08-18:16:35:16,854 INFO     [param_server.py:410] Lock worker 2 with localStep 296 , while globalStep is 296

2021-08-18:16:35:16,855 INFO     [param_server.py:441] ====Epoch 297 completes 20 clients with loss 127.88833517482799, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:16,855 INFO     [param_server.py:450] ====Start to sample for epoch 297, global virtualClock: 11135.001837676647, round_duration: 57.6461879098304
2021-08-18:16:35:16,856 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:17,200 INFO     [param_server.py:553] For epoch: 297, median_reward: 1071.8609927620469, dev: 5359.304963810235
2021-08-18:16:35:17,914 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7195, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:35:17,918 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1892, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:35:17,918 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3953.0431, eval_time 0.6793, test_loss 2.7195, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:35:17,919 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3953.0546, eval_time 0.6798, test_loss 3.1892, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:35:17,956 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7236, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:35:17,957 INFO     [learner.py:656] After aggregation epoch 296, CumulTime 3953.096, eval_time 0.7223, test_loss 3.7236, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:35:18,17 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:35:18,17 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:35:18,25 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:18,27 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:18,30 INFO     [learner.py:526] ====Start train round 297
2021-08-18:16:35:18,46 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:19,416 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:19,437 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:19,749 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:19,760 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:20,844 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:20,861 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:21,526 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:21,548 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:22,508 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:22,528 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:22,726 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:22,747 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:23,30 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:23,43 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:23,472 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:23,490 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:23,906 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:23,921 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:24,101 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:24,116 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:24,757 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:24,770 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:25,350 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:25,360 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:25,365 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:25,392 INFO     [learner.py:606] ====Pushing takes 0.025867938995361328 s
2021-08-18:16:35:25,436 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:25,446 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:25,447 INFO     [param_server.py:410] Lock worker 1 with localStep 297 , while globalStep is 296

2021-08-18:16:35:26,523 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:26,534 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:26,552 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:26,565 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:27,201 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:27,214 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:28,649 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:28,663 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:28,793 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:28,811 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:29,277 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:29,304 INFO     [learner.py:606] ====Pushing takes 0.026359081268310547 s
2021-08-18:16:35:29,342 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:29,350 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:29,351 INFO     [param_server.py:410] Lock worker 3 with localStep 297 , while globalStep is 296

2021-08-18:16:35:29,560 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:29,583 INFO     [learner.py:606] ====Pushing takes 0.02250385284423828 s
2021-08-18:16:35:29,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:29,616 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:29,616 INFO     [param_server.py:381] ====After aggregation in epoch: 296, virtual_clock: 11192.648025586477, top_1: : 66.6667 % (2066.0), top_5: : 100.0 % (3099.0), test loss: 3.2107432727460505, test len: 3099.0
2021-08-18:16:35:29,618 INFO     [param_server.py:410] Lock worker 2 with localStep 297 , while globalStep is 297

2021-08-18:16:35:29,619 INFO     [param_server.py:441] ====Epoch 298 completes 20 clients with loss 167.47506548358626, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:29,619 INFO     [param_server.py:450] ====Start to sample for epoch 298, global virtualClock: 11192.648025586477, round_duration: 57.6461879098304
2021-08-18:16:35:29,620 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:29,976 INFO     [param_server.py:553] For epoch: 298, median_reward: 1074.4648405254984, dev: 5372.324202627492
2021-08-18:16:35:30,494 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5766, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:35:30,496 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3965.6208, eval_time 0.4856, test_loss 3.5766, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:35:30,549 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.7048, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:35:30,551 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3965.6871, eval_time 0.5416, test_loss 2.7048, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:35:30,576 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:30,591 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:30,592 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7852, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:35:30,593 INFO     [learner.py:656] After aggregation epoch 297, CumulTime 3965.7318, eval_time 0.583, test_loss 2.7852, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:35:30,632 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:30,648 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:30,664 INFO     [learner.py:526] ====Start train round 298
2021-08-18:16:35:30,693 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:32,142 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:32,169 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:32,386 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:32,396 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:33,508 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:33,521 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:34,177 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:34,191 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:35,287 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:35,307 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:35,330 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:35,339 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:35,813 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:35,822 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:35,914 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:35,924 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:36,442 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:36,456 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:36,480 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:36,490 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:37,71 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:37,85 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:37,695 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:37,724 INFO     [learner.py:606] ====Pushing takes 0.026921987533569336 s
2021-08-18:16:35:37,765 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:37,773 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:37,774 INFO     [param_server.py:410] Lock worker 1 with localStep 298 , while globalStep is 297

2021-08-18:16:35:37,910 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:37,919 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:39,68 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:39,78 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:39,125 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:39,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:39,803 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:39,813 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:40,966 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:40,977 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:41,486 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:41,500 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:41,710 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:41,737 INFO     [learner.py:606] ====Pushing takes 0.026045799255371094 s
2021-08-18:16:35:41,775 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:41,782 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:41,783 INFO     [param_server.py:410] Lock worker 3 with localStep 298 , while globalStep is 297

2021-08-18:16:35:42,321 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:42,344 INFO     [learner.py:606] ====Pushing takes 0.02214503288269043 s
2021-08-18:16:35:42,371 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:42,378 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:42,379 INFO     [param_server.py:381] ====After aggregation in epoch: 297, virtual_clock: 11250.294213496307, top_1: : 66.5053 % (2061.0), top_5: : 100.0 % (3099.0), test loss: 3.0222025839266955, test len: 3099.0
2021-08-18:16:35:42,382 INFO     [param_server.py:410] Lock worker 2 with localStep 298 , while globalStep is 298

2021-08-18:16:35:42,382 INFO     [param_server.py:441] ====Epoch 299 completes 20 clients with loss 73.41664890049303, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:42,383 INFO     [param_server.py:450] ====Start to sample for epoch 299, global virtualClock: 11250.294213496307, round_duration: 57.6461879098304
2021-08-18:16:35:42,384 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:42,757 INFO     [param_server.py:553] For epoch: 299, median_reward: 992.4399347299915, dev: 4962.199673649958
2021-08-18:16:35:43,408 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7555, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:35:43,412 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3978.537, eval_time 0.5947, test_loss 2.7555, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:35:43,459 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0728, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:35:43,460 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3978.5961, eval_time 0.6432, test_loss 3.0728, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:35:43,476 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:43,484 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:43,529 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:43,538 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5562, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:35:43,540 INFO     [learner.py:656] After aggregation epoch 298, CumulTime 3978.6794, eval_time 0.7286, test_loss 3.5562, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:35:43,542 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:43,610 INFO     [learner.py:526] ====Start train round 299
2021-08-18:16:35:43,631 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:45,87 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:45,108 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:45,171 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:45,190 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:46,156 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:46,170 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:46,987 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:46,996 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:35:48,27 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:35:48,49 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:35:48,304 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:35:48,313 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:35:48,351 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:35:48,361 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:35:49,42 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:35:49,56 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:35:49,70 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:35:49,80 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:35:49,837 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:35:49,858 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:35:50,664 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:35:50,684 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:35:50,703 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:35:50,713 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:35:51,329 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:35:51,355 INFO     [learner.py:606] ====Pushing takes 0.025185585021972656 s
2021-08-18:16:35:51,397 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:51,408 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:35:51,409 INFO     [param_server.py:410] Lock worker 1 with localStep 299 , while globalStep is 298

2021-08-18:16:35:51,758 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:35:51,772 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:35:51,936 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:35:51,946 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:35:52,510 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:35:52,524 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:35:53,778 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:35:53,787 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:35:54,253 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:35:54,271 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:35:54,396 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:35:54,424 INFO     [learner.py:606] ====Pushing takes 0.026684284210205078 s
2021-08-18:16:35:54,455 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:54,462 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:35:54,463 INFO     [param_server.py:410] Lock worker 3 with localStep 299 , while globalStep is 298

2021-08-18:16:35:55,15 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:35:55,40 INFO     [learner.py:606] ====Pushing takes 0.02367091178894043 s
2021-08-18:16:35:55,65 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:35:55,71 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:35:55,72 INFO     [param_server.py:381] ====After aggregation in epoch: 298, virtual_clock: 11307.940401406137, top_1: : 66.7312 % (2068.0), top_5: : 100.0 % (3099.0), test loss: 3.1281780975836297, test len: 3099.0
2021-08-18:16:35:55,105 INFO     [param_server.py:410] Lock worker 2 with localStep 299 , while globalStep is 299

2021-08-18:16:35:55,105 INFO     [param_server.py:441] ====Epoch 300 completes 20 clients with loss 78.28771610072744, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:35:55,106 INFO     [param_server.py:450] ====Start to sample for epoch 300, global virtualClock: 11307.940401406137, round_duration: 57.6461879098304
2021-08-18:16:35:55,107 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:35:55,450 INFO     [param_server.py:553] For epoch: 300, median_reward: 1002.6160509295228, dev: 5013.080254647613
2021-08-18:16:35:56,32 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7035, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:35:56,33 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3991.1577, eval_time 0.5366, test_loss 2.7035, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:35:56,76 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8599, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:35:56,77 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3991.2127, eval_time 0.5819, test_loss 2.8599, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:35:56,102 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:56,109 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:35:56,145 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:56,150 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0748, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:35:56,150 INFO     [learner.py:656] After aggregation epoch 299, CumulTime 3991.2897, eval_time 0.6556, test_loss 3.0748, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:35:56,161 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:35:56,220 INFO     [learner.py:526] ====Start train round 300
2021-08-18:16:35:56,242 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:35:57,764 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:35:57,784 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:35:57,924 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:35:57,938 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:35:58,828 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:35:58,846 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:35:59,542 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:35:59,557 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:36:00,569 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:00,580 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:00,749 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:36:00,770 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:01,279 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:01,292 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:01,556 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:01,577 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:02,50 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:02,64 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:02,295 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:02,316 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:03,27 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:03,45 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:03,294 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:03,309 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:03,729 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:03,757 INFO     [learner.py:606] ====Pushing takes 0.026290416717529297 s
2021-08-18:16:36:03,797 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:03,804 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:36:03,805 INFO     [param_server.py:410] Lock worker 1 with localStep 300 , while globalStep is 299

2021-08-18:16:36:04,473 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:04,485 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:04,862 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:04,875 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:05,553 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:05,563 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:06,727 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:06,737 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:06,897 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:06,906 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:07,430 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:07,455 INFO     [learner.py:606] ====Pushing takes 0.02354907989501953 s
2021-08-18:16:36:07,481 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:07,488 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 13 clients
2021-08-18:16:36:07,488 INFO     [param_server.py:410] Lock worker 2 with localStep 300 , while globalStep is 299

2021-08-18:16:36:07,494 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:07,521 INFO     [learner.py:606] ====Pushing takes 0.025845050811767578 s
2021-08-18:16:36:07,549 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:07,556 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 20 clients
2021-08-18:16:36:07,557 INFO     [param_server.py:381] ====After aggregation in epoch: 299, virtual_clock: 11365.586589315966, top_1: : 66.9894 % (2076.0), top_5: : 100.0 % (3099.0), test loss: 2.879409951192361, test len: 3099.0
2021-08-18:16:36:07,559 INFO     [param_server.py:410] Lock worker 3 with localStep 300 , while globalStep is 300

2021-08-18:16:36:07,560 INFO     [param_server.py:441] ====Epoch 301 completes 20 clients with loss 93.88267557965146, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:07,560 INFO     [param_server.py:450] ====Start to sample for epoch 301, global virtualClock: 11365.586589315966, round_duration: 57.6461879098304
2021-08-18:16:36:07,561 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:07,896 INFO     [param_server.py:541] Handle Wight 0.031227588653564453 | Send 0.3361179828643799
2021-08-18:16:36:07,901 INFO     [param_server.py:553] For epoch: 301, median_reward: 987.4746983883433, dev: 4937.373491941717
2021-08-18:16:36:08,549 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6238, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:36:08,550 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4003.6749, eval_time 0.6189, test_loss 2.6238, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:36:08,619 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:36:08,619 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7873, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:36:08,620 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4003.756, eval_time 0.6892, test_loss 3.7873, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:36:08,627 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:08,665 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.145, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:36:08,666 INFO     [learner.py:656] After aggregation epoch 300, CumulTime 4003.8056, eval_time 0.7354, test_loss 3.145, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:36:08,691 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:36:08,711 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:08,736 INFO     [learner.py:526] ====Start train round 301
2021-08-18:16:36:08,765 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:10,214 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:10,237 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:10,524 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:10,535 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:11,417 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:11,432 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:12,252 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:12,274 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:36:13,95 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:13,106 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:13,559 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:36:13,569 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:13,967 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:13,976 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:14,264 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:14,278 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:14,659 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:14,669 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:15,27 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:15,42 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:15,661 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:15,680 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:15,703 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:15,714 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:16,227 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:16,255 INFO     [learner.py:606] ====Pushing takes 0.026149749755859375 s
2021-08-18:16:36:16,297 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:16,316 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:36:16,317 INFO     [param_server.py:410] Lock worker 1 with localStep 301 , while globalStep is 300

2021-08-18:16:36:16,763 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:16,773 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:17,304 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:17,316 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:17,966 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:17,982 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:19,39 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:19,59 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:19,64 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:19,77 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:19,640 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:19,667 INFO     [learner.py:606] ====Pushing takes 0.026294708251953125 s
2021-08-18:16:36:19,697 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:19,704 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:36:19,705 INFO     [param_server.py:410] Lock worker 3 with localStep 301 , while globalStep is 300

2021-08-18:16:36:19,761 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:19,786 INFO     [learner.py:606] ====Pushing takes 0.023162364959716797 s
2021-08-18:16:36:19,811 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:19,817 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:36:19,818 INFO     [param_server.py:381] ====After aggregation in epoch: 300, virtual_clock: 11423.232777225796, top_1: : 65.3114 % (2024.0), top_5: : 100.0 % (3099.0), test loss: 3.18535566550714, test len: 3099.0
2021-08-18:16:36:19,822 INFO     [param_server.py:410] Lock worker 2 with localStep 301 , while globalStep is 301

2021-08-18:16:36:19,822 INFO     [param_server.py:441] ====Epoch 302 completes 20 clients with loss 62.4167610248665, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:19,823 INFO     [param_server.py:450] ====Start to sample for epoch 302, global virtualClock: 11423.232777225796, round_duration: 57.6461879098304
2021-08-18:16:36:19,824 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:20,138 INFO     [param_server.py:553] For epoch: 302, median_reward: 1101.264245481947, dev: 5506.321227409735
2021-08-18:16:36:20,749 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6274, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:36:20,764 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4015.8886, eval_time 0.5765, test_loss 2.6274, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:36:20,780 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.549, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:36:20,781 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4015.9171, eval_time 0.5946, test_loss 3.549, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:36:20,820 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0087, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:36:20,823 INFO     [learner.py:656] After aggregation epoch 301, CumulTime 4015.9623, eval_time 0.641, test_loss 3.0087, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:36:20,838 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:36:20,851 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:36:20,852 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:20,865 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:20,914 INFO     [learner.py:526] ====Start train round 302
2021-08-18:16:36:20,937 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:22,427 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:22,448 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:22,818 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:22,832 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:23,742 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:23,751 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:24,357 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:24,372 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:36:25,480 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:25,494 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:25,636 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:36:25,645 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:26,176 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:26,188 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:26,189 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:26,199 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:26,885 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:26,893 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:26,895 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:26,908 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:27,581 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:27,603 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:28,62 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:28,71 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:28,295 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:28,319 INFO     [learner.py:606] ====Pushing takes 0.02329421043395996 s
2021-08-18:16:36:28,351 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:28,361 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:36:28,362 INFO     [param_server.py:410] Lock worker 1 with localStep 302 , while globalStep is 301

2021-08-18:16:36:29,278 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:29,289 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:29,477 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:29,487 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:30,121 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:30,132 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:31,439 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:31,453 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:31,886 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:31,906 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:32,114 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:32,140 INFO     [learner.py:606] ====Pushing takes 0.02413201332092285 s
2021-08-18:16:36:32,169 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:32,177 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:36:32,178 INFO     [param_server.py:410] Lock worker 3 with localStep 302 , while globalStep is 301

2021-08-18:16:36:32,657 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:32,681 INFO     [learner.py:606] ====Pushing takes 0.02208733558654785 s
2021-08-18:16:36:32,710 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:32,717 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:36:32,717 INFO     [param_server.py:381] ====After aggregation in epoch: 301, virtual_clock: 11480.878965135626, top_1: : 67.183 % (2082.0), top_5: : 100.0 % (3099.0), test loss: 3.0616962291576244, test len: 3099.0
2021-08-18:16:36:32,719 INFO     [param_server.py:410] Lock worker 2 with localStep 302 , while globalStep is 302

2021-08-18:16:36:32,720 INFO     [param_server.py:441] ====Epoch 303 completes 20 clients with loss 60.77750748652791, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:32,720 INFO     [param_server.py:450] ====Start to sample for epoch 303, global virtualClock: 11480.878965135626, round_duration: 57.6461879098304
2021-08-18:16:36:32,721 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:33,3 INFO     [param_server.py:553] For epoch: 303, median_reward: 1226.2532837937363, dev: 6131.266418968681
2021-08-18:16:36:33,697 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7122, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:36:33,701 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4028.8256, eval_time 0.6679, test_loss 2.7122, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:36:33,735 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9396, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:36:33,736 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4028.8722, eval_time 0.7056, test_loss 2.9396, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:36:33,737 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8111, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:36:33,738 INFO     [learner.py:656] After aggregation epoch 302, CumulTime 4028.877, eval_time 0.7071, test_loss 2.8111, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:36:33,774 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:33,784 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:33,811 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:33,824 INFO     [learner.py:526] ====Start train round 303
2021-08-18:16:36:33,827 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:33,840 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:35,206 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:35,226 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:35,667 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:35,686 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:36,443 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:36,452 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:37,102 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:37,116 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:36:38,356 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:38,375 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:38,478 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:36:38,496 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:38,909 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:38,920 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:39,213 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:39,234 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:39,587 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:39,597 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:40,62 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:40,88 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:40,708 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:40,734 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:41,103 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:41,121 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:41,384 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:41,411 INFO     [learner.py:606] ====Pushing takes 0.025516986846923828 s
2021-08-18:16:36:41,452 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:41,461 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:36:41,462 INFO     [param_server.py:410] Lock worker 1 with localStep 303 , while globalStep is 302

2021-08-18:16:36:42,386 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:42,399 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:42,455 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:42,472 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:43,94 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:43,105 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:44,289 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:44,298 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:44,888 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:44,916 INFO     [learner.py:606] ====Pushing takes 0.0267946720123291 s
2021-08-18:16:36:44,955 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:44,958 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:44,963 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:36:44,964 INFO     [param_server.py:410] Lock worker 3 with localStep 303 , while globalStep is 302

2021-08-18:16:36:44,972 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:45,636 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:45,660 INFO     [learner.py:606] ====Pushing takes 0.023038387298583984 s
2021-08-18:16:36:45,685 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:45,691 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:36:45,692 INFO     [param_server.py:381] ====After aggregation in epoch: 302, virtual_clock: 11538.525153045455, top_1: : 64.7951 % (2008.0), top_5: : 100.0 % (3099.0), test loss: 2.820956810756966, test len: 3099.0
2021-08-18:16:36:45,694 INFO     [param_server.py:410] Lock worker 2 with localStep 303 , while globalStep is 303

2021-08-18:16:36:45,695 INFO     [param_server.py:441] ====Epoch 304 completes 20 clients with loss 69.00373814238709, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:45,695 INFO     [param_server.py:450] ====Start to sample for epoch 304, global virtualClock: 11538.525153045455, round_duration: 57.6461879098304
2021-08-18:16:36:45,696 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:46,16 INFO     [param_server.py:553] For epoch: 304, median_reward: 1044.1366294466532, dev: 5220.683147233266
2021-08-18:16:36:46,616 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6266, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:36:46,618 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4041.7424, eval_time 0.5722, test_loss 2.6266, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:36:46,645 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6399, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:36:46,646 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4041.7818, eval_time 0.603, test_loss 3.6399, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:36:46,692 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:46,696 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9616, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:36:46,697 INFO     [learner.py:656] After aggregation epoch 303, CumulTime 4041.8364, eval_time 0.6565, test_loss 2.9616, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:36:46,701 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:46,717 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:46,733 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:46,768 INFO     [learner.py:526] ====Start train round 304
2021-08-18:16:36:46,790 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:36:48,218 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:36:48,245 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:36:48,427 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:36:48,441 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:36:49,209 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:36:49,221 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:36:50,220 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:36:50,241 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:36:51,265 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:36:51,284 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:36:51,671 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:36:51,685 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:36:51,962 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:36:51,973 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:36:52,437 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:36:52,450 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:36:52,531 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:36:52,540 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:36:53,165 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:36:53,185 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:36:53,770 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:36:53,791 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:36:53,926 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:36:53,944 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:36:54,323 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:36:54,350 INFO     [learner.py:606] ====Pushing takes 0.0259702205657959 s
2021-08-18:16:36:54,390 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:54,397 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:36:54,398 INFO     [param_server.py:410] Lock worker 1 with localStep 304 , while globalStep is 303

2021-08-18:16:36:55,227 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:36:55,236 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:36:55,272 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:36:55,282 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:36:55,921 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:36:55,930 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:36:57,166 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:36:57,175 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:36:57,697 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:36:57,699 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:36:57,718 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:36:57,724 INFO     [learner.py:606] ====Pushing takes 0.02570199966430664 s
2021-08-18:16:36:57,754 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:57,761 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:36:57,762 INFO     [param_server.py:410] Lock worker 3 with localStep 304 , while globalStep is 303

2021-08-18:16:36:58,417 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:36:58,441 INFO     [learner.py:606] ====Pushing takes 0.023164033889770508 s
2021-08-18:16:36:58,474 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:36:58,480 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:36:58,481 INFO     [param_server.py:381] ====After aggregation in epoch: 303, virtual_clock: 11596.171340955285, top_1: : 66.6021 % (2064.0), top_5: : 100.0 % (3099.0), test loss: 3.07600983204665, test len: 3099.0
2021-08-18:16:36:58,484 INFO     [param_server.py:410] Lock worker 2 with localStep 304 , while globalStep is 304

2021-08-18:16:36:58,484 INFO     [param_server.py:441] ====Epoch 305 completes 20 clients with loss 152.8906332171012, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:36:58,484 INFO     [param_server.py:450] ====Start to sample for epoch 305, global virtualClock: 11596.171340955285, round_duration: 57.6461879098304
2021-08-18:16:36:58,485 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:36:58,792 INFO     [param_server.py:553] For epoch: 305, median_reward: 1316.5755566121857, dev: 6582.877783060929
2021-08-18:16:36:59,353 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0438, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:36:59,354 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4054.4789, eval_time 0.5182, test_loss 3.0438, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:36:59,394 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2084, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:36:59,396 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4054.5318, eval_time 0.5597, test_loss 3.2084, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:36:59,423 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:59,431 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:36:59,467 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:59,483 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:36:59,481 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0173, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:36:59,484 INFO     [learner.py:656] After aggregation epoch 304, CumulTime 4054.6229, eval_time 0.6476, test_loss 3.0173, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:36:59,565 INFO     [learner.py:526] ====Start train round 305
2021-08-18:16:36:59,594 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:01,225 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:01,253 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:01,267 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:01,288 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:02,286 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:02,296 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:03,31 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:03,58 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:37:03,857 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:03,876 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:04,482 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:37:04,497 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:04,732 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:04,741 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:05,233 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:05,253 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:05,419 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:05,431 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:05,969 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:05,990 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:06,614 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:06,628 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:06,797 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:06,809 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:07,203 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:07,231 INFO     [learner.py:606] ====Pushing takes 0.025734901428222656 s
2021-08-18:16:37:07,274 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:07,283 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:37:07,283 INFO     [param_server.py:410] Lock worker 1 with localStep 305 , while globalStep is 304

2021-08-18:16:37:08,71 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:08,81 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:08,101 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:08,115 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:08,790 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:08,801 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:09,993 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:10,7 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:10,439 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:10,455 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:37:10,690 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:10,717 INFO     [learner.py:606] ====Pushing takes 0.025902986526489258 s
2021-08-18:16:37:10,761 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:10,769 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:37:10,769 INFO     [param_server.py:410] Lock worker 3 with localStep 305 , while globalStep is 304

2021-08-18:16:37:11,140 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:37:11,165 INFO     [learner.py:606] ====Pushing takes 0.023087501525878906 s
2021-08-18:16:37:11,191 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:11,200 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:37:11,200 INFO     [param_server.py:381] ====After aggregation in epoch: 304, virtual_clock: 11653.817528865115, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 3.0898643290555037, test len: 3099.0
2021-08-18:16:37:11,203 INFO     [param_server.py:410] Lock worker 2 with localStep 305 , while globalStep is 305

2021-08-18:16:37:11,203 INFO     [param_server.py:441] ====Epoch 306 completes 20 clients with loss 56.3527072962795, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:37:11,203 INFO     [param_server.py:450] ====Start to sample for epoch 306, global virtualClock: 11653.817528865115, round_duration: 57.6461879098304
2021-08-18:16:37:11,204 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 85, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:37:11,478 INFO     [param_server.py:553] For epoch: 306, median_reward: 1050.2876962729292, dev: 5251.438481364647
2021-08-18:16:37:12,77 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9341, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:37:12,78 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4067.2026, eval_time 0.5543, test_loss 2.9341, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:37:12,114 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2401, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:37:12,115 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4067.2542, eval_time 0.592, test_loss 3.2401, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:37:12,116 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5706, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:37:12,116 INFO     [learner.py:656] After aggregation epoch 305, CumulTime 4067.2523, eval_time 0.5927, test_loss 3.5706, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:37:12,146 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:37:12,154 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:12,188 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:37:12,195 INFO     [learner.py:526] ====Start train round 306
2021-08-18:16:37:12,203 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:12,212 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:13,448 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:13,468 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:13,914 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:13,932 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:14,759 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:14,769 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:15,484 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:15,504 INFO     [learner.py:165] Start to run client 85 on rank 1...
2021-08-18:16:37:16,756 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:16,777 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:16,853 INFO     [learner.py:439] Completed to run client 85
2021-08-18:16:37:16,875 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:17,176 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:17,186 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:17,518 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:17,532 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:17,931 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:17,949 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:18,216 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:18,236 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:18,921 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:18,935 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:19,591 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:19,603 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:19,615 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:19,618 INFO     [learner.py:606] ====Pushing takes 0.025292634963989258 s
2021-08-18:16:37:19,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:19,669 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05, now collected 7 clients
2021-08-18:16:37:19,670 INFO     [param_server.py:410] Lock worker 1 with localStep 306 , while globalStep is 305

2021-08-18:16:37:20,671 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:20,689 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:20,701 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:20,715 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:21,287 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:21,297 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:22,588 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:22,597 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:22,932 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:22,947 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:37:23,260 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:23,289 INFO     [learner.py:606] ====Pushing takes 0.025454282760620117 s
2021-08-18:16:37:23,326 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:23,336 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05, now collected 14 clients
2021-08-18:16:37:23,337 INFO     [param_server.py:410] Lock worker 3 with localStep 306 , while globalStep is 305

2021-08-18:16:37:23,726 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:37:23,751 INFO     [learner.py:606] ====Pushing takes 0.023171663284301758 s
2021-08-18:16:37:23,777 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:23,783 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05, now collected 20 clients
2021-08-18:16:37:23,784 INFO     [param_server.py:381] ====After aggregation in epoch: 305, virtual_clock: 11711.463716774944, top_1: : 67.2475 % (2084.0), top_5: : 100.0 % (3099.0), test loss: 3.2482506125061597, test len: 3099.0
2021-08-18:16:37:23,787 INFO     [param_server.py:410] Lock worker 2 with localStep 306 , while globalStep is 306

2021-08-18:16:37:23,796 INFO     [param_server.py:441] ====Epoch 307 completes 20 clients with loss 119.71687410228637, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 85: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:37:23,797 INFO     [param_server.py:450] ====Start to sample for epoch 307, global virtualClock: 11711.463716774944, round_duration: 57.6461879098304
2021-08-18:16:37:23,797 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:37:24,71 INFO     [param_server.py:553] For epoch: 307, median_reward: 1009.0445032275433, dev: 5045.222516137716
2021-08-18:16:37:24,658 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8604, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:37:24,659 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4079.7836, eval_time 0.5524, test_loss 2.8604, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:37:24,664 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4163, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:37:24,665 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4079.8012, eval_time 0.5587, test_loss 3.4163, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:37:24,728 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:37:24,736 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:24,736 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:37:24,738 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8813, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:37:24,739 INFO     [learner.py:656] After aggregation epoch 306, CumulTime 4079.8785, eval_time 0.6329, test_loss 2.8813, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:37:24,744 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:24,811 INFO     [learner.py:526] ====Start train round 307
2021-08-18:16:37:24,828 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:26,467 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:26,495 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:26,671 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:26,686 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:27,386 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:27,396 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:28,565 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:28,587 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:29,276 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:29,303 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:29,626 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:29,637 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:29,801 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:29,835 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:30,25 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:30,45 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:30,586 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:30,605 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:30,691 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:30,706 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:31,357 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:31,380 INFO     [learner.py:606] ====Pushing takes 0.02175426483154297 s
2021-08-18:16:37:31,414 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:31,422 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05263157894736842, now collected 6 clients
2021-08-18:16:37:31,423 INFO     [param_server.py:410] Lock worker 1 with localStep 307 , while globalStep is 306

2021-08-18:16:37:32,375 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:32,386 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:33,307 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:33,324 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:33,631 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:33,644 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:34,156 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:34,166 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:35,414 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:35,425 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:35,908 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:35,923 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:37:36,55 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:36,82 INFO     [learner.py:606] ====Pushing takes 0.026330232620239258 s
2021-08-18:16:37:36,119 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:36,126 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05263157894736842, now collected 13 clients
2021-08-18:16:37:36,127 INFO     [param_server.py:410] Lock worker 3 with localStep 307 , while globalStep is 306

2021-08-18:16:37:36,721 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:37:36,747 INFO     [learner.py:606] ====Pushing takes 0.024514436721801758 s
2021-08-18:16:37:36,774 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:36,780 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05263157894736842, now collected 19 clients
2021-08-18:16:37:36,780 INFO     [param_server.py:381] ====After aggregation in epoch: 306, virtual_clock: 11772.353798091235, top_1: : 65.1823 % (2020.0), top_5: : 100.0 % (3099.0), test loss: 3.0526907576455007, test len: 3099.0
2021-08-18:16:37:36,783 INFO     [param_server.py:410] Lock worker 2 with localStep 307 , while globalStep is 307

2021-08-18:16:37:36,784 INFO     [param_server.py:441] ====Epoch 308 completes 19 clients with loss 20.036224070260186, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:37:36,784 INFO     [param_server.py:450] ====Start to sample for epoch 308, global virtualClock: 11772.353798091235, round_duration: 60.89008131629102
2021-08-18:16:37:36,785 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 119, 58, 67]
2021-08-18:16:37:37,76 INFO     [param_server.py:553] For epoch: 308, median_reward: 1117.7759306524608, dev: 5588.879653262304
2021-08-18:16:37:37,761 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1667, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:37:37,765 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4092.9041, eval_time 0.6557, test_loss 3.1667, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:37:37,776 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2163, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:37:37,777 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4092.9013, eval_time 0.6665, test_loss 3.2163, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:37:37,777 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.316, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:37:37,778 INFO     [learner.py:656] After aggregation epoch 307, CumulTime 4092.9138, eval_time 0.668, test_loss 3.316, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:37:37,820 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:37,845 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:37,848 INFO     [learner.py:526] ====Start train round 308
2021-08-18:16:37:37,849 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:37,853 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:37,857 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:39,280 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:39,314 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:39,658 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:39,672 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:40,744 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:40,763 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:41,288 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:41,308 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:42,65 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:42,79 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:42,634 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:42,653 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:42,676 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:42,690 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:43,71 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:43,86 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:43,326 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:43,340 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:43,754 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:43,763 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:43,997 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:44,21 INFO     [learner.py:606] ====Pushing takes 0.022464990615844727 s
2021-08-18:16:37:44,55 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:44,63 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05263157894736842, now collected 6 clients
2021-08-18:16:37:44,64 INFO     [param_server.py:410] Lock worker 1 with localStep 308 , while globalStep is 307

2021-08-18:16:37:45,301 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:45,311 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:46,478 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:46,488 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:46,571 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:46,580 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:37:47,129 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:37:47,139 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:37:48,484 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:37:48,511 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:37:48,682 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:37:48,702 INFO     [learner.py:165] Start to run client 119 on rank 2...
2021-08-18:16:37:49,163 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:37:49,191 INFO     [learner.py:606] ====Pushing takes 0.026340961456298828 s
2021-08-18:16:37:49,227 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:49,237 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05263157894736842, now collected 13 clients
2021-08-18:16:37:49,238 INFO     [param_server.py:410] Lock worker 3 with localStep 308 , while globalStep is 307

2021-08-18:16:37:49,529 INFO     [learner.py:439] Completed to run client 119
2021-08-18:16:37:49,552 INFO     [learner.py:606] ====Pushing takes 0.02194952964782715 s
2021-08-18:16:37:49,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:49,584 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05263157894736842, now collected 19 clients
2021-08-18:16:37:49,585 INFO     [param_server.py:381] ====After aggregation in epoch: 307, virtual_clock: 11833.243879407526, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 3.233022195321542, test len: 3099.0
2021-08-18:16:37:49,587 INFO     [param_server.py:410] Lock worker 2 with localStep 308 , while globalStep is 308

2021-08-18:16:37:49,587 INFO     [param_server.py:441] ====Epoch 309 completes 19 clients with loss 48.4207824221105, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0, 119: 0} 
==========
2021-08-18:16:37:49,588 INFO     [param_server.py:450] ====Start to sample for epoch 309, global virtualClock: 11833.243879407526, round_duration: 60.89008131629102
2021-08-18:16:37:49,589 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:37:49,891 INFO     [param_server.py:553] For epoch: 309, median_reward: 993.4697734749789, dev: 4967.348867374894
2021-08-18:16:37:50,573 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0204, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:37:50,574 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4105.7096, eval_time 0.6383, test_loss 3.0204, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:37:50,616 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5858, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:37:50,617 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4105.7415, eval_time 0.6755, test_loss 2.5858, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:37:50,651 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:50,657 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8859, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:37:50,657 INFO     [learner.py:656] After aggregation epoch 308, CumulTime 4105.7964, eval_time 0.7218, test_loss 2.8859, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:37:50,659 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:37:50,682 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:50,699 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:37:50,722 INFO     [learner.py:526] ====Start train round 309
2021-08-18:16:37:50,743 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:37:52,182 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:37:52,202 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:37:52,550 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:37:52,564 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:37:53,364 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:37:53,376 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:37:54,298 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:37:54,317 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:37:55,16 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:37:55,30 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:37:55,384 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:37:55,402 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:37:55,669 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:37:55,681 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:37:55,723 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:37:55,737 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:37:56,425 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:37:56,446 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:37:56,512 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:37:56,523 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:37:57,37 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:37:57,59 INFO     [learner.py:606] ====Pushing takes 0.019690990447998047 s
2021-08-18:16:37:57,86 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:37:57,94 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:37:57,94 INFO     [param_server.py:410] Lock worker 1 with localStep 309 , while globalStep is 308

2021-08-18:16:37:58,131 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:37:58,140 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:37:59,413 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:37:59,432 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:37:59,474 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:37:59,483 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:00,201 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:00,215 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:01,642 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:01,663 INFO     [learner.py:606] ====Pushing takes 0.018242359161376953 s
2021-08-18:16:38:01,694 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:01,702 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:01,702 INFO     [param_server.py:410] Lock worker 2 with localStep 309 , while globalStep is 308

2021-08-18:16:38:01,956 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:01,965 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:02,581 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:02,610 INFO     [learner.py:606] ====Pushing takes 0.02675938606262207 s
2021-08-18:16:38:02,640 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:02,647 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:02,648 INFO     [param_server.py:381] ====After aggregation in epoch: 308, virtual_clock: 11897.377854130278, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 2.8307304139490483, test len: 3099.0
2021-08-18:16:38:02,651 INFO     [param_server.py:410] Lock worker 3 with localStep 309 , while globalStep is 309

2021-08-18:16:38:02,651 INFO     [param_server.py:441] ====Epoch 310 completes 18 clients with loss 18.157924618470943, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:02,652 INFO     [param_server.py:450] ====Start to sample for epoch 310, global virtualClock: 11897.377854130278, round_duration: 64.13397472275163
2021-08-18:16:38:02,652 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:02,936 INFO     [param_server.py:553] For epoch: 310, median_reward: 936.1572410909141, dev: 4680.78620545457
2021-08-18:16:38:03,603 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1747, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:38:03,604 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4118.7282, eval_time 0.6355, test_loss 3.1747, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:38:03,608 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1517, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:38:03,610 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4118.7488, eval_time 0.6416, test_loss 3.1517, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:38:03,612 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2658, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:38:03,616 INFO     [learner.py:656] After aggregation epoch 309, CumulTime 4118.7524, eval_time 0.6485, test_loss 3.2658, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:38:03,665 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:38:03,673 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:38:03,678 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:03,681 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:03,683 INFO     [learner.py:526] ====Start train round 310
2021-08-18:16:38:03,691 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:05,17 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:05,38 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:05,433 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:05,447 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:06,241 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:06,251 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:07,192 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:07,219 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:08,17 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:08,37 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:08,331 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:08,345 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:08,658 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:08,679 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:08,710 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:08,724 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:09,364 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:09,378 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:09,486 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:09,500 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:09,983 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:10,6 INFO     [learner.py:606] ====Pushing takes 0.022081375122070312 s
2021-08-18:16:38:10,36 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:10,43 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:10,44 INFO     [param_server.py:410] Lock worker 1 with localStep 310 , while globalStep is 309

2021-08-18:16:38:11,139 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:11,148 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:12,284 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:12,293 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:12,311 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:12,321 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:13,18 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:13,27 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:14,579 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:14,595 INFO     [learner.py:606] ====Pushing takes 0.01485586166381836 s
2021-08-18:16:38:14,618 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:14,624 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:14,624 INFO     [param_server.py:410] Lock worker 2 with localStep 310 , while globalStep is 309

2021-08-18:16:38:14,710 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:14,721 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:15,371 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:15,396 INFO     [learner.py:606] ====Pushing takes 0.023429393768310547 s
2021-08-18:16:38:15,424 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:15,431 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:15,432 INFO     [param_server.py:381] ====After aggregation in epoch: 309, virtual_clock: 11961.51182885303, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 3.1973915276704012, test len: 3099.0
2021-08-18:16:38:15,435 INFO     [param_server.py:410] Lock worker 3 with localStep 310 , while globalStep is 310

2021-08-18:16:38:15,435 INFO     [param_server.py:441] ====Epoch 311 completes 18 clients with loss 52.15475653279117, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:15,436 INFO     [param_server.py:450] ====Start to sample for epoch 311, global virtualClock: 11961.51182885303, round_duration: 64.13397472275163
2021-08-18:16:38:15,436 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:15,721 INFO     [param_server.py:553] For epoch: 311, median_reward: 954.9316839608456, dev: 4774.658419804228
2021-08-18:16:38:16,439 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8242, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:38:16,440 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4131.576, eval_time 0.6803, test_loss 2.8242, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:38:16,442 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8653, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:38:16,443 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4131.5675, eval_time 0.6825, test_loss 2.8653, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:38:16,498 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:38:16,508 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:16,513 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:38:16,521 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:16,520 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0853, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:38:16,522 INFO     [learner.py:656] After aggregation epoch 310, CumulTime 4131.6615, eval_time 0.7649, test_loss 3.0853, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:38:16,594 INFO     [learner.py:526] ====Start train round 311
2021-08-18:16:38:16,614 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:18,127 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:18,154 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:18,402 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:18,420 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:19,422 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:19,440 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:20,271 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:20,298 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:21,51 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:21,78 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:21,206 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:21,224 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:21,749 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:21,763 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:21,878 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:21,897 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:22,361 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:22,370 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:22,494 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:22,504 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:22,985 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:23,10 INFO     [learner.py:606] ====Pushing takes 0.023189067840576172 s
2021-08-18:16:38:23,48 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:23,58 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:23,59 INFO     [param_server.py:410] Lock worker 1 with localStep 311 , while globalStep is 310

2021-08-18:16:38:23,860 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:23,870 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:25,80 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:25,89 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:25,145 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:25,154 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:25,786 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:25,795 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:27,289 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:27,308 INFO     [learner.py:606] ====Pushing takes 0.017921924591064453 s
2021-08-18:16:38:27,346 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:27,352 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:27,353 INFO     [param_server.py:410] Lock worker 2 with localStep 311 , while globalStep is 310

2021-08-18:16:38:27,492 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:27,506 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:28,196 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:28,223 INFO     [learner.py:606] ====Pushing takes 0.026024818420410156 s
2021-08-18:16:38:28,254 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:28,266 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:28,267 INFO     [param_server.py:381] ====After aggregation in epoch: 310, virtual_clock: 12025.645803575782, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 2.9249565038416123, test len: 3099.0
2021-08-18:16:38:28,269 INFO     [param_server.py:410] Lock worker 3 with localStep 311 , while globalStep is 311

2021-08-18:16:38:28,269 INFO     [param_server.py:441] ====Epoch 312 completes 18 clients with loss 37.718528031026906, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:28,270 INFO     [param_server.py:450] ====Start to sample for epoch 312, global virtualClock: 12025.645803575782, round_duration: 64.13397472275163
2021-08-18:16:38:28,287 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:28,551 INFO     [param_server.py:553] For epoch: 312, median_reward: 968.2856451388967, dev: 4841.428225694483
2021-08-18:16:38:29,150 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3384, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:38:29,150 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4144.2864, eval_time 0.5874, test_loss 3.3384, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:38:29,189 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.651, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:38:29,190 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4144.3142, eval_time 0.6159, test_loss 2.651, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:38:29,191 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0249, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:38:29,192 INFO     [learner.py:656] After aggregation epoch 311, CumulTime 4144.331, eval_time 0.6287, test_loss 3.0249, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:38:29,218 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:29,228 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:29,260 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:29,260 INFO     [learner.py:526] ====Start train round 312
2021-08-18:16:38:29,272 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:29,273 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:30,863 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:30,891 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:30,991 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:31,0 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:32,124 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:32,133 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:32,979 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:33,7 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:33,781 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:33,802 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:33,861 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:33,881 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:34,527 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:34,526 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:34,542 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:34,548 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:35,174 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:35,188 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:35,282 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:35,291 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:35,928 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:35,960 INFO     [learner.py:606] ====Pushing takes 0.029650211334228516 s
2021-08-18:16:38:35,997 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:36,4 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:36,5 INFO     [param_server.py:410] Lock worker 1 with localStep 312 , while globalStep is 311

2021-08-18:16:38:36,675 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:36,685 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:37,968 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:37,980 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:38,27 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:38,41 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:38,920 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:38,934 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:40,566 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:40,584 INFO     [learner.py:606] ====Pushing takes 0.01692652702331543 s
2021-08-18:16:38:40,615 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:40,623 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:40,624 INFO     [param_server.py:410] Lock worker 2 with localStep 312 , while globalStep is 311

2021-08-18:16:38:40,759 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:40,773 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:41,522 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:41,556 INFO     [learner.py:606] ====Pushing takes 0.03267860412597656 s
2021-08-18:16:38:41,597 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:41,607 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:41,607 INFO     [param_server.py:381] ====After aggregation in epoch: 311, virtual_clock: 12089.779778298534, top_1: : 66.8603 % (2072.0), top_5: : 100.0 % (3099.0), test loss: 3.004770353988365, test len: 3099.0
2021-08-18:16:38:41,613 INFO     [param_server.py:410] Lock worker 3 with localStep 312 , while globalStep is 312

2021-08-18:16:38:41,613 INFO     [param_server.py:441] ====Epoch 313 completes 18 clients with loss 39.18968700220325, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:41,614 INFO     [param_server.py:450] ====Start to sample for epoch 313, global virtualClock: 12089.779778298534, round_duration: 64.13397472275163
2021-08-18:16:38:41,615 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:41,961 INFO     [param_server.py:553] For epoch: 313, median_reward: 968.5941809620415, dev: 4842.970904810208
2021-08-18:16:38:42,630 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3908, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:38:42,632 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4157.7679, eval_time 0.6353, test_loss 3.3908, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:38:42,639 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5877, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:38:42,640 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4157.7648, eval_time 0.6386, test_loss 2.5877, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:38:42,687 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:42,696 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:42,701 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7226, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:38:42,702 INFO     [learner.py:656] After aggregation epoch 312, CumulTime 4157.8411, eval_time 0.7071, test_loss 2.7226, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:38:42,711 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:42,719 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:42,772 INFO     [learner.py:526] ====Start train round 313
2021-08-18:16:38:42,794 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:44,316 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:44,337 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:44,376 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:44,390 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:45,312 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:45,322 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:46,479 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:46,505 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:47,147 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:47,158 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:38:47,324 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:38:47,357 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:38:47,746 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:38:47,767 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:38:48,59 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:38:48,76 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:38:48,515 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:38:48,525 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:38:48,696 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:38:48,706 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:38:49,260 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:38:49,283 INFO     [learner.py:606] ====Pushing takes 0.02207016944885254 s
2021-08-18:16:38:49,320 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:49,327 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:38:49,328 INFO     [param_server.py:410] Lock worker 1 with localStep 313 , while globalStep is 312

2021-08-18:16:38:49,887 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:38:49,896 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:38:51,117 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:38:51,129 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:38:51,462 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:38:51,480 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:38:52,144 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:38:52,154 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:38:53,662 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:38:53,675 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:38:53,742 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:38:53,765 INFO     [learner.py:606] ====Pushing takes 0.019097566604614258 s
2021-08-18:16:38:53,795 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:53,800 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:38:53,801 INFO     [param_server.py:410] Lock worker 2 with localStep 313 , while globalStep is 312

2021-08-18:16:38:54,398 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:38:54,426 INFO     [learner.py:606] ====Pushing takes 0.026258230209350586 s
2021-08-18:16:38:54,455 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:38:54,462 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:38:54,463 INFO     [param_server.py:381] ====After aggregation in epoch: 312, virtual_clock: 12153.913753021287, top_1: : 65.86 % (2041.0), top_5: : 100.0 % (3099.0), test loss: 2.90034916445061, test len: 3099.0
2021-08-18:16:38:54,465 INFO     [param_server.py:410] Lock worker 3 with localStep 313 , while globalStep is 313

2021-08-18:16:38:54,466 INFO     [param_server.py:441] ====Epoch 314 completes 18 clients with loss 45.40341333171156, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:38:54,466 INFO     [param_server.py:450] ====Start to sample for epoch 314, global virtualClock: 12153.913753021287, round_duration: 64.13397472275163
2021-08-18:16:38:54,467 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:38:54,807 INFO     [param_server.py:553] For epoch: 314, median_reward: 911.8537133639511, dev: 4559.2685668197555
2021-08-18:16:38:55,439 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.594, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:38:55,439 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2822, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:38:55,440 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4170.5645, eval_time 0.5862, test_loss 2.594, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:38:55,440 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4170.5762, eval_time 0.5877, test_loss 3.2822, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:38:55,530 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:55,530 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:55,538 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:38:55,540 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:38:55,558 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2189, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:38:55,559 INFO     [learner.py:656] After aggregation epoch 313, CumulTime 4170.6982, eval_time 0.7105, test_loss 3.2189, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:38:55,632 INFO     [learner.py:526] ====Start train round 314
2021-08-18:16:38:55,660 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:38:57,104 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:38:57,113 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:38:57,194 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:38:57,221 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:38:58,80 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:38:58,89 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:38:59,442 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:38:59,462 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:38:59,871 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:38:59,891 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:39:00,350 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:00,371 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:00,566 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:00,586 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:01,102 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:01,116 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:01,304 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:01,319 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:01,761 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:01,780 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:02,342 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:02,368 INFO     [learner.py:606] ====Pushing takes 0.02409052848815918 s
2021-08-18:16:39:02,408 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:02,417 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:39:02,418 INFO     [param_server.py:410] Lock worker 1 with localStep 314 , while globalStep is 313

2021-08-18:16:39:02,629 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:39:02,642 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:03,961 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:03,980 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:04,11 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:04,23 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:04,711 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:04,721 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:06,263 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:06,272 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:06,548 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:06,569 INFO     [learner.py:606] ====Pushing takes 0.019315481185913086 s
2021-08-18:16:39:06,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:06,606 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:39:06,607 INFO     [param_server.py:410] Lock worker 2 with localStep 314 , while globalStep is 313

2021-08-18:16:39:06,849 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:06,880 INFO     [learner.py:606] ====Pushing takes 0.02942204475402832 s
2021-08-18:16:39:06,910 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:06,917 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:39:06,918 INFO     [param_server.py:381] ====After aggregation in epoch: 313, virtual_clock: 12218.047727744039, top_1: : 66.5053 % (2061.0), top_5: : 100.0 % (3099.0), test loss: 3.0317242311106782, test len: 3099.0
2021-08-18:16:39:06,920 INFO     [param_server.py:410] Lock worker 3 with localStep 314 , while globalStep is 314

2021-08-18:16:39:06,921 INFO     [param_server.py:441] ====Epoch 315 completes 18 clients with loss 107.70565645130316, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:39:06,921 INFO     [param_server.py:450] ====Start to sample for epoch 315, global virtualClock: 12218.047727744039, round_duration: 64.13397472275163
2021-08-18:16:39:06,922 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:07,242 INFO     [param_server.py:553] For epoch: 315, median_reward: 1099.2322806791815, dev: 5496.161403395908
2021-08-18:16:39:07,895 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0888, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:39:07,896 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4183.0319, eval_time 0.6208, test_loss 3.0888, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:39:07,942 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8119, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:39:07,946 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4183.0711, eval_time 0.6679, test_loss 2.8119, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:39:07,951 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9053, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:39:07,954 INFO     [learner.py:656] After aggregation epoch 314, CumulTime 4183.0932, eval_time 0.6788, test_loss 2.9053, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:39:07,966 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:39:07,987 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:08,18 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:39:08,23 INFO     [learner.py:526] ====Start train round 315
2021-08-18:16:39:08,36 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:08,40 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:09,409 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:09,431 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:09,714 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:09,724 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:10,855 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:10,871 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:11,653 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:11,680 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:12,488 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:12,509 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:12,622 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:12,640 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:39:13,195 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:13,210 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:13,212 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:13,233 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:13,780 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:13,794 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:13,960 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:13,974 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:14,536 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:14,560 INFO     [learner.py:606] ====Pushing takes 0.021979570388793945 s
2021-08-18:16:39:14,594 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:14,600 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:39:14,601 INFO     [param_server.py:410] Lock worker 1 with localStep 315 , while globalStep is 314

2021-08-18:16:39:15,426 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:39:15,435 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:16,535 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:16,545 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:16,580 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:16,589 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:17,175 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:17,194 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:18,902 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:18,923 INFO     [learner.py:606] ====Pushing takes 0.018622636795043945 s
2021-08-18:16:39:18,954 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:18,963 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:39:18,964 INFO     [param_server.py:410] Lock worker 2 with localStep 315 , while globalStep is 314

2021-08-18:16:39:18,973 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:18,982 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:19,634 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:19,663 INFO     [learner.py:606] ====Pushing takes 0.027216434478759766 s
2021-08-18:16:39:19,693 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:19,700 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:39:19,700 INFO     [param_server.py:381] ====After aggregation in epoch: 314, virtual_clock: 12282.18170246679, top_1: : 65.6018 % (2033.0), top_5: : 100.0 % (3099.0), test loss: 2.935315741433038, test len: 3099.0
2021-08-18:16:39:19,703 INFO     [param_server.py:410] Lock worker 3 with localStep 315 , while globalStep is 315

2021-08-18:16:39:19,703 INFO     [param_server.py:441] ====Epoch 316 completes 18 clients with loss 53.01603004838915, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:39:19,704 INFO     [param_server.py:450] ====Start to sample for epoch 316, global virtualClock: 12282.18170246679, round_duration: 64.13397472275163
2021-08-18:16:39:19,705 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:20,7 INFO     [param_server.py:553] For epoch: 316, median_reward: 1128.7054193295066, dev: 5643.527096647533
2021-08-18:16:39:20,648 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8575, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:39:20,649 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4195.7733, eval_time 0.6027, test_loss 2.8575, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:39:20,685 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9973, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:39:20,686 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4195.8225, eval_time 0.6406, test_loss 2.9973, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:39:20,717 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:39:20,730 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0683, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:39:20,731 INFO     [learner.py:656] After aggregation epoch 315, CumulTime 4195.8704, eval_time 0.6897, test_loss 3.0683, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:39:20,738 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:20,754 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:39:20,769 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:20,798 INFO     [learner.py:526] ====Start train round 316
2021-08-18:16:39:20,819 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:22,270 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:22,291 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:22,568 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:22,578 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:23,565 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:23,580 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:24,365 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:24,386 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:25,174 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:25,194 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:25,601 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:25,628 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:39:25,936 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:25,948 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:25,957 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:25,968 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:26,637 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:26,665 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:26,845 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:26,859 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:27,261 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:27,284 INFO     [learner.py:606] ====Pushing takes 0.02165675163269043 s
2021-08-18:16:39:27,320 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:27,326 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:39:27,327 INFO     [param_server.py:410] Lock worker 1 with localStep 316 , while globalStep is 315

2021-08-18:16:39:28,432 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:39:28,445 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:29,486 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:29,505 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:29,643 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:29,655 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:30,268 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:30,281 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:31,943 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:31,958 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:32,61 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:32,83 INFO     [learner.py:606] ====Pushing takes 0.019677162170410156 s
2021-08-18:16:39:32,105 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:32,110 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:39:32,111 INFO     [param_server.py:410] Lock worker 2 with localStep 316 , while globalStep is 315

2021-08-18:16:39:32,612 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:32,643 INFO     [learner.py:606] ====Pushing takes 0.02923727035522461 s
2021-08-18:16:39:32,679 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:32,686 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:39:32,687 INFO     [param_server.py:381] ====After aggregation in epoch: 315, virtual_clock: 12346.315677189543, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 2.974367161591848, test len: 3099.0
2021-08-18:16:39:32,689 INFO     [param_server.py:410] Lock worker 3 with localStep 316 , while globalStep is 316

2021-08-18:16:39:32,690 INFO     [param_server.py:441] ====Epoch 317 completes 18 clients with loss 25.10230202832128, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:39:32,690 INFO     [param_server.py:450] ====Start to sample for epoch 317, global virtualClock: 12346.315677189543, round_duration: 64.13397472275163
2021-08-18:16:39:32,691 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:32,993 INFO     [param_server.py:553] For epoch: 317, median_reward: 1097.904251982523, dev: 5489.521259912615
2021-08-18:16:39:33,589 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3157, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:39:33,590 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4208.7146, eval_time 0.5715, test_loss 3.3157, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:39:33,591 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1625, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:39:33,610 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4208.7496, eval_time 0.5944, test_loss 3.1625, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:39:33,621 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9267, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:16:39:33,621 INFO     [learner.py:656] After aggregation epoch 316, CumulTime 4208.7574, eval_time 0.6031, test_loss 2.9267, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:16:39:33,657 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:33,665 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:33,678 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:33,691 INFO     [learner.py:526] ====Start train round 317
2021-08-18:16:39:33,695 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:33,706 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:34,905 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:34,926 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:35,281 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:35,292 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:36,181 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:36,194 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:37,175 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:37,202 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:38,82 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:38,119 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:38,222 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:38,242 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:39:38,607 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:38,623 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:38,801 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:38,821 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:39,304 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:39,314 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:39,459 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:39,480 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:40,124 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:40,149 INFO     [learner.py:606] ====Pushing takes 0.023227214813232422 s
2021-08-18:16:39:40,185 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:40,194 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:39:40,194 INFO     [param_server.py:410] Lock worker 1 with localStep 317 , while globalStep is 316

2021-08-18:16:39:41,244 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:39:41,255 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:42,191 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:42,206 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:42,411 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:42,425 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:42,955 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:42,965 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:44,455 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:44,464 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:44,925 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:44,948 INFO     [learner.py:606] ====Pushing takes 0.01869058609008789 s
2021-08-18:16:39:44,981 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:44,986 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:39:44,987 INFO     [param_server.py:410] Lock worker 2 with localStep 317 , while globalStep is 316

2021-08-18:16:39:45,106 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:45,133 INFO     [learner.py:606] ====Pushing takes 0.026088476181030273 s
2021-08-18:16:39:45,163 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:45,170 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:39:45,170 INFO     [param_server.py:381] ====After aggregation in epoch: 316, virtual_clock: 12410.449651912295, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 3.134927930655303, test len: 3099.0
2021-08-18:16:39:45,172 INFO     [param_server.py:410] Lock worker 3 with localStep 317 , while globalStep is 317

2021-08-18:16:39:45,172 INFO     [param_server.py:441] ====Epoch 318 completes 18 clients with loss 91.40520444160414, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:39:45,188 INFO     [param_server.py:450] ====Start to sample for epoch 318, global virtualClock: 12410.449651912295, round_duration: 64.13397472275163
2021-08-18:16:39:45,189 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:45,467 INFO     [param_server.py:553] For epoch: 318, median_reward: 1123.9885906259756, dev: 5619.942953129877
2021-08-18:16:39:46,166 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.11, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:39:46,166 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1793, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:39:46,167 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4221.2912, eval_time 0.6654, test_loss 3.11, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:39:46,167 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4221.3027, eval_time 0.6729, test_loss 3.1793, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:39:46,166 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0683, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:39:46,169 INFO     [learner.py:656] After aggregation epoch 317, CumulTime 4221.3083, eval_time 0.6788, test_loss 3.0683, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:39:46,235 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:46,235 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:46,238 INFO     [learner.py:526] ====Start train round 318
2021-08-18:16:39:46,248 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:39:46,250 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:46,257 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:47,671 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:39:47,689 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:39:48,49 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:39:48,67 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:39:49,136 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:39:49,146 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:39:49,745 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:39:49,765 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:39:50,700 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:39:50,727 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:39:50,821 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:39:50,840 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:39:51,558 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:39:51,572 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:39:51,629 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:39:51,656 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:39:52,358 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:39:52,367 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:39:52,381 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:39:52,385 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:39:52,920 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:39:52,944 INFO     [learner.py:606] ====Pushing takes 0.022342443466186523 s
2021-08-18:16:39:52,981 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:52,987 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:39:52,988 INFO     [param_server.py:410] Lock worker 1 with localStep 318 , while globalStep is 317

2021-08-18:16:39:53,935 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:39:53,953 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:39:55,111 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:39:55,127 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:39:55,135 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:39:55,144 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:39:55,736 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:39:55,750 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:39:57,345 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:39:57,366 INFO     [learner.py:606] ====Pushing takes 0.01867818832397461 s
2021-08-18:16:39:57,397 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:57,402 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:39:57,403 INFO     [param_server.py:410] Lock worker 2 with localStep 318 , while globalStep is 317

2021-08-18:16:39:57,438 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:39:57,452 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:39:58,123 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:39:58,150 INFO     [learner.py:606] ====Pushing takes 0.026258230209350586 s
2021-08-18:16:39:58,182 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:39:58,192 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:39:58,193 INFO     [param_server.py:381] ====After aggregation in epoch: 317, virtual_clock: 12474.583626635047, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 3.119218835124263, test len: 3099.0
2021-08-18:16:39:58,195 INFO     [param_server.py:410] Lock worker 3 with localStep 318 , while globalStep is 318

2021-08-18:16:39:58,195 INFO     [param_server.py:441] ====Epoch 319 completes 18 clients with loss 98.00446367261932, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:39:58,195 INFO     [param_server.py:450] ====Start to sample for epoch 319, global virtualClock: 12474.583626635047, round_duration: 64.13397472275163
2021-08-18:16:39:58,196 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 110, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:39:58,494 INFO     [param_server.py:553] For epoch: 319, median_reward: 1208.5629034834733, dev: 6042.814517417366
2021-08-18:16:39:59,134 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8241, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:39:59,135 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4234.2598, eval_time 0.6065, test_loss 2.8241, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:39:59,167 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4086, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:39:59,168 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4234.307, eval_time 0.6392, test_loss 3.4086, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:39:59,168 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4352, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:39:59,169 INFO     [learner.py:656] After aggregation epoch 318, CumulTime 4234.3051, eval_time 0.6406, test_loss 3.4352, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:39:59,209 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:59,218 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:39:59,238 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:59,240 INFO     [learner.py:526] ====Start train round 319
2021-08-18:16:39:59,252 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:39:59,254 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:00,502 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:00,512 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:01,7 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:01,18 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:02,80 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:02,95 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:02,478 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:02,505 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:03,318 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:03,339 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:03,781 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:03,800 INFO     [learner.py:165] Start to run client 110 on rank 2...
2021-08-18:16:40:03,995 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:04,15 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:04,435 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:04,445 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:04,791 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:04,812 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:05,70 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:05,79 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:05,407 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:05,429 INFO     [learner.py:606] ====Pushing takes 0.021079301834106445 s
2021-08-18:16:40:05,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:05,470 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.05555555555555555, now collected 6 clients
2021-08-18:16:40:05,470 INFO     [param_server.py:410] Lock worker 1 with localStep 319 , while globalStep is 318

2021-08-18:16:40:06,903 INFO     [learner.py:439] Completed to run client 110
2021-08-18:16:40:06,921 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:07,926 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:07,940 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:08,53 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:08,67 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:08,816 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:08,830 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:10,317 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:10,336 INFO     [learner.py:606] ====Pushing takes 0.017702102661132812 s
2021-08-18:16:40:10,365 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:10,370 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.05555555555555555, now collected 11 clients
2021-08-18:16:40:10,371 INFO     [param_server.py:410] Lock worker 2 with localStep 319 , while globalStep is 318

2021-08-18:16:40:10,514 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:10,528 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:11,237 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:11,265 INFO     [learner.py:606] ====Pushing takes 0.026208162307739258 s
2021-08-18:16:40:11,295 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:11,302 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.05555555555555555, now collected 18 clients
2021-08-18:16:40:11,303 INFO     [param_server.py:381] ====After aggregation in epoch: 318, virtual_clock: 12538.7176013578, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 3.2226299400682805, test len: 3099.0
2021-08-18:16:40:11,305 INFO     [param_server.py:410] Lock worker 3 with localStep 319 , while globalStep is 319

2021-08-18:16:40:11,306 INFO     [param_server.py:441] ====Epoch 320 completes 18 clients with loss 52.8141861806509, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 110: 0, 113: 0} 
==========
2021-08-18:16:40:11,306 INFO     [param_server.py:450] ====Start to sample for epoch 320, global virtualClock: 12538.7176013578, round_duration: 64.13397472275163
2021-08-18:16:40:11,307 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:11,609 INFO     [param_server.py:553] For epoch: 320, median_reward: 1119.3175588972224, dev: 5596.587794486112
2021-08-18:16:40:12,245 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9496, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:40:12,246 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4247.3824, eval_time 0.601, test_loss 2.9496, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:40:12,256 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8578, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:40:12,256 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4247.3808, eval_time 0.6102, test_loss 2.8578, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:40:12,288 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3451, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:40:12,289 INFO     [learner.py:656] After aggregation epoch 319, CumulTime 4247.428, eval_time 0.6453, test_loss 3.3451, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:40:12,317 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:40:12,326 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:40:12,330 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:12,338 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:12,355 INFO     [learner.py:526] ====Start train round 320
2021-08-18:16:40:12,376 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:13,810 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:13,822 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:14,728 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:14,741 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:15,247 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:15,258 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:15,944 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:15,964 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:16,776 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:16,797 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:17,564 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:17,582 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:17,606 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:17,633 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:17,696 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:17,709 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:18,290 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:18,317 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:18,489 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:18,503 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:19,38 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:19,40 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:19,54 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:19,61 INFO     [learner.py:606] ====Pushing takes 0.021842241287231445 s
2021-08-18:16:40:19,96 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:19,105 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:19,106 INFO     [param_server.py:410] Lock worker 1 with localStep 320 , while globalStep is 319

2021-08-18:16:40:21,251 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:21,266 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:21,754 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:21,769 INFO     [learner.py:606] ====Pushing takes 0.013302803039550781 s
2021-08-18:16:40:21,784 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:21,788 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:21,789 INFO     [param_server.py:410] Lock worker 2 with localStep 320 , while globalStep is 319

2021-08-18:16:40:22,133 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:22,147 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:23,785 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:23,794 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:24,395 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:24,422 INFO     [learner.py:606] ====Pushing takes 0.025931835174560547 s
2021-08-18:16:40:24,452 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:24,459 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:24,460 INFO     [param_server.py:381] ====After aggregation in epoch: 319, virtual_clock: 12606.09546948701, top_1: : 66.6989 % (2067.0), top_5: : 100.0 % (3099.0), test loss: 3.0508365211663424, test len: 3099.0
2021-08-18:16:40:24,462 INFO     [param_server.py:410] Lock worker 3 with localStep 320 , while globalStep is 320

2021-08-18:16:40:24,463 INFO     [param_server.py:441] ====Epoch 321 completes 17 clients with loss 100.40099709283739, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:24,463 INFO     [param_server.py:450] ====Start to sample for epoch 321, global virtualClock: 12606.09546948701, round_duration: 67.37786812921225
2021-08-18:16:40:24,465 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:24,749 INFO     [param_server.py:541] Handle Wight 0.03226661682128906 | Send 0.2861664295196533
2021-08-18:16:40:24,750 INFO     [param_server.py:553] For epoch: 321, median_reward: 1029.4480739283492, dev: 5147.240369641746
2021-08-18:16:40:25,364 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8409, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:40:25,368 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4260.5039, eval_time 0.5914, test_loss 3.8409, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:40:25,396 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.789, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:40:25,397 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4260.5219, eval_time 0.6206, test_loss 2.789, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:40:25,433 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2221, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:40:25,434 INFO     [learner.py:656] After aggregation epoch 320, CumulTime 4260.573, eval_time 0.6614, test_loss 3.2221, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:40:25,436 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:25,448 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:25,465 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:25,472 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:25,503 INFO     [learner.py:526] ====Start train round 321
2021-08-18:16:40:25,517 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:26,733 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:26,743 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:27,638 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:27,648 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:28,273 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:28,288 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:28,898 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:28,919 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:29,640 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:29,667 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:30,422 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:30,433 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:30,440 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:30,454 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:30,774 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:30,784 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:31,170 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:31,198 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:31,682 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:31,696 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:31,829 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:31,829 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:31,843 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:31,852 INFO     [learner.py:606] ====Pushing takes 0.02147507667541504 s
2021-08-18:16:40:31,886 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:31,893 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:31,893 INFO     [param_server.py:410] Lock worker 1 with localStep 321 , while globalStep is 320

2021-08-18:16:40:34,286 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:34,304 INFO     [learner.py:606] ====Pushing takes 0.013344287872314453 s
2021-08-18:16:40:34,319 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:34,324 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:34,324 INFO     [param_server.py:410] Lock worker 2 with localStep 321 , while globalStep is 320

2021-08-18:16:40:34,668 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:34,682 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:35,326 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:35,338 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:37,90 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:37,104 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:37,815 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:37,846 INFO     [learner.py:606] ====Pushing takes 0.02924799919128418 s
2021-08-18:16:40:37,878 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:37,887 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:37,888 INFO     [param_server.py:381] ====After aggregation in epoch: 320, virtual_clock: 12673.473337616222, top_1: : 65.4405 % (2028.0), top_5: : 100.0 % (3099.0), test loss: 3.2840197836911234, test len: 3099.0
2021-08-18:16:40:37,890 INFO     [param_server.py:410] Lock worker 3 with localStep 321 , while globalStep is 321

2021-08-18:16:40:37,891 INFO     [param_server.py:441] ====Epoch 322 completes 17 clients with loss 32.958742456746435, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:37,892 INFO     [param_server.py:450] ====Start to sample for epoch 322, global virtualClock: 12673.473337616222, round_duration: 67.37786812921225
2021-08-18:16:40:37,893 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:38,176 INFO     [param_server.py:553] For epoch: 322, median_reward: 1149.3381127445425, dev: 5746.690563722713
2021-08-18:16:40:38,832 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8204, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:40:38,833 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4273.9571, eval_time 0.6224, test_loss 2.8204, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:40:38,873 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.839, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:40:38,877 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4274.0162, eval_time 0.6669, test_loss 2.839, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:40:38,880 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1147, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:40:38,881 INFO     [learner.py:656] After aggregation epoch 321, CumulTime 4274.0168, eval_time 0.6708, test_loss 3.1147, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:40:38,902 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:38,915 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:38,943 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:38,950 INFO     [learner.py:526] ====Start train round 322
2021-08-18:16:40:38,961 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:38,966 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:40,302 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:40,316 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:41,113 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:41,122 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:41,706 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:41,720 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:42,717 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:42,737 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:43,624 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:43,651 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:43,962 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:43,981 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:44,269 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:44,283 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:44,490 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:44,512 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:44,937 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:44,947 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:45,218 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:45,238 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:45,447 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:45,483 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:45,833 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:45,856 INFO     [learner.py:606] ====Pushing takes 0.02183055877685547 s
2021-08-18:16:40:45,892 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:45,899 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:45,900 INFO     [param_server.py:410] Lock worker 1 with localStep 322 , while globalStep is 321

2021-08-18:16:40:47,440 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:40:47,451 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:40:47,910 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:40:47,925 INFO     [learner.py:606] ====Pushing takes 0.014393806457519531 s
2021-08-18:16:40:47,947 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:47,951 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:40:47,952 INFO     [param_server.py:410] Lock worker 2 with localStep 322 , while globalStep is 321

2021-08-18:16:40:48,283 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:40:48,297 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:40:50,9 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:40:50,22 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:40:50,694 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:40:50,722 INFO     [learner.py:606] ====Pushing takes 0.027317523956298828 s
2021-08-18:16:40:50,759 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:50,766 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:40:50,767 INFO     [param_server.py:381] ====After aggregation in epoch: 321, virtual_clock: 12740.851205745434, top_1: : 65.1178 % (2018.0), top_5: : 100.0 % (3099.0), test loss: 2.9246959553824534, test len: 3099.0
2021-08-18:16:40:50,769 INFO     [param_server.py:410] Lock worker 3 with localStep 322 , while globalStep is 322

2021-08-18:16:40:50,770 INFO     [param_server.py:441] ====Epoch 323 completes 17 clients with loss 63.915853949394695, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:40:50,770 INFO     [param_server.py:450] ====Start to sample for epoch 323, global virtualClock: 12740.851205745434, round_duration: 67.37786812921225
2021-08-18:16:40:50,771 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:40:51,74 INFO     [param_server.py:553] For epoch: 323, median_reward: 945.2531306109726, dev: 4726.265653054863
2021-08-18:16:40:51,786 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9748, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:40:51,787 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4286.9226, eval_time 0.6782, test_loss 2.9748, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:40:51,787 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1189, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:40:51,788 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4286.9122, eval_time 0.6766, test_loss 3.1189, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:40:51,790 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.105, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:40:51,790 INFO     [learner.py:656] After aggregation epoch 322, CumulTime 4286.9294, eval_time 0.6828, test_loss 3.105, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:40:51,855 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:51,856 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:51,859 INFO     [learner.py:526] ====Start train round 323
2021-08-18:16:40:51,871 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:40:51,871 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:40:51,872 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:40:53,366 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:40:53,384 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:40:54,211 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:40:54,220 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:40:54,927 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:40:54,939 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:40:55,764 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:40:55,779 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:40:56,576 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:40:56,591 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:40:57,61 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:40:57,81 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:40:57,195 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:40:57,205 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:40:57,358 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:40:57,378 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:40:57,910 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:40:57,920 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:40:58,154 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:40:58,181 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:40:58,489 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:40:58,507 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:40:58,924 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:40:58,947 INFO     [learner.py:606] ====Pushing takes 0.0218808650970459 s
2021-08-18:16:40:58,983 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:40:58,992 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:40:58,992 INFO     [param_server.py:410] Lock worker 1 with localStep 323 , while globalStep is 322

2021-08-18:16:41:00,783 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:00,793 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:00,797 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:00,808 INFO     [learner.py:606] ====Pushing takes 0.012670040130615234 s
2021-08-18:16:41:00,824 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:00,829 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:00,830 INFO     [param_server.py:410] Lock worker 2 with localStep 323 , while globalStep is 322

2021-08-18:16:41:01,601 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:01,616 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:03,216 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:03,230 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:03,970 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:03,996 INFO     [learner.py:606] ====Pushing takes 0.025259017944335938 s
2021-08-18:16:41:04,35 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:04,42 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:04,43 INFO     [param_server.py:381] ====After aggregation in epoch: 322, virtual_clock: 12808.229073874645, top_1: : 67.2798 % (2085.0), top_5: : 100.0 % (3099.0), test loss: 3.0662001238928895, test len: 3099.0
2021-08-18:16:41:04,46 INFO     [param_server.py:410] Lock worker 3 with localStep 323 , while globalStep is 323

2021-08-18:16:41:04,47 INFO     [param_server.py:441] ====Epoch 324 completes 17 clients with loss 53.55023479660133, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:04,47 INFO     [param_server.py:450] ====Start to sample for epoch 324, global virtualClock: 12808.229073874645, round_duration: 67.37786812921225
2021-08-18:16:41:04,48 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:04,342 INFO     [param_server.py:553] For epoch: 324, median_reward: 1041.141227295589, dev: 5205.706136477946
2021-08-18:16:41:04,983 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2178, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:41:04,984 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4300.1083, eval_time 0.6027, test_loss 3.2178, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:41:05,19 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1168, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:41:05,24 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4300.1595, eval_time 0.6431, test_loss 3.1168, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:41:05,34 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.866, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:41:05,35 INFO     [learner.py:656] After aggregation epoch 323, CumulTime 4300.174, eval_time 0.6588, test_loss 3.866, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:41:05,53 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:41:05,61 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:05,93 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:41:05,105 INFO     [learner.py:526] ====Start train round 324
2021-08-18:16:41:05,106 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:05,121 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:06,303 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:06,313 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:07,226 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:07,236 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:07,723 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:07,733 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:08,430 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:08,449 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:09,195 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:09,216 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:10,27 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:10,39 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:10,48 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:10,57 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:10,193 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:10,207 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:10,751 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:10,778 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:10,954 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:10,968 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:11,327 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:11,340 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:11,342 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:11,367 INFO     [learner.py:606] ====Pushing takes 0.023371219635009766 s
2021-08-18:16:41:11,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:11,407 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:11,408 INFO     [param_server.py:410] Lock worker 1 with localStep 324 , while globalStep is 323

2021-08-18:16:41:13,749 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:13,765 INFO     [learner.py:606] ====Pushing takes 0.01448512077331543 s
2021-08-18:16:41:13,786 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:13,795 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:13,795 INFO     [param_server.py:410] Lock worker 2 with localStep 324 , while globalStep is 323

2021-08-18:16:41:13,795 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:13,813 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:14,683 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:14,697 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:16,423 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:16,433 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:16,994 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:17,32 INFO     [learner.py:606] ====Pushing takes 0.026158809661865234 s
2021-08-18:16:41:17,69 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:17,76 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:17,77 INFO     [param_server.py:381] ====After aggregation in epoch: 323, virtual_clock: 12875.606942003857, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 3.4002235244821617, test len: 3099.0
2021-08-18:16:41:17,79 INFO     [param_server.py:410] Lock worker 3 with localStep 324 , while globalStep is 324

2021-08-18:16:41:17,80 INFO     [param_server.py:441] ====Epoch 325 completes 17 clients with loss 61.06679291277273, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:17,80 INFO     [param_server.py:450] ====Start to sample for epoch 325, global virtualClock: 12875.606942003857, round_duration: 67.37786812921225
2021-08-18:16:41:17,81 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:17,351 INFO     [param_server.py:553] For epoch: 325, median_reward: 915.0479750955309, dev: 4575.239875477654
2021-08-18:16:41:18,42 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7023, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:41:18,43 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4313.1674, eval_time 0.6548, test_loss 2.7023, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:41:18,111 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:41:18,120 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.6448, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:41:18,123 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4313.2621, eval_time 0.7381, test_loss 2.6448, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:41:18,126 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:18,131 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1159, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:41:18,132 INFO     [learner.py:656] After aggregation epoch 324, CumulTime 4313.2676, eval_time 0.7465, test_loss 3.1159, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:41:18,201 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:41:18,218 INFO     [learner.py:526] ====Start train round 325
2021-08-18:16:41:18,221 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:18,237 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:19,574 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:19,584 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:20,434 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:20,444 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:20,962 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:20,976 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:22,25 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:22,45 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:22,881 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:22,906 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:23,167 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:23,191 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:23,675 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:23,695 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:23,697 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:23,711 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:24,338 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:24,359 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:24,464 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:24,478 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:24,575 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:24,589 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:25,58 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:25,81 INFO     [learner.py:606] ====Pushing takes 0.021856069564819336 s
2021-08-18:16:41:25,114 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:25,123 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:25,124 INFO     [param_server.py:410] Lock worker 1 with localStep 325 , while globalStep is 324

2021-08-18:16:41:27,64 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:27,77 INFO     [learner.py:606] ====Pushing takes 0.011686563491821289 s
2021-08-18:16:41:27,98 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:27,103 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:27,104 INFO     [param_server.py:410] Lock worker 2 with localStep 325 , while globalStep is 324

2021-08-18:16:41:27,233 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:27,242 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:27,940 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:27,950 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:29,524 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:29,534 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:30,208 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:30,235 INFO     [learner.py:606] ====Pushing takes 0.02553868293762207 s
2021-08-18:16:41:30,270 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:30,276 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:30,277 INFO     [param_server.py:381] ====After aggregation in epoch: 324, virtual_clock: 12942.984810133068, top_1: : 66.6667 % (2066.0), top_5: : 100.0 % (3099.0), test loss: 2.8209885987970567, test len: 3099.0
2021-08-18:16:41:30,280 INFO     [param_server.py:410] Lock worker 3 with localStep 325 , while globalStep is 325

2021-08-18:16:41:30,280 INFO     [param_server.py:441] ====Epoch 326 completes 17 clients with loss 36.09797126619316, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:30,280 INFO     [param_server.py:450] ====Start to sample for epoch 326, global virtualClock: 12942.984810133068, round_duration: 67.37786812921225
2021-08-18:16:41:30,281 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:30,543 INFO     [param_server.py:553] For epoch: 326, median_reward: 864.7706007700696, dev: 4323.853003850348
2021-08-18:16:41:31,133 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9971, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:41:31,134 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4326.2586, eval_time 0.5508, test_loss 2.9971, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:41:31,169 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3794, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:41:31,170 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4326.3089, eval_time 0.5929, test_loss 3.3794, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:41:31,171 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4392, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:41:31,171 INFO     [learner.py:656] After aggregation epoch 325, CumulTime 4326.3071, eval_time 0.5906, test_loss 3.4392, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:41:31,203 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:31,215 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:31,247 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:31,240 INFO     [learner.py:526] ====Start train round 326
2021-08-18:16:41:31,272 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:31,277 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:32,894 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:32,908 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:33,664 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:33,674 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:34,443 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:34,463 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:35,200 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:35,227 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:36,66 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:36,80 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:36,527 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:36,546 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:36,790 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:36,803 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:36,873 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:36,884 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:37,436 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:37,450 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:37,593 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:37,603 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:37,990 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:38,12 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:38,18 INFO     [learner.py:606] ====Pushing takes 0.02313232421875 s
2021-08-18:16:41:38,31 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:38,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:38,60 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:38,61 INFO     [param_server.py:410] Lock worker 1 with localStep 326 , while globalStep is 325

2021-08-18:16:41:40,296 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:40,308 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:40,331 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:40,346 INFO     [learner.py:606] ====Pushing takes 0.01390838623046875 s
2021-08-18:16:41:40,362 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:40,367 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:40,368 INFO     [param_server.py:410] Lock worker 2 with localStep 326 , while globalStep is 325

2021-08-18:16:41:41,89 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:41,104 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:42,824 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:42,845 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:43,543 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:43,570 INFO     [learner.py:606] ====Pushing takes 0.026180505752563477 s
2021-08-18:16:41:43,607 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:43,616 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:43,617 INFO     [param_server.py:381] ====After aggregation in epoch: 325, virtual_clock: 13010.36267826228, top_1: : 66.7312 % (2068.0), top_5: : 100.0 % (3099.0), test loss: 3.271914932462904, test len: 3099.0
2021-08-18:16:41:43,619 INFO     [param_server.py:410] Lock worker 3 with localStep 326 , while globalStep is 326

2021-08-18:16:41:43,619 INFO     [param_server.py:441] ====Epoch 327 completes 17 clients with loss 85.65157634738783, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:43,619 INFO     [param_server.py:450] ====Start to sample for epoch 327, global virtualClock: 13010.36267826228, round_duration: 67.37786812921225
2021-08-18:16:41:43,620 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:43,884 INFO     [param_server.py:553] For epoch: 327, median_reward: 891.7356122037183, dev: 4458.6780610185915
2021-08-18:16:41:44,462 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3575, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:41:44,463 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4339.5873, eval_time 0.5385, test_loss 3.3575, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:41:44,505 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2343, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:16:41:44,506 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4339.6421, eval_time 0.5821, test_loss 3.2343, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:16:41:44,520 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0597, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:41:44,521 INFO     [learner.py:656] After aggregation epoch 326, CumulTime 4339.6605, eval_time 0.6042, test_loss 3.0597, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:41:44,530 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:44,544 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:44,576 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:44,590 INFO     [learner.py:526] ====Start train round 327
2021-08-18:16:41:44,598 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:44,619 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:46,92 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:46,112 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:41:46,803 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:41:46,812 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:41:47,333 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:41:47,343 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:41:48,293 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:41:48,307 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:41:49,29 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:41:49,44 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:41:49,455 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:41:49,468 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:41:49,649 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:41:49,659 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:41:49,753 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:41:49,767 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:41:50,234 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:41:50,243 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:41:50,336 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:41:50,363 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:41:50,867 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:41:50,881 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:41:51,25 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:41:51,48 INFO     [learner.py:606] ====Pushing takes 0.022077560424804688 s
2021-08-18:16:41:51,76 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:51,82 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:41:51,82 INFO     [param_server.py:410] Lock worker 1 with localStep 327 , while globalStep is 326

2021-08-18:16:41:53,249 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:41:53,267 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:41:53,369 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:41:53,387 INFO     [learner.py:606] ====Pushing takes 0.014402151107788086 s
2021-08-18:16:41:53,403 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:53,408 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:41:53,408 INFO     [param_server.py:410] Lock worker 2 with localStep 327 , while globalStep is 326

2021-08-18:16:41:54,186 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:41:54,200 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:41:56,27 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:41:56,41 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:41:56,741 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:41:56,767 INFO     [learner.py:606] ====Pushing takes 0.02423691749572754 s
2021-08-18:16:41:56,798 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:41:56,805 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:41:56,806 INFO     [param_server.py:381] ====After aggregation in epoch: 326, virtual_clock: 13077.740546391491, top_1: : 65.0532 % (2016.0), top_5: : 100.0 % (3099.0), test loss: 3.217155483033922, test len: 3099.0
2021-08-18:16:41:56,808 INFO     [param_server.py:410] Lock worker 3 with localStep 327 , while globalStep is 327

2021-08-18:16:41:56,809 INFO     [param_server.py:441] ====Epoch 328 completes 17 clients with loss 12.642745705557244, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:41:56,809 INFO     [param_server.py:450] ====Start to sample for epoch 328, global virtualClock: 13077.740546391491, round_duration: 67.37786812921225
2021-08-18:16:41:56,810 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:41:57,82 INFO     [param_server.py:553] For epoch: 328, median_reward: 999.6056311803123, dev: 4998.028155901562
2021-08-18:16:41:57,704 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6106, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:41:57,705 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4352.8298, eval_time 0.5853, test_loss 2.6106, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:41:57,784 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8372, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:41:57,785 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4352.9212, eval_time 0.6654, test_loss 2.8372, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:41:57,786 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7683, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:41:57,789 INFO     [learner.py:656] After aggregation epoch 327, CumulTime 4352.9281, eval_time 0.6733, test_loss 3.7683, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:41:57,800 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:57,810 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:41:57,858 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:57,863 INFO     [learner.py:526] ====Start train round 328
2021-08-18:16:41:57,878 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:41:57,884 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:41:59,440 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:41:59,454 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:00,273 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:00,284 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:00,473 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:00,483 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:01,758 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:01,778 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:02,642 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:02,662 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:02,937 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:02,955 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:03,73 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:03,87 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:03,530 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:03,550 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:03,692 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:03,706 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:04,190 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:04,210 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:04,323 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:04,337 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:04,744 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:04,767 INFO     [learner.py:606] ====Pushing takes 0.021889209747314453 s
2021-08-18:16:42:04,810 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:04,819 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:04,820 INFO     [param_server.py:410] Lock worker 1 with localStep 328 , while globalStep is 327

2021-08-18:16:42:06,457 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:06,476 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:06,968 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:06,983 INFO     [learner.py:606] ====Pushing takes 0.013574838638305664 s
2021-08-18:16:42:07,5 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:07,9 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:07,10 INFO     [param_server.py:410] Lock worker 2 with localStep 328 , while globalStep is 327

2021-08-18:16:42:07,293 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:07,303 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:09,16 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:09,32 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:09,642 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:09,672 INFO     [learner.py:606] ====Pushing takes 0.028962135314941406 s
2021-08-18:16:42:09,715 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:09,722 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:09,723 INFO     [param_server.py:381] ====After aggregation in epoch: 327, virtual_clock: 13145.118414520703, top_1: : 67.2798 % (2085.0), top_5: : 100.0 % (3099.0), test loss: 3.0720440579785246, test len: 3099.0
2021-08-18:16:42:09,725 INFO     [param_server.py:410] Lock worker 3 with localStep 328 , while globalStep is 328

2021-08-18:16:42:09,726 INFO     [param_server.py:441] ====Epoch 329 completes 17 clients with loss 54.567811364164086, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:09,726 INFO     [param_server.py:450] ====Start to sample for epoch 329, global virtualClock: 13145.118414520703, round_duration: 67.37786812921225
2021-08-18:16:42:09,727 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:10,63 INFO     [param_server.py:553] For epoch: 329, median_reward: 1027.6816963178921, dev: 5138.40848158946
2021-08-18:16:42:10,696 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6729, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:42:10,697 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4365.8218, eval_time 0.5934, test_loss 2.6729, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:42:10,738 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8918, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:42:10,741 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4365.8772, eval_time 0.6392, test_loss 2.8918, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:42:10,774 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7963, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:42:10,775 INFO     [learner.py:656] After aggregation epoch 328, CumulTime 4365.9142, eval_time 0.6772, test_loss 2.7963, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:42:10,788 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:42:10,796 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:10,832 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:42:10,840 INFO     [learner.py:526] ====Start train round 329
2021-08-18:16:42:10,854 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:10,860 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:12,102 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:12,116 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:13,66 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:13,80 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:13,624 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:13,638 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:14,457 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:14,485 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:15,328 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:15,349 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:15,835 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:15,848 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:16,121 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:16,142 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:16,304 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:16,317 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:16,826 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:16,867 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:17,119 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:17,137 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:17,199 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:17,213 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:17,438 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:17,462 INFO     [learner.py:606] ====Pushing takes 0.02264547348022461 s
2021-08-18:16:42:17,499 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:17,506 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:17,506 INFO     [param_server.py:410] Lock worker 1 with localStep 329 , while globalStep is 328

2021-08-18:16:42:19,570 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:19,587 INFO     [learner.py:606] ====Pushing takes 0.014751434326171875 s
2021-08-18:16:42:19,608 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:19,612 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:19,613 INFO     [param_server.py:410] Lock worker 2 with localStep 329 , while globalStep is 328

2021-08-18:16:42:19,882 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:19,893 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:20,581 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:20,591 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:22,393 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:22,407 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:23,92 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:23,138 INFO     [learner.py:606] ====Pushing takes 0.025789260864257812 s
2021-08-18:16:42:23,169 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:23,179 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:23,180 INFO     [param_server.py:381] ====After aggregation in epoch: 328, virtual_clock: 13212.496282649914, top_1: : 66.0536 % (2047.0), top_5: : 100.0 % (3099.0), test loss: 2.786985429348769, test len: 3099.0
2021-08-18:16:42:23,182 INFO     [param_server.py:410] Lock worker 3 with localStep 329 , while globalStep is 329

2021-08-18:16:42:23,182 INFO     [param_server.py:441] ====Epoch 330 completes 17 clients with loss 47.860308419686866, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:23,183 INFO     [param_server.py:450] ====Start to sample for epoch 330, global virtualClock: 13212.496282649914, round_duration: 67.37786812921225
2021-08-18:16:42:23,184 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:23,485 INFO     [param_server.py:553] For epoch: 330, median_reward: 1181.0454972507987, dev: 5905.227486253993
2021-08-18:16:42:24,174 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0394, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:42:24,174 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6515, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:42:24,175 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4379.3106, eval_time 0.6392, test_loss 3.0394, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:42:24,175 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4379.2994, eval_time 0.6392, test_loss 2.6515, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:42:24,243 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:42:24,253 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8398, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:42:24,254 INFO     [learner.py:656] After aggregation epoch 329, CumulTime 4379.3931, eval_time 0.7228, test_loss 2.8398, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:42:24,254 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:42:24,256 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:24,267 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:24,322 INFO     [learner.py:526] ====Start train round 330
2021-08-18:16:42:24,351 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:25,769 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:25,789 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:26,463 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:26,477 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:27,96 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:27,110 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:28,277 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:28,295 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:28,946 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:28,960 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:29,270 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:29,289 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:29,365 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:29,380 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:29,691 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:29,704 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:30,89 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:30,99 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:30,382 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:30,396 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:30,546 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:30,560 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:30,910 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:30,933 INFO     [learner.py:606] ====Pushing takes 0.022063732147216797 s
2021-08-18:16:42:30,968 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:30,975 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:30,975 INFO     [param_server.py:410] Lock worker 1 with localStep 330 , while globalStep is 329

2021-08-18:16:42:32,943 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:32,957 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:33,48 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:33,64 INFO     [learner.py:606] ====Pushing takes 0.013954877853393555 s
2021-08-18:16:42:33,89 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:33,94 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:33,94 INFO     [param_server.py:410] Lock worker 2 with localStep 330 , while globalStep is 329

2021-08-18:16:42:33,862 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:33,876 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:35,664 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:35,683 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:36,366 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:36,394 INFO     [learner.py:606] ====Pushing takes 0.026180744171142578 s
2021-08-18:16:42:36,425 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:36,433 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:36,433 INFO     [param_server.py:381] ====After aggregation in epoch: 329, virtual_clock: 13279.874150779126, top_1: : 66.6667 % (2066.0), top_5: : 100.0 % (3099.0), test loss: 2.843578453417178, test len: 3099.0
2021-08-18:16:42:36,436 INFO     [param_server.py:410] Lock worker 3 with localStep 330 , while globalStep is 330

2021-08-18:16:42:36,436 INFO     [param_server.py:441] ====Epoch 331 completes 17 clients with loss 32.39923021586508, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:36,436 INFO     [param_server.py:450] ====Start to sample for epoch 331, global virtualClock: 13279.874150779126, round_duration: 67.37786812921225
2021-08-18:16:42:36,437 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:36,737 INFO     [param_server.py:553] For epoch: 331, median_reward: 1059.7480967457045, dev: 5298.740483728523
2021-08-18:16:42:37,388 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3875, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:42:37,389 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4392.5251, eval_time 0.6069, test_loss 3.3875, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:42:37,395 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7076, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:42:37,396 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4392.5204, eval_time 0.6134, test_loss 2.7076, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:42:37,459 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:37,462 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:37,474 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:37,474 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:37,481 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5601, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:42:37,484 INFO     [learner.py:656] After aggregation epoch 330, CumulTime 4392.6235, eval_time 0.702, test_loss 3.5601, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:42:37,554 INFO     [learner.py:526] ====Start train round 331
2021-08-18:16:42:37,580 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:39,119 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:39,133 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:39,732 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:39,745 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:40,204 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:40,213 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:41,442 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:41,455 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:42,209 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:42,223 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:42,503 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:42,518 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:42,563 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:42,577 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:43,33 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:43,54 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:43,302 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:43,317 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:43,759 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:43,769 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:43,780 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:43,783 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:44,360 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:44,383 INFO     [learner.py:606] ====Pushing takes 0.021779298782348633 s
2021-08-18:16:42:44,413 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:44,424 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:44,424 INFO     [param_server.py:410] Lock worker 1 with localStep 331 , while globalStep is 330

2021-08-18:16:42:46,70 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:46,72 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:46,86 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:42:46,86 INFO     [learner.py:606] ====Pushing takes 0.014258146286010742 s
2021-08-18:16:42:46,102 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:46,108 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:46,109 INFO     [param_server.py:410] Lock worker 2 with localStep 331 , while globalStep is 330

2021-08-18:16:42:47,13 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:42:47,27 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:42:48,690 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:42:48,709 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:42:49,415 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:42:49,442 INFO     [learner.py:606] ====Pushing takes 0.0263364315032959 s
2021-08-18:16:42:49,484 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:49,493 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:42:49,494 INFO     [param_server.py:381] ====After aggregation in epoch: 330, virtual_clock: 13347.252018908337, top_1: : 66.8925 % (2073.0), top_5: : 100.0 % (3099.0), test loss: 3.218397083105865, test len: 3099.0
2021-08-18:16:42:49,496 INFO     [param_server.py:410] Lock worker 3 with localStep 331 , while globalStep is 331

2021-08-18:16:42:49,497 INFO     [param_server.py:441] ====Epoch 332 completes 17 clients with loss 44.310302944219075, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:42:49,497 INFO     [param_server.py:450] ====Start to sample for epoch 332, global virtualClock: 13347.252018908337, round_duration: 67.37786812921225
2021-08-18:16:42:49,498 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:42:49,824 INFO     [param_server.py:553] For epoch: 332, median_reward: 871.8830991002355, dev: 4359.415495501178
2021-08-18:16:42:50,552 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.5813, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:42:50,553 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4405.6777, eval_time 0.6947, test_loss 2.5813, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:42:50,589 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1729, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:42:50,593 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4405.729, eval_time 0.7347, test_loss 3.1729, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:42:50,622 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:50,630 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:42:50,634 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6413, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:42:50,635 INFO     [learner.py:656] After aggregation epoch 331, CumulTime 4405.7741, eval_time 0.7771, test_loss 3.6413, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:42:50,662 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:50,679 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:42:50,704 INFO     [learner.py:526] ====Start train round 332
2021-08-18:16:42:50,724 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:42:52,100 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:42:52,113 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:42:52,911 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:42:52,921 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:42:53,413 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:42:53,427 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:42:54,216 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:42:54,236 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:42:55,31 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:42:55,52 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:42:55,661 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:42:55,675 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:42:55,761 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:42:55,781 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:42:56,45 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:42:56,81 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:42:56,454 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:42:56,474 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:42:56,943 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:42:56,957 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:42:56,966 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:42:56,967 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:42:56,981 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:42:56,987 INFO     [learner.py:606] ====Pushing takes 0.01901531219482422 s
2021-08-18:16:42:57,17 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:57,24 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:42:57,26 INFO     [param_server.py:410] Lock worker 1 with localStep 332 , while globalStep is 331

2021-08-18:16:42:59,520 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:42:59,539 INFO     [learner.py:606] ====Pushing takes 0.01383829116821289 s
2021-08-18:16:42:59,554 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:42:59,558 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:42:59,559 INFO     [param_server.py:410] Lock worker 2 with localStep 332 , while globalStep is 331

2021-08-18:16:42:59,774 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:42:59,786 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:00,398 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:00,409 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:02,103 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:02,113 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:02,724 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:02,753 INFO     [learner.py:606] ====Pushing takes 0.027220726013183594 s
2021-08-18:16:43:02,790 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:02,798 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:02,798 INFO     [param_server.py:381] ====After aggregation in epoch: 331, virtual_clock: 13414.629887037549, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 3.131845207126052, test len: 3099.0
2021-08-18:16:43:02,801 INFO     [param_server.py:410] Lock worker 3 with localStep 332 , while globalStep is 332

2021-08-18:16:43:02,802 INFO     [param_server.py:441] ====Epoch 333 completes 17 clients with loss 28.23039116206492, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:02,802 INFO     [param_server.py:450] ====Start to sample for epoch 333, global virtualClock: 13414.629887037549, round_duration: 67.37786812921225
2021-08-18:16:43:02,803 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:03,146 INFO     [param_server.py:553] For epoch: 333, median_reward: 1077.2141362702207, dev: 5386.070681351103
2021-08-18:16:43:03,751 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.922, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:43:03,754 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4418.8789, eval_time 0.5743, test_loss 2.922, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:43:03,776 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8293, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:43:03,777 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4418.9166, eval_time 0.5981, test_loss 2.8293, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:43:03,779 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0367, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:43:03,780 INFO     [learner.py:656] After aggregation epoch 332, CumulTime 4418.9162, eval_time 0.6006, test_loss 3.0367, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:43:03,830 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:43:03,837 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:43:03,848 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:03,852 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:03,857 INFO     [learner.py:526] ====Start train round 333
2021-08-18:16:43:03,870 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:05,229 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:05,242 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:05,997 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:06,7 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:06,783 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:06,805 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:07,555 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:07,576 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:08,338 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:08,359 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:08,753 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:08,764 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:09,130 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:09,150 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:09,212 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:09,226 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:09,855 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:09,869 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:09,934 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:09,946 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:10,151 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:10,166 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:10,450 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:10,474 INFO     [learner.py:606] ====Pushing takes 0.021927595138549805 s
2021-08-18:16:43:10,503 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:10,511 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:10,512 INFO     [param_server.py:410] Lock worker 1 with localStep 333 , while globalStep is 332

2021-08-18:16:43:12,507 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:12,518 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:12,700 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:12,715 INFO     [learner.py:606] ====Pushing takes 0.013504266738891602 s
2021-08-18:16:43:12,730 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:12,736 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:12,736 INFO     [param_server.py:410] Lock worker 2 with localStep 333 , while globalStep is 332

2021-08-18:16:43:13,110 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:13,120 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:14,797 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:14,811 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:15,476 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:15,503 INFO     [learner.py:606] ====Pushing takes 0.02507472038269043 s
2021-08-18:16:43:15,531 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:15,538 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:15,538 INFO     [param_server.py:381] ====After aggregation in epoch: 332, virtual_clock: 13482.00775516676, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 2.929353881765295, test len: 3099.0
2021-08-18:16:43:15,541 INFO     [param_server.py:410] Lock worker 3 with localStep 333 , while globalStep is 333

2021-08-18:16:43:15,542 INFO     [param_server.py:441] ====Epoch 334 completes 17 clients with loss 18.769710328611072, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:15,542 INFO     [param_server.py:450] ====Start to sample for epoch 334, global virtualClock: 13482.00775516676, round_duration: 67.37786812921225
2021-08-18:16:43:15,543 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:15,884 INFO     [param_server.py:553] For epoch: 334, median_reward: 956.252594756264, dev: 4781.26297378132
2021-08-18:16:43:16,530 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9764, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:43:16,531 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4431.6555, eval_time 0.6045, test_loss 2.9764, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:43:16,533 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9598, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:43:16,534 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4431.6704, eval_time 0.6124, test_loss 2.9598, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:43:16,576 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9141, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:43:16,580 INFO     [learner.py:656] After aggregation epoch 333, CumulTime 4431.7194, eval_time 0.6626, test_loss 2.9141, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:43:16,598 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:43:16,602 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:43:16,617 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:16,620 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:16,648 INFO     [learner.py:526] ====Start train round 334
2021-08-18:16:43:16,669 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:18,25 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:18,46 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:18,940 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:18,950 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:19,606 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:19,626 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:20,364 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:20,380 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:21,160 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:21,174 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:21,750 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:21,782 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:21,852 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:21,861 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:21,943 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:21,963 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:22,521 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:22,531 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:22,605 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:22,626 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:23,137 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:23,155 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:23,227 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:23,248 INFO     [learner.py:606] ====Pushing takes 0.019587039947509766 s
2021-08-18:16:43:23,283 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:23,292 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:23,293 INFO     [param_server.py:410] Lock worker 1 with localStep 334 , while globalStep is 333

2021-08-18:16:43:25,264 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:25,285 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:25,697 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:25,712 INFO     [learner.py:606] ====Pushing takes 0.014267444610595703 s
2021-08-18:16:43:25,728 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:25,750 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:25,751 INFO     [param_server.py:410] Lock worker 2 with localStep 334 , while globalStep is 333

2021-08-18:16:43:26,142 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:26,162 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:27,812 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:27,826 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:28,531 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:28,558 INFO     [learner.py:606] ====Pushing takes 0.025278568267822266 s
2021-08-18:16:43:28,585 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:28,592 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:28,593 INFO     [param_server.py:381] ====After aggregation in epoch: 333, virtual_clock: 13549.385623295972, top_1: : 67.0539 % (2078.0), top_5: : 100.0 % (3099.0), test loss: 2.950090134585345, test len: 3099.0
2021-08-18:16:43:28,595 INFO     [param_server.py:410] Lock worker 3 with localStep 334 , while globalStep is 334

2021-08-18:16:43:28,596 INFO     [param_server.py:441] ====Epoch 335 completes 17 clients with loss 50.13965302640618, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:28,596 INFO     [param_server.py:450] ====Start to sample for epoch 335, global virtualClock: 13549.385623295972, round_duration: 67.37786812921225
2021-08-18:16:43:28,597 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:28,929 INFO     [param_server.py:553] For epoch: 335, median_reward: 1147.60113491079, dev: 5738.0056745539505
2021-08-18:16:43:29,638 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2864, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:43:29,639 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4444.7633, eval_time 0.6758, test_loss 3.2864, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:43:29,644 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.392, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:16:43:29,644 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4444.7804, eval_time 0.6818, test_loss 3.392, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:16:43:29,681 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9397, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:43:29,682 INFO     [learner.py:656] After aggregation epoch 334, CumulTime 4444.8213, eval_time 0.7194, test_loss 2.9397, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:43:29,708 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:29,718 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:29,721 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:29,732 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:29,738 INFO     [learner.py:526] ====Start train round 335
2021-08-18:16:43:29,760 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:31,56 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:31,70 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:31,943 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:31,953 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:32,438 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:32,447 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:33,255 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:33,273 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:34,96 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:34,116 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:34,812 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:34,825 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:34,871 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:34,885 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:34,982 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:35,9 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:35,642 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:35,656 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:35,681 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:35,708 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:36,128 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:36,142 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:36,404 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:36,423 INFO     [learner.py:606] ====Pushing takes 0.017956018447875977 s
2021-08-18:16:43:36,452 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:36,459 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:36,460 INFO     [param_server.py:410] Lock worker 1 with localStep 335 , while globalStep is 334

2021-08-18:16:43:38,637 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:38,665 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:38,777 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:38,795 INFO     [learner.py:606] ====Pushing takes 0.013652563095092773 s
2021-08-18:16:43:38,810 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:38,817 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:38,818 INFO     [param_server.py:410] Lock worker 2 with localStep 335 , while globalStep is 334

2021-08-18:16:43:39,603 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:39,617 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:41,235 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:41,244 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:41,872 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:41,900 INFO     [learner.py:606] ====Pushing takes 0.02760767936706543 s
2021-08-18:16:43:41,936 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:41,944 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:41,945 INFO     [param_server.py:381] ====After aggregation in epoch: 334, virtual_clock: 13616.763491425183, top_1: : 64.2143 % (1990.0), top_5: : 100.0 % (3099.0), test loss: 3.2060399761906377, test len: 3099.0
2021-08-18:16:43:41,947 INFO     [param_server.py:410] Lock worker 3 with localStep 335 , while globalStep is 335

2021-08-18:16:43:41,948 INFO     [param_server.py:441] ====Epoch 336 completes 17 clients with loss 24.120983470256512, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:41,948 INFO     [param_server.py:450] ====Start to sample for epoch 336, global virtualClock: 13616.763491425183, round_duration: 67.37786812921225
2021-08-18:16:43:41,949 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:42,307 INFO     [param_server.py:553] For epoch: 336, median_reward: 1048.4707598421348, dev: 5242.353799210674
2021-08-18:16:43:42,949 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3302, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:43:42,950 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4458.0747, eval_time 0.6133, test_loss 3.3302, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:43:42,981 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3063, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:43:42,981 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4458.1206, eval_time 0.6504, test_loss 3.3063, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:43:42,984 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3001, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:43:42,986 INFO     [learner.py:656] After aggregation epoch 335, CumulTime 4458.1218, eval_time 0.6515, test_loss 3.3001, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:43:43,34 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:43,37 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:43,43 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:43,52 INFO     [learner.py:526] ====Start train round 336
2021-08-18:16:43:43,52 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:43,65 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:44,482 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:44,495 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:45,366 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:45,376 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:45,866 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:45,881 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:43:46,675 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:43:46,702 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:43:47,556 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:43:47,585 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:43:48,77 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:43:48,92 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:43:48,342 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:43:48,369 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:43:48,670 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:43:48,684 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:43:49,136 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:43:49,163 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:43:49,483 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:43:49,497 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:43:49,553 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:43:49,570 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:43:49,801 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:43:49,824 INFO     [learner.py:606] ====Pushing takes 0.02131032943725586 s
2021-08-18:16:43:49,853 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:49,859 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:43:49,860 INFO     [param_server.py:410] Lock worker 1 with localStep 336 , while globalStep is 335

2021-08-18:16:43:52,19 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:43:52,34 INFO     [learner.py:606] ====Pushing takes 0.013950824737548828 s
2021-08-18:16:43:52,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:52,53 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:43:52,54 INFO     [param_server.py:410] Lock worker 2 with localStep 336 , while globalStep is 335

2021-08-18:16:43:52,109 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:43:52,123 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:43:53,22 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:43:53,36 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:43:54,731 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:43:54,740 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:43:55,474 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:43:55,499 INFO     [learner.py:606] ====Pushing takes 0.023774385452270508 s
2021-08-18:16:43:55,528 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:43:55,537 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:43:55,537 INFO     [param_server.py:381] ====After aggregation in epoch: 335, virtual_clock: 13684.141359554395, top_1: : 67.7961 % (2101.0), top_5: : 100.0 % (3099.0), test loss: 3.31218605571323, test len: 3099.0
2021-08-18:16:43:55,540 INFO     [param_server.py:410] Lock worker 3 with localStep 336 , while globalStep is 336

2021-08-18:16:43:55,541 INFO     [param_server.py:441] ====Epoch 337 completes 17 clients with loss 43.838349048732184, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:43:55,541 INFO     [param_server.py:450] ====Start to sample for epoch 337, global virtualClock: 13684.141359554395, round_duration: 67.37786812921225
2021-08-18:16:43:55,542 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:43:55,877 INFO     [param_server.py:553] For epoch: 337, median_reward: 1203.8306580441993, dev: 6019.1532902209965
2021-08-18:16:43:56,597 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4085, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:43:56,598 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4471.7345, eval_time 0.6875, test_loss 3.4085, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:43:56,599 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.884, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:16:43:56,600 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4471.7242, eval_time 0.6885, test_loss 2.884, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:16:43:56,627 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5681, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:43:56,628 INFO     [learner.py:656] After aggregation epoch 336, CumulTime 4471.7673, eval_time 0.717, test_loss 3.5681, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:43:56,668 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:56,681 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:43:56,693 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:56,695 INFO     [learner.py:526] ====Start train round 337
2021-08-18:16:43:56,707 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:43:56,718 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:43:58,290 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:43:58,317 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:43:58,928 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:43:58,941 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:43:59,781 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:43:59,795 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:00,887 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:00,901 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:01,603 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:01,613 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:01,665 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:01,679 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:02,237 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:02,246 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:02,381 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:02,395 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:02,912 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:02,926 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:03,52 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:03,67 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:03,69 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:03,88 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:03,700 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:03,725 INFO     [learner.py:606] ====Pushing takes 0.02353191375732422 s
2021-08-18:16:44:03,763 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:03,772 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:03,773 INFO     [param_server.py:410] Lock worker 1 with localStep 337 , while globalStep is 336

2021-08-18:16:44:05,551 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:05,560 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:05,635 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:05,650 INFO     [learner.py:606] ====Pushing takes 0.013756752014160156 s
2021-08-18:16:44:05,666 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:05,673 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:05,674 INFO     [param_server.py:410] Lock worker 2 with localStep 337 , while globalStep is 336

2021-08-18:16:44:06,344 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:06,359 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:08,118 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:08,139 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:08,921 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:08,949 INFO     [learner.py:606] ====Pushing takes 0.026477813720703125 s
2021-08-18:16:44:08,978 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:08,987 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:08,988 INFO     [param_server.py:381] ====After aggregation in epoch: 336, virtual_clock: 13751.519227683606, top_1: : 64.3756 % (1995.0), top_5: : 100.0 % (3099.0), test loss: 3.286860929595099, test len: 3099.0
2021-08-18:16:44:08,990 INFO     [param_server.py:410] Lock worker 3 with localStep 337 , while globalStep is 337

2021-08-18:16:44:08,990 INFO     [param_server.py:441] ====Epoch 338 completes 17 clients with loss 28.949500460869714, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:08,991 INFO     [param_server.py:450] ====Start to sample for epoch 338, global virtualClock: 13751.519227683606, round_duration: 67.37786812921225
2021-08-18:16:44:08,992 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:09,321 INFO     [param_server.py:553] For epoch: 338, median_reward: 1316.945884502445, dev: 6584.729422512226
2021-08-18:16:44:10,5 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0622, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:44:10,6 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4485.1415, eval_time 0.6379, test_loss 3.0622, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:44:10,3 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9832, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:44:10,7 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4485.1314, eval_time 0.6385, test_loss 2.9832, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:44:10,75 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:44:10,89 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:10,91 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:44:10,92 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.8318, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:44:10,93 INFO     [learner.py:656] After aggregation epoch 337, CumulTime 4485.2327, eval_time 0.728, test_loss 2.8318, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:44:10,107 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:10,163 INFO     [learner.py:526] ====Start train round 338
2021-08-18:16:44:10,184 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:11,686 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:11,699 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:12,545 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:12,554 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:13,123 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:13,133 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:13,914 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:13,929 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:14,775 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:14,789 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:15,336 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:15,350 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:15,384 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:15,394 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:15,540 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:15,554 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:16,148 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:16,157 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:16,169 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:16,183 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:16,695 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:16,709 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:16,731 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:16,754 INFO     [learner.py:606] ====Pushing takes 0.021345138549804688 s
2021-08-18:16:44:16,784 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:16,791 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:16,792 INFO     [param_server.py:410] Lock worker 1 with localStep 338 , while globalStep is 337

2021-08-18:16:44:18,959 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:18,978 INFO     [learner.py:606] ====Pushing takes 0.013993024826049805 s
2021-08-18:16:44:18,980 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:18,999 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:19,0 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:19,4 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:19,5 INFO     [param_server.py:410] Lock worker 2 with localStep 338 , while globalStep is 337

2021-08-18:16:44:19,750 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:19,764 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:21,407 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:21,421 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:22,67 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:22,94 INFO     [learner.py:606] ====Pushing takes 0.025890827178955078 s
2021-08-18:16:44:22,127 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:22,134 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:22,134 INFO     [param_server.py:381] ====After aggregation in epoch: 337, virtual_clock: 13818.897095812817, top_1: : 67.312 % (2086.0), top_5: : 100.0 % (3099.0), test loss: 2.9590716935970165, test len: 3099.0
2021-08-18:16:44:22,137 INFO     [param_server.py:410] Lock worker 3 with localStep 338 , while globalStep is 338

2021-08-18:16:44:22,137 INFO     [param_server.py:441] ====Epoch 339 completes 17 clients with loss 32.51061699326461, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:22,137 INFO     [param_server.py:450] ====Start to sample for epoch 339, global virtualClock: 13818.897095812817, round_duration: 67.37786812921225
2021-08-18:16:44:22,138 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:22,475 INFO     [param_server.py:553] For epoch: 339, median_reward: 963.3463197533564, dev: 4816.731598766782
2021-08-18:16:44:23,129 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0584, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:44:23,130 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4498.2661, eval_time 0.6226, test_loss 3.0584, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:44:23,135 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6157, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:44:23,136 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4498.2603, eval_time 0.628, test_loss 2.6157, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:44:23,167 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7002, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:44:23,169 INFO     [learner.py:656] After aggregation epoch 338, CumulTime 4498.3087, eval_time 0.6619, test_loss 2.7002, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:44:23,203 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:44:23,220 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:44:23,223 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:23,236 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:23,236 INFO     [learner.py:526] ====Start train round 339
2021-08-18:16:44:23,255 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:24,589 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:24,604 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:25,478 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:25,488 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:25,909 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:25,918 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:26,870 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:26,885 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:27,748 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:27,774 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:28,12 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:28,31 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:28,263 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:28,282 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:28,587 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:28,614 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:29,222 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:29,237 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:29,391 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:29,412 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:29,462 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:29,481 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:30,15 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:30,38 INFO     [learner.py:606] ====Pushing takes 0.02136373519897461 s
2021-08-18:16:44:30,66 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:30,75 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:30,76 INFO     [param_server.py:410] Lock worker 1 with localStep 339 , while globalStep is 338

2021-08-18:16:44:31,927 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:31,942 INFO     [learner.py:606] ====Pushing takes 0.01340031623840332 s
2021-08-18:16:44:31,959 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:31,964 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:31,965 INFO     [param_server.py:410] Lock worker 2 with localStep 339 , while globalStep is 338

2021-08-18:16:44:32,339 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:32,348 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:33,61 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:33,71 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:34,750 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:34,759 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:35,336 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:35,361 INFO     [learner.py:606] ====Pushing takes 0.024158239364624023 s
2021-08-18:16:44:35,391 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:35,399 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:35,400 INFO     [param_server.py:381] ====After aggregation in epoch: 338, virtual_clock: 13886.274963942029, top_1: : 66.5699 % (2063.0), top_5: : 100.0 % (3099.0), test loss: 2.791441638160635, test len: 3099.0
2021-08-18:16:44:35,402 INFO     [param_server.py:410] Lock worker 3 with localStep 339 , while globalStep is 339

2021-08-18:16:44:35,402 INFO     [param_server.py:441] ====Epoch 340 completes 17 clients with loss 18.084499152896772, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:35,403 INFO     [param_server.py:450] ====Start to sample for epoch 340, global virtualClock: 13886.274963942029, round_duration: 67.37786812921225
2021-08-18:16:44:35,404 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:35,737 INFO     [param_server.py:553] For epoch: 340, median_reward: 961.0589937238952, dev: 4805.294968619476
2021-08-18:16:44:36,309 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1954, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:44:36,310 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4511.4464, eval_time 0.5467, test_loss 3.1954, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:44:36,320 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.244, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:44:36,321 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4511.4459, eval_time 0.5574, test_loss 3.244, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:44:36,366 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0113, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:44:36,367 INFO     [learner.py:656] After aggregation epoch 339, CumulTime 4511.5064, eval_time 0.6067, test_loss 3.0113, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:44:36,377 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:36,390 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:36,393 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:36,403 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:36,436 INFO     [learner.py:526] ====Start train round 340
2021-08-18:16:44:36,449 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:37,734 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:37,748 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:38,578 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:38,592 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:39,296 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:39,309 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:40,100 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:40,120 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:40,970 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:40,990 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:41,379 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:41,398 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:41,778 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:41,805 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:42,10 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:42,25 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:42,482 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:42,502 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:42,658 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:42,672 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:42,733 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:42,743 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:43,127 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:43,147 INFO     [learner.py:606] ====Pushing takes 0.017930030822753906 s
2021-08-18:16:44:43,175 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:43,182 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:43,183 INFO     [param_server.py:410] Lock worker 1 with localStep 340 , while globalStep is 339

2021-08-18:16:44:45,95 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:45,108 INFO     [learner.py:606] ====Pushing takes 0.012394905090332031 s
2021-08-18:16:44:45,130 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:45,135 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:45,135 INFO     [param_server.py:410] Lock worker 2 with localStep 340 , while globalStep is 339

2021-08-18:16:44:45,501 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:45,521 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:46,200 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:46,209 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:44:48,23 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:44:48,37 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:44:48,611 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:44:48,639 INFO     [learner.py:606] ====Pushing takes 0.02646636962890625 s
2021-08-18:16:44:48,674 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:48,684 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:44:48,685 INFO     [param_server.py:381] ====After aggregation in epoch: 339, virtual_clock: 13953.65283207124, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 3.150227827054483, test len: 3099.0
2021-08-18:16:44:48,688 INFO     [param_server.py:410] Lock worker 3 with localStep 340 , while globalStep is 340

2021-08-18:16:44:48,688 INFO     [param_server.py:441] ====Epoch 341 completes 17 clients with loss 67.1554149426609, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:44:48,688 INFO     [param_server.py:450] ====Start to sample for epoch 341, global virtualClock: 13953.65283207124, round_duration: 67.37786812921225
2021-08-18:16:44:48,689 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:44:49,19 INFO     [param_server.py:541] Handle Wight 0.03784322738647461 | Send 0.3302452564239502
2021-08-18:16:44:49,20 INFO     [param_server.py:553] For epoch: 341, median_reward: 1225.575768843141, dev: 6127.878844215706
2021-08-18:16:44:49,642 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9373, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:44:49,643 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4524.7677, eval_time 0.5899, test_loss 2.9373, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:44:49,685 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1256, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:16:44:49,686 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4524.8221, eval_time 0.6331, test_loss 3.1256, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:16:44:49,711 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:49,716 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.346, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:44:49,717 INFO     [learner.py:656] After aggregation epoch 340, CumulTime 4524.8563, eval_time 0.6639, test_loss 3.346, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:44:49,726 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:44:49,754 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:49,768 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:44:49,775 INFO     [learner.py:526] ====Start train round 341
2021-08-18:16:44:49,792 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:44:51,75 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:44:51,88 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:44:51,915 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:44:51,925 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:44:52,640 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:44:52,654 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:44:53,412 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:44:53,430 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:44:54,257 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:44:54,278 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:44:54,672 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:44:54,690 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:44:54,887 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:44:54,902 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:44:55,164 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:44:55,184 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:44:55,694 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:44:55,709 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:44:55,844 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:44:55,865 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:44:55,920 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:44:55,934 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:44:56,451 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:44:56,475 INFO     [learner.py:606] ====Pushing takes 0.02230548858642578 s
2021-08-18:16:44:56,511 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:56,518 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:44:56,518 INFO     [param_server.py:410] Lock worker 1 with localStep 341 , while globalStep is 340

2021-08-18:16:44:58,236 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:44:58,252 INFO     [learner.py:606] ====Pushing takes 0.014221906661987305 s
2021-08-18:16:44:58,268 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:44:58,273 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:44:58,273 INFO     [param_server.py:410] Lock worker 2 with localStep 341 , while globalStep is 340

2021-08-18:16:44:58,641 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:44:58,654 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:44:59,496 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:44:59,510 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:01,256 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:01,271 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:02,61 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:02,87 INFO     [learner.py:606] ====Pushing takes 0.025399446487426758 s
2021-08-18:16:45:02,116 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:02,123 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:02,124 INFO     [param_server.py:381] ====After aggregation in epoch: 340, virtual_clock: 14021.030700200452, top_1: : 64.9564 % (2013.0), top_5: : 100.0 % (3099.0), test loss: 3.136288992784641, test len: 3099.0
2021-08-18:16:45:02,126 INFO     [param_server.py:410] Lock worker 3 with localStep 341 , while globalStep is 341

2021-08-18:16:45:02,127 INFO     [param_server.py:441] ====Epoch 342 completes 17 clients with loss 25.812609300115753, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:02,127 INFO     [param_server.py:450] ====Start to sample for epoch 342, global virtualClock: 14021.030700200452, round_duration: 67.37786812921225
2021-08-18:16:45:02,129 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:02,462 INFO     [param_server.py:553] For epoch: 342, median_reward: 1345.5359113451143, dev: 6727.679556725571
2021-08-18:16:45:03,90 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6132, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:45:03,92 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.8748, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:45:03,93 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4538.2178, eval_time 0.5887, test_loss 2.6132, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:45:03,93 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4538.2293, eval_time 0.5921, test_loss 2.8748, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:45:03,133 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3838, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:16:45:03,136 INFO     [learner.py:656] After aggregation epoch 341, CumulTime 4538.2749, eval_time 0.6386, test_loss 3.3838, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:16:45:03,152 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:45:03,165 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:45:03,174 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:03,179 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:03,204 INFO     [learner.py:526] ====Start train round 342
2021-08-18:16:45:03,224 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:04,501 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:04,511 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:05,321 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:05,331 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:05,816 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:05,826 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:07,27 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:07,48 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:08,18 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:08,45 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:08,252 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:08,272 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:08,612 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:08,626 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:08,812 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:08,833 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:09,429 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:09,443 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:09,617 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:09,638 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:09,745 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:09,761 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:10,274 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:10,296 INFO     [learner.py:606] ====Pushing takes 0.02075362205505371 s
2021-08-18:16:45:10,323 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:10,332 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:10,332 INFO     [param_server.py:410] Lock worker 1 with localStep 342 , while globalStep is 341

2021-08-18:16:45:12,215 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:12,229 INFO     [learner.py:606] ====Pushing takes 0.012560844421386719 s
2021-08-18:16:45:12,230 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:12,244 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:12,244 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:12,249 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:12,249 INFO     [param_server.py:410] Lock worker 2 with localStep 342 , while globalStep is 341

2021-08-18:16:45:13,57 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:13,70 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:14,754 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:14,763 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:15,341 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:15,367 INFO     [learner.py:606] ====Pushing takes 0.02507185935974121 s
2021-08-18:16:45:15,398 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:15,406 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:15,406 INFO     [param_server.py:381] ====After aggregation in epoch: 341, virtual_clock: 14088.408568329663, top_1: : 67.5379 % (2093.0), top_5: : 100.0 % (3099.0), test loss: 2.9572584430376687, test len: 3099.0
2021-08-18:16:45:15,408 INFO     [param_server.py:410] Lock worker 3 with localStep 342 , while globalStep is 342

2021-08-18:16:45:15,409 INFO     [param_server.py:441] ====Epoch 343 completes 17 clients with loss 31.70306729466662, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:15,409 INFO     [param_server.py:450] ====Start to sample for epoch 343, global virtualClock: 14088.408568329663, round_duration: 67.37786812921225
2021-08-18:16:45:15,410 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:15,686 INFO     [param_server.py:553] For epoch: 343, median_reward: 1070.7370812489346, dev: 5353.685406244673
2021-08-18:16:45:16,401 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8465, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:45:16,402 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4551.5263, eval_time 0.6863, test_loss 2.8465, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:45:16,443 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2001, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:45:16,444 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4551.5831, eval_time 0.735, test_loss 3.2001, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:45:16,446 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.185, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:45:16,449 INFO     [learner.py:656] After aggregation epoch 342, CumulTime 4551.5847, eval_time 0.7363, test_loss 3.185, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:45:16,471 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:45:16,479 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:16,513 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:45:16,520 INFO     [learner.py:526] ====Start train round 343
2021-08-18:16:45:16,533 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:16,535 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:17,891 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:17,927 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:18,696 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:18,706 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:19,486 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:19,505 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:20,427 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:20,455 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:21,268 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:21,289 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:21,462 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:21,481 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:21,948 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:21,962 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:22,29 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:22,50 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:22,764 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:22,781 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:22,785 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:22,794 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:22,855 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:22,869 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:23,349 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:23,373 INFO     [learner.py:606] ====Pushing takes 0.0194244384765625 s
2021-08-18:16:45:23,402 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:23,409 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:23,410 INFO     [param_server.py:410] Lock worker 1 with localStep 343 , while globalStep is 342

2021-08-18:16:45:25,513 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:25,531 INFO     [learner.py:606] ====Pushing takes 0.016681671142578125 s
2021-08-18:16:45:25,554 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:25,559 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:25,560 INFO     [param_server.py:410] Lock worker 2 with localStep 343 , while globalStep is 342

2021-08-18:16:45:25,564 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:25,576 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:26,309 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:26,319 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:28,2 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:28,23 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:28,868 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:28,898 INFO     [learner.py:606] ====Pushing takes 0.028255701065063477 s
2021-08-18:16:45:28,929 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:28,939 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:28,940 INFO     [param_server.py:381] ====After aggregation in epoch: 342, virtual_clock: 14155.786436458875, top_1: : 66.1181 % (2049.0), top_5: : 100.0 % (3099.0), test loss: 3.077203631401062, test len: 3099.0
2021-08-18:16:45:28,942 INFO     [param_server.py:410] Lock worker 3 with localStep 343 , while globalStep is 343

2021-08-18:16:45:28,943 INFO     [param_server.py:441] ====Epoch 344 completes 17 clients with loss 27.867575827191523, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:28,943 INFO     [param_server.py:450] ====Start to sample for epoch 344, global virtualClock: 14155.786436458875, round_duration: 67.37786812921225
2021-08-18:16:45:28,944 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:29,274 INFO     [param_server.py:553] For epoch: 344, median_reward: 1002.4020820057543, dev: 5012.010410028772
2021-08-18:16:45:29,977 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0905, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:45:29,978 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4565.1136, eval_time 0.6561, test_loss 3.0905, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:45:30,19 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7144, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:45:30,20 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4565.145, eval_time 0.6922, test_loss 2.7144, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:45:30,47 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:30,59 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:30,63 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4155, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:45:30,64 INFO     [learner.py:656] After aggregation epoch 343, CumulTime 4565.2031, eval_time 0.7449, test_loss 3.4155, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:45:30,89 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:30,111 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:30,143 INFO     [learner.py:526] ====Start train round 344
2021-08-18:16:45:30,165 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:31,588 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:31,602 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:32,254 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:32,265 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:32,845 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:32,859 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:34,52 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:34,72 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:34,828 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:34,842 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:34,879 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:34,897 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:35,349 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:35,360 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:35,485 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:35,499 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:36,18 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:36,28 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:36,117 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:36,131 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:36,213 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:36,227 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:36,645 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:36,672 INFO     [learner.py:606] ====Pushing takes 0.02570343017578125 s
2021-08-18:16:45:36,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:36,715 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:36,716 INFO     [param_server.py:410] Lock worker 1 with localStep 344 , while globalStep is 343

2021-08-18:16:45:38,759 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:38,778 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:38,782 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:38,795 INFO     [learner.py:606] ====Pushing takes 0.016257524490356445 s
2021-08-18:16:45:38,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:38,818 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:38,819 INFO     [param_server.py:410] Lock worker 2 with localStep 344 , while globalStep is 343

2021-08-18:16:45:39,626 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:39,646 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:41,697 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:41,718 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:42,394 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:42,422 INFO     [learner.py:606] ====Pushing takes 0.026563644409179688 s
2021-08-18:16:45:42,461 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:42,469 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:42,470 INFO     [param_server.py:381] ====After aggregation in epoch: 343, virtual_clock: 14223.164304588086, top_1: : 67.3766 % (2088.0), top_5: : 100.0 % (3099.0), test loss: 3.0734841249607228, test len: 3099.0
2021-08-18:16:45:42,481 INFO     [param_server.py:410] Lock worker 3 with localStep 344 , while globalStep is 344

2021-08-18:16:45:42,481 INFO     [param_server.py:441] ====Epoch 345 completes 17 clients with loss 19.368512599410366, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:42,482 INFO     [param_server.py:450] ====Start to sample for epoch 345, global virtualClock: 14223.164304588086, round_duration: 67.37786812921225
2021-08-18:16:45:42,483 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:42,746 INFO     [param_server.py:553] For epoch: 345, median_reward: 1149.6993340683835, dev: 5748.496670341918
2021-08-18:16:45:43,382 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8004, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:45:43,383 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4578.5071, eval_time 0.6015, test_loss 2.8004, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:45:43,434 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1288, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:45:43,435 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4578.5709, eval_time 0.6541, test_loss 3.1288, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:45:43,450 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:43,462 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:43,479 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9206, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:45:43,480 INFO     [learner.py:656] After aggregation epoch 344, CumulTime 4578.6194, eval_time 0.6992, test_loss 2.9206, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:45:43,528 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:43,544 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:43,548 INFO     [learner.py:526] ====Start train round 345
2021-08-18:16:45:43,570 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:44,901 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:44,910 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:45,778 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:45,790 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:46,175 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:46,185 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:45:47,101 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:45:47,115 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:45:47,886 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:45:47,899 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:45:48,381 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:45:48,395 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:45:48,560 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:45:48,579 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:45:48,623 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:45:48,644 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:45:49,260 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:45:49,274 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:45:49,330 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:45:49,351 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:45:49,807 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:45:49,820 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:45:50,64 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:45:50,88 INFO     [learner.py:606] ====Pushing takes 0.022689342498779297 s
2021-08-18:16:45:50,123 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:50,132 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:45:50,133 INFO     [param_server.py:410] Lock worker 1 with localStep 345 , while globalStep is 344

2021-08-18:16:45:52,17 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:45:52,31 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:45:52,195 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:45:52,212 INFO     [learner.py:606] ====Pushing takes 0.015597343444824219 s
2021-08-18:16:45:52,228 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:52,232 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:45:52,232 INFO     [param_server.py:410] Lock worker 2 with localStep 345 , while globalStep is 344

2021-08-18:16:45:52,994 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:45:53,22 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:45:54,806 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:45:54,820 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:45:55,421 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:45:55,450 INFO     [learner.py:606] ====Pushing takes 0.027695178985595703 s
2021-08-18:16:45:55,479 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:45:55,487 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:45:55,488 INFO     [param_server.py:381] ====After aggregation in epoch: 344, virtual_clock: 14290.542172717298, top_1: : 64.6983 % (2005.0), top_5: : 100.0 % (3099.0), test loss: 2.949928884704908, test len: 3099.0
2021-08-18:16:45:55,490 INFO     [param_server.py:410] Lock worker 3 with localStep 345 , while globalStep is 345

2021-08-18:16:45:55,491 INFO     [param_server.py:441] ====Epoch 346 completes 17 clients with loss 36.1128206811817, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:45:55,491 INFO     [param_server.py:450] ====Start to sample for epoch 346, global virtualClock: 14290.542172717298, round_duration: 67.37786812921225
2021-08-18:16:45:55,492 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:45:55,804 INFO     [param_server.py:553] For epoch: 346, median_reward: 1255.4770104942847, dev: 6277.3850524714235
2021-08-18:16:45:56,416 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6843, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:45:56,418 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4591.5421, eval_time 0.5903, test_loss 2.6843, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:45:56,471 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0416, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:45:56,474 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4591.61, eval_time 0.647, test_loss 3.0416, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:45:56,472 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0944, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:45:56,475 INFO     [learner.py:656] After aggregation epoch 345, CumulTime 4591.6141, eval_time 0.6477, test_loss 3.0944, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:45:56,486 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:56,494 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:45:56,553 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:56,565 INFO     [learner.py:526] ====Start train round 346
2021-08-18:16:45:56,565 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:45:56,581 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:45:58,30 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:45:58,48 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:45:58,868 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:45:58,877 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:45:59,268 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:45:59,282 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:00,253 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:00,274 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:01,126 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:01,147 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:01,614 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:01,631 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:01,841 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:01,855 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:01,937 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:01,964 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:02,646 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:02,658 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:02,666 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:02,685 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:03,70 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:03,84 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:03,295 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:03,320 INFO     [learner.py:606] ====Pushing takes 0.022871732711791992 s
2021-08-18:16:46:03,354 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:03,360 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:03,361 INFO     [param_server.py:410] Lock worker 1 with localStep 346 , while globalStep is 345

2021-08-18:16:46:05,588 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:05,604 INFO     [learner.py:606] ====Pushing takes 0.015066146850585938 s
2021-08-18:16:46:05,620 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:05,625 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:05,626 INFO     [param_server.py:410] Lock worker 2 with localStep 346 , while globalStep is 345

2021-08-18:16:46:05,650 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:05,661 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:06,363 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:06,372 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:08,11 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:08,23 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:08,698 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:08,727 INFO     [learner.py:606] ====Pushing takes 0.02735304832458496 s
2021-08-18:16:46:08,756 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:08,766 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:08,767 INFO     [param_server.py:381] ====After aggregation in epoch: 345, virtual_clock: 14357.92004084651, top_1: : 67.183 % (2082.0), top_5: : 100.0 % (3099.0), test loss: 2.9400848514503903, test len: 3099.0
2021-08-18:16:46:08,769 INFO     [param_server.py:410] Lock worker 3 with localStep 346 , while globalStep is 346

2021-08-18:16:46:08,770 INFO     [param_server.py:441] ====Epoch 347 completes 17 clients with loss 46.03935418820528, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:08,770 INFO     [param_server.py:450] ====Start to sample for epoch 347, global virtualClock: 14357.92004084651, round_duration: 67.37786812921225
2021-08-18:16:46:08,771 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:09,72 INFO     [param_server.py:553] For epoch: 347, median_reward: 1064.594034450957, dev: 5322.970172254785
2021-08-18:16:46:09,800 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0388, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:46:09,800 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4604.9249, eval_time 0.7031, test_loss 3.0388, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:46:09,802 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4075, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:46:09,803 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4604.9389, eval_time 0.7079, test_loss 3.4075, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:46:09,806 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6947, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:46:09,807 INFO     [learner.py:656] After aggregation epoch 346, CumulTime 4604.9458, eval_time 0.7115, test_loss 3.6947, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:46:09,870 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:46:09,875 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:46:09,882 INFO     [learner.py:526] ====Start train round 347
2021-08-18:16:46:09,891 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:09,885 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:09,923 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:11,293 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:11,314 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:12,178 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:12,188 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:12,801 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:12,815 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:13,790 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:13,818 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:14,728 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:14,755 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:14,953 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:14,971 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:15,588 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:15,596 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:15,609 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:15,610 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:16,302 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:16,316 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:16,342 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:16,351 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:16,348 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:16,379 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:17,24 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:17,47 INFO     [learner.py:606] ====Pushing takes 0.022298812866210938 s
2021-08-18:16:46:17,80 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:17,86 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:17,87 INFO     [param_server.py:410] Lock worker 1 with localStep 347 , while globalStep is 346

2021-08-18:16:46:18,867 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:18,883 INFO     [learner.py:606] ====Pushing takes 0.014317750930786133 s
2021-08-18:16:46:18,899 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:18,903 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:18,904 INFO     [param_server.py:410] Lock worker 2 with localStep 347 , while globalStep is 346

2021-08-18:16:46:19,106 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:19,115 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:19,745 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:19,755 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:21,571 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:21,584 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:22,177 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:22,206 INFO     [learner.py:606] ====Pushing takes 0.027318239212036133 s
2021-08-18:16:46:22,238 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:22,245 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:22,245 INFO     [param_server.py:381] ====After aggregation in epoch: 346, virtual_clock: 14425.297908975721, top_1: : 63.698 % (1974.0), top_5: : 100.0 % (3099.0), test loss: 3.38036013091052, test len: 3099.0
2021-08-18:16:46:22,247 INFO     [param_server.py:410] Lock worker 3 with localStep 347 , while globalStep is 347

2021-08-18:16:46:22,248 INFO     [param_server.py:441] ====Epoch 348 completes 17 clients with loss 26.91302907291002, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:22,248 INFO     [param_server.py:450] ====Start to sample for epoch 348, global virtualClock: 14425.297908975721, round_duration: 67.37786812921225
2021-08-18:16:46:22,249 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:22,521 INFO     [param_server.py:553] For epoch: 348, median_reward: 1021.2461380965437, dev: 5106.230690482718
2021-08-18:16:46:23,128 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0005, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:46:23,132 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4618.2562, eval_time 0.5769, test_loss 3.0005, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:46:23,135 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.801, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:46:23,136 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4618.2719, eval_time 0.5824, test_loss 3.801, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:46:23,173 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5081, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:46:23,174 INFO     [learner.py:656] After aggregation epoch 347, CumulTime 4618.3136, eval_time 0.6207, test_loss 3.5081, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:46:23,200 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:46:23,207 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:46:23,213 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:23,221 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:23,244 INFO     [learner.py:526] ====Start train round 348
2021-08-18:16:46:23,263 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:24,603 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:24,630 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:25,356 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:25,367 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:26,90 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:26,110 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:27,75 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:27,95 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:27,863 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:27,876 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:28,67 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:28,85 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:28,516 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:28,526 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:28,575 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:28,589 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:29,342 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:29,345 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:29,354 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:29,363 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:29,458 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:29,499 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:29,994 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:30,19 INFO     [learner.py:606] ====Pushing takes 0.023453712463378906 s
2021-08-18:16:46:30,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:30,58 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:30,58 INFO     [param_server.py:410] Lock worker 1 with localStep 348 , while globalStep is 347

2021-08-18:16:46:31,747 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:31,761 INFO     [learner.py:606] ====Pushing takes 0.012876749038696289 s
2021-08-18:16:46:31,777 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:31,781 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:31,782 INFO     [param_server.py:410] Lock worker 2 with localStep 348 , while globalStep is 347

2021-08-18:16:46:32,206 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:32,221 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:33,23 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:33,37 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:34,775 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:34,789 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:35,399 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:35,424 INFO     [learner.py:606] ====Pushing takes 0.023958206176757812 s
2021-08-18:16:46:35,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:35,461 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:35,462 INFO     [param_server.py:381] ====After aggregation in epoch: 347, virtual_clock: 14492.675777104932, top_1: : 67.8606 % (2103.0), top_5: : 100.0 % (3099.0), test loss: 3.4365522905632298, test len: 3099.0
2021-08-18:16:46:35,464 INFO     [param_server.py:410] Lock worker 3 with localStep 348 , while globalStep is 348

2021-08-18:16:46:35,465 INFO     [param_server.py:441] ====Epoch 349 completes 17 clients with loss 31.282635683098682, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:35,465 INFO     [param_server.py:450] ====Start to sample for epoch 349, global virtualClock: 14492.675777104932, round_duration: 67.37786812921225
2021-08-18:16:46:35,466 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:35,741 INFO     [param_server.py:553] For epoch: 349, median_reward: 1095.2936121651442, dev: 5476.46806082572
2021-08-18:16:46:36,539 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7354, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:46:36,540 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4631.6645, eval_time 0.7537, test_loss 2.7354, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:46:36,575 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1114, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:46:36,578 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4631.7172, eval_time 0.7918, test_loss 3.1114, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:46:36,578 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4107, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:46:36,581 INFO     [learner.py:656] After aggregation epoch 348, CumulTime 4631.717, eval_time 0.7949, test_loss 3.4107, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:46:36,604 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:36,620 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:36,634 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:36,650 INFO     [learner.py:526] ====Start train round 349
2021-08-18:16:46:36,653 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:36,663 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:38,136 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:38,156 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:38,935 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:38,945 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:39,447 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:39,458 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:40,548 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:40,569 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:41,371 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:41,391 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:41,710 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:41,725 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:42,69 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:42,83 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:42,186 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:42,207 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:42,792 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:42,805 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:42,970 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:42,997 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:43,112 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:43,133 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:43,667 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:43,690 INFO     [learner.py:606] ====Pushing takes 0.021187543869018555 s
2021-08-18:16:46:43,725 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:43,731 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:43,732 INFO     [param_server.py:410] Lock worker 1 with localStep 349 , while globalStep is 348

2021-08-18:16:46:45,551 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:45,566 INFO     [learner.py:606] ====Pushing takes 0.013472557067871094 s
2021-08-18:16:46:45,581 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:45,586 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:45,586 INFO     [param_server.py:410] Lock worker 2 with localStep 349 , while globalStep is 348

2021-08-18:16:46:45,612 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:45,626 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:46:46,410 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:46:46,425 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:46:48,183 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:46:48,202 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:46:48,905 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:46:48,934 INFO     [learner.py:606] ====Pushing takes 0.026811838150024414 s
2021-08-18:16:46:48,964 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:48,974 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:46:48,975 INFO     [param_server.py:381] ====After aggregation in epoch: 348, virtual_clock: 14560.053645234144, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 3.0858509658299025, test len: 3099.0
2021-08-18:16:46:48,977 INFO     [param_server.py:410] Lock worker 3 with localStep 349 , while globalStep is 349

2021-08-18:16:46:48,978 INFO     [param_server.py:441] ====Epoch 350 completes 17 clients with loss 40.591148382135415, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:46:48,978 INFO     [param_server.py:450] ====Start to sample for epoch 350, global virtualClock: 14560.053645234144, round_duration: 67.37786812921225
2021-08-18:16:46:48,979 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:46:49,258 INFO     [param_server.py:553] For epoch: 350, median_reward: 1009.2536007995857, dev: 5046.268003997929
2021-08-18:16:46:49,936 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2192, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:46:49,937 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4645.062, eval_time 0.6435, test_loss 3.2192, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:46:49,990 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3145, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:46:49,991 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4645.1267, eval_time 0.6988, test_loss 3.3145, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:46:50,5 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:50,15 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:46:49,989 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5065, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:46:50,42 INFO     [learner.py:656] After aggregation epoch 349, CumulTime 4645.1813, eval_time 0.75, test_loss 3.5065, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:46:50,48 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:50,63 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:46:50,110 INFO     [learner.py:526] ====Start train round 350
2021-08-18:16:46:50,128 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:46:51,442 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:46:51,462 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:46:52,295 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:46:52,306 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:46:52,889 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:46:52,909 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:46:53,893 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:46:53,915 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:46:54,802 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:46:54,822 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:46:55,118 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:46:55,137 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:46:55,473 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:46:55,487 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:46:55,645 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:46:55,665 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:46:56,286 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:46:56,300 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:46:56,372 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:46:56,388 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:46:56,392 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:46:56,409 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:46:57,10 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:46:57,34 INFO     [learner.py:606] ====Pushing takes 0.02173304557800293 s
2021-08-18:16:46:57,66 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:57,73 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:46:57,73 INFO     [param_server.py:410] Lock worker 1 with localStep 350 , while globalStep is 349

2021-08-18:16:46:58,748 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:46:58,763 INFO     [learner.py:606] ====Pushing takes 0.01320338249206543 s
2021-08-18:16:46:58,778 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:46:58,783 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:46:58,783 INFO     [param_server.py:410] Lock worker 2 with localStep 350 , while globalStep is 349

2021-08-18:16:46:59,156 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:46:59,183 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:00,7 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:00,21 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:01,750 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:01,759 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:02,433 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:02,461 INFO     [learner.py:606] ====Pushing takes 0.026107311248779297 s
2021-08-18:16:47:02,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:02,508 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:02,509 INFO     [param_server.py:381] ====After aggregation in epoch: 349, virtual_clock: 14627.431513363355, top_1: : 67.4734 % (2091.0), top_5: : 100.0 % (3099.0), test loss: 3.346710496478611, test len: 3099.0
2021-08-18:16:47:02,511 INFO     [param_server.py:410] Lock worker 3 with localStep 350 , while globalStep is 350

2021-08-18:16:47:02,512 INFO     [param_server.py:441] ====Epoch 351 completes 17 clients with loss 90.87551497585487, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:02,512 INFO     [param_server.py:450] ====Start to sample for epoch 351, global virtualClock: 14627.431513363355, round_duration: 67.37786812921225
2021-08-18:16:47:02,526 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:02,816 INFO     [param_server.py:553] For epoch: 351, median_reward: 1039.9587727263702, dev: 5199.79386363185
2021-08-18:16:47:03,492 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3925, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:47:03,494 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.203, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:16:47:03,496 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4658.6317, eval_time 0.6456, test_loss 3.3925, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:47:03,496 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4658.6205, eval_time 0.6456, test_loss 3.203, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:16:47:03,526 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2987, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:47:03,527 INFO     [learner.py:656] After aggregation epoch 350, CumulTime 4658.6662, eval_time 0.6767, test_loss 3.2987, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:47:03,564 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:47:03,566 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:47:03,578 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:03,587 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:03,596 INFO     [learner.py:526] ====Start train round 351
2021-08-18:16:47:03,625 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:05,218 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:05,232 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:05,912 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:05,922 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:06,575 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:06,589 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:07,734 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:07,748 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:08,419 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:08,433 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:08,744 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:08,753 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:08,812 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:08,830 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:09,150 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:09,171 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:09,432 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:09,443 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:09,846 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:09,866 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:10,201 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:10,216 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:10,472 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:10,495 INFO     [learner.py:606] ====Pushing takes 0.021564960479736328 s
2021-08-18:16:47:10,524 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:10,533 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:10,533 INFO     [param_server.py:410] Lock worker 1 with localStep 351 , while globalStep is 350

2021-08-18:16:47:12,312 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:12,321 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:12,400 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:12,415 INFO     [learner.py:606] ====Pushing takes 0.013335466384887695 s
2021-08-18:16:47:12,429 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:12,434 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:12,435 INFO     [param_server.py:410] Lock worker 2 with localStep 351 , while globalStep is 350

2021-08-18:16:47:13,223 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:13,238 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:14,970 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:14,984 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:15,658 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:15,683 INFO     [learner.py:606] ====Pushing takes 0.02376723289489746 s
2021-08-18:16:47:15,714 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:15,721 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:15,722 INFO     [param_server.py:381] ====After aggregation in epoch: 350, virtual_clock: 14694.809381492567, top_1: : 64.3433 % (1994.0), top_5: : 100.0 % (3099.0), test loss: 3.298044637397483, test len: 3099.0
2021-08-18:16:47:15,724 INFO     [param_server.py:410] Lock worker 3 with localStep 351 , while globalStep is 351

2021-08-18:16:47:15,724 INFO     [param_server.py:441] ====Epoch 352 completes 17 clients with loss 17.469743808625108, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:15,725 INFO     [param_server.py:450] ====Start to sample for epoch 352, global virtualClock: 14694.809381492567, round_duration: 67.37786812921225
2021-08-18:16:47:15,725 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:15,995 INFO     [param_server.py:553] For epoch: 352, median_reward: 1184.7350347368351, dev: 5923.675173684176
2021-08-18:16:47:16,756 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0672, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:47:16,757 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4671.8814, eval_time 0.7208, test_loss 3.0672, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:47:16,758 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.249, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:47:16,761 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4671.897, eval_time 0.7253, test_loss 3.249, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:47:16,804 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1286, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:47:16,806 INFO     [learner.py:656] After aggregation epoch 351, CumulTime 4671.9456, eval_time 0.7755, test_loss 3.1286, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:47:16,824 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:47:16,828 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:47:16,840 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:16,842 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:16,872 INFO     [learner.py:526] ====Start train round 352
2021-08-18:16:47:16,892 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:18,220 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:18,239 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:19,150 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:19,160 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:19,532 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:19,546 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:20,464 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:20,485 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:21,225 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:21,245 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:21,933 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:21,947 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:22,48 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:22,67 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:22,169 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:22,196 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:22,860 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:22,878 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:22,902 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:22,930 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:23,447 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:23,456 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:23,550 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:23,575 INFO     [learner.py:606] ====Pushing takes 0.02345871925354004 s
2021-08-18:16:47:23,610 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:23,616 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:23,617 INFO     [param_server.py:410] Lock worker 1 with localStep 352 , while globalStep is 351

2021-08-18:16:47:25,759 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:25,775 INFO     [learner.py:606] ====Pushing takes 0.014255762100219727 s
2021-08-18:16:47:25,790 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:25,790 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:25,795 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:25,796 INFO     [param_server.py:410] Lock worker 2 with localStep 352 , while globalStep is 351

2021-08-18:16:47:25,804 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:26,778 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:26,792 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:28,628 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:28,638 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:29,270 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:29,297 INFO     [learner.py:606] ====Pushing takes 0.02667975425720215 s
2021-08-18:16:47:29,335 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:29,350 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:29,351 INFO     [param_server.py:381] ====After aggregation in epoch: 351, virtual_clock: 14762.187249621778, top_1: : 67.5379 % (2093.0), top_5: : 100.0 % (3099.0), test loss: 3.1482768434065362, test len: 3099.0
2021-08-18:16:47:29,354 INFO     [param_server.py:410] Lock worker 3 with localStep 352 , while globalStep is 352

2021-08-18:16:47:29,354 INFO     [param_server.py:441] ====Epoch 353 completes 17 clients with loss 114.08698374496338, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:29,355 INFO     [param_server.py:450] ====Start to sample for epoch 353, global virtualClock: 14762.187249621778, round_duration: 67.37786812921225
2021-08-18:16:47:29,356 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:29,613 INFO     [param_server.py:553] For epoch: 353, median_reward: 1127.5162052953676, dev: 5637.581026476838
2021-08-18:16:47:30,246 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7113, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:47:30,248 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4685.3721, eval_time 0.6077, test_loss 2.7113, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:47:30,305 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.704, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:47:30,306 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4685.4456, eval_time 0.6688, test_loss 2.704, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:47:30,307 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3168, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:47:30,308 INFO     [learner.py:656] After aggregation epoch 352, CumulTime 4685.4435, eval_time 0.6679, test_loss 3.3168, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:47:30,331 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:30,339 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:30,377 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:30,377 INFO     [learner.py:526] ====Start train round 353
2021-08-18:16:47:30,389 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:30,390 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:31,708 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:31,735 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:32,510 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:32,520 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:33,81 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:33,100 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:34,421 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:34,454 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:35,336 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:35,341 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:35,355 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:35,368 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:35,781 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:35,802 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:36,214 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:36,241 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:36,762 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:36,764 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:36,774 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:36,776 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:36,956 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:36,970 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:37,604 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:37,627 INFO     [learner.py:606] ====Pushing takes 0.021301984786987305 s
2021-08-18:16:47:37,657 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:37,664 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:37,664 INFO     [param_server.py:410] Lock worker 1 with localStep 353 , while globalStep is 352

2021-08-18:16:47:39,168 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:39,184 INFO     [learner.py:606] ====Pushing takes 0.013615846633911133 s
2021-08-18:16:47:39,199 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:39,204 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:39,204 INFO     [param_server.py:410] Lock worker 2 with localStep 353 , while globalStep is 352

2021-08-18:16:47:39,604 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:39,618 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:40,361 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:40,371 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:41,973 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:41,983 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:42,672 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:42,697 INFO     [learner.py:606] ====Pushing takes 0.023529529571533203 s
2021-08-18:16:47:42,729 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:42,737 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:42,737 INFO     [param_server.py:381] ====After aggregation in epoch: 352, virtual_clock: 14829.56511775099, top_1: : 67.2152 % (2083.0), top_5: : 100.0 % (3099.0), test loss: 2.910723997211015, test len: 3099.0
2021-08-18:16:47:42,740 INFO     [param_server.py:410] Lock worker 3 with localStep 353 , while globalStep is 353

2021-08-18:16:47:42,741 INFO     [param_server.py:441] ====Epoch 354 completes 17 clients with loss 31.13980159219796, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:42,741 INFO     [param_server.py:450] ====Start to sample for epoch 354, global virtualClock: 14829.56511775099, round_duration: 67.37786812921225
2021-08-18:16:47:42,742 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:43,88 INFO     [param_server.py:553] For epoch: 354, median_reward: 1108.6689478709475, dev: 5543.344739354738
2021-08-18:16:47:43,741 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1411, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:47:43,742 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4698.8663, eval_time 0.6204, test_loss 3.1411, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:47:43,775 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9546, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:47:43,776 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4698.9121, eval_time 0.655, test_loss 2.9546, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:47:43,810 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:43,821 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:43,845 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:43,859 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:43,860 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9575, Top-1 Accuracy: 719.0/1033 (0.696), Top-5 Accuracy: 1.0
2021-08-18:16:47:43,861 INFO     [learner.py:656] After aggregation epoch 353, CumulTime 4698.9998, eval_time 0.7394, test_loss 2.9575, test_accuracy 0.696, test_5_accuracy 1.0 

2021-08-18:16:47:43,930 INFO     [learner.py:526] ====Start train round 354
2021-08-18:16:47:43,959 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:45,661 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:45,695 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:45,976 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:45,990 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:47:47,26 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:47:47,47 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:47:48,439 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:47:48,457 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:47:48,901 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:47:48,915 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:47:49,127 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:47:49,141 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:47:49,563 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:47:49,572 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:47:49,714 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:47:49,727 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:47:50,308 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:47:50,317 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:47:50,359 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:47:50,370 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:47:50,441 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:47:50,451 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:47:50,987 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:47:51,9 INFO     [learner.py:606] ====Pushing takes 0.0210113525390625 s
2021-08-18:16:47:51,40 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:51,49 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:47:51,50 INFO     [param_server.py:410] Lock worker 1 with localStep 354 , while globalStep is 353

2021-08-18:16:47:52,748 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:47:52,790 INFO     [learner.py:606] ====Pushing takes 0.013743877410888672 s
2021-08-18:16:47:52,805 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:52,810 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:47:52,811 INFO     [param_server.py:410] Lock worker 2 with localStep 354 , while globalStep is 353

2021-08-18:16:47:53,89 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:47:53,98 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:47:53,853 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:47:53,863 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:47:55,675 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:47:55,702 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:47:56,485 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:47:56,509 INFO     [learner.py:606] ====Pushing takes 0.023111581802368164 s
2021-08-18:16:47:56,540 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:47:56,548 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:47:56,549 INFO     [param_server.py:381] ====After aggregation in epoch: 353, virtual_clock: 14896.942985880201, top_1: : 68.151 % (2112.0), top_5: : 100.0 % (3099.0), test loss: 3.017727902366056, test len: 3099.0
2021-08-18:16:47:56,551 INFO     [param_server.py:410] Lock worker 3 with localStep 354 , while globalStep is 354

2021-08-18:16:47:56,552 INFO     [param_server.py:441] ====Epoch 355 completes 17 clients with loss 50.69522776387257, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:47:56,552 INFO     [param_server.py:450] ====Start to sample for epoch 355, global virtualClock: 14896.942985880201, round_duration: 67.37786812921225
2021-08-18:16:47:56,553 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:47:56,882 INFO     [param_server.py:553] For epoch: 355, median_reward: 923.2519025303822, dev: 4616.259512651911
2021-08-18:16:47:57,612 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.724, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:47:57,613 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4712.7376, eval_time 0.669, test_loss 2.724, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:47:57,629 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2076, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:47:57,632 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4712.7682, eval_time 0.6934, test_loss 3.2076, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:47:57,683 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:57,685 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1023, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:47:57,689 INFO     [learner.py:656] After aggregation epoch 354, CumulTime 4712.8279, eval_time 0.7518, test_loss 3.1023, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:47:57,701 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:47:57,706 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:57,719 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:47:57,744 INFO     [learner.py:526] ====Start train round 355
2021-08-18:16:47:57,769 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:47:59,221 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:47:59,235 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:47:59,845 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:47:59,854 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:00,335 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:00,346 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:01,558 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:01,572 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:02,281 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:02,295 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:02,586 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:02,596 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:02,769 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:02,787 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:02,950 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:02,964 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:03,390 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:03,401 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:03,603 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:03,617 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:04,92 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:04,102 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:04,321 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:04,345 INFO     [learner.py:606] ====Pushing takes 0.022446155548095703 s
2021-08-18:16:48:04,379 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:04,386 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:04,387 INFO     [param_server.py:410] Lock worker 1 with localStep 355 , while globalStep is 354

2021-08-18:16:48:06,259 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:06,287 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:06,335 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:06,349 INFO     [learner.py:606] ====Pushing takes 0.012538433074951172 s
2021-08-18:16:48:06,371 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:06,377 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:06,378 INFO     [param_server.py:410] Lock worker 2 with localStep 355 , while globalStep is 354

2021-08-18:16:48:07,502 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:07,529 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:09,411 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:09,421 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:09,992 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:10,21 INFO     [learner.py:606] ====Pushing takes 0.027232885360717773 s
2021-08-18:16:48:10,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:10,70 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:10,71 INFO     [param_server.py:381] ====After aggregation in epoch: 354, virtual_clock: 14964.320854009413, top_1: : 67.1507 % (2081.0), top_5: : 100.0 % (3099.0), test loss: 3.01130223053473, test len: 3099.0
2021-08-18:16:48:10,73 INFO     [param_server.py:410] Lock worker 3 with localStep 355 , while globalStep is 355

2021-08-18:16:48:10,73 INFO     [param_server.py:441] ====Epoch 356 completes 17 clients with loss 64.16591245679851, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:10,74 INFO     [param_server.py:450] ====Start to sample for epoch 356, global virtualClock: 14964.320854009413, round_duration: 67.37786812921225
2021-08-18:16:48:10,74 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:10,407 INFO     [param_server.py:553] For epoch: 356, median_reward: 947.4316145870399, dev: 4737.1580729352
2021-08-18:16:48:11,75 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8465, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:48:11,76 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4726.2011, eval_time 0.6441, test_loss 2.8465, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:48:11,110 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.7932, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:16:48:11,111 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4726.2506, eval_time 0.6813, test_loss 2.7932, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:16:48:11,119 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0612, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:48:11,120 INFO     [learner.py:656] After aggregation epoch 355, CumulTime 4726.2563, eval_time 0.6883, test_loss 3.0612, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:48:11,151 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:48:11,160 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:11,183 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:48:11,190 INFO     [learner.py:526] ====Start train round 356
2021-08-18:16:48:11,196 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:11,203 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:12,402 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:12,423 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:13,345 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:13,359 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:13,832 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:13,842 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:14,812 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:14,831 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:15,735 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:15,763 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:16,46 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:16,56 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:16,245 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:16,260 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:16,563 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:16,591 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:17,50 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:17,77 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:17,329 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:17,363 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:17,578 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:17,589 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:18,78 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:18,109 INFO     [learner.py:606] ====Pushing takes 0.02569746971130371 s
2021-08-18:16:48:18,142 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:18,151 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:18,152 INFO     [param_server.py:410] Lock worker 1 with localStep 356 , while globalStep is 355

2021-08-18:16:48:19,754 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:19,769 INFO     [learner.py:606] ====Pushing takes 0.013977527618408203 s
2021-08-18:16:48:19,787 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:19,793 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:19,793 INFO     [param_server.py:410] Lock worker 2 with localStep 356 , while globalStep is 355

2021-08-18:16:48:20,211 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:20,230 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:20,898 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:20,908 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:22,413 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:22,422 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:23,55 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:23,82 INFO     [learner.py:606] ====Pushing takes 0.02525615692138672 s
2021-08-18:16:48:23,111 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:23,118 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:23,119 INFO     [param_server.py:381] ====After aggregation in epoch: 355, virtual_clock: 15031.698722138624, top_1: : 67.2798 % (2085.0), top_5: : 100.0 % (3099.0), test loss: 2.9003148928836544, test len: 3099.0
2021-08-18:16:48:23,121 INFO     [param_server.py:410] Lock worker 3 with localStep 356 , while globalStep is 356

2021-08-18:16:48:23,122 INFO     [param_server.py:441] ====Epoch 357 completes 17 clients with loss 142.36864048256075, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:23,122 INFO     [param_server.py:450] ====Start to sample for epoch 357, global virtualClock: 15031.698722138624, round_duration: 67.37786812921225
2021-08-18:16:48:23,123 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:23,451 INFO     [param_server.py:553] For epoch: 357, median_reward: 1182.0357237973444, dev: 5910.178618986722
2021-08-18:16:48:24,75 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9166, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:48:24,76 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4739.2008, eval_time 0.6006, test_loss 2.9166, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:48:24,120 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3776, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:16:48:24,121 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4739.257, eval_time 0.6456, test_loss 3.3776, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:16:48:24,127 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0305, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:48:24,128 INFO     [learner.py:656] After aggregation epoch 356, CumulTime 4739.2673, eval_time 0.6526, test_loss 3.0305, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:48:24,145 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:48:24,154 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:24,178 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:48:24,183 INFO     [learner.py:526] ====Start train round 357
2021-08-18:16:48:24,191 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:24,198 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:25,514 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:25,534 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:26,417 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:26,432 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:26,830 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:26,858 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:28,237 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:28,264 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:29,211 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:29,244 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:29,319 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:29,339 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:29,877 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:29,904 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:30,144 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:30,165 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:30,669 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:30,683 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:30,704 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:30,724 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:30,775 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:30,796 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:31,352 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:31,375 INFO     [learner.py:606] ====Pushing takes 0.021717071533203125 s
2021-08-18:16:48:31,414 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:31,429 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:31,430 INFO     [param_server.py:410] Lock worker 1 with localStep 357 , while globalStep is 356

2021-08-18:16:48:32,835 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:32,850 INFO     [learner.py:606] ====Pushing takes 0.013082027435302734 s
2021-08-18:16:48:32,866 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:32,871 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:32,872 INFO     [param_server.py:410] Lock worker 2 with localStep 357 , while globalStep is 356

2021-08-18:16:48:33,286 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:33,297 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:34,130 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:34,139 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:35,697 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:35,707 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:36,360 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:36,389 INFO     [learner.py:606] ====Pushing takes 0.027416706085205078 s
2021-08-18:16:48:36,421 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:36,429 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:36,430 INFO     [param_server.py:381] ====After aggregation in epoch: 356, virtual_clock: 15099.076590267836, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 3.1082066794236503, test len: 3099.0
2021-08-18:16:48:36,432 INFO     [param_server.py:410] Lock worker 3 with localStep 357 , while globalStep is 357

2021-08-18:16:48:36,433 INFO     [param_server.py:441] ====Epoch 358 completes 17 clients with loss 60.871997925210906, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:36,433 INFO     [param_server.py:450] ====Start to sample for epoch 358, global virtualClock: 15099.076590267836, round_duration: 67.37786812921225
2021-08-18:16:48:36,434 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:36,774 INFO     [param_server.py:553] For epoch: 358, median_reward: 1392.5978009342894, dev: 6962.989004671446
2021-08-18:16:48:37,494 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4412, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:48:37,495 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4752.6195, eval_time 0.6755, test_loss 3.4412, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:48:37,537 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0724, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:48:37,538 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4752.6741, eval_time 0.7188, test_loss 3.0724, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:48:37,564 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:37,578 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:37,607 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:37,616 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.235, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:48:37,619 INFO     [learner.py:656] After aggregation epoch 357, CumulTime 4752.758, eval_time 0.7994, test_loss 4.235, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:48:37,622 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:37,686 INFO     [learner.py:526] ====Start train round 358
2021-08-18:16:48:37,708 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:39,317 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:39,350 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:39,942 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:39,969 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:40,659 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:40,678 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:41,990 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:42,11 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:42,783 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:42,803 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:43,46 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:43,64 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:43,203 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:43,212 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:43,564 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:43,579 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:43,824 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:43,838 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:44,204 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:44,214 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:44,329 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:44,339 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:44,759 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:44,784 INFO     [learner.py:606] ====Pushing takes 0.022968530654907227 s
2021-08-18:16:48:44,819 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:44,827 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:44,828 INFO     [param_server.py:410] Lock worker 1 with localStep 358 , while globalStep is 357

2021-08-18:16:48:46,532 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:48:46,543 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:48:46,669 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:46,684 INFO     [learner.py:606] ====Pushing takes 0.013299226760864258 s
2021-08-18:16:48:46,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:46,712 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:48:46,713 INFO     [param_server.py:410] Lock worker 2 with localStep 358 , while globalStep is 357

2021-08-18:16:48:47,204 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:48:47,213 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:48:48,863 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:48:48,890 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:48:49,671 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:48:49,705 INFO     [learner.py:606] ====Pushing takes 0.03323698043823242 s
2021-08-18:16:48:49,747 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:49,757 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:48:49,758 INFO     [param_server.py:381] ====After aggregation in epoch: 357, virtual_clock: 15166.454458397047, top_1: : 66.344 % (2056.0), top_5: : 100.0 % (3099.0), test loss: 3.5828443589033903, test len: 3099.0
2021-08-18:16:48:49,761 INFO     [param_server.py:410] Lock worker 3 with localStep 358 , while globalStep is 358

2021-08-18:16:48:49,761 INFO     [param_server.py:441] ====Epoch 359 completes 17 clients with loss 117.37723298633952, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:48:49,762 INFO     [param_server.py:450] ====Start to sample for epoch 359, global virtualClock: 15166.454458397047, round_duration: 67.37786812921225
2021-08-18:16:48:49,762 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:48:50,36 INFO     [param_server.py:553] For epoch: 359, median_reward: 1235.1023479600028, dev: 6175.511739800014
2021-08-18:16:48:50,665 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8768, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:48:50,666 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6293, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:48:50,678 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4765.8023, eval_time 0.6019, test_loss 2.8768, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:48:50,678 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4765.8139, eval_time 0.6067, test_loss 3.6293, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:48:50,710 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0706, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:48:50,711 INFO     [learner.py:656] After aggregation epoch 358, CumulTime 4765.8498, eval_time 0.6417, test_loss 3.0706, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:48:50,747 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:50,747 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:50,756 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:48:50,756 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:48:50,779 INFO     [learner.py:526] ====Start train round 359
2021-08-18:16:48:50,791 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:48:52,434 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:48:52,461 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:48:53,251 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:48:53,265 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:48:53,866 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:48:53,884 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:48:55,282 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:48:55,300 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:48:55,947 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:48:55,961 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:48:56,285 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:48:56,296 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:48:56,398 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:48:56,416 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:48:56,668 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:48:56,688 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:48:57,6 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:48:57,21 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:48:57,305 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:48:57,326 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:48:57,799 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:48:57,808 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:48:57,905 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:48:57,927 INFO     [learner.py:606] ====Pushing takes 0.01957225799560547 s
2021-08-18:16:48:57,964 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:48:57,971 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:48:57,972 INFO     [param_server.py:410] Lock worker 1 with localStep 359 , while globalStep is 358

2021-08-18:16:48:59,968 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:48:59,984 INFO     [learner.py:606] ====Pushing takes 0.014446258544921875 s
2021-08-18:16:49:00,4 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:00,9 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:49:00,9 INFO     [param_server.py:410] Lock worker 2 with localStep 359 , while globalStep is 358

2021-08-18:16:49:00,193 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:00,214 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:01,94 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:01,108 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:02,755 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:02,766 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:03,377 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:03,405 INFO     [learner.py:606] ====Pushing takes 0.02606987953186035 s
2021-08-18:16:49:03,441 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:03,449 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:49:03,449 INFO     [param_server.py:381] ====After aggregation in epoch: 358, virtual_clock: 15233.832326526259, top_1: : 66.6344 % (2065.0), top_5: : 100.0 % (3099.0), test loss: 3.192216917320534, test len: 3099.0
2021-08-18:16:49:03,452 INFO     [param_server.py:410] Lock worker 3 with localStep 359 , while globalStep is 359

2021-08-18:16:49:03,453 INFO     [param_server.py:441] ====Epoch 360 completes 17 clients with loss 42.36537316429091, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:03,453 INFO     [param_server.py:450] ====Start to sample for epoch 360, global virtualClock: 15233.832326526259, round_duration: 67.37786812921225
2021-08-18:16:49:03,454 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:49:03,742 INFO     [param_server.py:553] For epoch: 360, median_reward: 987.7929267838841, dev: 4938.9646339194205
2021-08-18:16:49:04,358 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8395, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:49:04,359 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4779.495, eval_time 0.5838, test_loss 3.8395, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:49:04,394 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6721, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:49:04,395 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4779.5192, eval_time 0.6183, test_loss 2.6721, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:49:04,428 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:49:04,434 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1418, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:49:04,435 INFO     [learner.py:656] After aggregation epoch 359, CumulTime 4779.5745, eval_time 0.66, test_loss 3.1418, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:49:04,436 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:04,464 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:49:04,480 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:04,505 INFO     [learner.py:526] ====Start train round 360
2021-08-18:16:49:04,524 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:06,98 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:06,118 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:06,566 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:06,580 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:07,309 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:07,319 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:08,730 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:08,766 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:09,562 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:09,583 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:09,724 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:09,743 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:09,790 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:09,804 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:10,415 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:10,429 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:49:10,736 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:10,751 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:11,104 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:49:11,117 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:11,178 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:11,187 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:11,818 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:11,842 INFO     [learner.py:606] ====Pushing takes 0.022603511810302734 s
2021-08-18:16:49:11,872 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:11,881 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:49:11,881 INFO     [param_server.py:410] Lock worker 1 with localStep 360 , while globalStep is 359

2021-08-18:16:49:13,424 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:13,435 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:13,473 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:13,490 INFO     [learner.py:606] ====Pushing takes 0.014806509017944336 s
2021-08-18:16:49:13,511 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:13,515 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:49:13,516 INFO     [param_server.py:410] Lock worker 2 with localStep 360 , while globalStep is 359

2021-08-18:16:49:14,124 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:14,133 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:15,733 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:15,747 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:16,426 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:16,454 INFO     [learner.py:606] ====Pushing takes 0.026039600372314453 s
2021-08-18:16:49:16,484 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:16,492 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:49:16,493 INFO     [param_server.py:381] ====After aggregation in epoch: 359, virtual_clock: 15301.21019465547, top_1: : 67.9574 % (2106.0), top_5: : 100.0 % (3099.0), test loss: 3.217770792819836, test len: 3099.0
2021-08-18:16:49:16,495 INFO     [param_server.py:410] Lock worker 3 with localStep 360 , while globalStep is 360

2021-08-18:16:49:16,496 INFO     [param_server.py:441] ====Epoch 361 completes 17 clients with loss 42.33084973048041, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:16,496 INFO     [param_server.py:450] ====Start to sample for epoch 361, global virtualClock: 15301.21019465547, round_duration: 67.37786812921225
2021-08-18:16:49:16,497 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:49:16,762 INFO     [param_server.py:541] Handle Wight 0.0335695743560791 | Send 0.2655646800994873
2021-08-18:16:49:16,763 INFO     [param_server.py:553] For epoch: 361, median_reward: 1033.4891279961464, dev: 5167.445639980732
2021-08-18:16:49:17,465 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7676, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:49:17,466 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4792.6022, eval_time 0.6709, test_loss 3.7676, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:49:17,470 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8565, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:49:17,471 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4792.5953, eval_time 0.6738, test_loss 2.8565, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:49:17,506 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1049, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:49:17,509 INFO     [learner.py:656] After aggregation epoch 360, CumulTime 4792.6484, eval_time 0.7139, test_loss 3.1049, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:49:17,537 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:49:17,541 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:49:17,546 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:17,550 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:17,576 INFO     [learner.py:526] ====Start train round 361
2021-08-18:16:49:17,598 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:19,260 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:19,288 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:19,672 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:19,690 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:20,237 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:20,256 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:22,5 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:22,32 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:22,747 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:22,767 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:22,929 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:22,932 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:22,946 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:22,948 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:23,404 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:23,415 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:23,678 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:23,698 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:49:24,276 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:24,290 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:49:24,293 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:24,300 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:24,800 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:24,826 INFO     [learner.py:606] ====Pushing takes 0.024482011795043945 s
2021-08-18:16:49:24,867 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:24,874 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:49:24,875 INFO     [param_server.py:410] Lock worker 1 with localStep 361 , while globalStep is 360

2021-08-18:16:49:26,271 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:26,290 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:26,498 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:26,515 INFO     [learner.py:606] ====Pushing takes 0.014964818954467773 s
2021-08-18:16:49:26,536 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:26,541 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:49:26,541 INFO     [param_server.py:410] Lock worker 2 with localStep 361 , while globalStep is 360

2021-08-18:16:49:27,119 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:27,133 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:28,892 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:28,902 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:29,562 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:29,591 INFO     [learner.py:606] ====Pushing takes 0.02746272087097168 s
2021-08-18:16:49:29,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:29,641 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:49:29,641 INFO     [param_server.py:381] ====After aggregation in epoch: 360, virtual_clock: 15368.588062784682, top_1: : 66.4731 % (2060.0), top_5: : 100.0 % (3099.0), test loss: 3.2430234926718255, test len: 3099.0
2021-08-18:16:49:29,644 INFO     [param_server.py:410] Lock worker 3 with localStep 361 , while globalStep is 361

2021-08-18:16:49:29,644 INFO     [param_server.py:441] ====Epoch 362 completes 17 clients with loss 46.343739620199, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:29,645 INFO     [param_server.py:450] ====Start to sample for epoch 362, global virtualClock: 15368.588062784682, round_duration: 67.37786812921225
2021-08-18:16:49:29,646 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 58, 67]
2021-08-18:16:49:29,962 INFO     [param_server.py:553] For epoch: 362, median_reward: 942.489169275847, dev: 4712.445846379234
2021-08-18:16:49:30,636 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0751, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:49:30,640 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4805.7761, eval_time 0.6436, test_loss 3.0751, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:49:30,641 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7879, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:49:30,642 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4805.7664, eval_time 0.6449, test_loss 2.7879, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:49:30,706 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2007, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:49:30,707 INFO     [learner.py:656] After aggregation epoch 361, CumulTime 4805.8461, eval_time 0.7105, test_loss 3.2007, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:49:30,710 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:30,710 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:30,719 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:30,719 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:30,774 INFO     [learner.py:526] ====Start train round 362
2021-08-18:16:49:30,797 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:32,345 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:32,372 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:32,863 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:32,873 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:33,564 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:33,574 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:34,891 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:34,919 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:35,646 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:35,666 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:35,870 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:35,881 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:36,46 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:36,66 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:36,431 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:36,444 INFO     [learner.py:165] Start to run client 58 on rank 1...
2021-08-18:16:49:36,618 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:36,629 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:37,165 INFO     [learner.py:439] Completed to run client 58
2021-08-18:16:49:37,186 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:37,463 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:37,491 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:37,799 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:37,820 INFO     [learner.py:606] ====Pushing takes 0.019628047943115234 s
2021-08-18:16:49:37,858 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:37,866 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.058823529411764705, now collected 6 clients
2021-08-18:16:49:37,866 INFO     [param_server.py:410] Lock worker 1 with localStep 362 , while globalStep is 361

2021-08-18:16:49:39,553 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:39,575 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:39,693 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:39,709 INFO     [learner.py:606] ====Pushing takes 0.014147758483886719 s
2021-08-18:16:49:39,730 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:39,735 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.058823529411764705, now collected 10 clients
2021-08-18:16:49:39,735 INFO     [param_server.py:410] Lock worker 2 with localStep 362 , while globalStep is 361

2021-08-18:16:49:40,287 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:40,301 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:41,977 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:41,991 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:42,598 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:42,627 INFO     [learner.py:606] ====Pushing takes 0.027553796768188477 s
2021-08-18:16:49:42,664 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:42,671 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.058823529411764705, now collected 17 clients
2021-08-18:16:49:42,672 INFO     [param_server.py:381] ====After aggregation in epoch: 361, virtual_clock: 15435.965930913893, top_1: : 67.4734 % (2091.0), top_5: : 100.0 % (3099.0), test loss: 3.021247468612812, test len: 3099.0
2021-08-18:16:49:42,675 INFO     [param_server.py:410] Lock worker 3 with localStep 362 , while globalStep is 362

2021-08-18:16:49:42,675 INFO     [param_server.py:441] ====Epoch 363 completes 17 clients with loss 130.30512824625984, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 58: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:42,676 INFO     [param_server.py:450] ====Start to sample for epoch 363, global virtualClock: 15435.965930913893, round_duration: 67.37786812921225
2021-08-18:16:49:42,677 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:42,958 INFO     [param_server.py:553] For epoch: 363, median_reward: 1099.8647766819624, dev: 5499.323883409812
2021-08-18:16:49:43,632 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9543, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:49:43,633 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4818.7691, eval_time 0.6505, test_loss 2.9543, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:49:43,663 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9498, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:49:43,664 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4818.8035, eval_time 0.6816, test_loss 2.9498, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:49:43,680 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.6255, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:49:43,681 INFO     [learner.py:656] After aggregation epoch 362, CumulTime 4818.8056, eval_time 0.6951, test_loss 2.6255, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:49:43,704 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:43,718 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:43,734 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:43,752 INFO     [learner.py:526] ====Start train round 363
2021-08-18:16:49:43,757 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:43,766 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:45,290 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:45,311 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:45,862 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:45,871 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:49:46,442 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:49:46,453 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:49:47,891 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:49:47,924 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:49:48,754 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:49:48,781 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:49:48,864 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:49:48,878 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:49:48,900 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:49:48,927 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:49:49,709 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:49:49,717 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:49:49,735 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:49:49,738 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:49:50,285 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:49:50,305 INFO     [learner.py:606] ====Pushing takes 0.019004344940185547 s
2021-08-18:16:49:50,336 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:50,343 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:49:50,344 INFO     [param_server.py:410] Lock worker 1 with localStep 363 , while globalStep is 362

2021-08-18:16:49:50,690 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:49:50,704 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:49:52,549 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:49:52,568 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:49:53,10 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:49:53,25 INFO     [learner.py:606] ====Pushing takes 0.013601064682006836 s
2021-08-18:16:49:53,46 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:53,50 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:49:53,51 INFO     [param_server.py:410] Lock worker 2 with localStep 363 , while globalStep is 362

2021-08-18:16:49:53,953 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:49:53,968 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:49:55,835 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:49:55,851 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:49:56,555 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:49:56,583 INFO     [learner.py:606] ====Pushing takes 0.02649092674255371 s
2021-08-18:16:49:56,615 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:49:56,622 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:49:56,623 INFO     [param_server.py:381] ====After aggregation in epoch: 362, virtual_clock: 15506.587692449566, top_1: : 67.9251 % (2105.0), top_5: : 100.0 % (3099.0), test loss: 2.8431931869299323, test len: 3099.0
2021-08-18:16:49:56,626 INFO     [param_server.py:410] Lock worker 3 with localStep 363 , while globalStep is 363

2021-08-18:16:49:56,627 INFO     [param_server.py:441] ====Epoch 364 completes 16 clients with loss 5.1843900587740155, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:49:56,627 INFO     [param_server.py:450] ====Start to sample for epoch 364, global virtualClock: 15506.587692449566, round_duration: 70.62176153567286
2021-08-18:16:49:56,628 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:49:56,899 INFO     [param_server.py:553] For epoch: 364, median_reward: 1059.0584421840836, dev: 5295.292210920417
2021-08-18:16:49:57,611 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6242, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:49:57,612 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4832.7478, eval_time 0.6979, test_loss 3.6242, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:49:57,616 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3098, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:49:57,617 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4832.7419, eval_time 0.7032, test_loss 3.3098, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:49:57,648 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0421, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:49:57,652 INFO     [learner.py:656] After aggregation epoch 363, CumulTime 4832.7908, eval_time 0.7407, test_loss 3.0421, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:49:57,687 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:57,692 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:57,695 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:49:57,701 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:49:57,721 INFO     [learner.py:526] ====Start train round 364
2021-08-18:16:49:57,734 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:49:59,254 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:49:59,281 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:49:59,890 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:49:59,905 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:00,446 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:00,483 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:02,109 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:02,143 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:02,863 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:02,876 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:03,27 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:03,54 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:03,262 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:03,283 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:03,856 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:03,873 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:03,938 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:03,965 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:04,506 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:04,528 INFO     [learner.py:606] ====Pushing takes 0.019852161407470703 s
2021-08-18:16:50:04,560 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:04,565 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:04,566 INFO     [param_server.py:410] Lock worker 1 with localStep 364 , while globalStep is 363

2021-08-18:16:50:05,7 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:05,23 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:06,677 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:06,686 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:07,324 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:07,340 INFO     [learner.py:606] ====Pushing takes 0.01471400260925293 s
2021-08-18:16:50:07,358 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:07,362 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:07,363 INFO     [param_server.py:410] Lock worker 2 with localStep 364 , while globalStep is 363

2021-08-18:16:50:07,981 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:07,991 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:09,770 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:09,781 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:10,446 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:10,476 INFO     [learner.py:606] ====Pushing takes 0.029079675674438477 s
2021-08-18:16:50:10,506 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:10,516 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:10,517 INFO     [param_server.py:381] ====After aggregation in epoch: 363, virtual_clock: 15577.209453985239, top_1: : 66.2149 % (2052.0), top_5: : 100.0 % (3099.0), test loss: 3.325370554570798, test len: 3099.0
2021-08-18:16:50:10,519 INFO     [param_server.py:410] Lock worker 3 with localStep 364 , while globalStep is 364

2021-08-18:16:50:10,520 INFO     [param_server.py:441] ====Epoch 365 completes 16 clients with loss 4.087067581114109, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:10,520 INFO     [param_server.py:450] ====Start to sample for epoch 365, global virtualClock: 15577.209453985239, round_duration: 70.62176153567286
2021-08-18:16:50:10,521 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:10,792 INFO     [param_server.py:553] For epoch: 365, median_reward: 981.740137102305, dev: 4908.700685511525
2021-08-18:16:50:11,409 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2312, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:50:11,412 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4846.5482, eval_time 0.5745, test_loss 3.2312, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:50:11,456 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8416, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:50:11,457 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4846.5812, eval_time 0.6187, test_loss 2.8416, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:50:11,491 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:50:11,499 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:11,523 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:50:11,534 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0027, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:50:11,535 INFO     [learner.py:656] After aggregation epoch 364, CumulTime 4846.6743, eval_time 0.6973, test_loss 3.0027, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:50:11,538 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:11,603 INFO     [learner.py:526] ====Start train round 365
2021-08-18:16:50:11,627 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:13,506 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:13,540 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:13,581 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:13,593 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:14,405 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:14,423 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:16,248 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:16,268 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:16,736 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:16,757 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:16,842 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:16,851 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:17,51 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:17,72 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:17,571 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:17,581 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:17,789 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:17,803 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:18,430 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:18,452 INFO     [learner.py:606] ====Pushing takes 0.020102977752685547 s
2021-08-18:16:50:18,488 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:18,494 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:18,495 INFO     [param_server.py:410] Lock worker 1 with localStep 365 , while globalStep is 364

2021-08-18:16:50:18,562 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:18,572 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:20,339 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:20,352 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:20,915 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:20,931 INFO     [learner.py:606] ====Pushing takes 0.014448881149291992 s
2021-08-18:16:50:20,947 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:20,952 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:20,953 INFO     [param_server.py:410] Lock worker 2 with localStep 365 , while globalStep is 364

2021-08-18:16:50:21,609 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:21,618 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:23,323 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:23,337 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:23,937 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:23,964 INFO     [learner.py:606] ====Pushing takes 0.026269197463989258 s
2021-08-18:16:50:23,996 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:24,4 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:24,5 INFO     [param_server.py:381] ====After aggregation in epoch: 364, virtual_clock: 15647.831215520911, top_1: : 66.6021 % (2064.0), top_5: : 100.0 % (3099.0), test loss: 3.025184463571619, test len: 3099.0
2021-08-18:16:50:24,8 INFO     [param_server.py:410] Lock worker 3 with localStep 365 , while globalStep is 365

2021-08-18:16:50:24,8 INFO     [param_server.py:441] ====Epoch 366 completes 16 clients with loss 5.0138339424491924, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:24,9 INFO     [param_server.py:450] ====Start to sample for epoch 366, global virtualClock: 15647.831215520911, round_duration: 70.62176153567286
2021-08-18:16:50:24,10 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:24,333 INFO     [param_server.py:553] For epoch: 366, median_reward: 902.3100134120232, dev: 4511.550067060116
2021-08-18:16:50:25,11 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.225, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:50:25,12 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4860.1475, eval_time 0.6335, test_loss 3.225, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:50:25,46 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1036, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:50:25,48 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4860.1723, eval_time 0.6696, test_loss 3.1036, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:50:25,85 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:25,87 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1347, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:50:25,88 INFO     [learner.py:656] After aggregation epoch 365, CumulTime 4860.2275, eval_time 0.7103, test_loss 3.1347, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:50:25,94 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:25,120 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:25,133 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:25,148 INFO     [learner.py:526] ====Start train round 366
2021-08-18:16:50:25,170 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:26,731 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:26,751 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:27,266 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:27,277 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:27,837 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:27,846 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:29,331 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:29,358 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:30,29 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:30,40 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:30,140 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:30,169 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:30,208 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:30,229 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:30,780 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:30,794 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:31,62 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:31,77 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:31,660 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:31,681 INFO     [learner.py:606] ====Pushing takes 0.019652366638183594 s
2021-08-18:16:50:31,715 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:31,723 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:31,723 INFO     [param_server.py:410] Lock worker 1 with localStep 366 , while globalStep is 365

2021-08-18:16:50:32,87 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:32,102 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:33,637 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:33,655 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:34,399 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:34,415 INFO     [learner.py:606] ====Pushing takes 0.013982772827148438 s
2021-08-18:16:50:34,430 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:34,435 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:34,436 INFO     [param_server.py:410] Lock worker 2 with localStep 366 , while globalStep is 365

2021-08-18:16:50:35,193 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:35,213 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:37,68 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:37,86 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:37,732 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:37,764 INFO     [learner.py:606] ====Pushing takes 0.02819061279296875 s
2021-08-18:16:50:37,796 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:37,803 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:37,804 INFO     [param_server.py:381] ====After aggregation in epoch: 365, virtual_clock: 15718.452977056584, top_1: : 66.9571 % (2075.0), top_5: : 100.0 % (3099.0), test loss: 3.1544432463469327, test len: 3099.0
2021-08-18:16:50:37,807 INFO     [param_server.py:410] Lock worker 3 with localStep 366 , while globalStep is 366

2021-08-18:16:50:37,808 INFO     [param_server.py:441] ====Epoch 367 completes 16 clients with loss 3.7271754088600924, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:37,808 INFO     [param_server.py:450] ====Start to sample for epoch 367, global virtualClock: 15718.452977056584, round_duration: 70.62176153567286
2021-08-18:16:50:37,809 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:38,141 INFO     [param_server.py:553] For epoch: 367, median_reward: 1032.3752875479452, dev: 5161.876437739726
2021-08-18:16:50:38,794 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1546, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:50:38,795 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4873.9311, eval_time 0.6412, test_loss 3.1546, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:50:38,812 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0511, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:50:38,813 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4873.9376, eval_time 0.6589, test_loss 3.0511, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:50:38,847 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3496, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:50:38,848 INFO     [learner.py:656] After aggregation epoch 366, CumulTime 4873.987, eval_time 0.6941, test_loss 3.3496, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:50:38,862 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:38,872 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:38,881 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:38,889 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:38,916 INFO     [learner.py:526] ====Start train round 367
2021-08-18:16:50:38,928 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:40,505 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:40,525 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:41,25 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:41,35 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:41,553 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:41,562 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:42,864 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:42,885 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:43,774 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:43,801 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:43,840 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:43,850 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:44,79 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:44,100 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:44,748 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:44,776 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:44,782 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:44,796 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:45,400 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:45,419 INFO     [learner.py:606] ====Pushing takes 0.01824474334716797 s
2021-08-18:16:50:45,454 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:45,465 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:45,465 INFO     [param_server.py:410] Lock worker 1 with localStep 367 , while globalStep is 366

2021-08-18:16:50:45,887 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:45,901 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:50:47,942 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:50:47,952 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:50:48,132 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:50:48,151 INFO     [learner.py:606] ====Pushing takes 0.013183116912841797 s
2021-08-18:16:50:48,166 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:48,174 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:50:48,174 INFO     [param_server.py:410] Lock worker 2 with localStep 367 , while globalStep is 366

2021-08-18:16:50:49,165 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:50:49,179 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:50:50,879 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:50:50,889 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:50:51,634 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:50:51,661 INFO     [learner.py:606] ====Pushing takes 0.025737285614013672 s
2021-08-18:16:50:51,700 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:51,707 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:50:51,708 INFO     [param_server.py:381] ====After aggregation in epoch: 366, virtual_clock: 15789.074738592257, top_1: : 67.7961 % (2101.0), top_5: : 100.0 % (3099.0), test loss: 3.185118966632419, test len: 3099.0
2021-08-18:16:50:51,729 INFO     [param_server.py:410] Lock worker 3 with localStep 367 , while globalStep is 367

2021-08-18:16:50:51,729 INFO     [param_server.py:441] ====Epoch 368 completes 16 clients with loss 6.969896566302026, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:50:51,730 INFO     [param_server.py:450] ====Start to sample for epoch 368, global virtualClock: 15789.074738592257, round_duration: 70.62176153567286
2021-08-18:16:50:51,731 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:50:52,63 INFO     [param_server.py:553] For epoch: 368, median_reward: 945.8584686218734, dev: 4729.292343109367
2021-08-18:16:50:52,607 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.144, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:16:50:52,607 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4887.7321, eval_time 0.5098, test_loss 3.144, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:16:50:52,613 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8924, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:50:52,614 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4887.7497, eval_time 0.5175, test_loss 3.8924, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:50:52,679 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:52,685 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:52,687 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:50:52,686 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2231, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:16:50:52,688 INFO     [learner.py:656] After aggregation epoch 367, CumulTime 4887.8272, eval_time 0.5921, test_loss 3.2231, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:16:50:52,699 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:50:52,761 INFO     [learner.py:526] ====Start train round 368
2021-08-18:16:50:52,782 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:50:54,243 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:50:54,264 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:50:54,818 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:50:54,837 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:50:55,332 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:50:55,341 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:50:57,133 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:50:57,167 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:50:57,945 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:50:57,967 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:50:58,100 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:50:58,127 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:50:58,316 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:50:58,337 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:50:58,934 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:50:58,954 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:50:59,124 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:50:59,139 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:50:59,543 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:50:59,563 INFO     [learner.py:606] ====Pushing takes 0.018808603286743164 s
2021-08-18:16:50:59,586 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:50:59,592 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:50:59,592 INFO     [param_server.py:410] Lock worker 1 with localStep 368 , while globalStep is 367

2021-08-18:16:50:59,862 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:50:59,872 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:01,776 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:01,786 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:02,249 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:02,266 INFO     [learner.py:606] ====Pushing takes 0.016101598739624023 s
2021-08-18:16:51:02,283 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:02,289 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:02,289 INFO     [param_server.py:410] Lock worker 2 with localStep 368 , while globalStep is 367

2021-08-18:16:51:02,909 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:02,918 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:04,502 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:04,513 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:05,132 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:05,156 INFO     [learner.py:606] ====Pushing takes 0.023700237274169922 s
2021-08-18:16:51:05,186 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:05,196 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:05,196 INFO     [param_server.py:381] ====After aggregation in epoch: 367, virtual_clock: 15859.69650012793, top_1: : 68.0219 % (2108.0), top_5: : 100.0 % (3099.0), test loss: 3.419810427559747, test len: 3099.0
2021-08-18:16:51:05,198 INFO     [param_server.py:410] Lock worker 3 with localStep 368 , while globalStep is 368

2021-08-18:16:51:05,199 INFO     [param_server.py:441] ====Epoch 369 completes 16 clients with loss 5.7841971372657675, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:05,199 INFO     [param_server.py:450] ====Start to sample for epoch 369, global virtualClock: 15859.69650012793, round_duration: 70.62176153567286
2021-08-18:16:51:05,200 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:05,539 INFO     [param_server.py:553] For epoch: 369, median_reward: 936.2060911723008, dev: 4681.030455861504
2021-08-18:16:51:06,198 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8393, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:51:06,202 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4901.3377, eval_time 0.6283, test_loss 3.8393, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:51:06,202 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2597, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:51:06,203 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4901.3276, eval_time 0.629, test_loss 3.2597, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:51:06,272 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:51:06,272 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:51:06,281 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:06,281 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:06,284 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2231, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:51:06,285 INFO     [learner.py:656] After aggregation epoch 368, CumulTime 4901.4242, eval_time 0.7121, test_loss 3.2231, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:51:06,364 INFO     [learner.py:526] ====Start train round 369
2021-08-18:16:51:06,381 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:08,102 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:08,135 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:08,504 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:08,518 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:09,481 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:09,508 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:10,884 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:10,905 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:11,471 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:11,492 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:11,719 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:11,735 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:11,923 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:11,933 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:12,428 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:12,473 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:12,615 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:12,626 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:13,29 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:13,49 INFO     [learner.py:606] ====Pushing takes 0.019333362579345703 s
2021-08-18:16:51:13,80 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:13,86 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:13,87 INFO     [param_server.py:410] Lock worker 1 with localStep 369 , while globalStep is 368

2021-08-18:16:51:13,349 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:13,359 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:15,431 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:15,442 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:15,677 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:15,692 INFO     [learner.py:606] ====Pushing takes 0.01412057876586914 s
2021-08-18:16:51:15,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:15,712 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:15,713 INFO     [param_server.py:410] Lock worker 2 with localStep 369 , while globalStep is 368

2021-08-18:16:51:16,646 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:16,656 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:18,523 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:18,538 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:19,311 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:19,341 INFO     [learner.py:606] ====Pushing takes 0.029273033142089844 s
2021-08-18:16:51:19,376 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:19,385 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:19,385 INFO     [param_server.py:381] ====After aggregation in epoch: 368, virtual_clock: 15930.318261663602, top_1: : 66.8925 % (2073.0), top_5: : 100.0 % (3099.0), test loss: 3.440687276698925, test len: 3099.0
2021-08-18:16:51:19,388 INFO     [param_server.py:410] Lock worker 3 with localStep 369 , while globalStep is 369

2021-08-18:16:51:19,405 INFO     [param_server.py:441] ====Epoch 370 completes 16 clients with loss 9.000217206293657, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:19,405 INFO     [param_server.py:450] ====Start to sample for epoch 370, global virtualClock: 15930.318261663602, round_duration: 70.62176153567286
2021-08-18:16:51:19,406 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:19,791 INFO     [param_server.py:553] For epoch: 370, median_reward: 984.2587490882038, dev: 4921.2937454410185
2021-08-18:16:51:20,534 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3322, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:51:20,535 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4915.6708, eval_time 0.699, test_loss 3.3322, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:51:20,574 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1724, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:51:20,576 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4915.7001, eval_time 0.7378, test_loss 3.1724, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:51:20,605 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:51:20,610 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1091, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:51:20,611 INFO     [learner.py:656] After aggregation epoch 369, CumulTime 4915.7498, eval_time 0.7748, test_loss 3.1091, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:51:20,613 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:20,646 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:51:20,661 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:20,668 INFO     [learner.py:526] ====Start train round 370
2021-08-18:16:51:20,690 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:22,316 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:22,337 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:22,731 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:22,741 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:23,354 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:23,366 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:24,582 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:24,603 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:25,462 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:25,484 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:25,594 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:25,608 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:25,706 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:25,725 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:26,174 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:26,188 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:26,330 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:26,344 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:26,730 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:26,751 INFO     [learner.py:606] ====Pushing takes 0.01871514320373535 s
2021-08-18:16:51:26,775 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:26,784 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:26,785 INFO     [param_server.py:410] Lock worker 1 with localStep 370 , while globalStep is 369

2021-08-18:16:51:27,289 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:27,300 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:28,902 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:28,916 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:29,689 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:29,704 INFO     [learner.py:606] ====Pushing takes 0.013180732727050781 s
2021-08-18:16:51:29,720 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:29,727 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:29,728 INFO     [param_server.py:410] Lock worker 2 with localStep 370 , while globalStep is 369

2021-08-18:16:51:30,276 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:30,294 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:32,124 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:32,138 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:32,814 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:32,841 INFO     [learner.py:606] ====Pushing takes 0.026020288467407227 s
2021-08-18:16:51:32,872 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:32,879 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:32,880 INFO     [param_server.py:381] ====After aggregation in epoch: 369, virtual_clock: 16000.940023199275, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.204569529604029, test len: 3099.0
2021-08-18:16:51:32,882 INFO     [param_server.py:410] Lock worker 3 with localStep 370 , while globalStep is 370

2021-08-18:16:51:32,883 INFO     [param_server.py:441] ====Epoch 371 completes 16 clients with loss 6.145625641523674, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:32,883 INFO     [param_server.py:450] ====Start to sample for epoch 371, global virtualClock: 16000.940023199275, round_duration: 70.62176153567286
2021-08-18:16:51:32,884 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:33,186 INFO     [param_server.py:553] For epoch: 371, median_reward: 1133.0039823172815, dev: 5665.019911586407
2021-08-18:16:51:33,870 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4375, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:51:33,870 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4928.9951, eval_time 0.6476, test_loss 3.4375, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:51:33,873 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.032, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:51:33,873 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4929.0091, eval_time 0.6528, test_loss 3.032, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:51:33,888 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2743, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:16:51:33,889 INFO     [learner.py:656] After aggregation epoch 370, CumulTime 4929.0286, eval_time 0.6696, test_loss 3.2743, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:16:51:33,940 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:33,945 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:33,949 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:33,954 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:33,960 INFO     [learner.py:526] ====Start train round 371
2021-08-18:16:51:33,971 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:35,305 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:35,325 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:36,114 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:36,125 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:36,643 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:36,658 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:37,757 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:37,776 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:38,606 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:38,624 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:38,917 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:38,926 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:39,27 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:39,46 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:39,297 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:39,312 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:39,613 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:39,623 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:39,892 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:39,914 INFO     [learner.py:606] ====Pushing takes 0.020106792449951172 s
2021-08-18:16:51:39,947 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:39,952 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:39,953 INFO     [param_server.py:410] Lock worker 1 with localStep 371 , while globalStep is 370

2021-08-18:16:51:40,733 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:40,743 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:42,488 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:42,502 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:43,98 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:43,115 INFO     [learner.py:606] ====Pushing takes 0.014171600341796875 s
2021-08-18:16:51:43,130 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:43,137 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:43,138 INFO     [param_server.py:410] Lock worker 2 with localStep 371 , while globalStep is 370

2021-08-18:16:51:43,738 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:43,759 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:45,396 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:45,405 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:45,989 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:46,17 INFO     [learner.py:606] ====Pushing takes 0.02592611312866211 s
2021-08-18:16:51:46,49 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:46,58 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:46,59 INFO     [param_server.py:381] ====After aggregation in epoch: 370, virtual_clock: 16071.561784734948, top_1: : 67.5056 % (2092.0), top_5: : 100.0 % (3099.0), test loss: 3.2479573350865394, test len: 3099.0
2021-08-18:16:51:46,61 INFO     [param_server.py:410] Lock worker 3 with localStep 371 , while globalStep is 371

2021-08-18:16:51:46,62 INFO     [param_server.py:441] ====Epoch 372 completes 16 clients with loss 5.146191939544586, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:46,62 INFO     [param_server.py:450] ====Start to sample for epoch 372, global virtualClock: 16071.561784734948, round_duration: 70.62176153567286
2021-08-18:16:51:46,63 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:46,373 INFO     [param_server.py:553] For epoch: 372, median_reward: 1060.8682505478068, dev: 5304.341252739034
2021-08-18:16:51:47,15 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2401, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:51:47,14 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8592, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:51:47,15 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4942.1514, eval_time 0.6285, test_loss 3.2401, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:51:47,16 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4942.1402, eval_time 0.628, test_loss 2.8592, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:51:47,15 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:51:47,18 INFO     [learner.py:656] After aggregation epoch 371, CumulTime 4942.1572, eval_time 0.633, test_loss 3.4, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:51:47,86 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:47,86 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:47,90 INFO     [learner.py:526] ====Start train round 372
2021-08-18:16:51:47,94 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:51:47,95 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:51:47,99 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:51:48,411 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:51:48,431 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:51:49,102 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:51:49,120 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:51:49,685 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:51:49,699 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:51:50,744 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:51:50,758 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:51:51,746 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:51:51,779 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:51:51,965 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:51:51,974 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:51:52,49 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:51:52,63 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:51:52,752 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:51:52,779 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:51:52,813 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:51:52,844 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:51:53,287 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:51:53,309 INFO     [learner.py:606] ====Pushing takes 0.01739215850830078 s
2021-08-18:16:51:53,332 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:53,338 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:51:53,339 INFO     [param_server.py:410] Lock worker 1 with localStep 372 , while globalStep is 371

2021-08-18:16:51:53,721 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:51:53,731 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:51:55,557 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:51:55,567 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:51:56,224 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:51:56,239 INFO     [learner.py:606] ====Pushing takes 0.013434410095214844 s
2021-08-18:16:51:56,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:56,265 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:51:56,266 INFO     [param_server.py:410] Lock worker 2 with localStep 372 , while globalStep is 371

2021-08-18:16:51:56,859 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:51:56,873 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:51:58,546 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:51:58,556 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:51:59,201 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:51:59,228 INFO     [learner.py:606] ====Pushing takes 0.02641916275024414 s
2021-08-18:16:51:59,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:51:59,269 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:51:59,270 INFO     [param_server.py:381] ====After aggregation in epoch: 371, virtual_clock: 16142.18354627062, top_1: : 65.6341 % (2034.0), top_5: : 100.0 % (3099.0), test loss: 3.166423346433375, test len: 3099.0
2021-08-18:16:51:59,272 INFO     [param_server.py:410] Lock worker 3 with localStep 372 , while globalStep is 372

2021-08-18:16:51:59,273 INFO     [param_server.py:441] ====Epoch 373 completes 16 clients with loss 4.09829134912288, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:51:59,273 INFO     [param_server.py:450] ====Start to sample for epoch 373, global virtualClock: 16142.18354627062, round_duration: 70.62176153567286
2021-08-18:16:51:59,275 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:51:59,604 INFO     [param_server.py:553] For epoch: 373, median_reward: 868.18851854764, dev: 4340.9425927382
2021-08-18:16:52:00,204 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.359, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:52:00,208 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4955.3437, eval_time 0.5769, test_loss 3.359, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:52:00,217 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0305, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:52:00,217 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4955.3421, eval_time 0.5865, test_loss 3.0305, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:52:00,247 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4399, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:52:00,248 INFO     [learner.py:656] After aggregation epoch 372, CumulTime 4955.3874, eval_time 0.62, test_loss 3.4399, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:52:00,278 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:52:00,287 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:52:00,294 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:00,297 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:52:00,307 INFO     [learner.py:526] ====Start train round 373
2021-08-18:16:52:00,324 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:01,731 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:01,766 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:02,421 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:02,430 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:02,921 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:52:02,930 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:04,463 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:04,496 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:05,290 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:05,310 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:05,366 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:05,393 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:05,568 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:05,582 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:06,199 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:06,219 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:06,507 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:06,528 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:06,798 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:06,820 INFO     [learner.py:606] ====Pushing takes 0.019979000091552734 s
2021-08-18:16:52:06,842 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:06,848 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:52:06,849 INFO     [param_server.py:410] Lock worker 1 with localStep 373 , while globalStep is 372

2021-08-18:16:52:07,117 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:07,126 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:09,286 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:09,302 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:09,383 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:09,397 INFO     [learner.py:606] ====Pushing takes 0.01263570785522461 s
2021-08-18:16:52:09,412 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:09,417 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:52:09,418 INFO     [param_server.py:410] Lock worker 2 with localStep 373 , while globalStep is 372

2021-08-18:16:52:10,785 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:10,796 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:12,608 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:12,623 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:13,298 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:13,323 INFO     [learner.py:606] ====Pushing takes 0.023793697357177734 s
2021-08-18:16:52:13,353 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:13,360 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:52:13,361 INFO     [param_server.py:381] ====After aggregation in epoch: 372, virtual_clock: 16212.805307806293, top_1: : 68.1187 % (2111.0), top_5: : 100.0 % (3099.0), test loss: 3.2764599588182235, test len: 3099.0
2021-08-18:16:52:13,364 INFO     [param_server.py:410] Lock worker 3 with localStep 373 , while globalStep is 373

2021-08-18:16:52:13,364 INFO     [param_server.py:441] ====Epoch 374 completes 16 clients with loss 7.858833355477804, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:13,365 INFO     [param_server.py:450] ====Start to sample for epoch 374, global virtualClock: 16212.805307806293, round_duration: 70.62176153567286
2021-08-18:16:52:13,365 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:13,640 INFO     [param_server.py:553] For epoch: 374, median_reward: 866.456125676441, dev: 4332.280628382206
2021-08-18:16:52:14,230 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.4743, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:16:52:14,231 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4969.3665, eval_time 0.5553, test_loss 4.4743, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:16:52:14,239 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5002, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:16:52:14,240 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4969.3643, eval_time 0.5635, test_loss 3.5002, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:16:52:14,287 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:52:14,296 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:14,308 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:52:14,315 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:52:14,358 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4181, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:52:14,359 INFO     [learner.py:656] After aggregation epoch 373, CumulTime 4969.4979, eval_time 0.6855, test_loss 3.4181, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:52:14,426 INFO     [learner.py:526] ====Start train round 374
2021-08-18:16:52:14,449 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:16,238 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:16,268 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:16,581 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:16,590 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:17,141 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:52:17,162 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:18,781 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:18,801 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:19,547 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:19,556 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:19,589 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:19,593 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:19,610 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:19,612 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:20,303 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:20,317 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:20,368 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:20,390 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:20,985 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:21,6 INFO     [learner.py:606] ====Pushing takes 0.019765615463256836 s
2021-08-18:16:52:21,37 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:21,46 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:52:21,46 INFO     [param_server.py:410] Lock worker 1 with localStep 374 , while globalStep is 373

2021-08-18:16:52:21,339 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:21,349 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:22,984 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:22,995 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:23,523 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:23,539 INFO     [learner.py:606] ====Pushing takes 0.013902902603149414 s
2021-08-18:16:52:23,555 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:23,560 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:52:23,561 INFO     [param_server.py:410] Lock worker 2 with localStep 374 , while globalStep is 373

2021-08-18:16:52:24,139 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:24,150 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:25,803 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:25,812 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:26,443 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:26,471 INFO     [learner.py:606] ====Pushing takes 0.026447296142578125 s
2021-08-18:16:52:26,505 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:26,513 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:52:26,514 INFO     [param_server.py:381] ====After aggregation in epoch: 373, virtual_clock: 16283.427069341966, top_1: : 63.0849 % (1955.0), top_5: : 100.0 % (3099.0), test loss: 3.797528253661262, test len: 3099.0
2021-08-18:16:52:26,516 INFO     [param_server.py:410] Lock worker 3 with localStep 374 , while globalStep is 374

2021-08-18:16:52:26,516 INFO     [param_server.py:441] ====Epoch 375 completes 16 clients with loss 5.56142780357215, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:26,517 INFO     [param_server.py:450] ====Start to sample for epoch 375, global virtualClock: 16283.427069341966, round_duration: 70.62176153567286
2021-08-18:16:52:26,518 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:26,833 INFO     [param_server.py:553] For epoch: 375, median_reward: 904.8439966389977, dev: 4524.219983194988
2021-08-18:16:52:27,547 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6424, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:16:52:27,548 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4982.6836, eval_time 0.6902, test_loss 3.6424, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:16:52:27,594 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9313, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:52:27,595 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4982.7193, eval_time 0.7346, test_loss 2.9313, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:52:27,613 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:52:27,622 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:27,664 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:52:27,666 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1036, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:52:27,668 INFO     [learner.py:656] After aggregation epoch 374, CumulTime 4982.8077, eval_time 0.811, test_loss 3.1036, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:52:27,678 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:52:27,738 INFO     [learner.py:526] ====Start train round 375
2021-08-18:16:52:27,767 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:29,246 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:29,266 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:29,932 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:29,942 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:30,489 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:52:30,502 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:31,577 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:31,586 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:32,339 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:32,352 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:32,517 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:32,527 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:32,660 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:32,670 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:33,97 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:33,107 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:33,338 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:33,347 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:33,704 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:33,726 INFO     [learner.py:606] ====Pushing takes 0.019825458526611328 s
2021-08-18:16:52:33,751 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:33,757 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:52:33,758 INFO     [param_server.py:410] Lock worker 1 with localStep 375 , while globalStep is 374

2021-08-18:16:52:34,193 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:34,203 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:35,964 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:35,978 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:36,550 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:36,563 INFO     [learner.py:606] ====Pushing takes 0.01147007942199707 s
2021-08-18:16:52:36,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:36,585 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:52:36,586 INFO     [param_server.py:410] Lock worker 2 with localStep 375 , while globalStep is 374

2021-08-18:16:52:37,170 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:37,181 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:38,934 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:38,948 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:39,608 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:39,633 INFO     [learner.py:606] ====Pushing takes 0.02370429039001465 s
2021-08-18:16:52:39,662 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:39,673 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:52:39,674 INFO     [param_server.py:381] ====After aggregation in epoch: 374, virtual_clock: 16354.048830877638, top_1: : 67.7638 % (2100.0), top_5: : 100.0 % (3099.0), test loss: 3.2257716462568005, test len: 3099.0
2021-08-18:16:52:39,676 INFO     [param_server.py:410] Lock worker 3 with localStep 375 , while globalStep is 375

2021-08-18:16:52:39,677 INFO     [param_server.py:441] ====Epoch 376 completes 16 clients with loss 6.893178987180367, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:39,677 INFO     [param_server.py:450] ====Start to sample for epoch 376, global virtualClock: 16354.048830877638, round_duration: 70.62176153567286
2021-08-18:16:52:39,678 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 6, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:39,972 INFO     [param_server.py:553] For epoch: 376, median_reward: 1140.296495915377, dev: 5701.4824795768845
2021-08-18:16:52:40,773 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.964, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:16:52:40,774 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 4995.8981, eval_time 0.7592, test_loss 2.964, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:16:52:40,772 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5532, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:16:52:40,775 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 4995.9113, eval_time 0.7653, test_loss 3.5532, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:16:52:40,834 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:40,842 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:40,849 INFO     [learner.py:165] Start to run client 6 on rank 3...
2021-08-18:16:52:40,850 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:40,852 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1947, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:52:40,853 INFO     [learner.py:656] After aggregation epoch 375, CumulTime 4995.9921, eval_time 0.8475, test_loss 3.1947, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:52:40,923 INFO     [learner.py:526] ====Start train round 376
2021-08-18:16:52:40,945 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:42,250 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:42,260 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:43,94 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:43,106 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:43,616 INFO     [learner.py:439] Completed to run client 6
2021-08-18:16:52:43,630 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:44,492 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:44,506 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:45,275 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:45,289 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:45,964 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:45,974 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:52:46,26 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:52:46,40 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:52:46,77 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:46,88 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:46,691 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:52:46,711 INFO     [learner.py:606] ====Pushing takes 0.018606185913085938 s
2021-08-18:16:52:46,747 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:46,753 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.0625, now collected 5 clients
2021-08-18:16:52:46,754 INFO     [param_server.py:410] Lock worker 1 with localStep 376 , while globalStep is 375

2021-08-18:16:52:46,854 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:46,864 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:47,616 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:52:47,630 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:52:49,671 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:52:49,695 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:52:50,67 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:52:50,82 INFO     [learner.py:606] ====Pushing takes 0.013308525085449219 s
2021-08-18:16:52:50,97 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:50,101 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.0625, now collected 9 clients
2021-08-18:16:52:50,102 INFO     [param_server.py:410] Lock worker 2 with localStep 376 , while globalStep is 375

2021-08-18:16:52:50,987 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:52:51,1 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:52:52,863 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:52:52,872 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:52:53,573 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:52:53,600 INFO     [learner.py:606] ====Pushing takes 0.026081562042236328 s
2021-08-18:16:52:53,630 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:52:53,637 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.0625, now collected 16 clients
2021-08-18:16:52:53,638 INFO     [param_server.py:381] ====After aggregation in epoch: 375, virtual_clock: 16424.670592413313, top_1: : 65.1178 % (2018.0), top_5: : 100.0 % (3099.0), test loss: 3.2372953197592764, test len: 3099.0
2021-08-18:16:52:53,640 INFO     [param_server.py:410] Lock worker 3 with localStep 376 , while globalStep is 376

2021-08-18:16:52:53,641 INFO     [param_server.py:441] ====Epoch 377 completes 16 clients with loss 5.1754249026237815, sampled rewards are: 
 {5: 0, 6: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:52:53,641 INFO     [param_server.py:450] ====Start to sample for epoch 377, global virtualClock: 16424.670592413313, round_duration: 70.62176153567286
2021-08-18:16:52:53,642 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:52:53,919 INFO     [param_server.py:553] For epoch: 377, median_reward: 1075.0735106658612, dev: 5375.367553329306
2021-08-18:16:52:54,606 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3001, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:16:52:54,607 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5009.7463, eval_time 0.6772, test_loss 4.3001, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:16:52:54,608 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7847, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:52:54,609 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5009.7452, eval_time 0.6785, test_loss 3.7847, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:52:54,610 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3824, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:16:52:54,611 INFO     [learner.py:656] After aggregation epoch 376, CumulTime 5009.7357, eval_time 0.6794, test_loss 3.3824, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:16:52:54,675 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:54,680 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:54,680 INFO     [learner.py:526] ====Start train round 377
2021-08-18:16:52:54,684 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:52:54,687 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:52:54,687 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:52:56,151 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:52:56,172 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:52:56,860 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:52:56,869 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:52:57,69 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:52:57,83 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:52:57,822 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:52:57,833 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:52:58,807 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:52:58,835 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:52:59,597 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:52:59,611 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:52:59,744 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:52:59,758 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:00,384 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:00,404 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:00,518 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:00,532 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:01,77 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:01,97 INFO     [learner.py:606] ====Pushing takes 0.019273757934570312 s
2021-08-18:16:53:01,127 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:01,135 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:01,135 INFO     [param_server.py:410] Lock worker 1 with localStep 377 , while globalStep is 376

2021-08-18:16:53:01,404 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:01,414 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:01,932 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:01,946 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:03,598 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:03,639 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:03,653 INFO     [learner.py:606] ====Pushing takes 0.012531757354736328 s
2021-08-18:16:53:03,669 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:03,670 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:03,673 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:03,674 INFO     [param_server.py:410] Lock worker 2 with localStep 377 , while globalStep is 376

2021-08-18:16:53:04,283 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:04,309 INFO     [learner.py:606] ====Pushing takes 0.02454519271850586 s
2021-08-18:16:53:04,335 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:04,341 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:04,342 INFO     [param_server.py:381] ====After aggregation in epoch: 376, virtual_clock: 16498.536247355445, top_1: : 68.1833 % (2113.0), top_5: : 100.0 % (3099.0), test loss: 3.8224118771376436, test len: 3099.0
2021-08-18:16:53:04,344 INFO     [param_server.py:410] Lock worker 3 with localStep 377 , while globalStep is 377

2021-08-18:16:53:04,345 INFO     [param_server.py:441] ====Epoch 378 completes 15 clients with loss 5.857515965557336, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:04,345 INFO     [param_server.py:450] ====Start to sample for epoch 378, global virtualClock: 16498.536247355445, round_duration: 73.86565494213346
2021-08-18:16:53:04,346 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:04,621 INFO     [param_server.py:553] For epoch: 378, median_reward: 1159.5096809508395, dev: 5797.548404754198
2021-08-18:16:53:05,295 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5903, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:16:53:05,299 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5020.4379, eval_time 0.6544, test_loss 3.5903, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:16:53:05,300 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8794, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:53:05,300 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5020.4361, eval_time 0.6536, test_loss 3.8794, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:53:05,301 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1331, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:53:05,301 INFO     [learner.py:656] After aggregation epoch 377, CumulTime 5020.4258, eval_time 0.6525, test_loss 3.1331, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:53:05,394 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:53:05,421 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:05,440 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:53:05,440 INFO     [learner.py:526] ====Start train round 378
2021-08-18:16:53:05,449 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:05,450 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:07,32 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:07,53 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:07,725 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:07,734 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:07,797 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:07,808 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:08,511 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:08,527 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:09,378 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:09,398 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:10,185 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:10,205 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:10,558 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:10,567 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:10,866 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:10,886 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:11,511 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:11,522 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:11,531 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:11,542 INFO     [learner.py:606] ====Pushing takes 0.01923537254333496 s
2021-08-18:16:53:11,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:11,584 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:11,585 INFO     [param_server.py:410] Lock worker 1 with localStep 378 , while globalStep is 377

2021-08-18:16:53:12,147 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:12,156 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:12,913 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:12,934 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:14,525 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:14,540 INFO     [learner.py:606] ====Pushing takes 0.012470483779907227 s
2021-08-18:16:53:14,564 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:14,569 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:14,569 INFO     [param_server.py:410] Lock worker 2 with localStep 378 , while globalStep is 377

2021-08-18:16:53:14,696 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:14,706 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:15,444 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:15,469 INFO     [learner.py:606] ====Pushing takes 0.023497819900512695 s
2021-08-18:16:53:15,496 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:15,502 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:15,503 INFO     [param_server.py:381] ====After aggregation in epoch: 377, virtual_clock: 16572.401902297577, top_1: : 64.9242 % (2012.0), top_5: : 100.0 % (3099.0), test loss: 3.5342713991800943, test len: 3099.0
2021-08-18:16:53:15,505 INFO     [param_server.py:410] Lock worker 3 with localStep 378 , while globalStep is 378

2021-08-18:16:53:15,505 INFO     [param_server.py:441] ====Epoch 379 completes 15 clients with loss 6.620237455630872, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:15,505 INFO     [param_server.py:450] ====Start to sample for epoch 379, global virtualClock: 16572.401902297577, round_duration: 73.86565494213346
2021-08-18:16:53:15,506 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:15,782 INFO     [param_server.py:553] For epoch: 379, median_reward: 1175.2110805599782, dev: 5876.055402799891
2021-08-18:16:53:16,415 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2382, Top-1 Accuracy: 723.0/1033 (0.6999), Top-5 Accuracy: 1.0
2021-08-18:16:53:16,416 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5031.5551, eval_time 0.6219, test_loss 3.2382, test_accuracy 0.6999, test_5_accuracy 1.0 

2021-08-18:16:53:16,419 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2201, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:53:16,420 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5031.5562, eval_time 0.6247, test_loss 3.2201, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:53:16,425 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.237, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:53:16,426 INFO     [learner.py:656] After aggregation epoch 378, CumulTime 5031.5505, eval_time 0.6289, test_loss 3.237, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:53:16,482 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:53:16,487 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:53:16,490 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:16,496 INFO     [learner.py:526] ====Start train round 379
2021-08-18:16:53:16,496 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:16,504 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:17,829 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:17,839 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:18,724 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:18,737 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:18,831 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:18,845 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:19,803 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:19,817 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:20,262 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:20,289 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:21,196 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:21,225 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:21,439 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:21,448 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:22,126 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:22,153 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:22,505 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:22,514 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:22,792 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:22,813 INFO     [learner.py:606] ====Pushing takes 0.01979517936706543 s
2021-08-18:16:53:22,848 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:22,856 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:22,856 INFO     [param_server.py:410] Lock worker 1 with localStep 379 , while globalStep is 378

2021-08-18:16:53:23,242 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:23,255 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:24,14 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:24,33 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:25,647 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:25,662 INFO     [learner.py:606] ====Pushing takes 0.013563394546508789 s
2021-08-18:16:53:25,684 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:25,690 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:25,691 INFO     [param_server.py:410] Lock worker 2 with localStep 379 , while globalStep is 378

2021-08-18:16:53:25,812 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:25,822 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:26,477 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:26,501 INFO     [learner.py:606] ====Pushing takes 0.023725509643554688 s
2021-08-18:16:53:26,530 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:26,537 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:26,537 INFO     [param_server.py:381] ====After aggregation in epoch: 378, virtual_clock: 16646.26755723971, top_1: : 68.1833 % (2113.0), top_5: : 100.0 % (3099.0), test loss: 3.2317608771500765, test len: 3099.0
2021-08-18:16:53:26,541 INFO     [param_server.py:410] Lock worker 3 with localStep 379 , while globalStep is 379

2021-08-18:16:53:26,541 INFO     [param_server.py:441] ====Epoch 380 completes 15 clients with loss 6.462506199520128, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:26,542 INFO     [param_server.py:450] ====Start to sample for epoch 380, global virtualClock: 16646.26755723971, round_duration: 73.86565494213346
2021-08-18:16:53:26,543 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:26,873 INFO     [param_server.py:553] For epoch: 380, median_reward: 1278.9388726551451, dev: 6394.694363275726
2021-08-18:16:53:27,486 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3731, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:53:27,489 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5042.6284, eval_time 0.6046, test_loss 3.3731, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:53:27,492 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5419, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:53:27,492 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5042.6284, eval_time 0.6057, test_loss 3.5419, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:53:27,497 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8979, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:53:27,498 INFO     [learner.py:656] After aggregation epoch 379, CumulTime 5042.6226, eval_time 0.6108, test_loss 3.8979, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:53:27,553 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:53:27,560 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:53:27,561 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:27,569 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:27,570 INFO     [learner.py:526] ====Start train round 380
2021-08-18:16:53:27,579 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:29,85 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:29,112 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:29,845 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:29,855 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:30,6 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:30,19 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:30,648 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:30,662 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:31,511 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:31,525 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:32,374 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:32,395 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:32,472 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:32,484 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:33,254 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:33,263 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:33,275 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:33,278 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:33,905 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:33,926 INFO     [learner.py:606] ====Pushing takes 0.0189211368560791 s
2021-08-18:16:53:33,957 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:33,963 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:33,964 INFO     [param_server.py:410] Lock worker 1 with localStep 380 , while globalStep is 379

2021-08-18:16:53:34,77 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:34,89 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:34,672 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:34,690 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:36,451 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:36,461 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:36,500 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:36,516 INFO     [learner.py:606] ====Pushing takes 0.014118194580078125 s
2021-08-18:16:53:36,538 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:36,543 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:36,544 INFO     [param_server.py:410] Lock worker 2 with localStep 380 , while globalStep is 379

2021-08-18:16:53:37,154 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:37,181 INFO     [learner.py:606] ====Pushing takes 0.026027441024780273 s
2021-08-18:16:53:37,214 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:37,226 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:37,227 INFO     [param_server.py:381] ====After aggregation in epoch: 379, virtual_clock: 16720.13321218184, top_1: : 66.0536 % (2047.0), top_5: : 100.0 % (3099.0), test loss: 3.6042995541184033, test len: 3099.0
2021-08-18:16:53:37,230 INFO     [param_server.py:410] Lock worker 3 with localStep 380 , while globalStep is 380

2021-08-18:16:53:37,230 INFO     [param_server.py:441] ====Epoch 381 completes 15 clients with loss 5.5726543364817, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:37,231 INFO     [param_server.py:450] ====Start to sample for epoch 381, global virtualClock: 16720.13321218184, round_duration: 73.86565494213346
2021-08-18:16:53:37,233 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:37,630 INFO     [param_server.py:541] Handle Wight 0.040578603744506836 | Send 0.398984432220459
2021-08-18:16:53:37,631 INFO     [param_server.py:553] For epoch: 381, median_reward: 1185.3592346200578, dev: 5926.796173100289
2021-08-18:16:53:38,305 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0452, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:53:38,307 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5053.432, eval_time 0.6541, test_loss 3.0452, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:53:38,349 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3634, Top-1 Accuracy: 719.0/1033 (0.696), Top-5 Accuracy: 1.0
2021-08-18:16:53:38,350 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5053.4896, eval_time 0.6971, test_loss 3.3634, test_accuracy 0.696, test_5_accuracy 1.0 

2021-08-18:16:53:38,354 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6794, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:53:38,355 INFO     [learner.py:656] After aggregation epoch 380, CumulTime 5053.4908, eval_time 0.7017, test_loss 3.6794, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:53:38,377 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:53:38,392 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:38,412 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:53:38,418 INFO     [learner.py:526] ====Start train round 381
2021-08-18:16:53:38,428 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:38,438 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:39,736 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:39,750 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:40,539 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:40,550 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:40,801 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:40,810 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:41,521 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:41,532 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:42,234 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:42,248 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:43,65 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:43,86 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:43,179 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:43,191 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:43,848 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:43,875 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:44,262 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:44,280 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:44,543 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:44,564 INFO     [learner.py:606] ====Pushing takes 0.01950860023498535 s
2021-08-18:16:53:44,593 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:44,603 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:44,603 INFO     [param_server.py:410] Lock worker 1 with localStep 381 , while globalStep is 380

2021-08-18:16:53:44,774 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:44,783 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:45,776 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:45,790 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:47,183 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:47,198 INFO     [learner.py:606] ====Pushing takes 0.013651132583618164 s
2021-08-18:16:53:47,220 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:47,225 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:47,226 INFO     [param_server.py:410] Lock worker 2 with localStep 381 , while globalStep is 380

2021-08-18:16:53:47,533 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:47,542 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:48,272 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:48,298 INFO     [learner.py:606] ====Pushing takes 0.02467823028564453 s
2021-08-18:16:53:48,328 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:48,334 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:48,335 INFO     [param_server.py:381] ====After aggregation in epoch: 380, virtual_clock: 16793.998867123973, top_1: : 66.9894 % (2076.0), top_5: : 100.0 % (3099.0), test loss: 3.362655410060176, test len: 3099.0
2021-08-18:16:53:48,338 INFO     [param_server.py:410] Lock worker 3 with localStep 381 , while globalStep is 381

2021-08-18:16:53:48,338 INFO     [param_server.py:441] ====Epoch 382 completes 15 clients with loss 7.014027197740391, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:48,339 INFO     [param_server.py:450] ====Start to sample for epoch 382, global virtualClock: 16793.998867123973, round_duration: 73.86565494213346
2021-08-18:16:53:48,339 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:48,669 INFO     [param_server.py:553] For epoch: 382, median_reward: 1021.4966059729354, dev: 5107.4830298646775
2021-08-18:16:53:49,368 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2996, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:53:49,370 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5064.5057, eval_time 0.6752, test_loss 3.2996, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:53:49,412 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5805, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:53:49,413 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5064.5524, eval_time 0.7207, test_loss 3.5805, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:53:49,417 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9415, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:53:49,418 INFO     [learner.py:656] After aggregation epoch 381, CumulTime 5064.5423, eval_time 0.723, test_loss 2.9415, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:53:49,439 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:49,447 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:53:49,480 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:49,484 INFO     [learner.py:526] ====Start train round 382
2021-08-18:16:53:49,496 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:53:49,498 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:53:50,842 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:53:50,851 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:53:51,703 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:53:51,713 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:53:51,832 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:53:51,841 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:53:52,521 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:53:52,530 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:53:53,463 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:53:53,491 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:53:54,379 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:53:54,400 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:53:54,547 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:53:54,561 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:53:55,135 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:53:55,150 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:53:55,187 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:53:55,207 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:53:55,912 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:53:55,933 INFO     [learner.py:606] ====Pushing takes 0.019328594207763672 s
2021-08-18:16:53:55,961 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:55,967 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:53:55,968 INFO     [param_server.py:410] Lock worker 1 with localStep 382 , while globalStep is 381

2021-08-18:16:53:56,106 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:53:56,117 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:53:56,513 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:53:56,528 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:53:58,329 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:53:58,339 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:53:58,469 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:53:58,483 INFO     [learner.py:606] ====Pushing takes 0.01263284683227539 s
2021-08-18:16:53:58,500 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:58,505 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:53:58,506 INFO     [param_server.py:410] Lock worker 2 with localStep 382 , while globalStep is 381

2021-08-18:16:53:58,966 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:53:58,991 INFO     [learner.py:606] ====Pushing takes 0.024244308471679688 s
2021-08-18:16:53:59,20 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:53:59,27 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:53:59,28 INFO     [param_server.py:381] ====After aggregation in epoch: 381, virtual_clock: 16867.864522066106, top_1: : 67.0862 % (2079.0), top_5: : 100.0 % (3099.0), test loss: 3.2739007296385587, test len: 3099.0
2021-08-18:16:53:59,31 INFO     [param_server.py:410] Lock worker 3 with localStep 382 , while globalStep is 382

2021-08-18:16:53:59,32 INFO     [param_server.py:441] ====Epoch 383 completes 15 clients with loss 5.498448924021787, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:53:59,32 INFO     [param_server.py:450] ====Start to sample for epoch 383, global virtualClock: 16867.864522066106, round_duration: 73.86565494213346
2021-08-18:16:53:59,33 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:53:59,372 INFO     [param_server.py:553] For epoch: 383, median_reward: 973.5233914552601, dev: 4867.616957276301
2021-08-18:16:54:00,21 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1563, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:54:00,22 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5075.1576, eval_time 0.623, test_loss 3.1563, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:54:00,63 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4082, Top-1 Accuracy: 720.0/1033 (0.697), Top-5 Accuracy: 1.0
2021-08-18:16:54:00,67 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5075.2063, eval_time 0.6709, test_loss 3.4082, test_accuracy 0.697, test_5_accuracy 1.0 

2021-08-18:16:54:00,67 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.8593, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:16:54:00,68 INFO     [learner.py:656] After aggregation epoch 382, CumulTime 5075.1924, eval_time 0.6667, test_loss 2.8593, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:16:54:00,78 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:54:00,87 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:00,135 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:54:00,136 INFO     [learner.py:526] ====Start train round 383
2021-08-18:16:54:00,148 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:54:00,149 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:01,657 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:01,678 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:02,442 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:02,451 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:02,543 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:54:02,553 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:03,316 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:03,328 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:03,905 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:03,919 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:04,573 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:04,593 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:05,230 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:05,242 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:05,405 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:05,425 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:05,936 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:05,955 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:05,996 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:06,18 INFO     [learner.py:606] ====Pushing takes 0.019669294357299805 s
2021-08-18:16:54:06,52 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:06,59 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:54:06,60 INFO     [param_server.py:410] Lock worker 1 with localStep 383 , while globalStep is 382

2021-08-18:16:54:06,817 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:06,827 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:07,375 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:07,386 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:09,19 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:09,33 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:09,344 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:09,360 INFO     [learner.py:606] ====Pushing takes 0.014599323272705078 s
2021-08-18:16:54:09,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:09,382 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:54:09,383 INFO     [param_server.py:410] Lock worker 2 with localStep 383 , while globalStep is 382

2021-08-18:16:54:09,965 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:09,991 INFO     [learner.py:606] ====Pushing takes 0.02430129051208496 s
2021-08-18:16:54:10,18 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:10,26 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:54:10,27 INFO     [param_server.py:381] ====After aggregation in epoch: 382, virtual_clock: 16941.730177008238, top_1: : 68.151 % (2112.0), top_5: : 100.0 % (3099.0), test loss: 3.1412530166131476, test len: 3099.0
2021-08-18:16:54:10,30 INFO     [param_server.py:410] Lock worker 3 with localStep 383 , while globalStep is 383

2021-08-18:16:54:10,30 INFO     [param_server.py:441] ====Epoch 384 completes 15 clients with loss 5.594877645355761, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:10,31 INFO     [param_server.py:450] ====Start to sample for epoch 384, global virtualClock: 16941.730177008238, round_duration: 73.86565494213346
2021-08-18:16:54:10,32 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:10,366 INFO     [param_server.py:553] For epoch: 384, median_reward: 982.1810753586793, dev: 4910.9053767933965
2021-08-18:16:54:11,56 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1702, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:16:54:11,57 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5086.1815, eval_time 0.6634, test_loss 3.1702, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:16:54:11,59 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6082, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:54:11,60 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5086.1958, eval_time 0.6673, test_loss 3.6082, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:54:11,67 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3728, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:54:11,67 INFO     [learner.py:656] After aggregation epoch 383, CumulTime 5086.2065, eval_time 0.6773, test_loss 3.3728, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:54:11,127 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:54:11,130 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:54:11,137 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:54:11,139 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:11,153 INFO     [learner.py:526] ====Start train round 384
2021-08-18:16:54:11,161 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:12,523 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:12,533 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:13,458 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:13,470 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:13,484 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:54:13,494 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:14,279 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:14,288 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:14,712 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:14,725 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:15,385 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:15,398 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:16,152 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:16,162 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:16,172 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:16,179 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:16,765 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:16,784 INFO     [learner.py:606] ====Pushing takes 0.017065048217773438 s
2021-08-18:16:54:16,786 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:16,799 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:16,809 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:16,815 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:54:16,816 INFO     [param_server.py:410] Lock worker 1 with localStep 384 , while globalStep is 383

2021-08-18:16:54:17,754 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:17,768 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:18,221 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:18,246 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:20,22 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:20,36 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:20,46 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:20,61 INFO     [learner.py:606] ====Pushing takes 0.013493776321411133 s
2021-08-18:16:54:20,77 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:20,81 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:54:20,82 INFO     [param_server.py:410] Lock worker 2 with localStep 384 , while globalStep is 383

2021-08-18:16:54:20,647 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:20,671 INFO     [learner.py:606] ====Pushing takes 0.022717952728271484 s
2021-08-18:16:54:20,701 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:20,708 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:54:20,752 INFO     [param_server.py:381] ====After aggregation in epoch: 383, virtual_clock: 17015.59583195037, top_1: : 66.1826 % (2051.0), top_5: : 100.0 % (3099.0), test loss: 3.383732084874753, test len: 3099.0
2021-08-18:16:54:20,755 INFO     [param_server.py:410] Lock worker 3 with localStep 384 , while globalStep is 384

2021-08-18:16:54:20,756 INFO     [param_server.py:441] ====Epoch 385 completes 15 clients with loss 6.008482159626716, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:20,757 INFO     [param_server.py:450] ====Start to sample for epoch 385, global virtualClock: 17015.59583195037, round_duration: 73.86565494213346
2021-08-18:16:54:20,759 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:21,140 INFO     [param_server.py:553] For epoch: 385, median_reward: 1102.0014288676964, dev: 5510.007144338482
2021-08-18:16:54:21,711 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0045, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:54:21,712 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5096.8371, eval_time 0.5596, test_loss 3.0045, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:54:21,715 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.633, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:54:21,715 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5096.8514, eval_time 0.563, test_loss 3.633, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:54:21,720 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0632, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:54:21,723 INFO     [learner.py:656] After aggregation epoch 384, CumulTime 5096.8623, eval_time 0.5706, test_loss 3.0632, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:54:21,780 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:54:21,782 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:54:21,787 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:54:21,789 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:21,818 INFO     [learner.py:526] ====Start train round 385
2021-08-18:16:54:21,830 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:23,63 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:23,72 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:23,860 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:23,872 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:23,926 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:54:23,936 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:24,657 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:24,668 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:25,560 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:25,581 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:26,600 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:26,620 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:26,703 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:26,714 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:27,381 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:27,382 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:27,402 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:27,403 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:28,6 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:28,27 INFO     [learner.py:606] ====Pushing takes 0.019017457962036133 s
2021-08-18:16:54:28,56 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:28,68 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:54:28,68 INFO     [param_server.py:410] Lock worker 1 with localStep 385 , while globalStep is 384

2021-08-18:16:54:28,243 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:28,252 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:28,854 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:28,865 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:30,557 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:30,576 INFO     [learner.py:606] ====Pushing takes 0.01409602165222168 s
2021-08-18:16:54:30,594 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:30,600 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:54:30,600 INFO     [param_server.py:410] Lock worker 2 with localStep 385 , while globalStep is 384

2021-08-18:16:54:30,635 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:30,645 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:31,314 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:31,342 INFO     [learner.py:606] ====Pushing takes 0.02626347541809082 s
2021-08-18:16:54:31,369 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:31,378 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:54:31,378 INFO     [param_server.py:381] ====After aggregation in epoch: 384, virtual_clock: 17089.461486892502, top_1: : 67.4088 % (2089.0), top_5: : 100.0 % (3099.0), test loss: 3.2335791543678005, test len: 3099.0
2021-08-18:16:54:31,381 INFO     [param_server.py:410] Lock worker 3 with localStep 385 , while globalStep is 385

2021-08-18:16:54:31,381 INFO     [param_server.py:441] ====Epoch 386 completes 15 clients with loss 5.030737596819361, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:31,382 INFO     [param_server.py:450] ====Start to sample for epoch 386, global virtualClock: 17089.461486892502, round_duration: 73.86565494213346
2021-08-18:16:54:31,382 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:31,661 INFO     [param_server.py:553] For epoch: 386, median_reward: 984.4955133437327, dev: 4922.477566718663
2021-08-18:16:54:32,338 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7016, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:54:32,339 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5107.4783, eval_time 0.6653, test_loss 3.7016, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:54:32,342 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0826, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:54:32,343 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5107.4675, eval_time 0.6686, test_loss 3.0826, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:54:32,343 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5506, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:16:54:32,344 INFO     [learner.py:656] After aggregation epoch 385, CumulTime 5107.4795, eval_time 0.6694, test_loss 3.5506, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:16:54:32,394 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:54:32,402 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:32,409 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:54:32,418 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:54:32,421 INFO     [learner.py:526] ====Start train round 386
2021-08-18:16:54:32,430 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:33,717 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:33,727 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:34,629 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:34,640 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:34,699 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:54:34,711 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:35,335 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:35,346 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:35,886 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:35,906 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:36,714 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:36,734 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:37,270 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:37,281 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:37,584 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:37,604 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:37,888 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:37,907 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:38,210 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:38,234 INFO     [learner.py:606] ====Pushing takes 0.019193410873413086 s
2021-08-18:16:54:38,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:38,265 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:54:38,266 INFO     [param_server.py:410] Lock worker 1 with localStep 386 , while globalStep is 385

2021-08-18:16:54:38,956 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:38,973 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:39,189 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:39,203 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:40,878 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:40,887 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:41,310 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:41,327 INFO     [learner.py:606] ====Pushing takes 0.015281438827514648 s
2021-08-18:16:54:41,353 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:41,358 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:54:41,359 INFO     [param_server.py:410] Lock worker 2 with localStep 386 , while globalStep is 385

2021-08-18:16:54:41,573 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:41,610 INFO     [learner.py:606] ====Pushing takes 0.03429985046386719 s
2021-08-18:16:54:41,643 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:41,650 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:54:41,650 INFO     [param_server.py:381] ====After aggregation in epoch: 385, virtual_clock: 17163.327141834634, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 3.4449260146529586, test len: 3099.0
2021-08-18:16:54:41,653 INFO     [param_server.py:410] Lock worker 3 with localStep 386 , while globalStep is 386

2021-08-18:16:54:41,654 INFO     [param_server.py:441] ====Epoch 387 completes 15 clients with loss 4.754031602569353, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:41,654 INFO     [param_server.py:450] ====Start to sample for epoch 387, global virtualClock: 17163.327141834634, round_duration: 73.86565494213346
2021-08-18:16:54:41,655 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 51, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:41,946 INFO     [param_server.py:553] For epoch: 387, median_reward: 1098.5304801758914, dev: 5492.652400879457
2021-08-18:16:54:42,600 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3229, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:16:54:42,602 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5117.7264, eval_time 0.63, test_loss 3.3229, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:16:54:42,609 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2401, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:54:42,610 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5117.7458, eval_time 0.6385, test_loss 3.2401, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:54:42,634 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2134, Top-1 Accuracy: 720.0/1033 (0.697), Top-5 Accuracy: 1.0
2021-08-18:16:54:42,635 INFO     [learner.py:656] After aggregation epoch 386, CumulTime 5117.7742, eval_time 0.6658, test_loss 3.2134, test_accuracy 0.697, test_5_accuracy 1.0 

2021-08-18:16:54:42,674 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:42,683 INFO     [learner.py:165] Start to run client 51 on rank 3...
2021-08-18:16:54:42,701 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:42,703 INFO     [learner.py:526] ====Start train round 387
2021-08-18:16:54:42,709 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:42,717 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:43,955 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:43,973 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:44,688 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:44,700 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:44,802 INFO     [learner.py:439] Completed to run client 51
2021-08-18:16:54:44,811 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:45,483 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:45,492 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:46,510 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:46,530 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:47,301 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:47,322 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:47,475 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:47,486 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:48,11 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:48,24 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:48,58 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:48,78 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:48,618 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:48,641 INFO     [learner.py:606] ====Pushing takes 0.021250009536743164 s
2021-08-18:16:54:48,668 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:48,677 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.06666666666666667, now collected 5 clients
2021-08-18:16:54:48,677 INFO     [param_server.py:410] Lock worker 1 with localStep 387 , while globalStep is 386

2021-08-18:16:54:49,49 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:49,67 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:49,285 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:49,298 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:50,960 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:50,973 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:51,349 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:54:51,364 INFO     [learner.py:606] ====Pushing takes 0.013304710388183594 s
2021-08-18:16:54:51,380 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:51,386 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.06666666666666667, now collected 9 clients
2021-08-18:16:54:51,387 INFO     [param_server.py:410] Lock worker 2 with localStep 387 , while globalStep is 386

2021-08-18:16:54:51,636 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:54:51,665 INFO     [learner.py:606] ====Pushing takes 0.027577638626098633 s
2021-08-18:16:54:51,694 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:51,702 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.06666666666666667, now collected 15 clients
2021-08-18:16:54:51,702 INFO     [param_server.py:381] ====After aggregation in epoch: 386, virtual_clock: 17237.192796776766, top_1: : 67.9251 % (2105.0), top_5: : 100.0 % (3099.0), test loss: 3.258779062165155, test len: 3099.0
2021-08-18:16:54:51,705 INFO     [param_server.py:410] Lock worker 3 with localStep 387 , while globalStep is 387

2021-08-18:16:54:51,705 INFO     [param_server.py:441] ====Epoch 388 completes 15 clients with loss 5.643459095221672, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 51: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:54:51,706 INFO     [param_server.py:450] ====Start to sample for epoch 388, global virtualClock: 17237.192796776766, round_duration: 73.86565494213346
2021-08-18:16:54:51,707 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:54:52,89 INFO     [param_server.py:553] For epoch: 388, median_reward: 1397.9609531062172, dev: 6989.804765531086
2021-08-18:16:54:52,671 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2002, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:54:52,672 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5127.7969, eval_time 0.5587, test_loss 3.2002, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:54:52,674 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0517, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:16:54:52,675 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5127.8112, eval_time 0.5616, test_loss 4.0517, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:16:54:52,700 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3158, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:54:52,702 INFO     [learner.py:656] After aggregation epoch 387, CumulTime 5127.8412, eval_time 0.5906, test_loss 3.3158, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:54:52,744 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:52,748 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:52,752 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:54:52,755 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:54:52,796 INFO     [learner.py:526] ====Start train round 388
2021-08-18:16:54:52,809 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:54:53,403 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:54:53,415 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:54:54,538 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:54:54,556 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:54:54,886 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:54:54,895 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:54:56,80 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:54:56,89 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:54:56,741 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:54:56,761 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:54:57,242 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:54:57,260 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:54:57,563 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:54:57,574 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:54:57,929 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:54:57,949 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:54:58,767 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:54:58,793 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:54:59,141 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:54:59,159 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:54:59,274 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:54:59,292 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:54:59,313 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:54:59,335 INFO     [learner.py:606] ====Pushing takes 0.020856380462646484 s
2021-08-18:16:54:59,362 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:54:59,369 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:54:59,370 INFO     [param_server.py:410] Lock worker 1 with localStep 388 , while globalStep is 387

2021-08-18:16:55:00,340 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:00,368 INFO     [learner.py:606] ====Pushing takes 0.025911808013916016 s
2021-08-18:16:55:00,393 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:00,398 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:00,399 INFO     [param_server.py:410] Lock worker 3 with localStep 388 , while globalStep is 387

2021-08-18:16:55:01,436 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:01,456 INFO     [learner.py:606] ====Pushing takes 0.01822209358215332 s
2021-08-18:16:55:01,473 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:01,477 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:01,477 INFO     [param_server.py:381] ====After aggregation in epoch: 387, virtual_clock: 17314.30234512536, top_1: : 65.86 % (2041.0), top_5: : 100.0 % (3099.0), test loss: 3.5225600280143596, test len: 3099.0
2021-08-18:16:55:01,480 INFO     [param_server.py:410] Lock worker 2 with localStep 388 , while globalStep is 388

2021-08-18:16:55:01,480 INFO     [param_server.py:441] ====Epoch 389 completes 14 clients with loss 6.399600289289888, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:01,481 INFO     [param_server.py:450] ====Start to sample for epoch 389, global virtualClock: 17314.30234512536, round_duration: 77.10954834859407
2021-08-18:16:55:01,481 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:01,714 INFO     [param_server.py:553] For epoch: 389, median_reward: 1229.3001357728328, dev: 6146.500678864164
2021-08-18:16:55:02,286 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0216, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:55:02,287 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5137.4229, eval_time 0.55, test_loss 3.0216, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:55:02,292 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7717, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:55:02,292 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5137.4169, eval_time 0.5531, test_loss 2.7717, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:55:02,325 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0372, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:16:55:02,327 INFO     [learner.py:656] After aggregation epoch 388, CumulTime 5137.4661, eval_time 0.5898, test_loss 3.0372, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:16:55:02,359 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:55:02,363 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:55:02,366 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:02,371 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:02,383 INFO     [learner.py:526] ====Start train round 389
2021-08-18:16:55:02,399 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:02,962 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:02,974 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:03,970 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:03,988 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:04,371 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:04,380 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:05,417 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:05,429 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:06,171 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:06,184 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:06,618 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:06,627 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:06,945 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:06,956 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:07,373 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:07,394 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:08,232 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:08,250 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:08,477 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:08,503 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:08,725 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:08,739 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:09,79 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:09,103 INFO     [learner.py:606] ====Pushing takes 0.022119760513305664 s
2021-08-18:16:55:09,145 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:09,160 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:09,161 INFO     [param_server.py:410] Lock worker 1 with localStep 389 , while globalStep is 388

2021-08-18:16:55:09,395 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:09,421 INFO     [learner.py:606] ====Pushing takes 0.02376842498779297 s
2021-08-18:16:55:09,446 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:09,451 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:09,452 INFO     [param_server.py:410] Lock worker 3 with localStep 389 , while globalStep is 388

2021-08-18:16:55:10,966 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:10,984 INFO     [learner.py:606] ====Pushing takes 0.016148805618286133 s
2021-08-18:16:55:11,3 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:11,8 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:11,9 INFO     [param_server.py:381] ====After aggregation in epoch: 388, virtual_clock: 17391.411893473956, top_1: : 67.6347 % (2096.0), top_5: : 100.0 % (3099.0), test loss: 2.943511439694299, test len: 3099.0
2021-08-18:16:55:11,12 INFO     [param_server.py:410] Lock worker 2 with localStep 389 , while globalStep is 389

2021-08-18:16:55:11,12 INFO     [param_server.py:441] ====Epoch 390 completes 14 clients with loss 6.15446578808355, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:11,13 INFO     [param_server.py:450] ====Start to sample for epoch 390, global virtualClock: 17391.411893473956, round_duration: 77.10954834859407
2021-08-18:16:55:11,13 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:11,270 INFO     [param_server.py:553] For epoch: 390, median_reward: 1186.3489339602859, dev: 5931.744669801429
2021-08-18:16:55:11,870 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3172, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:16:55:11,871 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5146.9961, eval_time 0.5761, test_loss 3.3172, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:16:55:11,884 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9047, Top-1 Accuracy: 642.0/1033 (0.6215), Top-5 Accuracy: 1.0
2021-08-18:16:55:11,885 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5147.0213, eval_time 0.5924, test_loss 3.9047, test_accuracy 0.6215, test_5_accuracy 1.0 

2021-08-18:16:55:11,923 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.9215, Top-1 Accuracy: 694.0/1033 (0.6718), Top-5 Accuracy: 1.0
2021-08-18:16:55:11,923 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:55:11,924 INFO     [learner.py:656] After aggregation epoch 389, CumulTime 5147.0627, eval_time 0.6305, test_loss 4.9215, test_accuracy 0.6718, test_5_accuracy 1.0 

2021-08-18:16:55:11,931 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:11,977 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:55:11,984 INFO     [learner.py:526] ====Start train round 390
2021-08-18:16:55:11,992 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:11,993 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:12,760 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:12,770 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:13,898 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:13,917 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:14,217 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:14,229 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:15,422 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:15,434 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:16,175 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:16,195 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:16,545 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:16,557 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:16,908 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:16,918 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:17,475 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:17,501 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:18,216 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:18,243 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:18,284 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:18,311 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:18,527 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:18,539 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:18,954 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:18,993 INFO     [learner.py:606] ====Pushing takes 0.03683161735534668 s
2021-08-18:16:55:19,21 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:19,28 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:19,32 INFO     [param_server.py:410] Lock worker 1 with localStep 390 , while globalStep is 389

2021-08-18:16:55:19,351 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:19,373 INFO     [learner.py:606] ====Pushing takes 0.020303010940551758 s
2021-08-18:16:55:19,397 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:19,403 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:19,404 INFO     [param_server.py:410] Lock worker 3 with localStep 390 , while globalStep is 389

2021-08-18:16:55:20,719 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:20,735 INFO     [learner.py:606] ====Pushing takes 0.013878345489501953 s
2021-08-18:16:55:20,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:20,757 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:20,758 INFO     [param_server.py:381] ====After aggregation in epoch: 389, virtual_clock: 17468.52144182255, top_1: : 64.8919 % (2011.0), top_5: : 100.0 % (3099.0), test loss: 4.047801119309885, test len: 3099.0
2021-08-18:16:55:20,760 INFO     [param_server.py:410] Lock worker 2 with localStep 390 , while globalStep is 390

2021-08-18:16:55:20,761 INFO     [param_server.py:441] ====Epoch 391 completes 14 clients with loss 6.4344571191615385, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:20,762 INFO     [param_server.py:450] ====Start to sample for epoch 391, global virtualClock: 17468.52144182255, round_duration: 77.10954834859407
2021-08-18:16:55:20,762 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:21,16 INFO     [param_server.py:553] For epoch: 391, median_reward: 1237.0602261020983, dev: 6185.301130510492
2021-08-18:16:55:21,667 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5567, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:55:21,669 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5156.7933, eval_time 0.6291, test_loss 3.5567, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:55:21,682 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 2.9744, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:55:21,683 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5156.819, eval_time 0.645, test_loss 2.9744, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:55:21,733 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 2.9612, Top-1 Accuracy: 724.0/1033 (0.7009), Top-5 Accuracy: 1.0
2021-08-18:16:55:21,734 INFO     [learner.py:656] After aggregation epoch 390, CumulTime 5156.8731, eval_time 0.696, test_loss 2.9612, test_accuracy 0.7009, test_5_accuracy 1.0 

2021-08-18:16:55:21,739 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:55:21,748 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:21,761 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:55:21,770 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:21,802 INFO     [learner.py:526] ====Start train round 391
2021-08-18:16:55:21,813 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:22,465 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:22,474 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:23,592 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:23,610 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:23,870 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:23,886 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:25,121 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:25,135 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:26,75 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:26,95 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:26,159 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:26,170 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:26,510 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:26,521 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:27,264 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:27,291 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:28,126 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:28,129 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:28,138 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:28,144 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:28,144 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:28,165 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:28,681 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:28,708 INFO     [learner.py:606] ====Pushing takes 0.025483369827270508 s
2021-08-18:16:55:28,742 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:28,750 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:28,751 INFO     [param_server.py:410] Lock worker 1 with localStep 391 , while globalStep is 390

2021-08-18:16:55:29,181 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:29,208 INFO     [learner.py:606] ====Pushing takes 0.025311708450317383 s
2021-08-18:16:55:29,234 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:29,241 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:29,242 INFO     [param_server.py:410] Lock worker 3 with localStep 391 , while globalStep is 390

2021-08-18:16:55:30,311 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:30,326 INFO     [learner.py:606] ====Pushing takes 0.013678789138793945 s
2021-08-18:16:55:30,343 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:30,348 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:30,349 INFO     [param_server.py:381] ====After aggregation in epoch: 390, virtual_clock: 17545.630990171147, top_1: : 67.9897 % (2107.0), top_5: : 100.0 % (3099.0), test loss: 3.164071062096843, test len: 3099.0
2021-08-18:16:55:30,352 INFO     [param_server.py:410] Lock worker 2 with localStep 391 , while globalStep is 391

2021-08-18:16:55:30,353 INFO     [param_server.py:441] ====Epoch 392 completes 14 clients with loss 6.241633811620663, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:30,353 INFO     [param_server.py:450] ====Start to sample for epoch 392, global virtualClock: 17545.630990171147, round_duration: 77.10954834859407
2021-08-18:16:55:30,354 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:30,593 INFO     [param_server.py:553] For epoch: 392, median_reward: 1045.7907214095287, dev: 5228.953607047643
2021-08-18:16:55:31,181 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1703, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:55:31,181 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6382, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:55:31,182 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5166.3067, eval_time 0.5647, test_loss 3.1703, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:55:31,182 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5166.3182, eval_time 0.5649, test_loss 3.6382, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:55:31,210 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0856, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:16:55:31,211 INFO     [learner.py:656] After aggregation epoch 391, CumulTime 5166.3506, eval_time 0.5962, test_loss 4.0856, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:16:55:31,248 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:55:31,249 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:55:31,256 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:31,256 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:31,289 INFO     [learner.py:526] ====Start train round 392
2021-08-18:16:55:31,303 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:31,872 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:31,881 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:33,58 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:33,76 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:33,307 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:33,319 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:34,505 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:34,516 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:35,534 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:35,555 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:35,583 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:35,594 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:36,29 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:36,38 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:36,685 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:36,712 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:37,255 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:37,275 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:37,459 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:37,486 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:37,606 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:37,619 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:38,66 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:38,85 INFO     [learner.py:606] ====Pushing takes 0.017440080642700195 s
2021-08-18:16:55:38,113 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:38,118 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:38,119 INFO     [param_server.py:410] Lock worker 1 with localStep 392 , while globalStep is 391

2021-08-18:16:55:38,499 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:38,521 INFO     [learner.py:606] ====Pushing takes 0.020309925079345703 s
2021-08-18:16:55:38,548 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:38,553 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:38,553 INFO     [param_server.py:410] Lock worker 3 with localStep 392 , while globalStep is 391

2021-08-18:16:55:39,824 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:39,844 INFO     [learner.py:606] ====Pushing takes 0.01240086555480957 s
2021-08-18:16:55:39,863 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:39,867 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:39,868 INFO     [param_server.py:381] ====After aggregation in epoch: 391, virtual_clock: 17622.74053851974, top_1: : 66.7635 % (2069.0), top_5: : 100.0 % (3099.0), test loss: 3.631364795896742, test len: 3099.0
2021-08-18:16:55:39,871 INFO     [param_server.py:410] Lock worker 2 with localStep 392 , while globalStep is 392

2021-08-18:16:55:39,872 INFO     [param_server.py:441] ====Epoch 393 completes 14 clients with loss 5.689061686492951, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:39,872 INFO     [param_server.py:450] ====Start to sample for epoch 393, global virtualClock: 17622.74053851974, round_duration: 77.10954834859407
2021-08-18:16:55:39,873 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:40,213 INFO     [param_server.py:553] For epoch: 393, median_reward: 1186.969968786503, dev: 5934.849843932515
2021-08-18:16:55:40,777 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9511, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:55:40,778 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5175.9139, eval_time 0.5405, test_loss 3.9511, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:55:40,800 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9996, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:16:55:40,801 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5175.9261, eval_time 0.5641, test_loss 2.9996, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:16:55:40,819 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1928, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:16:55:40,821 INFO     [learner.py:656] After aggregation epoch 392, CumulTime 5175.9601, eval_time 0.5857, test_loss 3.1928, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:16:55:40,833 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:40,843 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:40,872 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:40,880 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:40,916 INFO     [learner.py:526] ====Start train round 393
2021-08-18:16:55:40,932 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:41,519 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:41,528 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:42,595 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:42,608 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:42,975 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:42,987 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:44,342 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:44,353 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:45,37 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:45,51 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:45,516 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:45,525 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:45,792 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:45,801 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:46,285 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:46,312 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:47,138 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:47,165 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:47,329 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:47,349 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:47,370 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:47,384 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:47,703 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:47,736 INFO     [learner.py:606] ====Pushing takes 0.016849517822265625 s
2021-08-18:16:55:47,766 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:47,775 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:47,775 INFO     [param_server.py:410] Lock worker 1 with localStep 393 , while globalStep is 392

2021-08-18:16:55:48,460 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:48,486 INFO     [learner.py:606] ====Pushing takes 0.024358272552490234 s
2021-08-18:16:55:48,514 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:48,521 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:48,522 INFO     [param_server.py:410] Lock worker 3 with localStep 393 , while globalStep is 392

2021-08-18:16:55:49,723 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:49,744 INFO     [learner.py:606] ====Pushing takes 0.017808914184570312 s
2021-08-18:16:55:49,760 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:49,765 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:49,766 INFO     [param_server.py:381] ====After aggregation in epoch: 392, virtual_clock: 17699.850086868337, top_1: : 64.6983 % (2005.0), top_5: : 100.0 % (3099.0), test loss: 3.38116286529435, test len: 3099.0
2021-08-18:16:55:49,768 INFO     [param_server.py:410] Lock worker 2 with localStep 393 , while globalStep is 393

2021-08-18:16:55:49,769 INFO     [param_server.py:441] ====Epoch 394 completes 14 clients with loss 4.5939899179029995, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:49,769 INFO     [param_server.py:450] ====Start to sample for epoch 394, global virtualClock: 17699.850086868337, round_duration: 77.10954834859407
2021-08-18:16:55:49,770 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:50,76 INFO     [param_server.py:553] For epoch: 394, median_reward: 1277.1293927035072, dev: 6385.646963517536
2021-08-18:16:55:50,661 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9008, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:55:50,662 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5185.787, eval_time 0.5641, test_loss 2.9008, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:55:50,663 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.348, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:16:55:50,665 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5185.8006, eval_time 0.5663, test_loss 3.348, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:16:55:50,707 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1708, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:16:55:50,710 INFO     [learner.py:656] After aggregation epoch 393, CumulTime 5185.8495, eval_time 0.612, test_loss 3.1708, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:16:55:50,729 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:50,737 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:55:50,765 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:50,772 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:55:50,782 INFO     [learner.py:526] ====Start train round 394
2021-08-18:16:55:50,795 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:55:51,335 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:55:51,345 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:55:52,561 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:55:52,580 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:55:52,905 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:55:52,915 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:55:54,20 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:55:54,29 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:55:55,65 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:55:55,85 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:55:55,417 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:55:55,429 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:55:55,511 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:55:55,523 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:55:56,447 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:55:56,474 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:55:57,245 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:55:57,256 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:55:57,299 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:55:57,319 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:55:57,335 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:55:57,349 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:55:57,848 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:55:57,866 INFO     [learner.py:606] ====Pushing takes 0.016753435134887695 s
2021-08-18:16:55:57,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:57,905 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:55:57,906 INFO     [param_server.py:410] Lock worker 1 with localStep 394 , while globalStep is 393

2021-08-18:16:55:58,426 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:55:58,457 INFO     [learner.py:606] ====Pushing takes 0.02655649185180664 s
2021-08-18:16:55:58,482 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:58,487 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:55:58,488 INFO     [param_server.py:410] Lock worker 3 with localStep 394 , while globalStep is 393

2021-08-18:16:55:59,486 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:55:59,504 INFO     [learner.py:606] ====Pushing takes 0.014136314392089844 s
2021-08-18:16:55:59,522 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:55:59,527 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:55:59,527 INFO     [param_server.py:381] ====After aggregation in epoch: 393, virtual_clock: 17776.959635216932, top_1: : 67.8283 % (2102.0), top_5: : 100.0 % (3099.0), test loss: 3.1398959705709584, test len: 3099.0
2021-08-18:16:55:59,530 INFO     [param_server.py:410] Lock worker 2 with localStep 394 , while globalStep is 394

2021-08-18:16:55:59,531 INFO     [param_server.py:441] ====Epoch 395 completes 14 clients with loss 4.154711398429992, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:55:59,531 INFO     [param_server.py:450] ====Start to sample for epoch 395, global virtualClock: 17776.959635216932, round_duration: 77.10954834859407
2021-08-18:16:55:59,532 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:55:59,789 INFO     [param_server.py:553] For epoch: 395, median_reward: 1433.1956698178187, dev: 7165.978349089093
2021-08-18:16:56:00,365 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2588, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:16:56:00,367 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5195.5029, eval_time 0.5559, test_loss 4.2588, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:16:56:00,409 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5482, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:56:00,410 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5195.5344, eval_time 0.5981, test_loss 3.5482, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:56:00,430 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4843, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:16:56:00,432 INFO     [learner.py:656] After aggregation epoch 394, CumulTime 5195.5709, eval_time 0.6208, test_loss 3.4843, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:16:56:00,435 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:56:00,443 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:00,484 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:56:00,493 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:00,534 INFO     [learner.py:526] ====Start train round 395
2021-08-18:16:56:00,547 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:01,147 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:01,156 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:02,171 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:02,185 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:02,567 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:02,576 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:03,661 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:03,672 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:04,359 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:04,379 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:04,783 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:04,792 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:05,195 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:05,209 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:05,686 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:05,713 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:06,533 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:06,539 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:06,560 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:06,566 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:06,780 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:06,792 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:07,150 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:07,173 INFO     [learner.py:606] ====Pushing takes 0.02160024642944336 s
2021-08-18:16:56:07,201 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:07,214 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:07,215 INFO     [param_server.py:410] Lock worker 1 with localStep 395 , while globalStep is 394

2021-08-18:16:56:07,691 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:07,712 INFO     [learner.py:606] ====Pushing takes 0.019931554794311523 s
2021-08-18:16:56:07,739 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:07,745 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:07,746 INFO     [param_server.py:410] Lock worker 3 with localStep 395 , while globalStep is 394

2021-08-18:16:56:08,985 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:09,1 INFO     [learner.py:606] ====Pushing takes 0.015157699584960938 s
2021-08-18:16:56:09,18 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:09,22 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:09,23 INFO     [param_server.py:381] ====After aggregation in epoch: 394, virtual_clock: 17854.069183565527, top_1: : 66.9571 % (2075.0), top_5: : 100.0 % (3099.0), test loss: 3.7637902983912714, test len: 3099.0
2021-08-18:16:56:09,25 INFO     [param_server.py:410] Lock worker 2 with localStep 395 , while globalStep is 395

2021-08-18:16:56:09,26 INFO     [param_server.py:441] ====Epoch 396 completes 14 clients with loss 9.105710172879691, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:09,26 INFO     [param_server.py:450] ====Start to sample for epoch 396, global virtualClock: 17854.069183565527, round_duration: 77.10954834859407
2021-08-18:16:56:09,27 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:09,283 INFO     [param_server.py:553] For epoch: 396, median_reward: 1464.457440531847, dev: 7322.287202659235
2021-08-18:16:56:09,814 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4937, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:16:56:09,815 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5204.9509, eval_time 0.509, test_loss 3.4937, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:16:56:09,819 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9601, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:56:09,820 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5204.9443, eval_time 0.5137, test_loss 2.9601, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:56:09,851 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1988, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:56:09,855 INFO     [learner.py:656] After aggregation epoch 395, CumulTime 5204.9939, eval_time 0.549, test_loss 3.1988, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:56:09,902 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:56:09,911 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:09,914 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:56:09,923 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:09,924 INFO     [learner.py:526] ====Start train round 396
2021-08-18:16:56:09,940 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:10,616 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:10,625 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:11,921 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:11,935 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:12,423 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:12,434 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:13,438 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:13,451 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:14,255 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:14,274 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:14,674 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:14,688 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:15,89 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:15,101 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:15,481 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:15,508 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:16,353 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:16,380 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:16,594 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:16,614 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:16,810 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:16,822 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:16,985 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:17,8 INFO     [learner.py:606] ====Pushing takes 0.022328615188598633 s
2021-08-18:16:56:17,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:17,62 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:17,63 INFO     [param_server.py:410] Lock worker 1 with localStep 396 , while globalStep is 395

2021-08-18:16:56:17,742 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:17,762 INFO     [learner.py:606] ====Pushing takes 0.019129276275634766 s
2021-08-18:16:56:17,786 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:17,791 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:17,791 INFO     [param_server.py:410] Lock worker 3 with localStep 396 , while globalStep is 395

2021-08-18:16:56:18,940 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:18,958 INFO     [learner.py:606] ====Pushing takes 0.013955116271972656 s
2021-08-18:16:56:18,974 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:18,981 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:18,982 INFO     [param_server.py:381] ====After aggregation in epoch: 395, virtual_clock: 17931.178731914122, top_1: : 65.15 % (2019.0), top_5: : 100.0 % (3099.0), test loss: 3.2175462466699103, test len: 3099.0
2021-08-18:16:56:18,985 INFO     [param_server.py:410] Lock worker 2 with localStep 396 , while globalStep is 396

2021-08-18:16:56:18,986 INFO     [param_server.py:441] ====Epoch 397 completes 14 clients with loss 4.778665885182095, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:18,986 INFO     [param_server.py:450] ====Start to sample for epoch 397, global virtualClock: 17931.178731914122, round_duration: 77.10954834859407
2021-08-18:16:56:18,987 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:19,282 INFO     [param_server.py:553] For epoch: 397, median_reward: 1330.3946071986657, dev: 6651.973035993328
2021-08-18:16:56:19,857 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6114, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:16:56:19,858 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5214.9943, eval_time 0.551, test_loss 3.6114, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:16:56:19,857 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2719, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:56:19,861 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5214.9852, eval_time 0.5533, test_loss 3.2719, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:56:19,887 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2681, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:56:19,888 INFO     [learner.py:656] After aggregation epoch 396, CumulTime 5215.0271, eval_time 0.5829, test_loss 3.2681, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:56:19,927 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:56:19,928 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:56:19,935 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:19,935 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:19,968 INFO     [learner.py:526] ====Start train round 397
2021-08-18:16:56:19,983 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:20,684 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:20,693 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:21,747 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:21,761 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:22,161 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:22,172 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:23,271 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:23,282 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:24,286 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:24,307 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:24,321 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:24,330 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:24,719 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:24,730 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:25,572 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:25,599 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:26,243 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:26,255 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:26,261 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:26,265 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:26,406 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:26,427 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:26,964 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:26,983 INFO     [learner.py:606] ====Pushing takes 0.017740249633789062 s
2021-08-18:16:56:27,6 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:27,13 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:27,14 INFO     [param_server.py:410] Lock worker 1 with localStep 397 , while globalStep is 396

2021-08-18:16:56:27,372 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:27,392 INFO     [learner.py:606] ====Pushing takes 0.018492460250854492 s
2021-08-18:16:56:27,422 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:27,429 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:27,443 INFO     [param_server.py:410] Lock worker 3 with localStep 397 , while globalStep is 396

2021-08-18:16:56:28,547 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:28,565 INFO     [learner.py:606] ====Pushing takes 0.013748645782470703 s
2021-08-18:16:56:28,580 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:28,588 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:28,589 INFO     [param_server.py:381] ====After aggregation in epoch: 396, virtual_clock: 18008.288280262717, top_1: : 65.7954 % (2039.0), top_5: : 100.0 % (3099.0), test loss: 3.3838034323244184, test len: 3099.0
2021-08-18:16:56:28,592 INFO     [param_server.py:410] Lock worker 2 with localStep 397 , while globalStep is 397

2021-08-18:16:56:28,592 INFO     [param_server.py:441] ====Epoch 398 completes 14 clients with loss 6.629124915542581, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:28,593 INFO     [param_server.py:450] ====Start to sample for epoch 398, global virtualClock: 18008.288280262717, round_duration: 77.10954834859407
2021-08-18:16:56:28,593 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:28,858 INFO     [param_server.py:553] For epoch: 398, median_reward: 1208.1951580808677, dev: 6040.975790404338
2021-08-18:16:56:29,441 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.1755, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:56:29,442 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5224.5782, eval_time 0.5601, test_loss 3.1755, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:56:29,450 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.184, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:16:56:29,452 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5224.5767, eval_time 0.5699, test_loss 4.184, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:16:56:29,474 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1394, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:56:29,478 INFO     [learner.py:656] After aggregation epoch 397, CumulTime 5224.6172, eval_time 0.5966, test_loss 3.1394, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:56:29,512 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:56:29,521 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:29,529 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:56:29,537 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:29,548 INFO     [learner.py:526] ====Start train round 398
2021-08-18:16:56:29,564 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:30,122 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:30,131 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:31,161 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:31,184 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:31,482 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:31,491 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:32,604 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:32,615 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:33,382 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:33,396 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:33,880 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:33,891 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:34,49 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:34,61 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:34,642 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:34,669 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:35,452 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:35,479 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:35,666 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:35,678 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:35,797 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:35,815 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:36,46 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:36,68 INFO     [learner.py:606] ====Pushing takes 0.019980907440185547 s
2021-08-18:16:56:36,108 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:36,116 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:36,117 INFO     [param_server.py:410] Lock worker 1 with localStep 398 , while globalStep is 397

2021-08-18:16:56:36,756 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:36,781 INFO     [learner.py:606] ====Pushing takes 0.02325296401977539 s
2021-08-18:16:56:36,805 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:36,815 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:36,816 INFO     [param_server.py:410] Lock worker 3 with localStep 398 , while globalStep is 397

2021-08-18:16:56:37,794 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:37,814 INFO     [learner.py:606] ====Pushing takes 0.017571687698364258 s
2021-08-18:16:56:37,828 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:37,833 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:37,834 INFO     [param_server.py:381] ====After aggregation in epoch: 397, virtual_clock: 18085.397828611312, top_1: : 66.4408 % (2059.0), top_5: : 100.0 % (3099.0), test loss: 3.499634349787677, test len: 3099.0
2021-08-18:16:56:37,836 INFO     [param_server.py:410] Lock worker 2 with localStep 398 , while globalStep is 398

2021-08-18:16:56:37,837 INFO     [param_server.py:441] ====Epoch 399 completes 14 clients with loss 5.83687249878631, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:37,837 INFO     [param_server.py:450] ====Start to sample for epoch 399, global virtualClock: 18085.397828611312, round_duration: 77.10954834859407
2021-08-18:16:56:37,838 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:38,101 INFO     [param_server.py:553] For epoch: 399, median_reward: 1110.5433710184263, dev: 5552.7168550921315
2021-08-18:16:56:38,613 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3823, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:56:38,617 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5233.7532, eval_time 0.4937, test_loss 3.3823, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:56:38,626 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1194, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:56:38,629 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5233.7539, eval_time 0.5056, test_loss 3.1194, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:56:38,661 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1183, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:16:56:38,663 INFO     [learner.py:656] After aggregation epoch 398, CumulTime 5233.8019, eval_time 0.539, test_loss 3.1183, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:16:56:38,688 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:56:38,696 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:38,707 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:56:38,716 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:38,731 INFO     [learner.py:526] ====Start train round 399
2021-08-18:16:56:38,745 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:39,301 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:39,310 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:40,545 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:40,559 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:40,738 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:40,749 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:41,907 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:41,916 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:42,932 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:42,952 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:43,58 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:43,70 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:43,381 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:43,395 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:44,174 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:44,201 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:44,937 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:44,957 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:45,53 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:45,80 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:45,80 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:45,98 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:45,579 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:45,600 INFO     [learner.py:606] ====Pushing takes 0.019914627075195312 s
2021-08-18:16:56:45,630 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:45,637 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:45,637 INFO     [param_server.py:410] Lock worker 1 with localStep 399 , while globalStep is 398

2021-08-18:16:56:46,38 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:46,57 INFO     [learner.py:606] ====Pushing takes 0.018001556396484375 s
2021-08-18:16:56:46,84 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:46,93 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:46,93 INFO     [param_server.py:410] Lock worker 3 with localStep 399 , while globalStep is 398

2021-08-18:16:56:47,224 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:47,240 INFO     [learner.py:606] ====Pushing takes 0.014153242111206055 s
2021-08-18:16:56:47,257 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:47,263 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:47,264 INFO     [param_server.py:381] ====After aggregation in epoch: 398, virtual_clock: 18162.507376959908, top_1: : 67.2798 % (2085.0), top_5: : 100.0 % (3099.0), test loss: 3.206632985009088, test len: 3099.0
2021-08-18:16:56:47,267 INFO     [param_server.py:410] Lock worker 2 with localStep 399 , while globalStep is 399

2021-08-18:16:56:47,267 INFO     [param_server.py:441] ====Epoch 400 completes 14 clients with loss 4.57307307113169, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:47,268 INFO     [param_server.py:450] ====Start to sample for epoch 400, global virtualClock: 18162.507376959908, round_duration: 77.10954834859407
2021-08-18:16:56:47,269 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:47,549 INFO     [param_server.py:553] For epoch: 400, median_reward: 1393.4071241402237, dev: 6967.035620701118
2021-08-18:16:56:48,106 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1769, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:56:48,107 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5243.2313, eval_time 0.533, test_loss 3.1769, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:56:48,107 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7947, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:16:56:48,108 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5243.2437, eval_time 0.5363, test_loss 3.7947, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:16:56:48,139 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6033, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:16:56:48,143 INFO     [learner.py:656] After aggregation epoch 399, CumulTime 5243.2822, eval_time 0.5715, test_loss 3.6033, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:16:56:48,177 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:48,186 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:48,215 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:48,224 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:48,244 INFO     [learner.py:526] ====Start train round 400
2021-08-18:16:56:48,259 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:48,875 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:48,885 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:49,992 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:50,6 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:50,322 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:50,333 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:56:51,398 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:56:51,408 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:56:52,172 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:56:52,185 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:56:52,531 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:56:52,547 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:56:52,952 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:56:52,963 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:56:53,325 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:56:53,351 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:56:54,96 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:56:54,116 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:56:54,187 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:56:54,213 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:56:54,482 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:56:54,493 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:56:54,722 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:56:54,741 INFO     [learner.py:606] ====Pushing takes 0.018052101135253906 s
2021-08-18:16:56:54,770 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:54,775 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:56:54,776 INFO     [param_server.py:410] Lock worker 1 with localStep 400 , while globalStep is 399

2021-08-18:16:56:55,227 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:56:55,248 INFO     [learner.py:606] ====Pushing takes 0.020119667053222656 s
2021-08-18:16:56:55,274 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:55,279 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:56:55,280 INFO     [param_server.py:410] Lock worker 3 with localStep 400 , while globalStep is 399

2021-08-18:16:56:56,708 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:56:56,723 INFO     [learner.py:606] ====Pushing takes 0.013231992721557617 s
2021-08-18:16:56:56,743 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:56:56,747 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:56:56,748 INFO     [param_server.py:381] ====After aggregation in epoch: 399, virtual_clock: 18239.616925308503, top_1: : 65.7631 % (2038.0), top_5: : 100.0 % (3099.0), test loss: 3.524921395160534, test len: 3099.0
2021-08-18:16:56:56,751 INFO     [param_server.py:410] Lock worker 2 with localStep 400 , while globalStep is 400

2021-08-18:16:56:56,751 INFO     [param_server.py:441] ====Epoch 401 completes 14 clients with loss 7.060294264234686, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:56:56,751 INFO     [param_server.py:450] ====Start to sample for epoch 401, global virtualClock: 18239.616925308503, round_duration: 77.10954834859407
2021-08-18:16:56:56,752 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:56:57,15 INFO     [param_server.py:541] Handle Wight 0.02303600311279297 | Send 0.26326465606689453
2021-08-18:16:56:57,16 INFO     [param_server.py:553] For epoch: 401, median_reward: 1390.7872291781507, dev: 6953.936145890753
2021-08-18:16:56:57,636 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6178, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:16:56:57,637 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5252.7733, eval_time 0.6003, test_loss 3.6178, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:16:56:57,652 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.7716, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:16:56:57,653 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5252.7778, eval_time 0.6138, test_loss 2.7716, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:16:56:57,691 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0631, Top-1 Accuracy: 720.0/1033 (0.697), Top-5 Accuracy: 1.0
2021-08-18:16:56:57,692 INFO     [learner.py:656] After aggregation epoch 400, CumulTime 5252.8317, eval_time 0.6555, test_loss 3.0631, test_accuracy 0.697, test_5_accuracy 1.0 

2021-08-18:16:56:57,716 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:57,725 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:56:57,730 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:57,739 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:56:57,749 INFO     [learner.py:526] ====Start train round 401
2021-08-18:16:56:57,762 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:56:58,330 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:56:58,341 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:56:59,364 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:56:59,378 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:56:59,703 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:56:59,713 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:00,963 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:00,972 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:01,780 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:01,798 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:02,75 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:02,86 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:02,294 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:02,306 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:02,992 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:03,19 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:03,655 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:03,675 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:03,758 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:03,785 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:03,938 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:03,947 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:04,311 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:04,330 INFO     [learner.py:606] ====Pushing takes 0.01772165298461914 s
2021-08-18:16:57:04,355 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:04,359 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:04,362 INFO     [param_server.py:410] Lock worker 1 with localStep 401 , while globalStep is 400

2021-08-18:16:57:04,756 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:04,776 INFO     [learner.py:606] ====Pushing takes 0.017682313919067383 s
2021-08-18:16:57:04,798 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:04,804 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:04,819 INFO     [param_server.py:410] Lock worker 3 with localStep 401 , while globalStep is 400

2021-08-18:16:57:06,110 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:06,125 INFO     [learner.py:606] ====Pushing takes 0.01280975341796875 s
2021-08-18:16:57:06,145 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:06,151 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:06,152 INFO     [param_server.py:381] ====After aggregation in epoch: 400, virtual_clock: 18316.726473657098, top_1: : 67.1507 % (2081.0), top_5: : 100.0 % (3099.0), test loss: 3.1508156701370518, test len: 3099.0
2021-08-18:16:57:06,154 INFO     [param_server.py:410] Lock worker 2 with localStep 401 , while globalStep is 401

2021-08-18:16:57:06,155 INFO     [param_server.py:441] ====Epoch 402 completes 14 clients with loss 4.364729297143967, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:06,155 INFO     [param_server.py:450] ====Start to sample for epoch 402, global virtualClock: 18316.726473657098, round_duration: 77.10954834859407
2021-08-18:16:57:06,156 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:06,446 INFO     [param_server.py:553] For epoch: 402, median_reward: 1496.0327051471945, dev: 7480.163525735972
2021-08-18:16:57:06,964 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4209, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:16:57:06,966 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5262.0904, eval_time 0.4949, test_loss 3.4209, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:16:57:06,969 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.971, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:16:57:06,970 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5262.1063, eval_time 0.4995, test_loss 3.971, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:16:57:06,997 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6199, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:16:57:07,0 INFO     [learner.py:656] After aggregation epoch 401, CumulTime 5262.1396, eval_time 0.5317, test_loss 3.6199, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:16:57:07,36 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:57:07,45 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:57:07,45 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:07,53 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:07,68 INFO     [learner.py:526] ====Start train round 402
2021-08-18:16:57:07,82 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:07,738 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:07,748 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:08,861 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:08,875 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:09,274 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:09,283 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:10,374 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:10,383 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:11,381 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:11,394 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:11,698 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:11,713 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:11,848 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:11,860 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:12,662 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:12,689 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:13,334 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:13,352 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:13,493 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:13,520 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:13,542 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:13,568 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:14,94 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:14,124 INFO     [learner.py:606] ====Pushing takes 0.027698755264282227 s
2021-08-18:16:57:14,170 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:14,180 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:14,181 INFO     [param_server.py:410] Lock worker 1 with localStep 402 , while globalStep is 401

2021-08-18:16:57:14,664 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:14,689 INFO     [learner.py:606] ====Pushing takes 0.02332758903503418 s
2021-08-18:16:57:14,715 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:14,721 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:14,721 INFO     [param_server.py:410] Lock worker 3 with localStep 402 , while globalStep is 401

2021-08-18:16:57:15,692 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:15,707 INFO     [learner.py:606] ====Pushing takes 0.013925790786743164 s
2021-08-18:16:57:15,723 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:15,729 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:15,729 INFO     [param_server.py:381] ====After aggregation in epoch: 401, virtual_clock: 18393.836022005693, top_1: : 66.7635 % (2069.0), top_5: : 100.0 % (3099.0), test loss: 3.670618154384472, test len: 3099.0
2021-08-18:16:57:15,731 INFO     [param_server.py:410] Lock worker 2 with localStep 402 , while globalStep is 402

2021-08-18:16:57:15,732 INFO     [param_server.py:441] ====Epoch 403 completes 14 clients with loss 4.7949520262539265, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:15,732 INFO     [param_server.py:450] ====Start to sample for epoch 403, global virtualClock: 18393.836022005693, round_duration: 77.10954834859407
2021-08-18:16:57:15,733 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:15,999 INFO     [param_server.py:553] For epoch: 403, median_reward: 1041.6607098969578, dev: 5208.303549484789
2021-08-18:16:57:16,601 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0988, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:16:57:16,602 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5271.7262, eval_time 0.5763, test_loss 3.0988, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:16:57:16,620 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3495, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:16:57:16,621 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5271.757, eval_time 0.5958, test_loss 3.3495, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:16:57:16,656 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:57:16,657 INFO     [learner.py:656] After aggregation epoch 402, CumulTime 5271.7965, eval_time 0.6343, test_loss 4.5, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:57:16,669 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:57:16,678 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:16,688 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:57:16,696 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:16,726 INFO     [learner.py:526] ====Start train round 403
2021-08-18:16:57:16,742 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:17,443 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:17,457 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:18,485 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:18,499 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:18,860 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:18,871 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:19,980 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:19,989 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:20,875 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:20,889 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:21,347 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:21,358 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:21,615 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:21,642 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:21,955 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:21,975 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:22,709 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:22,736 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:23,77 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:23,104 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:23,301 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:23,324 INFO     [learner.py:606] ====Pushing takes 0.01810169219970703 s
2021-08-18:16:57:23,348 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:23,356 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:23,356 INFO     [param_server.py:410] Lock worker 1 with localStep 403 , while globalStep is 402

2021-08-18:16:57:23,439 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:23,453 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:24,305 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:24,325 INFO     [learner.py:606] ====Pushing takes 0.018809795379638672 s
2021-08-18:16:57:24,347 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:24,354 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:24,355 INFO     [param_server.py:410] Lock worker 3 with localStep 403 , while globalStep is 402

2021-08-18:16:57:25,723 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:25,738 INFO     [learner.py:606] ====Pushing takes 0.013324737548828125 s
2021-08-18:16:57:25,753 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:25,759 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:25,760 INFO     [param_server.py:381] ====After aggregation in epoch: 402, virtual_clock: 18470.945570354288, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 3.6494244381233494, test len: 3099.0
2021-08-18:16:57:25,763 INFO     [param_server.py:410] Lock worker 2 with localStep 403 , while globalStep is 403

2021-08-18:16:57:25,763 INFO     [param_server.py:441] ====Epoch 404 completes 14 clients with loss 3.864863370270599, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:25,763 INFO     [param_server.py:450] ====Start to sample for epoch 404, global virtualClock: 18470.945570354288, round_duration: 77.10954834859407
2021-08-18:16:57:25,764 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:26,63 INFO     [param_server.py:553] For epoch: 404, median_reward: 1122.8019874941083, dev: 5614.009937470541
2021-08-18:16:57:26,666 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4907, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:57:26,667 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5281.8035, eval_time 0.5794, test_loss 3.4907, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:57:26,669 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4151, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:57:26,670 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5281.795, eval_time 0.5822, test_loss 3.4151, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:57:26,712 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3888, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:16:57:26,713 INFO     [learner.py:656] After aggregation epoch 403, CumulTime 5281.8519, eval_time 0.6269, test_loss 3.3888, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:16:57:26,736 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:57:26,737 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:57:26,744 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:26,747 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:26,781 INFO     [learner.py:526] ====Start train round 404
2021-08-18:16:57:26,795 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:27,388 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:27,397 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:28,485 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:28,505 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:28,772 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:28,787 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:30,245 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:30,256 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:30,994 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:31,8 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:31,530 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:31,542 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:31,545 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:31,557 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:32,132 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:32,152 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:32,882 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:32,915 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:33,73 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:33,83 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:33,99 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:33,120 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:33,572 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:33,591 INFO     [learner.py:606] ====Pushing takes 0.01692676544189453 s
2021-08-18:16:57:33,613 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:33,619 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:33,619 INFO     [param_server.py:410] Lock worker 1 with localStep 404 , while globalStep is 403

2021-08-18:16:57:34,205 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:34,226 INFO     [learner.py:606] ====Pushing takes 0.019536733627319336 s
2021-08-18:16:57:34,247 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:34,253 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:34,253 INFO     [param_server.py:410] Lock worker 3 with localStep 404 , while globalStep is 403

2021-08-18:16:57:35,251 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:35,273 INFO     [learner.py:606] ====Pushing takes 0.0198519229888916 s
2021-08-18:16:57:35,288 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:35,292 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:35,293 INFO     [param_server.py:381] ====After aggregation in epoch: 403, virtual_clock: 18548.055118702883, top_1: : 67.0216 % (2077.0), top_5: : 100.0 % (3099.0), test loss: 3.431537217564053, test len: 3099.0
2021-08-18:16:57:35,295 INFO     [param_server.py:410] Lock worker 2 with localStep 404 , while globalStep is 404

2021-08-18:16:57:35,296 INFO     [param_server.py:441] ====Epoch 405 completes 14 clients with loss 5.8846546343310315, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:35,297 INFO     [param_server.py:450] ====Start to sample for epoch 405, global virtualClock: 18548.055118702883, round_duration: 77.10954834859407
2021-08-18:16:57:35,297 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:35,561 INFO     [param_server.py:553] For epoch: 405, median_reward: 1385.8974103432906, dev: 6929.487051716453
2021-08-18:16:57:36,115 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.0589, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:16:57:36,116 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5291.2524, eval_time 0.522, test_loss 3.0589, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:16:57:36,119 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2123, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:57:36,120 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5291.2445, eval_time 0.5256, test_loss 3.2123, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:57:36,177 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0275, Top-1 Accuracy: 725.0/1033 (0.7018), Top-5 Accuracy: 1.0
2021-08-18:16:57:36,178 INFO     [learner.py:656] After aggregation epoch 404, CumulTime 5291.3175, eval_time 0.5844, test_loss 3.0275, test_accuracy 0.7018, test_5_accuracy 1.0 

2021-08-18:16:57:36,189 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:57:36,196 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:36,230 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:57:36,239 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:36,248 INFO     [learner.py:526] ====Start train round 405
2021-08-18:16:57:36,264 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:36,857 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:36,867 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:38,168 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:38,186 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:38,554 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:38,565 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:39,713 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:39,726 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:40,652 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:40,666 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:41,133 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:41,153 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:41,236 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:41,255 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:41,896 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:41,917 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:42,721 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:42,748 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:42,966 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:42,976 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:42,980 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:42,988 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:43,349 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:43,373 INFO     [learner.py:606] ====Pushing takes 0.019927978515625 s
2021-08-18:16:57:43,409 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:43,416 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:43,417 INFO     [param_server.py:410] Lock worker 1 with localStep 405 , while globalStep is 404

2021-08-18:16:57:44,229 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:44,251 INFO     [learner.py:606] ====Pushing takes 0.02021026611328125 s
2021-08-18:16:57:44,274 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:44,281 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:44,282 INFO     [param_server.py:410] Lock worker 3 with localStep 405 , while globalStep is 404

2021-08-18:16:57:45,483 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:45,506 INFO     [learner.py:606] ====Pushing takes 0.02191925048828125 s
2021-08-18:16:57:45,523 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:45,528 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:45,528 INFO     [param_server.py:381] ====After aggregation in epoch: 404, virtual_clock: 18625.16466705148, top_1: : 67.7315 % (2099.0), top_5: : 100.0 % (3099.0), test loss: 3.0995759478321783, test len: 3099.0
2021-08-18:16:57:45,530 INFO     [param_server.py:410] Lock worker 2 with localStep 405 , while globalStep is 405

2021-08-18:16:57:45,531 INFO     [param_server.py:441] ====Epoch 406 completes 14 clients with loss 4.759404628835826, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:45,531 INFO     [param_server.py:450] ====Start to sample for epoch 406, global virtualClock: 18625.16466705148, round_duration: 77.10954834859407
2021-08-18:16:57:45,531 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:45,796 INFO     [param_server.py:553] For epoch: 406, median_reward: 1088.0754203750864, dev: 5440.377101875432
2021-08-18:16:57:46,463 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3661, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:57:46,463 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5301.5995, eval_time 0.6332, test_loss 3.3661, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:57:46,491 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1665, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:16:57:46,492 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5301.6166, eval_time 0.6589, test_loss 3.1665, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:16:57:46,493 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9508, Top-1 Accuracy: 720.0/1033 (0.697), Top-5 Accuracy: 1.0
2021-08-18:16:57:46,494 INFO     [learner.py:656] After aggregation epoch 405, CumulTime 5301.6328, eval_time 0.6632, test_loss 3.9508, test_accuracy 0.697, test_5_accuracy 1.0 

2021-08-18:16:57:46,550 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:46,557 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:46,564 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:46,571 INFO     [learner.py:526] ====Start train round 406
2021-08-18:16:57:46,576 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:46,591 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:47,476 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:47,497 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:48,386 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:48,407 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:48,794 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:48,812 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:57:50,269 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:57:50,281 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:57:50,682 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:57:50,696 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:57:51,439 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:57:51,448 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:57:51,502 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:57:51,516 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:57:51,845 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:57:51,865 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:57:52,714 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:57:52,748 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:57:53,123 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:57:53,132 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:57:53,287 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:57:53,311 INFO     [learner.py:606] ====Pushing takes 0.019425153732299805 s
2021-08-18:16:57:53,336 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:53,344 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:57:53,344 INFO     [param_server.py:410] Lock worker 1 with localStep 406 , while globalStep is 405

2021-08-18:16:57:53,494 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:57:53,521 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:57:54,766 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:57:54,788 INFO     [learner.py:606] ====Pushing takes 0.02030158042907715 s
2021-08-18:16:57:54,813 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:54,821 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:57:54,822 INFO     [param_server.py:410] Lock worker 3 with localStep 406 , while globalStep is 405

2021-08-18:16:57:55,452 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:57:55,467 INFO     [learner.py:606] ====Pushing takes 0.014084339141845703 s
2021-08-18:16:57:55,485 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:57:55,489 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:57:55,490 INFO     [param_server.py:381] ====After aggregation in epoch: 405, virtual_clock: 18702.274215400073, top_1: : 67.8283 % (2102.0), top_5: : 100.0 % (3099.0), test loss: 3.4944501364672624, test len: 3099.0
2021-08-18:16:57:55,492 INFO     [param_server.py:410] Lock worker 2 with localStep 406 , while globalStep is 406

2021-08-18:16:57:55,492 INFO     [param_server.py:441] ====Epoch 407 completes 14 clients with loss 3.902483432882095, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:57:55,493 INFO     [param_server.py:450] ====Start to sample for epoch 407, global virtualClock: 18702.274215400073, round_duration: 77.10954834859407
2021-08-18:16:57:55,493 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:57:55,762 INFO     [param_server.py:553] For epoch: 407, median_reward: 1150.3744856735298, dev: 5751.872428367649
2021-08-18:16:57:56,280 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3366, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:57:56,281 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5311.4167, eval_time 0.4965, test_loss 3.3366, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:57:56,282 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9007, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:16:57:56,282 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5311.4067, eval_time 0.4979, test_loss 3.9007, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:16:57:56,327 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8965, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:57:56,328 INFO     [learner.py:656] After aggregation epoch 406, CumulTime 5311.4676, eval_time 0.5441, test_loss 3.8965, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:57:56,349 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:56,349 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:56,362 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:57:56,363 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:57:56,401 INFO     [learner.py:526] ====Start train round 407
2021-08-18:16:57:56,422 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:57:57,165 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:57:57,179 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:57:58,254 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:57:58,275 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:57:58,663 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:57:58,676 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:00,124 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:00,138 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:00,764 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:00,786 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:01,568 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:01,589 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:01,646 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:01,664 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:02,137 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:02,158 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:03,5 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:03,38 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:03,291 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:03,302 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:03,555 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:03,576 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:03,662 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:03,683 INFO     [learner.py:606] ====Pushing takes 0.019455671310424805 s
2021-08-18:16:58:03,714 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:03,721 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:03,722 INFO     [param_server.py:410] Lock worker 1 with localStep 407 , while globalStep is 406

2021-08-18:16:58:04,790 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:04,810 INFO     [learner.py:606] ====Pushing takes 0.018682003021240234 s
2021-08-18:16:58:04,835 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:04,841 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:04,841 INFO     [param_server.py:410] Lock worker 3 with localStep 407 , while globalStep is 406

2021-08-18:16:58:05,498 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:05,515 INFO     [learner.py:606] ====Pushing takes 0.014811277389526367 s
2021-08-18:16:58:05,529 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:05,535 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:05,535 INFO     [param_server.py:381] ====After aggregation in epoch: 406, virtual_clock: 18779.38376374867, top_1: : 66.9571 % (2075.0), top_5: : 100.0 % (3099.0), test loss: 3.711242538911325, test len: 3099.0
2021-08-18:16:58:05,537 INFO     [param_server.py:410] Lock worker 2 with localStep 407 , while globalStep is 407

2021-08-18:16:58:05,538 INFO     [param_server.py:441] ====Epoch 408 completes 14 clients with loss 4.464891407865986, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:05,538 INFO     [param_server.py:450] ====Start to sample for epoch 408, global virtualClock: 18779.38376374867, round_duration: 77.10954834859407
2021-08-18:16:58:05,539 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:05,812 INFO     [param_server.py:553] For epoch: 408, median_reward: 938.2028838374482, dev: 4691.014419187241
2021-08-18:16:58:06,438 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.27, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:16:58:06,439 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5321.5748, eval_time 0.5892, test_loss 3.27, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:16:58:06,486 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2318, Top-1 Accuracy: 701.0/1033 (0.6786), Top-5 Accuracy: 1.0
2021-08-18:16:58:06,487 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5321.6258, eval_time 0.639, test_loss 3.2318, test_accuracy 0.6786, test_5_accuracy 1.0 

2021-08-18:16:58:06,504 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:58:06,514 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:06,523 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3286, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:58:06,525 INFO     [learner.py:656] After aggregation epoch 407, CumulTime 5321.6494, eval_time 0.6726, test_loss 3.3286, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:58:06,561 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:58:06,573 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:06,593 INFO     [learner.py:526] ====Start train round 408
2021-08-18:16:58:06,611 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:07,502 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:07,523 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:08,592 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:08,619 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:08,750 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:08,769 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:10,576 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:10,597 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:11,309 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:11,323 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:11,490 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:11,501 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:11,999 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:12,14 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:12,399 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:12,413 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:13,106 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:13,116 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:13,210 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:13,230 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:13,872 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:13,894 INFO     [learner.py:606] ====Pushing takes 0.017621517181396484 s
2021-08-18:16:58:13,917 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:13,922 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:13,923 INFO     [param_server.py:410] Lock worker 1 with localStep 408 , while globalStep is 407

2021-08-18:16:58:13,953 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:13,973 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:15,157 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:15,177 INFO     [learner.py:606] ====Pushing takes 0.018750905990600586 s
2021-08-18:16:58:15,201 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:15,207 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:15,207 INFO     [param_server.py:410] Lock worker 3 with localStep 408 , while globalStep is 407

2021-08-18:16:58:15,486 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:15,501 INFO     [learner.py:606] ====Pushing takes 0.014177322387695312 s
2021-08-18:16:58:15,518 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:15,523 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:15,524 INFO     [param_server.py:381] ====After aggregation in epoch: 407, virtual_clock: 18856.493312097264, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 3.2768099109331765, test len: 3099.0
2021-08-18:16:58:15,526 INFO     [param_server.py:410] Lock worker 2 with localStep 408 , while globalStep is 408

2021-08-18:16:58:15,526 INFO     [param_server.py:441] ====Epoch 409 completes 14 clients with loss 4.175474233177516, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:15,527 INFO     [param_server.py:450] ====Start to sample for epoch 409, global virtualClock: 18856.493312097264, round_duration: 77.10954834859407
2021-08-18:16:58:15,527 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:15,797 INFO     [param_server.py:553] For epoch: 409, median_reward: 1207.0866532928196, dev: 6035.433266464098
2021-08-18:16:58:16,528 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2466, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:16:58:16,529 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5331.6645, eval_time 0.6736, test_loss 3.2466, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:16:58:16,562 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0375, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:16:58:16,563 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5331.6876, eval_time 0.708, test_loss 3.0375, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:16:58:16,596 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3051, Top-1 Accuracy: 721.0/1033 (0.698), Top-5 Accuracy: 1.0
2021-08-18:16:58:16,597 INFO     [learner.py:656] After aggregation epoch 408, CumulTime 5331.7364, eval_time 0.745, test_loss 3.3051, test_accuracy 0.698, test_5_accuracy 1.0 

2021-08-18:16:58:16,599 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:58:16,618 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:16,632 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:58:16,645 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:16,670 INFO     [learner.py:526] ====Start train round 409
2021-08-18:16:58:16,693 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:17,460 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:17,469 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:18,575 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:18,589 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:18,903 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:18,914 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:20,428 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:20,449 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:21,359 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:21,386 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:21,610 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:21,624 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:21,916 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:21,937 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:22,695 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:22,715 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:23,265 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:23,277 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:23,615 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:23,649 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:23,830 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:23,844 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:24,300 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:24,321 INFO     [learner.py:606] ====Pushing takes 0.019238948822021484 s
2021-08-18:16:58:24,351 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:24,358 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:24,359 INFO     [param_server.py:410] Lock worker 1 with localStep 409 , while globalStep is 408

2021-08-18:16:58:25,83 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:25,106 INFO     [learner.py:606] ====Pushing takes 0.021389007568359375 s
2021-08-18:16:58:25,126 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:25,131 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:25,132 INFO     [param_server.py:410] Lock worker 3 with localStep 409 , while globalStep is 408

2021-08-18:16:58:25,738 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:25,753 INFO     [learner.py:606] ====Pushing takes 0.013592243194580078 s
2021-08-18:16:58:25,770 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:25,778 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:25,778 INFO     [param_server.py:381] ====After aggregation in epoch: 408, virtual_clock: 18933.60286044586, top_1: : 68.2801 % (2116.0), top_5: : 100.0 % (3099.0), test loss: 3.196417677733633, test len: 3099.0
2021-08-18:16:58:25,781 INFO     [param_server.py:410] Lock worker 2 with localStep 409 , while globalStep is 409

2021-08-18:16:58:25,782 INFO     [param_server.py:441] ====Epoch 410 completes 14 clients with loss 4.800784108947153, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:25,783 INFO     [param_server.py:450] ====Start to sample for epoch 410, global virtualClock: 18933.60286044586, round_duration: 77.10954834859407
2021-08-18:16:58:25,784 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:26,71 INFO     [param_server.py:553] For epoch: 410, median_reward: 1109.9185881500541, dev: 5549.592940750271
2021-08-18:16:58:26,698 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7469, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:16:58:26,699 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5341.8346, eval_time 0.5814, test_loss 3.7469, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:16:58:26,764 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:58:26,773 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:26,778 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2588, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:58:26,779 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5341.9032, eval_time 0.6614, test_loss 3.2588, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:58:26,826 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3338, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:16:58:26,827 INFO     [learner.py:656] After aggregation epoch 409, CumulTime 5341.9662, eval_time 0.7098, test_loss 4.3338, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:16:58:26,844 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:58:26,864 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:26,893 INFO     [learner.py:526] ====Start train round 410
2021-08-18:16:58:26,920 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:27,706 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:27,716 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:28,838 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:28,852 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:29,54 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:29,65 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:30,448 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:30,466 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:31,572 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:31,599 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:31,982 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:32,2 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:32,24 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:32,35 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:32,968 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:32,988 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:33,598 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:33,612 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:33,724 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:33,742 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:33,818 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:33,838 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:34,439 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:34,461 INFO     [learner.py:606] ====Pushing takes 0.019915342330932617 s
2021-08-18:16:58:34,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:34,496 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:34,497 INFO     [param_server.py:410] Lock worker 1 with localStep 410 , while globalStep is 409

2021-08-18:16:58:34,842 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:34,862 INFO     [learner.py:606] ====Pushing takes 0.018902063369750977 s
2021-08-18:16:58:34,886 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:34,891 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:34,892 INFO     [param_server.py:410] Lock worker 3 with localStep 410 , while globalStep is 409

2021-08-18:16:58:35,950 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:35,965 INFO     [learner.py:606] ====Pushing takes 0.014004230499267578 s
2021-08-18:16:58:35,980 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:35,985 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:35,986 INFO     [param_server.py:381] ====After aggregation in epoch: 409, virtual_clock: 19010.712408794454, top_1: : 65.2146 % (2021.0), top_5: : 100.0 % (3099.0), test loss: 3.7798185834178217, test len: 3099.0
2021-08-18:16:58:35,988 INFO     [param_server.py:410] Lock worker 2 with localStep 410 , while globalStep is 410

2021-08-18:16:58:35,989 INFO     [param_server.py:441] ====Epoch 411 completes 14 clients with loss 5.3009648306205905, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:35,989 INFO     [param_server.py:450] ====Start to sample for epoch 411, global virtualClock: 19010.712408794454, round_duration: 77.10954834859407
2021-08-18:16:58:35,990 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:36,261 INFO     [param_server.py:553] For epoch: 411, median_reward: 1324.1795579713385, dev: 6620.897789856692
2021-08-18:16:58:36,978 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2776, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:16:58:36,979 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5352.1148, eval_time 0.6825, test_loss 3.2776, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:16:58:37,2 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1801, Top-1 Accuracy: 722.0/1033 (0.6989), Top-5 Accuracy: 1.0
2021-08-18:16:58:37,3 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5352.1426, eval_time 0.7086, test_loss 3.1801, test_accuracy 0.6989, test_5_accuracy 1.0 

2021-08-18:16:58:37,36 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1924, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:58:37,37 INFO     [learner.py:656] After aggregation epoch 410, CumulTime 5352.1614, eval_time 0.7403, test_loss 3.1924, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:58:37,48 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:58:37,56 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:37,73 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:58:37,103 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:37,107 INFO     [learner.py:526] ====Start train round 411
2021-08-18:16:58:37,127 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:38,85 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:38,105 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:39,85 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:39,104 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:39,362 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:39,377 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:40,857 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:40,870 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:41,822 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:41,842 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:42,13 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:42,24 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:42,429 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:42,456 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:43,169 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:43,209 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:43,592 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:43,602 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:44,98 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:44,137 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:44,516 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:44,536 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:44,670 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:44,696 INFO     [learner.py:606] ====Pushing takes 0.023815631866455078 s
2021-08-18:16:58:44,722 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:44,729 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:44,729 INFO     [param_server.py:410] Lock worker 1 with localStep 411 , while globalStep is 410

2021-08-18:16:58:45,617 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:45,648 INFO     [learner.py:606] ====Pushing takes 0.029334068298339844 s
2021-08-18:16:58:45,676 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:45,681 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:45,682 INFO     [param_server.py:410] Lock worker 3 with localStep 411 , while globalStep is 410

2021-08-18:16:58:46,215 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:46,245 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:46,231 INFO     [learner.py:606] ====Pushing takes 0.014461040496826172 s
2021-08-18:16:58:46,250 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:46,251 INFO     [param_server.py:381] ====After aggregation in epoch: 410, virtual_clock: 19087.82195714305, top_1: : 68.0542 % (2109.0), top_5: : 100.0 % (3099.0), test loss: 3.2167033619350853, test len: 3099.0
2021-08-18:16:58:46,253 INFO     [param_server.py:410] Lock worker 2 with localStep 411 , while globalStep is 411

2021-08-18:16:58:46,253 INFO     [param_server.py:441] ====Epoch 412 completes 14 clients with loss 5.809094132626287, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:46,254 INFO     [param_server.py:450] ====Start to sample for epoch 412, global virtualClock: 19087.82195714305, round_duration: 77.10954834859407
2021-08-18:16:58:46,254 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:46,534 INFO     [param_server.py:553] For epoch: 412, median_reward: 1051.006357692589, dev: 5255.031788462946
2021-08-18:16:58:47,292 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5524, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:16:58:47,292 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3034, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:58:47,293 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5362.4175, eval_time 0.7363, test_loss 3.5524, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:16:58:47,293 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5362.4292, eval_time 0.737, test_loss 3.3034, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:58:47,332 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9704, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:58:47,333 INFO     [learner.py:656] After aggregation epoch 411, CumulTime 5362.4722, eval_time 0.7767, test_loss 3.9704, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:58:47,362 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:47,371 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:47,377 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:47,386 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:47,400 INFO     [learner.py:526] ====Start train round 412
2021-08-18:16:58:47,414 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:48,293 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:48,311 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:49,527 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:49,554 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:49,589 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:49,600 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:58:51,279 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:58:51,288 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:58:51,905 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:58:51,919 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:58:52,207 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:58:52,216 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:58:52,509 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:58:52,521 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:58:53,99 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:58:53,120 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:58:53,971 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:58:53,980 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:58:54,11 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:58:54,45 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:58:54,331 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:58:54,365 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:58:54,794 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:58:54,817 INFO     [learner.py:606] ====Pushing takes 0.019297122955322266 s
2021-08-18:16:58:54,841 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:54,846 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:58:54,847 INFO     [param_server.py:410] Lock worker 1 with localStep 412 , while globalStep is 411

2021-08-18:16:58:55,510 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:58:55,531 INFO     [learner.py:606] ====Pushing takes 0.019870758056640625 s
2021-08-18:16:58:55,556 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:55,562 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:58:55,563 INFO     [param_server.py:410] Lock worker 3 with localStep 412 , while globalStep is 411

2021-08-18:16:58:56,452 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:58:56,468 INFO     [learner.py:606] ====Pushing takes 0.014396190643310547 s
2021-08-18:16:58:56,483 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:58:56,488 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:58:56,489 INFO     [param_server.py:381] ====After aggregation in epoch: 411, virtual_clock: 19164.931505491644, top_1: : 66.344 % (2056.0), top_5: : 100.0 % (3099.0), test loss: 3.608749466913718, test len: 3099.0
2021-08-18:16:58:56,491 INFO     [param_server.py:410] Lock worker 2 with localStep 412 , while globalStep is 412

2021-08-18:16:58:56,491 INFO     [param_server.py:441] ====Epoch 413 completes 14 clients with loss 5.297172682334303, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:58:56,492 INFO     [param_server.py:450] ====Start to sample for epoch 413, global virtualClock: 19164.931505491644, round_duration: 77.10954834859407
2021-08-18:16:58:56,492 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:58:56,778 INFO     [param_server.py:553] For epoch: 413, median_reward: 1068.6081744010353, dev: 5343.040872005176
2021-08-18:16:58:57,434 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.9217, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:16:58:57,435 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5372.5714, eval_time 0.6182, test_loss 4.9217, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:16:58:57,439 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9016, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:58:57,439 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5372.5641, eval_time 0.6217, test_loss 2.9016, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:58:57,473 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.0467, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:16:58:57,474 INFO     [learner.py:656] After aggregation epoch 412, CumulTime 5372.6133, eval_time 0.6614, test_loss 3.0467, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:16:58:57,517 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:57,527 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:58:57,532 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:57,541 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:58:57,546 INFO     [learner.py:526] ====Start train round 413
2021-08-18:16:58:57,559 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:58:58,181 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:58:58,195 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:58:59,255 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:58:59,289 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:58:59,614 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:58:59,632 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:01,37 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:01,46 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:02,12 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:02,33 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:02,384 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:02,398 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:02,415 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:02,434 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:03,215 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:03,236 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:04,40 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:04,63 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:04,251 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:04,278 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:04,300 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:04,310 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:04,863 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:04,886 INFO     [learner.py:606] ====Pushing takes 0.021602392196655273 s
2021-08-18:16:59:04,916 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:04,925 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:04,925 INFO     [param_server.py:410] Lock worker 1 with localStep 413 , while globalStep is 412

2021-08-18:16:59:05,542 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:05,563 INFO     [learner.py:606] ====Pushing takes 0.0193939208984375 s
2021-08-18:16:59:05,586 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:05,591 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:05,592 INFO     [param_server.py:410] Lock worker 3 with localStep 413 , while globalStep is 412

2021-08-18:16:59:06,677 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:06,693 INFO     [learner.py:606] ====Pushing takes 0.014391422271728516 s
2021-08-18:16:59:06,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:06,713 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:06,714 INFO     [param_server.py:381] ====After aggregation in epoch: 412, virtual_clock: 19242.04105384024, top_1: : 67.7315 % (2099.0), top_5: : 100.0 % (3099.0), test loss: 3.6233228471957974, test len: 3099.0
2021-08-18:16:59:06,716 INFO     [param_server.py:410] Lock worker 2 with localStep 413 , while globalStep is 413

2021-08-18:16:59:06,716 INFO     [param_server.py:441] ====Epoch 414 completes 14 clients with loss 5.615869332752744, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:06,717 INFO     [param_server.py:450] ====Start to sample for epoch 414, global virtualClock: 19242.04105384024, round_duration: 77.10954834859407
2021-08-18:16:59:06,718 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:07,9 INFO     [param_server.py:553] For epoch: 414, median_reward: 1140.5438229252732, dev: 5702.719114626366
2021-08-18:16:59:07,664 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1672, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:59:07,664 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5382.7891, eval_time 0.618, test_loss 3.1672, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:59:07,665 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6903, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:16:59:07,666 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5382.8024, eval_time 0.6222, test_loss 3.6903, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:16:59:07,703 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5931, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:59:07,704 INFO     [learner.py:656] After aggregation epoch 413, CumulTime 5382.8437, eval_time 0.6604, test_loss 3.5931, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:59:07,736 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:59:07,747 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:59:07,749 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:07,755 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:07,775 INFO     [learner.py:526] ====Start train round 414
2021-08-18:16:59:07,795 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:08,539 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:08,549 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:09,753 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:09,773 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:10,77 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:10,89 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:11,588 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:11,606 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:12,431 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:12,459 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:12,925 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:12,937 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:13,156 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:13,171 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:13,797 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:13,824 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:14,634 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:14,661 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:14,696 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:14,710 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:15,130 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:15,144 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:15,254 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:15,273 INFO     [learner.py:606] ====Pushing takes 0.01772475242614746 s
2021-08-18:16:59:15,296 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:15,301 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:15,301 INFO     [param_server.py:410] Lock worker 1 with localStep 414 , while globalStep is 413

2021-08-18:16:59:16,283 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:16,303 INFO     [learner.py:606] ====Pushing takes 0.01864147186279297 s
2021-08-18:16:59:16,325 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:16,330 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:16,331 INFO     [param_server.py:410] Lock worker 3 with localStep 414 , while globalStep is 413

2021-08-18:16:59:16,926 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:16,940 INFO     [learner.py:606] ====Pushing takes 0.013271093368530273 s
2021-08-18:16:59:16,955 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:16,959 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:16,960 INFO     [param_server.py:381] ====After aggregation in epoch: 413, virtual_clock: 19319.150602188834, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 3.4835272939116866, test len: 3099.0
2021-08-18:16:59:16,962 INFO     [param_server.py:410] Lock worker 2 with localStep 414 , while globalStep is 414

2021-08-18:16:59:16,962 INFO     [param_server.py:441] ====Epoch 415 completes 14 clients with loss 3.743448226168441, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:16,963 INFO     [param_server.py:450] ====Start to sample for epoch 415, global virtualClock: 19319.150602188834, round_duration: 77.10954834859407
2021-08-18:16:59:16,964 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:17,264 INFO     [param_server.py:553] For epoch: 415, median_reward: 1194.9250273381358, dev: 5974.625136690679
2021-08-18:16:59:17,952 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0408, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:16:59:17,953 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5393.0781, eval_time 0.6417, test_loss 3.0408, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:16:59:17,956 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3159, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:16:59:17,957 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5393.0934, eval_time 0.6457, test_loss 3.3159, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:16:59:18,17 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9832, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:16:59:18,18 INFO     [learner.py:656] After aggregation epoch 414, CumulTime 5393.157, eval_time 0.7081, test_loss 3.9832, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:16:59:18,27 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:59:18,27 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:59:18,36 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:18,36 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:18,92 INFO     [learner.py:526] ====Start train round 415
2021-08-18:16:59:18,116 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:18,743 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:18,755 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:20,67 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:20,88 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:20,209 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:20,225 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:21,898 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:21,912 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:22,742 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:22,763 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:23,14 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:23,33 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:23,289 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:23,308 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:23,970 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:23,997 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:24,775 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:24,789 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:24,840 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:24,867 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:25,46 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:25,60 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:25,423 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:25,445 INFO     [learner.py:606] ====Pushing takes 0.021120786666870117 s
2021-08-18:16:59:25,477 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:25,485 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:25,485 INFO     [param_server.py:410] Lock worker 1 with localStep 415 , while globalStep is 414

2021-08-18:16:59:26,179 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:26,201 INFO     [learner.py:606] ====Pushing takes 0.02070927619934082 s
2021-08-18:16:59:26,223 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:26,229 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:26,230 INFO     [param_server.py:410] Lock worker 3 with localStep 415 , while globalStep is 414

2021-08-18:16:59:27,175 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:27,192 INFO     [learner.py:606] ====Pushing takes 0.015624523162841797 s
2021-08-18:16:59:27,207 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:27,211 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:27,212 INFO     [param_server.py:381] ====After aggregation in epoch: 414, virtual_clock: 19396.26015053743, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.446640676922268, test len: 3099.0
2021-08-18:16:59:27,215 INFO     [param_server.py:410] Lock worker 2 with localStep 415 , while globalStep is 415

2021-08-18:16:59:27,215 INFO     [param_server.py:441] ====Epoch 416 completes 14 clients with loss 4.919292181239048, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:27,215 INFO     [param_server.py:450] ====Start to sample for epoch 416, global virtualClock: 19396.26015053743, round_duration: 77.10954834859407
2021-08-18:16:59:27,216 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:27,486 INFO     [param_server.py:553] For epoch: 416, median_reward: 1183.1496848066556, dev: 5915.748424033278
2021-08-18:16:59:28,228 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3458, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:16:59:28,229 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5403.365, eval_time 0.6979, test_loss 3.3458, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:16:59:28,251 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.109, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:16:59:28,252 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5403.3763, eval_time 0.718, test_loss 4.109, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:16:59:28,294 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6122, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:16:59:28,294 INFO     [learner.py:656] After aggregation epoch 415, CumulTime 5403.4336, eval_time 0.7631, test_loss 3.6122, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:16:59:28,300 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:59:28,309 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:28,322 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:59:28,335 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:28,364 INFO     [learner.py:526] ====Start train round 416
2021-08-18:16:59:28,384 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:29,277 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:29,291 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:30,373 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:30,388 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:30,722 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:30,732 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:32,212 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:32,227 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:33,9 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:33,37 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:33,601 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:33,614 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:33,621 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:33,635 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:34,442 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:34,470 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:35,271 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:35,276 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:35,283 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:35,290 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:35,517 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:35,527 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:35,921 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:35,941 INFO     [learner.py:606] ====Pushing takes 0.018995285034179688 s
2021-08-18:16:59:35,971 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:35,976 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:35,977 INFO     [param_server.py:410] Lock worker 1 with localStep 416 , while globalStep is 415

2021-08-18:16:59:36,604 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:36,624 INFO     [learner.py:606] ====Pushing takes 0.018846988677978516 s
2021-08-18:16:59:36,648 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:36,654 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:36,655 INFO     [param_server.py:410] Lock worker 3 with localStep 416 , while globalStep is 415

2021-08-18:16:59:37,716 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:37,731 INFO     [learner.py:606] ====Pushing takes 0.014013290405273438 s
2021-08-18:16:59:37,746 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:37,751 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:37,751 INFO     [param_server.py:381] ====After aggregation in epoch: 415, virtual_clock: 19473.369698886025, top_1: : 67.2152 % (2083.0), top_5: : 100.0 % (3099.0), test loss: 3.688987846727725, test len: 3099.0
2021-08-18:16:59:37,754 INFO     [param_server.py:410] Lock worker 2 with localStep 416 , while globalStep is 416

2021-08-18:16:59:37,755 INFO     [param_server.py:441] ====Epoch 417 completes 14 clients with loss 5.313352176878413, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:37,755 INFO     [param_server.py:450] ====Start to sample for epoch 417, global virtualClock: 19473.369698886025, round_duration: 77.10954834859407
2021-08-18:16:59:37,756 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:38,28 INFO     [param_server.py:553] For epoch: 417, median_reward: 1602.6206547807903, dev: 8013.103273903952
2021-08-18:16:59:38,587 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3643, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:16:59:38,591 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5413.7274, eval_time 0.5186, test_loss 3.3643, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:16:59:38,598 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7875, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:16:59:38,601 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5413.7256, eval_time 0.5282, test_loss 3.7875, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:16:59:38,661 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:59:38,670 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:59:38,671 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:38,678 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:38,680 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.4828, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:16:59:38,681 INFO     [learner.py:656] After aggregation epoch 416, CumulTime 5413.8203, eval_time 0.6101, test_loss 4.4828, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:16:59:38,753 INFO     [learner.py:526] ====Start train round 417
2021-08-18:16:59:38,777 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:39,464 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:39,478 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:40,849 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:40,860 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:40,991 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:41,18 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:42,593 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:42,611 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:43,404 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:43,425 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:43,644 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:43,656 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:43,972 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:43,986 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:44,708 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:44,729 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:45,335 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:45,345 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:45,543 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:45,571 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:45,889 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:45,909 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:46,126 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:46,146 INFO     [learner.py:606] ====Pushing takes 0.01950979232788086 s
2021-08-18:16:59:46,170 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:46,177 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:46,177 INFO     [param_server.py:410] Lock worker 1 with localStep 417 , while globalStep is 416

2021-08-18:16:59:47,170 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:47,190 INFO     [learner.py:606] ====Pushing takes 0.018950223922729492 s
2021-08-18:16:59:47,213 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:47,219 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:47,220 INFO     [param_server.py:410] Lock worker 3 with localStep 417 , while globalStep is 416

2021-08-18:16:59:47,602 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:47,618 INFO     [learner.py:606] ====Pushing takes 0.014286518096923828 s
2021-08-18:16:59:47,635 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:47,640 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:47,641 INFO     [param_server.py:381] ====After aggregation in epoch: 416, virtual_clock: 19550.47924723462, top_1: : 66.5053 % (2061.0), top_5: : 100.0 % (3099.0), test loss: 3.8781650198830504, test len: 3099.0
2021-08-18:16:59:47,643 INFO     [param_server.py:410] Lock worker 2 with localStep 417 , while globalStep is 417

2021-08-18:16:59:47,643 INFO     [param_server.py:441] ====Epoch 418 completes 14 clients with loss 5.4180053651375, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:47,644 INFO     [param_server.py:450] ====Start to sample for epoch 418, global virtualClock: 19550.47924723462, round_duration: 77.10954834859407
2021-08-18:16:59:47,645 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:47,924 INFO     [param_server.py:553] For epoch: 418, median_reward: 1554.8486628964054, dev: 7774.243314482027
2021-08-18:16:59:48,612 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4595, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:16:59:48,616 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5423.7523, eval_time 0.6363, test_loss 3.4595, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:16:59:48,651 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1515, Top-1 Accuracy: 695.0/1033 (0.6728), Top-5 Accuracy: 1.0
2021-08-18:16:59:48,652 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5423.7761, eval_time 0.6689, test_loss 3.1515, test_accuracy 0.6728, test_5_accuracy 1.0 

2021-08-18:16:59:48,687 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:48,696 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:48,704 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.1549, Top-1 Accuracy: 722.0/1033 (0.6989), Top-5 Accuracy: 1.0
2021-08-18:16:59:48,705 INFO     [learner.py:656] After aggregation epoch 417, CumulTime 5423.8438, eval_time 0.727, test_loss 3.1549, test_accuracy 0.6989, test_5_accuracy 1.0 

2021-08-18:16:59:48,724 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:48,737 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:48,799 INFO     [learner.py:526] ====Start train round 418
2021-08-18:16:59:48,820 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:49,663 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:49,673 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:16:59:50,786 INFO     [learner.py:439] Completed to run client 40
2021-08-18:16:59:50,800 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:16:59:50,967 INFO     [learner.py:439] Completed to run client 113
2021-08-18:16:59:50,978 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:16:59:52,459 INFO     [learner.py:439] Completed to run client 93
2021-08-18:16:59:52,473 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:16:59:53,571 INFO     [learner.py:439] Completed to run client 11
2021-08-18:16:59:53,585 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:16:59:53,747 INFO     [learner.py:439] Completed to run client 97
2021-08-18:16:59:53,775 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:16:59:54,6 INFO     [learner.py:439] Completed to run client 87
2021-08-18:16:59:54,24 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:16:59:55,209 INFO     [learner.py:439] Completed to run client 5
2021-08-18:16:59:55,218 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:16:59:55,263 INFO     [learner.py:439] Completed to run client 103
2021-08-18:16:59:55,284 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:16:59:55,848 INFO     [learner.py:439] Completed to run client 12
2021-08-18:16:59:55,861 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:16:59:56,234 INFO     [learner.py:439] Completed to run client 79
2021-08-18:16:59:56,262 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:16:59:56,945 INFO     [learner.py:439] Completed to run client 67
2021-08-18:16:59:56,967 INFO     [learner.py:606] ====Pushing takes 0.020538806915283203 s
2021-08-18:16:59:56,968 INFO     [learner.py:439] Completed to run client 105
2021-08-18:16:59:56,997 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:56,997 INFO     [learner.py:606] ====Pushing takes 0.02837204933166504 s
2021-08-18:16:59:57,4 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:16:59:57,5 INFO     [param_server.py:410] Lock worker 1 with localStep 418 , while globalStep is 417

2021-08-18:16:59:57,20 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:57,40 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:16:59:57,41 INFO     [param_server.py:410] Lock worker 3 with localStep 418 , while globalStep is 417

2021-08-18:16:59:57,498 INFO     [learner.py:439] Completed to run client 50
2021-08-18:16:59:57,514 INFO     [learner.py:606] ====Pushing takes 0.01397252082824707 s
2021-08-18:16:59:57,529 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:16:59:57,534 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:16:59:57,535 INFO     [param_server.py:381] ====After aggregation in epoch: 417, virtual_clock: 19627.588795583215, top_1: : 67.6347 % (2096.0), top_5: : 100.0 % (3099.0), test loss: 3.255300709494838, test len: 3099.0
2021-08-18:16:59:57,538 INFO     [param_server.py:410] Lock worker 2 with localStep 418 , while globalStep is 418

2021-08-18:16:59:57,538 INFO     [param_server.py:441] ====Epoch 419 completes 14 clients with loss 6.6753132491372105, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:16:59:57,539 INFO     [param_server.py:450] ====Start to sample for epoch 419, global virtualClock: 19627.588795583215, round_duration: 77.10954834859407
2021-08-18:16:59:57,539 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:16:59:57,826 INFO     [param_server.py:553] For epoch: 419, median_reward: 1089.0892305203665, dev: 5445.446152601833
2021-08-18:16:59:58,550 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6781, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:16:59:58,551 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5433.687, eval_time 0.6694, test_loss 3.6781, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:16:59:58,595 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2038, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:16:59:58,596 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5433.7204, eval_time 0.7139, test_loss 3.2038, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:16:59:58,626 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:58,628 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3793, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:16:59:58,629 INFO     [learner.py:656] After aggregation epoch 418, CumulTime 5433.7685, eval_time 0.7477, test_loss 4.3793, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:16:59:58,639 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:16:59:58,669 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:58,681 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:16:59:58,707 INFO     [learner.py:526] ====Start train round 419
2021-08-18:16:59:58,725 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:16:59:59,509 INFO     [learner.py:439] Completed to run client 81
2021-08-18:16:59:59,523 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:00,742 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:00,762 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:00,866 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:00,875 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:02,353 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:02,368 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:03,535 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:03,575 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:03,740 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:03,750 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:04,4 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:04,31 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:04,974 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:05,1 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:05,426 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:05,435 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:05,949 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:05,970 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:06,100 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:06,115 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:06,492 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:06,512 INFO     [learner.py:606] ====Pushing takes 0.018519878387451172 s
2021-08-18:17:00:06,537 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:06,544 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:06,545 INFO     [param_server.py:410] Lock worker 1 with localStep 419 , while globalStep is 418

2021-08-18:17:00:07,257 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:07,278 INFO     [learner.py:606] ====Pushing takes 0.018904924392700195 s
2021-08-18:17:00:07,300 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:07,306 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:07,306 INFO     [param_server.py:410] Lock worker 3 with localStep 419 , while globalStep is 418

2021-08-18:17:00:07,755 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:07,769 INFO     [learner.py:606] ====Pushing takes 0.013018369674682617 s
2021-08-18:17:00:07,784 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:07,789 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:07,789 INFO     [param_server.py:381] ====After aggregation in epoch: 418, virtual_clock: 19704.69834393181, top_1: : 63.8916 % (1980.0), top_5: : 100.0 % (3099.0), test loss: 3.753717323144277, test len: 3099.0
2021-08-18:17:00:07,792 INFO     [param_server.py:410] Lock worker 2 with localStep 419 , while globalStep is 419

2021-08-18:17:00:07,792 INFO     [param_server.py:441] ====Epoch 420 completes 14 clients with loss 4.651170216642224, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:07,793 INFO     [param_server.py:450] ====Start to sample for epoch 420, global virtualClock: 19704.69834393181, round_duration: 77.10954834859407
2021-08-18:17:00:07,794 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:08,67 INFO     [param_server.py:553] For epoch: 420, median_reward: 1098.7727950713438, dev: 5493.863975356719
2021-08-18:17:00:08,650 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4116, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:00:08,653 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5443.7891, eval_time 0.5401, test_loss 3.4116, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:00:08,707 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0322, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:17:00:08,708 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5443.8326, eval_time 0.595, test_loss 3.0322, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:17:00:08,723 INFO     [learner.py:526] ====Start train round 420
2021-08-18:17:00:08,731 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:08,780 INFO     [learner.py:526] ====Start train round 420
2021-08-18:17:00:08,784 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3093, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:17:00:08,788 INFO     [learner.py:656] After aggregation epoch 419, CumulTime 5443.9273, eval_time 0.6774, test_loss 3.3093, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:17:00:08,795 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:08,861 INFO     [learner.py:526] ====Start train round 420
2021-08-18:17:00:08,886 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:09,594 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:09,609 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:10,891 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:10,902 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:11,71 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:11,98 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:12,801 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:12,815 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:13,669 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:13,680 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:14,32 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:14,65 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:14,343 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:14,363 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:15,375 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:15,389 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:15,424 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:15,434 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:15,948 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:15,957 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:16,185 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:16,212 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:16,799 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:16,821 INFO     [learner.py:606] ====Pushing takes 0.01997661590576172 s
2021-08-18:17:00:16,855 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:16,860 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:16,861 INFO     [param_server.py:410] Lock worker 1 with localStep 420 , while globalStep is 419

2021-08-18:17:00:17,114 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:17,134 INFO     [learner.py:606] ====Pushing takes 0.018412351608276367 s
2021-08-18:17:00:17,156 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:17,161 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:17,162 INFO     [param_server.py:410] Lock worker 3 with localStep 420 , while globalStep is 419

2021-08-18:17:00:17,858 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:17,874 INFO     [learner.py:606] ====Pushing takes 0.014395713806152344 s
2021-08-18:17:00:17,890 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:17,895 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:17,895 INFO     [param_server.py:381] ====After aggregation in epoch: 419, virtual_clock: 19781.807892280405, top_1: : 68.1833 % (2113.0), top_5: : 100.0 % (3099.0), test loss: 3.2510212989592993, test len: 3099.0
2021-08-18:17:00:17,902 INFO     [param_server.py:410] Lock worker 2 with localStep 420 , while globalStep is 420

2021-08-18:17:00:17,903 INFO     [param_server.py:441] ====Epoch 421 completes 14 clients with loss 4.583454108927584, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:17,903 INFO     [param_server.py:450] ====Start to sample for epoch 421, global virtualClock: 19781.807892280405, round_duration: 77.10954834859407
2021-08-18:17:00:17,904 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:18,167 INFO     [param_server.py:541] Handle Wight 0.024141788482666016 | Send 0.2639138698577881
2021-08-18:17:00:18,171 INFO     [param_server.py:553] For epoch: 421, median_reward: 1196.5886875229012, dev: 5982.9434376145055
2021-08-18:17:00:18,830 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3027, Top-1 Accuracy: 668.0/1033 (0.6467), Top-5 Accuracy: 1.0
2021-08-18:17:00:18,831 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5453.9669, eval_time 0.6224, test_loss 3.3027, test_accuracy 0.6467, test_5_accuracy 1.0 

2021-08-18:17:00:18,873 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9526, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:00:18,874 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5453.9989, eval_time 0.6657, test_loss 2.9526, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:00:18,897 INFO     [learner.py:526] ====Start train round 421
2021-08-18:17:00:18,907 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:18,942 INFO     [learner.py:526] ====Start train round 421
2021-08-18:17:00:18,956 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.2606, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:17:00:18,956 INFO     [learner.py:656] After aggregation epoch 420, CumulTime 5454.0957, eval_time 0.748, test_loss 3.2606, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:17:00:18,965 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:19,25 INFO     [learner.py:526] ====Start train round 421
2021-08-18:17:00:19,49 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:19,900 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:19,921 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:21,167 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:21,179 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:21,204 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:21,230 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:22,876 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:22,891 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:23,824 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:23,838 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:24,42 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:24,75 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:24,403 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:24,415 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:25,432 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:25,443 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:25,453 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:25,459 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:26,170 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:26,184 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:26,284 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:26,311 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:26,839 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:26,864 INFO     [learner.py:606] ====Pushing takes 0.023213863372802734 s
2021-08-18:17:00:26,896 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:26,905 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:26,906 INFO     [param_server.py:410] Lock worker 1 with localStep 421 , while globalStep is 420

2021-08-18:17:00:27,281 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:27,301 INFO     [learner.py:606] ====Pushing takes 0.019378662109375 s
2021-08-18:17:00:27,324 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:27,329 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:27,330 INFO     [param_server.py:410] Lock worker 3 with localStep 421 , while globalStep is 420

2021-08-18:17:00:27,796 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:27,813 INFO     [learner.py:606] ====Pushing takes 0.014733314514160156 s
2021-08-18:17:00:27,834 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:27,839 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:27,840 INFO     [param_server.py:381] ====After aggregation in epoch: 420, virtual_clock: 19858.917440629, top_1: : 66.4085 % (2058.0), top_5: : 100.0 % (3099.0), test loss: 3.1719667160952536, test len: 3099.0
2021-08-18:17:00:27,842 INFO     [param_server.py:410] Lock worker 2 with localStep 421 , while globalStep is 421

2021-08-18:17:00:27,843 INFO     [param_server.py:441] ====Epoch 422 completes 14 clients with loss 5.16356963279953, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:27,843 INFO     [param_server.py:450] ====Start to sample for epoch 422, global virtualClock: 19858.917440629, round_duration: 77.10954834859407
2021-08-18:17:00:27,844 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:28,173 INFO     [param_server.py:553] For epoch: 422, median_reward: 1137.349012290246, dev: 5686.74506145123
2021-08-18:17:00:28,738 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.5636, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:17:00:28,739 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5463.8749, eval_time 0.5199, test_loss 3.5636, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:17:00:28,772 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0171, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:17:00:28,773 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5463.8977, eval_time 0.5511, test_loss 3.0171, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:17:00:28,807 INFO     [learner.py:526] ====Start train round 422
2021-08-18:17:00:28,816 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:28,843 INFO     [learner.py:526] ====Start train round 422
2021-08-18:17:00:28,859 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:28,859 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7394, Top-1 Accuracy: 712.0/1033 (0.6893), Top-5 Accuracy: 1.0
2021-08-18:17:00:28,862 INFO     [learner.py:656] After aggregation epoch 421, CumulTime 5464.0014, eval_time 0.6453, test_loss 3.7394, test_accuracy 0.6893, test_5_accuracy 1.0 

2021-08-18:17:00:28,932 INFO     [learner.py:526] ====Start train round 422
2021-08-18:17:00:28,956 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:29,752 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:29,772 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:30,929 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:30,938 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:31,39 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:31,60 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:32,649 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:32,658 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:33,570 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:33,586 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:33,710 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:33,743 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:33,898 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:33,911 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:35,155 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:35,182 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:35,276 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:35,285 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:35,785 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:35,806 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:36,41 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:36,75 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:36,670 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:36,694 INFO     [learner.py:606] ====Pushing takes 0.022146940231323242 s
2021-08-18:17:00:36,725 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:36,732 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:36,732 INFO     [param_server.py:410] Lock worker 1 with localStep 422 , while globalStep is 421

2021-08-18:17:00:37,68 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:37,89 INFO     [learner.py:606] ====Pushing takes 0.01958942413330078 s
2021-08-18:17:00:37,112 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:37,118 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:37,118 INFO     [param_server.py:410] Lock worker 3 with localStep 422 , while globalStep is 421

2021-08-18:17:00:37,601 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:37,617 INFO     [learner.py:606] ====Pushing takes 0.014330387115478516 s
2021-08-18:17:00:37,632 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:37,637 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:37,637 INFO     [param_server.py:381] ====After aggregation in epoch: 421, virtual_clock: 19936.026988977595, top_1: : 68.3446 % (2118.0), top_5: : 100.0 % (3099.0), test loss: 3.4400278903819896, test len: 3099.0
2021-08-18:17:00:37,640 INFO     [param_server.py:410] Lock worker 2 with localStep 422 , while globalStep is 422

2021-08-18:17:00:37,641 INFO     [param_server.py:441] ====Epoch 423 completes 14 clients with loss 3.967355614127828, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:37,641 INFO     [param_server.py:450] ====Start to sample for epoch 423, global virtualClock: 19936.026988977595, round_duration: 77.10954834859407
2021-08-18:17:00:37,642 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:37,975 INFO     [param_server.py:553] For epoch: 423, median_reward: 1167.3997385579853, dev: 5836.998692789926
2021-08-18:17:00:38,677 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4836, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:00:38,678 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 2.9235, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:17:00:38,679 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5473.8148, eval_time 0.6669, test_loss 3.4836, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:00:38,679 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5473.8041, eval_time 0.6632, test_loss 2.9235, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:17:00:38,711 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4004, Top-1 Accuracy: 721.0/1033 (0.698), Top-5 Accuracy: 1.0
2021-08-18:17:00:38,713 INFO     [learner.py:656] After aggregation epoch 422, CumulTime 5473.8519, eval_time 0.7031, test_loss 3.4004, test_accuracy 0.698, test_5_accuracy 1.0 

2021-08-18:17:00:38,747 INFO     [learner.py:526] ====Start train round 423
2021-08-18:17:00:38,756 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:38,773 INFO     [learner.py:526] ====Start train round 423
2021-08-18:17:00:38,781 INFO     [learner.py:526] ====Start train round 423
2021-08-18:17:00:38,782 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:38,794 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:39,566 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:39,576 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:40,920 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:40,948 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:41,83 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:41,95 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:42,498 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:42,526 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:43,840 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:43,854 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:44,144 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:44,178 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:44,292 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:44,312 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:45,459 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:45,473 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:45,530 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:45,541 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:46,119 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:46,128 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:46,272 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:46,293 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:46,967 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:46,990 INFO     [learner.py:606] ====Pushing takes 0.02180004119873047 s
2021-08-18:17:00:47,22 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:47,30 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:47,31 INFO     [param_server.py:410] Lock worker 1 with localStep 423 , while globalStep is 422

2021-08-18:17:00:47,251 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:47,272 INFO     [learner.py:606] ====Pushing takes 0.01924443244934082 s
2021-08-18:17:00:47,295 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:47,300 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:47,300 INFO     [param_server.py:410] Lock worker 3 with localStep 423 , while globalStep is 422

2021-08-18:17:00:47,898 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:47,914 INFO     [learner.py:606] ====Pushing takes 0.014007091522216797 s
2021-08-18:17:00:47,929 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:47,934 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:47,934 INFO     [param_server.py:381] ====After aggregation in epoch: 422, virtual_clock: 20013.13653732619, top_1: : 67.6025 % (2095.0), top_5: : 100.0 % (3099.0), test loss: 3.269177139633232, test len: 3099.0
2021-08-18:17:00:47,937 INFO     [param_server.py:410] Lock worker 2 with localStep 423 , while globalStep is 423

2021-08-18:17:00:47,937 INFO     [param_server.py:441] ====Epoch 424 completes 14 clients with loss 5.6401082656373696, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:47,937 INFO     [param_server.py:450] ====Start to sample for epoch 424, global virtualClock: 20013.13653732619, round_duration: 77.10954834859407
2021-08-18:17:00:47,938 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:48,244 INFO     [param_server.py:553] For epoch: 424, median_reward: 1210.3708888892531, dev: 6051.854444446266
2021-08-18:17:00:49,29 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3176, Top-1 Accuracy: 690.0/1033 (0.668), Top-5 Accuracy: 1.0
2021-08-18:17:00:49,30 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5484.1658, eval_time 0.7195, test_loss 3.3176, test_accuracy 0.668, test_5_accuracy 1.0 

2021-08-18:17:00:49,114 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2865, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:00:49,115 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5484.2391, eval_time 0.804, test_loss 3.2865, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:00:49,131 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:49,138 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:49,187 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6024, Top-1 Accuracy: 723.0/1033 (0.6999), Top-5 Accuracy: 1.0
2021-08-18:17:00:49,191 INFO     [learner.py:656] After aggregation epoch 423, CumulTime 5484.3299, eval_time 0.8803, test_loss 3.6024, test_accuracy 0.6999, test_5_accuracy 1.0 

2021-08-18:17:00:49,204 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:49,223 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:49,262 INFO     [learner.py:526] ====Start train round 424
2021-08-18:17:00:49,288 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:50,222 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:50,248 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:00:51,285 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:00:51,301 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:00:51,388 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:00:51,409 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:00:53,354 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:00:53,369 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:00:53,871 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:00:53,884 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:00:54,53 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:00:54,87 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:00:54,655 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:00:54,673 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:00:55,513 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:00:55,541 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:00:55,654 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:00:55,663 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:00:56,469 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:00:56,503 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:00:56,603 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:00:56,621 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:00:57,220 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:00:57,241 INFO     [learner.py:606] ====Pushing takes 0.019203901290893555 s
2021-08-18:17:00:57,271 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:57,276 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:00:57,277 INFO     [param_server.py:410] Lock worker 1 with localStep 424 , while globalStep is 423

2021-08-18:17:00:57,756 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:00:57,777 INFO     [learner.py:606] ====Pushing takes 0.018900394439697266 s
2021-08-18:17:00:57,798 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:57,803 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:00:57,804 INFO     [param_server.py:410] Lock worker 3 with localStep 424 , while globalStep is 423

2021-08-18:17:00:57,996 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:00:58,12 INFO     [learner.py:606] ====Pushing takes 0.01435708999633789 s
2021-08-18:17:00:58,26 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:00:58,31 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:00:58,31 INFO     [param_server.py:381] ====After aggregation in epoch: 423, virtual_clock: 20090.246085674786, top_1: : 68.2478 % (2115.0), top_5: : 100.0 % (3099.0), test loss: 3.402161015404595, test len: 3099.0
2021-08-18:17:00:58,34 INFO     [param_server.py:410] Lock worker 2 with localStep 424 , while globalStep is 424

2021-08-18:17:00:58,35 INFO     [param_server.py:441] ====Epoch 425 completes 14 clients with loss 6.935020228993391, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:00:58,35 INFO     [param_server.py:450] ====Start to sample for epoch 425, global virtualClock: 20090.246085674786, round_duration: 77.10954834859407
2021-08-18:17:00:58,36 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:00:58,328 INFO     [param_server.py:553] For epoch: 425, median_reward: 1018.3894044646062, dev: 5091.947022323031
2021-08-18:17:00:58,983 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6036, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:00:58,984 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5494.1197, eval_time 0.6111, test_loss 3.6036, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:00:59,26 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1763, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:00:59,27 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5494.152, eval_time 0.6486, test_loss 3.1763, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:00:59,56 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:59,63 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3114, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:17:00:59,64 INFO     [learner.py:656] After aggregation epoch 424, CumulTime 5494.2032, eval_time 0.6913, test_loss 3.3114, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:17:00:59,65 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:00:59,107 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:59,118 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:00:59,134 INFO     [learner.py:526] ====Start train round 425
2021-08-18:17:00:59,157 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:00:59,893 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:00:59,906 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:01,242 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:01,259 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:01,269 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:01,270 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:02,938 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:02,956 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:03,967 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:03,980 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:04,145 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:04,178 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:01:04,353 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:04,367 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:05,566 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:01:05,603 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:05,742 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:05,751 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:06,352 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:06,371 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:06,493 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:06,527 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:07,206 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:07,228 INFO     [learner.py:606] ====Pushing takes 0.020108699798583984 s
2021-08-18:17:01:07,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:07,268 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:01:07,269 INFO     [param_server.py:410] Lock worker 1 with localStep 425 , while globalStep is 424

2021-08-18:17:01:07,481 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:07,502 INFO     [learner.py:606] ====Pushing takes 0.019326210021972656 s
2021-08-18:17:01:07,525 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:07,532 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:01:07,533 INFO     [param_server.py:410] Lock worker 3 with localStep 425 , while globalStep is 424

2021-08-18:17:01:08,141 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:08,156 INFO     [learner.py:606] ====Pushing takes 0.01395726203918457 s
2021-08-18:17:01:08,171 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:08,178 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:01:08,178 INFO     [param_server.py:381] ====After aggregation in epoch: 424, virtual_clock: 20167.35563402338, top_1: : 66.0858 % (2048.0), top_5: : 100.0 % (3099.0), test loss: 3.363769175829711, test len: 3099.0
2021-08-18:17:01:08,180 INFO     [param_server.py:410] Lock worker 2 with localStep 425 , while globalStep is 425

2021-08-18:17:01:08,181 INFO     [param_server.py:441] ====Epoch 426 completes 14 clients with loss 4.767998691706602, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:08,181 INFO     [param_server.py:450] ====Start to sample for epoch 426, global virtualClock: 20167.35563402338, round_duration: 77.10954834859407
2021-08-18:17:01:08,182 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 103, 12, 79, 50, 105, 67]
2021-08-18:17:01:08,457 INFO     [param_server.py:553] For epoch: 426, median_reward: 1276.483857062256, dev: 6382.41928531128
2021-08-18:17:01:09,111 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0796, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:01:09,113 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5504.2493, eval_time 0.6091, test_loss 4.0796, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:01:09,112 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.0538, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:17:01:09,115 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5504.2397, eval_time 0.6109, test_loss 3.0538, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:17:01:09,186 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:01:09,191 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3537, Top-1 Accuracy: 718.0/1033 (0.6951), Top-5 Accuracy: 1.0
2021-08-18:17:01:09,192 INFO     [learner.py:656] After aggregation epoch 425, CumulTime 5504.3308, eval_time 0.6899, test_loss 3.3537, test_accuracy 0.6951, test_5_accuracy 1.0 

2021-08-18:17:01:09,193 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:01:09,197 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:09,204 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:09,264 INFO     [learner.py:526] ====Start train round 426
2021-08-18:17:01:09,282 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:09,984 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:09,998 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:11,139 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:11,159 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:11,354 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:11,365 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:12,729 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:12,743 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:14,73 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:14,101 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:14,107 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:14,126 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:14,370 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:14,397 INFO     [learner.py:165] Start to run client 103 on rank 1...
2021-08-18:17:01:15,679 INFO     [learner.py:439] Completed to run client 103
2021-08-18:17:01:15,700 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:15,743 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:15,752 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:15,880 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:15,898 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:16,609 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:16,643 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:16,956 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:16,977 INFO     [learner.py:606] ====Pushing takes 0.01997208595275879 s
2021-08-18:17:01:17,10 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:17,16 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07142857142857142, now collected 5 clients
2021-08-18:17:01:17,17 INFO     [param_server.py:410] Lock worker 3 with localStep 426 , while globalStep is 425

2021-08-18:17:01:17,441 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:17,462 INFO     [learner.py:606] ====Pushing takes 0.019715309143066406 s
2021-08-18:17:01:17,485 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:17,491 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07142857142857142, now collected 10 clients
2021-08-18:17:01:17,492 INFO     [param_server.py:410] Lock worker 1 with localStep 426 , while globalStep is 425

2021-08-18:17:01:18,109 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:18,125 INFO     [learner.py:606] ====Pushing takes 0.014723062515258789 s
2021-08-18:17:01:18,141 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:18,150 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07142857142857142, now collected 14 clients
2021-08-18:17:01:18,150 INFO     [param_server.py:381] ====After aggregation in epoch: 425, virtual_clock: 20244.465182371976, top_1: : 67.7315 % (2099.0), top_5: : 100.0 % (3099.0), test loss: 3.495722748615124, test len: 3099.0
2021-08-18:17:01:18,153 INFO     [param_server.py:410] Lock worker 2 with localStep 426 , while globalStep is 426

2021-08-18:17:01:18,153 INFO     [param_server.py:441] ====Epoch 427 completes 14 clients with loss 5.305508990298487, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 103: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:18,154 INFO     [param_server.py:450] ====Start to sample for epoch 427, global virtualClock: 20244.465182371976, round_duration: 77.10954834859407
2021-08-18:17:01:18,155 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:18,490 INFO     [param_server.py:553] For epoch: 427, median_reward: 1087.6521622494517, dev: 5438.260811247259
2021-08-18:17:01:19,172 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7843, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:01:19,173 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5514.3092, eval_time 0.6383, test_loss 3.7843, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:01:19,241 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:01:19,254 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:19,260 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4629, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:01:19,260 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5514.385, eval_time 0.7227, test_loss 3.4629, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:01:19,292 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4948, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:01:19,293 INFO     [learner.py:656] After aggregation epoch 426, CumulTime 5514.4318, eval_time 0.7577, test_loss 3.4948, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:01:19,337 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:01:19,354 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:19,366 INFO     [learner.py:526] ====Start train round 427
2021-08-18:17:01:19,390 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:20,500 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:20,513 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:21,358 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:21,372 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:21,581 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:21,602 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:23,328 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:23,347 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:24,65 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:24,80 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:24,623 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:24,662 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:24,987 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:25,7 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:25,613 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:25,633 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:25,670 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:25,680 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:26,288 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:26,301 INFO     [learner.py:606] ====Pushing takes 0.011855602264404297 s
2021-08-18:17:01:26,317 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:26,325 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:26,326 INFO     [param_server.py:410] Lock worker 1 with localStep 427 , while globalStep is 426

2021-08-18:17:01:26,843 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:26,856 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:27,946 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:27,967 INFO     [learner.py:606] ====Pushing takes 0.018680095672607422 s
2021-08-18:17:01:27,990 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:27,995 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:01:27,996 INFO     [param_server.py:410] Lock worker 3 with localStep 427 , while globalStep is 426

2021-08-18:17:01:28,118 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:28,132 INFO     [learner.py:606] ====Pushing takes 0.013044118881225586 s
2021-08-18:17:01:28,148 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:28,155 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:28,155 INFO     [param_server.py:381] ====After aggregation in epoch: 426, virtual_clock: 20324.81862412703, top_1: : 63.9561 % (1982.0), top_5: : 100.0 % (3099.0), test loss: 3.580655548307631, test len: 3099.0
2021-08-18:17:01:28,158 INFO     [param_server.py:410] Lock worker 2 with localStep 427 , while globalStep is 427

2021-08-18:17:01:28,158 INFO     [param_server.py:441] ====Epoch 428 completes 13 clients with loss 4.374035823892507, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:28,159 INFO     [param_server.py:450] ====Start to sample for epoch 428, global virtualClock: 20324.81862412703, round_duration: 80.35344175505469
2021-08-18:17:01:28,159 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:28,436 INFO     [param_server.py:553] For epoch: 428, median_reward: 1239.7636164786938, dev: 6198.818082393469
2021-08-18:17:01:29,82 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2702, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:01:29,83 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5524.2194, eval_time 0.5916, test_loss 4.2702, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:01:29,86 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1703, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:01:29,90 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5524.2144, eval_time 0.5971, test_loss 3.1703, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:01:29,153 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:01:29,158 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:01:29,160 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:29,166 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:29,202 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7061, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:01:29,203 INFO     [learner.py:656] After aggregation epoch 427, CumulTime 5524.3423, eval_time 0.7118, test_loss 3.7061, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:01:29,273 INFO     [learner.py:526] ====Start train round 428
2021-08-18:17:01:29,296 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:30,450 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:30,471 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:31,306 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:31,316 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:31,560 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:31,594 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:33,510 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:33,529 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:34,120 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:34,131 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:34,479 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:34,512 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:34,985 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:35,3 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:35,328 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:35,361 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:35,945 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:35,954 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:36,69 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:36,83 INFO     [learner.py:606] ====Pushing takes 0.01293492317199707 s
2021-08-18:17:01:36,108 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:36,112 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:36,114 INFO     [param_server.py:410] Lock worker 1 with localStep 428 , while globalStep is 427

2021-08-18:17:01:36,612 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:36,626 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:37,918 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:37,938 INFO     [learner.py:606] ====Pushing takes 0.018922805786132812 s
2021-08-18:17:01:37,966 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:37,974 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:01:37,975 INFO     [param_server.py:410] Lock worker 3 with localStep 428 , while globalStep is 427

2021-08-18:17:01:38,452 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:38,469 INFO     [learner.py:606] ====Pushing takes 0.013901233673095703 s
2021-08-18:17:01:38,484 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:38,489 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:38,490 INFO     [param_server.py:381] ====After aggregation in epoch: 427, virtual_clock: 20405.172065882085, top_1: : 67.3766 % (2088.0), top_5: : 100.0 % (3099.0), test loss: 3.7155413520005016, test len: 3099.0
2021-08-18:17:01:38,492 INFO     [param_server.py:410] Lock worker 2 with localStep 428 , while globalStep is 428

2021-08-18:17:01:38,493 INFO     [param_server.py:441] ====Epoch 429 completes 13 clients with loss 5.717931426593258, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:38,494 INFO     [param_server.py:450] ====Start to sample for epoch 429, global virtualClock: 20405.172065882085, round_duration: 80.35344175505469
2021-08-18:17:01:38,494 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:38,787 INFO     [param_server.py:553] For epoch: 429, median_reward: 1357.2490195145788, dev: 6786.245097572893
2021-08-18:17:01:39,622 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.2794, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:01:39,623 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5534.7593, eval_time 0.7786, test_loss 3.2794, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:01:39,627 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2272, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:01:39,628 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5534.7527, eval_time 0.7816, test_loss 3.2272, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:01:39,699 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:01:39,699 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7013, Top-1 Accuracy: 697.0/1033 (0.6747), Top-5 Accuracy: 1.0
2021-08-18:17:01:39,700 INFO     [learner.py:656] After aggregation epoch 428, CumulTime 5534.8394, eval_time 0.8573, test_loss 3.7013, test_accuracy 0.6747, test_5_accuracy 1.0 

2021-08-18:17:01:39,714 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:39,720 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:01:39,728 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:39,769 INFO     [learner.py:526] ====Start train round 429
2021-08-18:17:01:39,787 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:40,988 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:41,3 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:41,816 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:41,836 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:42,33 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:42,45 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:43,876 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:43,897 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:44,934 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:44,949 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:44,963 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:44,968 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:45,481 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:45,508 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:45,814 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:45,841 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:46,475 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:46,487 INFO     [learner.py:606] ====Pushing takes 0.011381387710571289 s
2021-08-18:17:01:46,507 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:46,514 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:46,515 INFO     [param_server.py:410] Lock worker 1 with localStep 429 , while globalStep is 428

2021-08-18:17:01:46,523 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:46,534 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:47,446 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:47,460 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:48,562 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:48,587 INFO     [learner.py:606] ====Pushing takes 0.02018570899963379 s
2021-08-18:17:01:48,617 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:48,623 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:01:48,624 INFO     [param_server.py:410] Lock worker 3 with localStep 429 , while globalStep is 428

2021-08-18:17:01:48,825 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:48,840 INFO     [learner.py:606] ====Pushing takes 0.013921499252319336 s
2021-08-18:17:01:48,855 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:48,859 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:48,860 INFO     [param_server.py:381] ====After aggregation in epoch: 428, virtual_clock: 20485.52550763714, top_1: : 65.4082 % (2027.0), top_5: : 100.0 % (3099.0), test loss: 3.4026216347184444, test len: 3099.0
2021-08-18:17:01:48,862 INFO     [param_server.py:410] Lock worker 2 with localStep 429 , while globalStep is 429

2021-08-18:17:01:48,863 INFO     [param_server.py:441] ====Epoch 430 completes 13 clients with loss 4.1418162095362, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:48,863 INFO     [param_server.py:450] ====Start to sample for epoch 430, global virtualClock: 20485.52550763714, round_duration: 80.35344175505469
2021-08-18:17:01:48,864 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:49,174 INFO     [param_server.py:553] For epoch: 430, median_reward: 1113.596380003309, dev: 5567.981900016544
2021-08-18:17:01:49,776 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9166, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:01:49,777 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5544.9131, eval_time 0.56, test_loss 3.9166, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:01:49,829 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5627, Top-1 Accuracy: 706.0/1033 (0.6834), Top-5 Accuracy: 1.0
2021-08-18:17:01:49,830 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5544.9546, eval_time 0.61, test_loss 3.5627, test_accuracy 0.6834, test_5_accuracy 1.0 

2021-08-18:17:01:49,857 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:49,866 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:01:49,880 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5228, Top-1 Accuracy: 715.0/1033 (0.6922), Top-5 Accuracy: 1.0
2021-08-18:17:01:49,881 INFO     [learner.py:656] After aggregation epoch 429, CumulTime 5545.0205, eval_time 0.6641, test_loss 3.5228, test_accuracy 0.6922, test_5_accuracy 1.0 

2021-08-18:17:01:49,899 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:49,912 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:01:49,948 INFO     [learner.py:526] ====Start train round 430
2021-08-18:17:01:49,983 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:01:51,197 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:01:51,206 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:01:52,102 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:01:52,114 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:01:52,227 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:01:52,255 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:01:54,466 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:01:54,484 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:01:54,764 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:01:54,776 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:01:55,98 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:01:55,125 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:01:55,971 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:01:55,991 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:01:56,97 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:01:56,111 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:01:56,652 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:01:56,661 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:01:56,704 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:01:56,716 INFO     [learner.py:606] ====Pushing takes 0.011350154876708984 s
2021-08-18:17:01:56,739 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:56,744 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:01:56,745 INFO     [param_server.py:410] Lock worker 1 with localStep 430 , while globalStep is 429

2021-08-18:17:01:57,964 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:01:57,973 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:01:58,945 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:01:58,960 INFO     [learner.py:606] ====Pushing takes 0.013891220092773438 s
2021-08-18:17:01:58,975 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:58,980 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:01:58,980 INFO     [param_server.py:410] Lock worker 2 with localStep 430 , while globalStep is 429

2021-08-18:17:01:59,198 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:01:59,218 INFO     [learner.py:606] ====Pushing takes 0.019123315811157227 s
2021-08-18:17:01:59,249 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:01:59,254 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:01:59,255 INFO     [param_server.py:381] ====After aggregation in epoch: 429, virtual_clock: 20565.878949392194, top_1: : 67.7961 % (2101.0), top_5: : 100.0 % (3099.0), test loss: 3.6673719706358736, test len: 3099.0
2021-08-18:17:01:59,257 INFO     [param_server.py:410] Lock worker 3 with localStep 430 , while globalStep is 430

2021-08-18:17:01:59,258 INFO     [param_server.py:441] ====Epoch 431 completes 13 clients with loss 5.959127995346211, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:01:59,258 INFO     [param_server.py:450] ====Start to sample for epoch 431, global virtualClock: 20565.878949392194, round_duration: 80.35344175505469
2021-08-18:17:01:59,259 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:01:59,559 INFO     [param_server.py:553] For epoch: 431, median_reward: 1163.9809223348168, dev: 5819.904611674084
2021-08-18:17:02:00,242 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.882, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:17:02:00,243 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5555.3794, eval_time 0.6386, test_loss 3.882, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:17:02:00,287 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6651, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:02:00,288 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5555.4124, eval_time 0.6738, test_loss 3.6651, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:02:00,350 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:02:00,357 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:02:00,358 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:00,363 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2379, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:02:00,364 INFO     [learner.py:656] After aggregation epoch 430, CumulTime 5555.5033, eval_time 0.7593, test_loss 4.2379, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:02:00,372 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:00,435 INFO     [learner.py:526] ====Start train round 431
2021-08-18:17:02:00,461 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:01,583 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:01,615 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:02,459 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:02,487 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:02,579 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:02,589 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:04,453 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:04,480 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:05,281 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:05,295 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:05,529 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:05,563 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:06,19 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:06,46 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:06,439 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:06,466 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:06,981 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:06,993 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:07,41 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:07,55 INFO     [learner.py:606] ====Pushing takes 0.012618780136108398 s
2021-08-18:17:02:07,71 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:07,78 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:07,79 INFO     [param_server.py:410] Lock worker 1 with localStep 431 , while globalStep is 430

2021-08-18:17:02:08,93 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:08,107 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:09,238 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:09,259 INFO     [learner.py:606] ====Pushing takes 0.019307613372802734 s
2021-08-18:17:02:09,261 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:09,283 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:09,284 INFO     [learner.py:606] ====Pushing takes 0.020784854888916016 s
2021-08-18:17:02:09,288 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:09,289 INFO     [param_server.py:410] Lock worker 3 with localStep 431 , while globalStep is 430

2021-08-18:17:02:09,301 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:09,306 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:09,306 INFO     [param_server.py:381] ====After aggregation in epoch: 430, virtual_clock: 20646.23239114725, top_1: : 63.1817 % (1958.0), top_5: : 100.0 % (3099.0), test loss: 3.9283545458758318, test len: 3099.0
2021-08-18:17:02:09,309 INFO     [param_server.py:410] Lock worker 2 with localStep 431 , while globalStep is 431

2021-08-18:17:02:09,309 INFO     [param_server.py:441] ====Epoch 432 completes 13 clients with loss 5.118458934220073, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:09,309 INFO     [param_server.py:450] ====Start to sample for epoch 432, global virtualClock: 20646.23239114725, round_duration: 80.35344175505469
2021-08-18:17:02:09,310 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:09,589 INFO     [param_server.py:553] For epoch: 432, median_reward: 1081.150661494211, dev: 5405.7533074710545
2021-08-18:17:02:10,200 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3795, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:02:10,201 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5565.3256, eval_time 0.5596, test_loss 3.3795, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:02:10,201 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6223, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:02:10,202 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5565.3377, eval_time 0.5604, test_loss 3.6223, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:02:10,270 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:02:10,279 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:10,288 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.0147, Top-1 Accuracy: 699.0/1033 (0.6767), Top-5 Accuracy: 1.0
2021-08-18:17:02:10,289 INFO     [learner.py:656] After aggregation epoch 431, CumulTime 5565.4281, eval_time 0.6522, test_loss 5.0147, test_accuracy 0.6767, test_5_accuracy 1.0 

2021-08-18:17:02:10,312 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:02:10,321 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:10,358 INFO     [learner.py:526] ====Start train round 432
2021-08-18:17:02:10,387 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:11,598 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:11,612 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:12,472 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:12,506 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:12,630 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:12,643 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:14,822 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:14,840 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:15,335 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:15,362 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:15,449 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:15,461 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:16,324 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:16,338 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:16,362 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:16,389 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:17,19 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:17,30 INFO     [learner.py:606] ====Pushing takes 0.010674476623535156 s
2021-08-18:17:02:17,47 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:17,52 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:17,52 INFO     [param_server.py:410] Lock worker 1 with localStep 432 , while globalStep is 431

2021-08-18:17:02:17,91 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:17,102 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:18,95 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:18,109 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:19,212 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:19,236 INFO     [learner.py:606] ====Pushing takes 0.022109270095825195 s
2021-08-18:17:02:19,264 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:19,269 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:19,270 INFO     [param_server.py:410] Lock worker 3 with localStep 432 , while globalStep is 431

2021-08-18:17:02:19,417 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:19,433 INFO     [learner.py:606] ====Pushing takes 0.014441490173339844 s
2021-08-18:17:02:19,448 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:19,454 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:19,454 INFO     [param_server.py:381] ====After aggregation in epoch: 431, virtual_clock: 20726.585832902303, top_1: : 65.7309 % (2037.0), top_5: : 100.0 % (3099.0), test loss: 4.005484625145241, test len: 3099.0
2021-08-18:17:02:19,456 INFO     [param_server.py:410] Lock worker 2 with localStep 432 , while globalStep is 432

2021-08-18:17:02:19,457 INFO     [param_server.py:441] ====Epoch 433 completes 13 clients with loss 3.7790292677159543, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:19,457 INFO     [param_server.py:450] ====Start to sample for epoch 433, global virtualClock: 20726.585832902303, round_duration: 80.35344175505469
2021-08-18:17:02:19,458 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:19,727 INFO     [param_server.py:553] For epoch: 433, median_reward: 1153.9006685717113, dev: 5769.503342858557
2021-08-18:17:02:20,556 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7585, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:02:20,568 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5575.7036, eval_time 0.7815, test_loss 3.7585, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:02:20,596 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3517, Top-1 Accuracy: 684.0/1033 (0.6621), Top-5 Accuracy: 1.0
2021-08-18:17:02:20,597 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5575.7217, eval_time 0.8072, test_loss 3.3517, test_accuracy 0.6621, test_5_accuracy 1.0 

2021-08-18:17:02:20,653 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:02:20,662 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:20,667 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:02:20,670 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6863, Top-1 Accuracy: 707.0/1033 (0.6844), Top-5 Accuracy: 1.0
2021-08-18:17:02:20,671 INFO     [learner.py:656] After aggregation epoch 432, CumulTime 5575.8102, eval_time 0.8882, test_loss 3.6863, test_accuracy 0.6844, test_5_accuracy 1.0 

2021-08-18:17:02:20,690 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:20,730 INFO     [learner.py:526] ====Start train round 433
2021-08-18:17:02:20,753 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:22,32 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:22,46 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:22,756 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:22,767 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:22,808 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:22,836 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:24,867 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:24,885 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:25,398 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:25,417 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:25,577 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:25,610 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:26,271 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:26,291 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:26,456 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:26,486 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:27,120 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:27,134 INFO     [learner.py:606] ====Pushing takes 0.012398481369018555 s
2021-08-18:17:02:27,149 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:27,154 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:27,158 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:27,161 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:27,162 INFO     [param_server.py:410] Lock worker 1 with localStep 433 , while globalStep is 432

2021-08-18:17:02:28,343 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:28,357 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:29,446 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:29,454 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:29,463 INFO     [learner.py:606] ====Pushing takes 0.015532732009887695 s
2021-08-18:17:02:29,481 INFO     [learner.py:606] ====Pushing takes 0.024850130081176758 s
2021-08-18:17:02:29,481 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:29,485 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 8 clients
2021-08-18:17:02:29,486 INFO     [param_server.py:410] Lock worker 2 with localStep 433 , while globalStep is 432

2021-08-18:17:02:29,506 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:29,511 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:29,512 INFO     [param_server.py:381] ====After aggregation in epoch: 432, virtual_clock: 20806.939274657358, top_1: : 66.6667 % (2066.0), top_5: : 100.0 % (3099.0), test loss: 3.5988489521874327, test len: 3099.0
2021-08-18:17:02:29,514 INFO     [param_server.py:410] Lock worker 3 with localStep 433 , while globalStep is 433

2021-08-18:17:02:29,515 INFO     [param_server.py:441] ====Epoch 434 completes 13 clients with loss 5.7477368195481855, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:29,515 INFO     [param_server.py:450] ====Start to sample for epoch 434, global virtualClock: 20806.939274657358, round_duration: 80.35344175505469
2021-08-18:17:02:29,516 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:29,778 INFO     [param_server.py:553] For epoch: 434, median_reward: 1172.7806091714274, dev: 5863.903045857137
2021-08-18:17:02:30,463 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7104, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:02:30,466 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5585.6017, eval_time 0.6427, test_loss 3.7104, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:02:30,467 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.145, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:02:30,468 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5585.5925, eval_time 0.6448, test_loss 3.145, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:02:30,539 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:02:30,539 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:02:30,543 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5207, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:17:02:30,544 INFO     [learner.py:656] After aggregation epoch 433, CumulTime 5585.6836, eval_time 0.7214, test_loss 3.5207, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:17:02:30,547 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:30,552 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:30,618 INFO     [learner.py:526] ====Start train round 434
2021-08-18:17:02:30,648 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:31,699 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:31,709 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:32,657 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:32,669 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:32,740 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:32,768 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:34,785 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:34,799 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:35,576 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:35,592 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:35,694 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:35,721 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:36,303 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:36,324 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:36,557 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:36,577 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:37,144 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:37,158 INFO     [learner.py:606] ====Pushing takes 0.012149333953857422 s
2021-08-18:17:02:37,180 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:37,185 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:37,185 INFO     [param_server.py:410] Lock worker 1 with localStep 434 , while globalStep is 433

2021-08-18:17:02:37,343 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:37,361 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:38,97 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:38,107 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:39,138 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:39,158 INFO     [learner.py:606] ====Pushing takes 0.019340038299560547 s
2021-08-18:17:02:39,188 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:39,194 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:39,195 INFO     [param_server.py:410] Lock worker 3 with localStep 434 , while globalStep is 433

2021-08-18:17:02:39,649 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:39,672 INFO     [learner.py:606] ====Pushing takes 0.02123403549194336 s
2021-08-18:17:02:39,687 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:39,692 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:39,692 INFO     [param_server.py:381] ====After aggregation in epoch: 433, virtual_clock: 20887.292716412412, top_1: : 66.2472 % (2053.0), top_5: : 100.0 % (3099.0), test loss: 3.4586873628475043, test len: 3099.0
2021-08-18:17:02:39,694 INFO     [param_server.py:410] Lock worker 2 with localStep 434 , while globalStep is 434

2021-08-18:17:02:39,695 INFO     [param_server.py:441] ====Epoch 435 completes 13 clients with loss 3.22040941701531, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:39,696 INFO     [param_server.py:450] ====Start to sample for epoch 435, global virtualClock: 20887.292716412412, round_duration: 80.35344175505469
2021-08-18:17:02:39,697 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:39,973 INFO     [param_server.py:553] For epoch: 435, median_reward: 1384.7458727688795, dev: 6923.729363844397
2021-08-18:17:02:40,584 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7552, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:02:40,585 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5595.7212, eval_time 0.5532, test_loss 3.7552, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:02:40,654 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:02:40,663 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:40,720 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.508, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:02:40,721 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5595.8454, eval_time 0.6862, test_loss 3.508, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:02:40,789 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:02:40,799 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3825, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:02:40,800 INFO     [learner.py:656] After aggregation epoch 434, CumulTime 5595.9396, eval_time 0.7708, test_loss 3.3825, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:02:40,811 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:40,856 INFO     [learner.py:526] ====Start train round 435
2021-08-18:17:02:40,890 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:42,88 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:42,102 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:42,975 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:42,996 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:43,34 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:43,45 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:44,847 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:44,859 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:45,876 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:45,883 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:45,895 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:45,910 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:46,59 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:46,79 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:46,900 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:46,933 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:47,524 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:47,538 INFO     [learner.py:606] ====Pushing takes 0.012064218521118164 s
2021-08-18:17:02:47,569 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:47,578 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:47,593 INFO     [param_server.py:410] Lock worker 1 with localStep 435 , while globalStep is 434

2021-08-18:17:02:47,602 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:47,612 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:48,17 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:48,31 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:49,261 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:49,288 INFO     [learner.py:606] ====Pushing takes 0.02225470542907715 s
2021-08-18:17:02:49,310 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:49,316 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:49,316 INFO     [param_server.py:410] Lock worker 3 with localStep 435 , while globalStep is 434

2021-08-18:17:02:49,978 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:02:49,994 INFO     [learner.py:606] ====Pushing takes 0.014521360397338867 s
2021-08-18:17:02:50,9 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:50,14 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:02:50,15 INFO     [param_server.py:381] ====After aggregation in epoch: 434, virtual_clock: 20967.646158167467, top_1: : 65.4082 % (2027.0), top_5: : 100.0 % (3099.0), test loss: 3.5485452457710545, test len: 3099.0
2021-08-18:17:02:50,17 INFO     [param_server.py:410] Lock worker 2 with localStep 435 , while globalStep is 435

2021-08-18:17:02:50,17 INFO     [param_server.py:441] ====Epoch 436 completes 13 clients with loss 2.902413174724167, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:02:50,18 INFO     [param_server.py:450] ====Start to sample for epoch 436, global virtualClock: 20967.646158167467, round_duration: 80.35344175505469
2021-08-18:17:02:50,19 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:02:50,304 INFO     [param_server.py:553] For epoch: 436, median_reward: 1070.028730348695, dev: 5350.143651743475
2021-08-18:17:02:50,944 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.623, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:02:50,945 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5606.0807, eval_time 0.6064, test_loss 3.623, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:02:50,950 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4377, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:17:02:50,951 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5606.0761, eval_time 0.6131, test_loss 3.4377, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:17:02:51,10 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.995, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:17:02:51,10 INFO     [learner.py:656] After aggregation epoch 435, CumulTime 5606.1497, eval_time 0.6722, test_loss 3.995, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:17:02:51,17 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:51,25 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:02:51,53 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:51,62 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:02:51,82 INFO     [learner.py:526] ====Start train round 436
2021-08-18:17:02:51,101 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:02:52,365 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:02:52,379 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:02:53,472 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:02:53,497 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:02:53,506 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:02:53,515 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:02:55,243 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:02:55,262 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:02:56,255 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:02:56,267 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:02:56,310 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:02:56,324 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:02:56,660 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:02:56,670 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:02:57,90 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:02:57,111 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:02:57,728 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:02:57,740 INFO     [learner.py:606] ====Pushing takes 0.01104736328125 s
2021-08-18:17:02:57,763 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:57,768 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:02:57,768 INFO     [param_server.py:410] Lock worker 1 with localStep 436 , while globalStep is 435

2021-08-18:17:02:58,136 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:02:58,145 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:02:58,424 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:02:58,435 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:02:59,651 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:02:59,672 INFO     [learner.py:606] ====Pushing takes 0.019025325775146484 s
2021-08-18:17:02:59,694 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:02:59,699 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:02:59,700 INFO     [param_server.py:410] Lock worker 3 with localStep 436 , while globalStep is 435

2021-08-18:17:03:00,463 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:00,484 INFO     [learner.py:606] ====Pushing takes 0.018967866897583008 s
2021-08-18:17:03:00,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:00,505 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:00,506 INFO     [param_server.py:381] ====After aggregation in epoch: 435, virtual_clock: 21047.99959992252, top_1: : 66.2794 % (2054.0), top_5: : 100.0 % (3099.0), test loss: 3.685212091163353, test len: 3099.0
2021-08-18:17:03:00,508 INFO     [param_server.py:410] Lock worker 2 with localStep 436 , while globalStep is 436

2021-08-18:17:03:00,509 INFO     [param_server.py:441] ====Epoch 437 completes 13 clients with loss 6.786327854187377, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:00,509 INFO     [param_server.py:450] ====Start to sample for epoch 437, global virtualClock: 21047.99959992252, round_duration: 80.35344175505469
2021-08-18:17:03:00,510 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:00,787 INFO     [param_server.py:553] For epoch: 437, median_reward: 1003.3717588407847, dev: 5016.858794203923
2021-08-18:17:03:01,474 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7061, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:03:01,475 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5616.6106, eval_time 0.6307, test_loss 3.7061, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:03:01,474 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3364, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:03:01,477 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5616.6019, eval_time 0.6334, test_loss 3.3364, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:03:01,547 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:03:01,543 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0707, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:17:03:01,560 INFO     [learner.py:656] After aggregation epoch 436, CumulTime 5616.6991, eval_time 0.7172, test_loss 4.0707, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:17:03:01,561 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:01,564 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:03:01,579 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:01,616 INFO     [learner.py:526] ====Start train round 437
2021-08-18:17:03:01,633 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:02,762 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:02,772 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:03,559 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:03,586 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:03,799 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:03,812 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:05,438 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:05,456 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:06,387 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:06,396 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:06,568 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:06,595 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:07,1 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:07,19 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:07,391 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:07,412 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:08,21 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:08,35 INFO     [learner.py:606] ====Pushing takes 0.012903451919555664 s
2021-08-18:17:03:08,60 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:08,67 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:08,68 INFO     [param_server.py:410] Lock worker 1 with localStep 437 , while globalStep is 436

2021-08-18:17:03:08,104 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:08,115 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:08,679 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:08,688 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:09,704 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:09,724 INFO     [learner.py:606] ====Pushing takes 0.018950462341308594 s
2021-08-18:17:03:09,748 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:09,756 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:09,756 INFO     [param_server.py:410] Lock worker 3 with localStep 437 , while globalStep is 436

2021-08-18:17:03:10,278 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:10,293 INFO     [learner.py:606] ====Pushing takes 0.01369023323059082 s
2021-08-18:17:03:10,309 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:10,313 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:10,314 INFO     [param_server.py:381] ====After aggregation in epoch: 436, virtual_clock: 21128.353041677576, top_1: : 65.2791 % (2023.0), top_5: : 100.0 % (3099.0), test loss: 3.704383351184704, test len: 3099.0
2021-08-18:17:03:10,317 INFO     [param_server.py:410] Lock worker 2 with localStep 437 , while globalStep is 437

2021-08-18:17:03:10,318 INFO     [param_server.py:441] ====Epoch 438 completes 13 clients with loss 5.36760492358533, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:10,318 INFO     [param_server.py:450] ====Start to sample for epoch 438, global virtualClock: 21128.353041677576, round_duration: 80.35344175505469
2021-08-18:17:03:10,319 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:10,591 INFO     [param_server.py:553] For epoch: 438, median_reward: 1098.2903557901577, dev: 5491.451778950788
2021-08-18:17:03:11,381 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8782, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:03:11,381 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2632, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:03:11,382 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5626.5178, eval_time 0.7203, test_loss 3.8782, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:03:11,382 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5626.5066, eval_time 0.7174, test_loss 3.2632, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:03:11,447 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:03:11,447 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:03:11,455 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:11,461 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:11,516 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6125, Top-1 Accuracy: 714.0/1033 (0.6912), Top-5 Accuracy: 1.0
2021-08-18:17:03:11,517 INFO     [learner.py:656] After aggregation epoch 437, CumulTime 5626.6561, eval_time 0.8595, test_loss 3.6125, test_accuracy 0.6912, test_5_accuracy 1.0 

2021-08-18:17:03:11,596 INFO     [learner.py:526] ====Start train round 438
2021-08-18:17:03:11,623 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:12,738 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:12,748 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:13,734 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:13,741 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:13,750 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:13,762 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:15,363 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:15,373 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:16,267 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:16,285 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:16,624 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:16,651 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:16,799 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:16,817 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:17,606 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:17,633 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:18,73 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:18,87 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:18,358 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:18,375 INFO     [learner.py:606] ====Pushing takes 0.012924671173095703 s
2021-08-18:17:03:18,398 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:18,403 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:18,404 INFO     [param_server.py:410] Lock worker 1 with localStep 438 , while globalStep is 437

2021-08-18:17:03:18,601 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:18,610 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:19,659 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:19,679 INFO     [learner.py:606] ====Pushing takes 0.018967390060424805 s
2021-08-18:17:03:19,708 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:19,713 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:19,714 INFO     [param_server.py:410] Lock worker 3 with localStep 438 , while globalStep is 437

2021-08-18:17:03:20,405 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:20,420 INFO     [learner.py:606] ====Pushing takes 0.013759374618530273 s
2021-08-18:17:03:20,435 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:20,440 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:20,441 INFO     [param_server.py:381] ====After aggregation in epoch: 437, virtual_clock: 21208.70648343263, top_1: : 67.6025 % (2095.0), top_5: : 100.0 % (3099.0), test loss: 3.5846250410433167, test len: 3099.0
2021-08-18:17:03:20,443 INFO     [param_server.py:410] Lock worker 2 with localStep 438 , while globalStep is 438

2021-08-18:17:03:20,444 INFO     [param_server.py:441] ====Epoch 439 completes 13 clients with loss 5.9970779285417315, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:20,444 INFO     [param_server.py:450] ====Start to sample for epoch 439, global virtualClock: 21208.70648343263, round_duration: 80.35344175505469
2021-08-18:17:03:20,445 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:20,721 INFO     [param_server.py:553] For epoch: 439, median_reward: 1181.9970161806534, dev: 5909.985080903267
2021-08-18:17:03:21,428 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4913, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:17:03:21,429 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8584, Top-1 Accuracy: 624.0/1033 (0.6041), Top-5 Accuracy: 1.0
2021-08-18:17:03:21,429 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5636.5536, eval_time 0.6631, test_loss 3.4913, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:17:03:21,429 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5636.5653, eval_time 0.6635, test_loss 3.8584, test_accuracy 0.6041, test_5_accuracy 1.0 

2021-08-18:17:03:21,498 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:03:21,499 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:03:21,507 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:21,508 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:21,551 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7247, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:17:03:21,552 INFO     [learner.py:656] After aggregation epoch 438, CumulTime 5636.6909, eval_time 0.7859, test_loss 3.7247, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:17:03:21,620 INFO     [learner.py:526] ====Start train round 439
2021-08-18:17:03:21,644 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:22,651 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:22,665 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:23,719 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:23,734 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:23,819 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:23,845 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:25,463 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:25,481 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:26,533 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:26,542 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:26,785 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:26,804 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:26,818 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:26,842 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:27,667 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:27,694 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:28,223 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:28,233 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:28,267 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:28,281 INFO     [learner.py:606] ====Pushing takes 0.012516260147094727 s
2021-08-18:17:03:28,304 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:28,311 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:28,312 INFO     [param_server.py:410] Lock worker 1 with localStep 439 , while globalStep is 438

2021-08-18:17:03:28,602 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:28,616 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:29,838 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:29,861 INFO     [learner.py:606] ====Pushing takes 0.021537303924560547 s
2021-08-18:17:03:29,889 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:29,895 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:29,895 INFO     [param_server.py:410] Lock worker 3 with localStep 439 , while globalStep is 438

2021-08-18:17:03:30,610 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:30,626 INFO     [learner.py:606] ====Pushing takes 0.014297962188720703 s
2021-08-18:17:03:30,641 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:30,646 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:30,647 INFO     [param_server.py:381] ====After aggregation in epoch: 438, virtual_clock: 21289.059925187685, top_1: : 62.6976 % (1943.0), top_5: : 100.0 % (3099.0), test loss: 3.6914575409006196, test len: 3099.0
2021-08-18:17:03:30,649 INFO     [param_server.py:410] Lock worker 2 with localStep 439 , while globalStep is 439

2021-08-18:17:03:30,650 INFO     [param_server.py:441] ====Epoch 440 completes 13 clients with loss 3.750664682674654, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:30,650 INFO     [param_server.py:450] ====Start to sample for epoch 440, global virtualClock: 21289.059925187685, round_duration: 80.35344175505469
2021-08-18:17:03:30,651 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:30,918 INFO     [param_server.py:553] For epoch: 440, median_reward: 1237.7363716405582, dev: 6188.681858202791
2021-08-18:17:03:31,573 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1503, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:03:31,575 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5646.7105, eval_time 0.6118, test_loss 4.1503, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:03:31,579 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2968, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:03:31,580 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5646.7049, eval_time 0.6149, test_loss 3.2968, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:03:31,619 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.327, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:17:03:31,621 INFO     [learner.py:656] After aggregation epoch 439, CumulTime 5646.7598, eval_time 0.6578, test_loss 3.327, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:17:03:31,647 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:03:31,652 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:03:31,655 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:31,660 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:31,691 INFO     [learner.py:526] ====Start train round 440
2021-08-18:17:03:31,707 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:32,728 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:32,738 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:33,691 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:33,724 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:33,764 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:33,797 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:35,384 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:35,405 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:36,417 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:36,428 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:36,677 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:36,692 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:36,773 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:36,881 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:37,577 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:37,597 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:38,230 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:38,246 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:38,316 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:38,330 INFO     [learner.py:606] ====Pushing takes 0.012192964553833008 s
2021-08-18:17:03:38,352 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:38,356 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:38,357 INFO     [param_server.py:410] Lock worker 1 with localStep 440 , while globalStep is 439

2021-08-18:17:03:38,488 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:38,498 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:39,466 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:39,487 INFO     [learner.py:606] ====Pushing takes 0.019580602645874023 s
2021-08-18:17:03:39,510 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:39,516 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:39,517 INFO     [param_server.py:410] Lock worker 3 with localStep 440 , while globalStep is 439

2021-08-18:17:03:40,470 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:40,486 INFO     [learner.py:606] ====Pushing takes 0.013852596282958984 s
2021-08-18:17:03:40,501 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:40,506 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:40,506 INFO     [param_server.py:381] ====After aggregation in epoch: 439, virtual_clock: 21369.41336694274, top_1: : 65.9568 % (2044.0), top_5: : 100.0 % (3099.0), test loss: 3.5913588912398726, test len: 3099.0
2021-08-18:17:03:40,509 INFO     [param_server.py:410] Lock worker 2 with localStep 440 , while globalStep is 440

2021-08-18:17:03:40,509 INFO     [param_server.py:441] ====Epoch 441 completes 13 clients with loss 4.330141045195703, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:40,510 INFO     [param_server.py:450] ====Start to sample for epoch 441, global virtualClock: 21369.41336694274, round_duration: 80.35344175505469
2021-08-18:17:03:40,510 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:40,774 INFO     [param_server.py:541] Handle Wight 0.019410371780395508 | Send 0.26453232765197754
2021-08-18:17:03:40,775 INFO     [param_server.py:553] For epoch: 441, median_reward: 1133.4587555050214, dev: 5667.293777525107
2021-08-18:17:03:41,396 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8841, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:17:03:41,398 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5656.5336, eval_time 0.5571, test_loss 3.8841, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:17:03:41,465 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:03:41,472 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5227, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:03:41,472 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5656.597, eval_time 0.6314, test_loss 3.5227, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:03:41,477 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:41,539 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:03:41,555 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9373, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:17:03:41,556 INFO     [learner.py:656] After aggregation epoch 440, CumulTime 5656.6953, eval_time 0.7156, test_loss 3.9373, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:17:03:41,556 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:41,625 INFO     [learner.py:526] ====Start train round 441
2021-08-18:17:03:41,654 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:42,773 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:42,782 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:43,594 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:43,608 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:43,855 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:43,865 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:45,596 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:45,609 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:46,494 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:46,534 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:46,649 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:46,665 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:47,9 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:47,23 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:47,411 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:47,445 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:48,89 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:48,103 INFO     [learner.py:606] ====Pushing takes 0.012671709060668945 s
2021-08-18:17:03:48,131 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:48,138 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:48,139 INFO     [param_server.py:410] Lock worker 1 with localStep 441 , while globalStep is 440

2021-08-18:17:03:48,607 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:48,618 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:48,677 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:48,695 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:03:49,678 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:03:49,698 INFO     [learner.py:606] ====Pushing takes 0.019023656845092773 s
2021-08-18:17:03:49,728 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:49,734 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:03:49,734 INFO     [param_server.py:410] Lock worker 3 with localStep 441 , while globalStep is 440

2021-08-18:17:03:50,865 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:03:50,883 INFO     [learner.py:606] ====Pushing takes 0.01601433753967285 s
2021-08-18:17:03:50,906 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:50,912 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:03:50,912 INFO     [param_server.py:381] ====After aggregation in epoch: 440, virtual_clock: 21449.766808697794, top_1: : 64.4079 % (1996.0), top_5: : 100.0 % (3099.0), test loss: 3.781345861929434, test len: 3099.0
2021-08-18:17:03:50,915 INFO     [param_server.py:410] Lock worker 2 with localStep 441 , while globalStep is 441

2021-08-18:17:03:50,916 INFO     [param_server.py:441] ====Epoch 442 completes 13 clients with loss 4.250703346217018, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:03:50,916 INFO     [param_server.py:450] ====Start to sample for epoch 442, global virtualClock: 21449.766808697794, round_duration: 80.35344175505469
2021-08-18:17:03:50,917 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:03:51,253 INFO     [param_server.py:553] For epoch: 442, median_reward: 1253.879800158698, dev: 6269.39900079349
2021-08-18:17:03:51,862 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4767, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:03:51,862 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5666.9984, eval_time 0.5738, test_loss 3.4767, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:03:51,865 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.1616, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:03:51,866 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5666.9901, eval_time 0.5769, test_loss 3.1616, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:03:51,930 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:51,935 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:51,938 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:03:51,943 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:03:52,35 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6709, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:17:03:52,37 INFO     [learner.py:656] After aggregation epoch 441, CumulTime 5667.1767, eval_time 0.7507, test_loss 3.6709, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:17:03:52,107 INFO     [learner.py:526] ====Start train round 442
2021-08-18:17:03:52,142 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:03:53,97 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:03:53,117 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:03:54,225 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:03:54,243 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:03:54,312 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:03:54,333 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:03:55,782 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:03:55,792 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:03:56,981 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:03:56,993 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:03:57,109 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:03:57,142 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:03:57,341 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:03:57,351 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:03:58,65 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:03:58,98 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:03:58,676 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:03:58,692 INFO     [learner.py:606] ====Pushing takes 0.013978242874145508 s
2021-08-18:17:03:58,692 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:03:58,701 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:03:58,717 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:03:58,723 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:03:58,723 INFO     [param_server.py:410] Lock worker 1 with localStep 442 , while globalStep is 441

2021-08-18:17:03:59,327 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:03:59,348 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:00,374 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:00,396 INFO     [learner.py:606] ====Pushing takes 0.01983475685119629 s
2021-08-18:17:04:00,425 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:00,431 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:00,431 INFO     [param_server.py:410] Lock worker 3 with localStep 442 , while globalStep is 441

2021-08-18:17:04:00,976 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:00,992 INFO     [learner.py:606] ====Pushing takes 0.01470494270324707 s
2021-08-18:17:04:01,7 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:01,12 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:01,12 INFO     [param_server.py:381] ====After aggregation in epoch: 441, virtual_clock: 21530.12025045285, top_1: : 65.5373 % (2031.0), top_5: : 100.0 % (3099.0), test loss: 3.4363859406224004, test len: 3099.0
2021-08-18:17:04:01,14 INFO     [param_server.py:410] Lock worker 2 with localStep 442 , while globalStep is 442

2021-08-18:17:04:01,14 INFO     [param_server.py:441] ====Epoch 443 completes 13 clients with loss 3.488102626211014, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:01,15 INFO     [param_server.py:450] ====Start to sample for epoch 443, global virtualClock: 21530.12025045285, round_duration: 80.35344175505469
2021-08-18:17:04:01,15 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:01,350 INFO     [param_server.py:553] For epoch: 443, median_reward: 1135.5587843476387, dev: 5677.793921738194
2021-08-18:17:04:02,9 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3794, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:04:02,10 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5677.1344, eval_time 0.6359, test_loss 3.3794, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:04:02,13 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8969, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:04:02,14 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5677.1495, eval_time 0.6397, test_loss 3.8969, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:04:02,58 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.3061, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:04:02,59 INFO     [learner.py:656] After aggregation epoch 442, CumulTime 5677.1984, eval_time 0.6854, test_loss 3.3061, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:04:02,79 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:04:02,84 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:04:02,88 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:02,92 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:02,130 INFO     [learner.py:526] ====Start train round 443
2021-08-18:17:04:02,154 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:03,161 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:03,173 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:04,148 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:04,158 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:04,352 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:04,386 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:06,19 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:06,33 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:07,25 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:07,39 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:07,152 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:07,166 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:07,537 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:07,546 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:07,914 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:07,935 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:08,536 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:08,555 INFO     [learner.py:606] ====Pushing takes 0.012477874755859375 s
2021-08-18:17:04:08,578 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:08,586 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:08,586 INFO     [param_server.py:410] Lock worker 1 with localStep 443 , while globalStep is 442

2021-08-18:17:04:08,791 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:08,800 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:09,308 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:09,318 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:10,480 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:10,500 INFO     [learner.py:606] ====Pushing takes 0.019264936447143555 s
2021-08-18:17:04:10,523 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:10,529 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:10,530 INFO     [param_server.py:410] Lock worker 3 with localStep 443 , while globalStep is 442

2021-08-18:17:04:10,994 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:11,10 INFO     [learner.py:606] ====Pushing takes 0.014191627502441406 s
2021-08-18:17:04:11,26 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:11,31 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:11,31 INFO     [param_server.py:381] ====After aggregation in epoch: 442, virtual_clock: 21610.473692207903, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 3.5274743746828148, test len: 3099.0
2021-08-18:17:04:11,34 INFO     [param_server.py:410] Lock worker 2 with localStep 443 , while globalStep is 443

2021-08-18:17:04:11,34 INFO     [param_server.py:441] ====Epoch 444 completes 13 clients with loss 4.394792039856693, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:11,35 INFO     [param_server.py:450] ====Start to sample for epoch 444, global virtualClock: 21610.473692207903, round_duration: 80.35344175505469
2021-08-18:17:04:11,36 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:11,372 INFO     [param_server.py:553] For epoch: 444, median_reward: 1168.8692368723816, dev: 5844.346184361908
2021-08-18:17:04:12,17 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4569, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:04:12,18 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5687.1427, eval_time 0.5992, test_loss 3.4569, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:04:12,14 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.4905, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:04:12,31 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5687.1671, eval_time 0.6123, test_loss 3.4905, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:04:12,60 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6446, Top-1 Accuracy: 718.0/1033 (0.6951), Top-5 Accuracy: 1.0
2021-08-18:17:04:12,61 INFO     [learner.py:656] After aggregation epoch 443, CumulTime 5687.2004, eval_time 0.6449, test_loss 3.6446, test_accuracy 0.6951, test_5_accuracy 1.0 

2021-08-18:17:04:12,89 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:04:12,97 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:12,116 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:04:12,123 INFO     [learner.py:526] ====Start train round 444
2021-08-18:17:04:12,124 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:12,137 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:13,250 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:13,259 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:14,6 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:14,27 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:14,282 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:14,295 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:15,987 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:16,0 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:17,111 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:17,131 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:17,275 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:17,309 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:17,645 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:17,658 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:18,7 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:18,21 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:18,656 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:18,669 INFO     [learner.py:606] ====Pushing takes 0.011580944061279297 s
2021-08-18:17:04:18,693 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:18,699 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:18,699 INFO     [param_server.py:410] Lock worker 1 with localStep 444 , while globalStep is 443

2021-08-18:17:04:18,715 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:18,727 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:19,303 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:19,314 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:20,465 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:20,498 INFO     [learner.py:606] ====Pushing takes 0.018841981887817383 s
2021-08-18:17:04:20,526 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:20,531 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:20,532 INFO     [param_server.py:410] Lock worker 3 with localStep 444 , while globalStep is 443

2021-08-18:17:04:21,76 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:21,91 INFO     [learner.py:606] ====Pushing takes 0.014257669448852539 s
2021-08-18:17:04:21,106 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:21,111 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:21,112 INFO     [param_server.py:381] ====After aggregation in epoch: 443, virtual_clock: 21690.827133962957, top_1: : 66.9571 % (2075.0), top_5: : 100.0 % (3099.0), test loss: 3.530645569165548, test len: 3099.0
2021-08-18:17:04:21,114 INFO     [param_server.py:410] Lock worker 2 with localStep 444 , while globalStep is 444

2021-08-18:17:04:21,115 INFO     [param_server.py:441] ====Epoch 445 completes 13 clients with loss 4.4779864904456685, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:21,116 INFO     [param_server.py:450] ====Start to sample for epoch 445, global virtualClock: 21690.827133962957, round_duration: 80.35344175505469
2021-08-18:17:04:21,117 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:21,450 INFO     [param_server.py:553] For epoch: 445, median_reward: 975.4570726292826, dev: 4877.285363146413
2021-08-18:17:04:22,118 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7225, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:04:22,119 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5697.2551, eval_time 0.6027, test_loss 3.7225, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:04:22,145 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3646, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:04:22,146 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5697.2702, eval_time 0.629, test_loss 3.3646, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:04:22,187 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:04:22,196 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:22,216 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:04:22,230 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:22,297 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9757, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:17:04:22,298 INFO     [learner.py:656] After aggregation epoch 444, CumulTime 5697.4377, eval_time 0.7819, test_loss 3.9757, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:17:04:22,369 INFO     [learner.py:526] ====Start train round 445
2021-08-18:17:04:22,397 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:23,673 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:23,699 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:24,319 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:24,338 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:24,570 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:24,581 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:26,343 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:26,356 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:27,288 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:27,300 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:27,413 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:27,447 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:27,865 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:27,883 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:28,314 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:28,348 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:29,41 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:29,56 INFO     [learner.py:606] ====Pushing takes 0.012815237045288086 s
2021-08-18:17:04:29,72 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:29,79 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:29,80 INFO     [param_server.py:410] Lock worker 1 with localStep 445 , while globalStep is 444

2021-08-18:17:04:29,104 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:29,122 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:29,808 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:29,817 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:30,846 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:30,866 INFO     [learner.py:606] ====Pushing takes 0.018659353256225586 s
2021-08-18:17:04:30,888 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:30,894 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:30,894 INFO     [param_server.py:410] Lock worker 3 with localStep 445 , while globalStep is 444

2021-08-18:17:04:31,369 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:31,383 INFO     [learner.py:606] ====Pushing takes 0.013072729110717773 s
2021-08-18:17:04:31,398 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:31,403 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:31,403 INFO     [param_server.py:381] ====After aggregation in epoch: 444, virtual_clock: 21771.180575718012, top_1: : 64.7951 % (2008.0), top_5: : 100.0 % (3099.0), test loss: 3.6876099507013955, test len: 3099.0
2021-08-18:17:04:31,406 INFO     [param_server.py:410] Lock worker 2 with localStep 445 , while globalStep is 445

2021-08-18:17:04:31,407 INFO     [param_server.py:441] ====Epoch 446 completes 13 clients with loss 5.360777194602325, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:31,407 INFO     [param_server.py:450] ====Start to sample for epoch 446, global virtualClock: 21771.180575718012, round_duration: 80.35344175505469
2021-08-18:17:04:31,408 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:31,751 INFO     [param_server.py:553] For epoch: 446, median_reward: 1059.372625553536, dev: 5296.8631277676795
2021-08-18:17:04:32,516 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4824, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:04:32,517 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8449, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:04:32,517 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5707.642, eval_time 0.7293, test_loss 3.4824, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:04:32,518 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5707.6535, eval_time 0.7295, test_loss 3.8449, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:04:32,586 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:04:32,586 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:04:32,593 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:32,595 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:32,676 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8784, Top-1 Accuracy: 686.0/1033 (0.6641), Top-5 Accuracy: 1.0
2021-08-18:17:04:32,677 INFO     [learner.py:656] After aggregation epoch 445, CumulTime 5707.8164, eval_time 0.8892, test_loss 3.8784, test_accuracy 0.6641, test_5_accuracy 1.0 

2021-08-18:17:04:32,749 INFO     [learner.py:526] ====Start train round 446
2021-08-18:17:04:32,782 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:33,726 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:33,739 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:34,792 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:34,812 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:35,182 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:35,209 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:36,736 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:36,750 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:37,497 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:37,509 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:37,791 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:37,812 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:37,901 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:37,911 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:38,693 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:38,727 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:39,255 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:39,265 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:39,456 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:39,469 INFO     [learner.py:606] ====Pushing takes 0.012049674987792969 s
2021-08-18:17:04:39,493 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:39,499 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:39,500 INFO     [param_server.py:410] Lock worker 1 with localStep 446 , while globalStep is 445

2021-08-18:17:04:39,804 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:39,815 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:40,984 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:41,5 INFO     [learner.py:606] ====Pushing takes 0.019594192504882812 s
2021-08-18:17:04:41,29 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:41,35 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:41,35 INFO     [param_server.py:410] Lock worker 3 with localStep 446 , while globalStep is 445

2021-08-18:17:04:41,667 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:41,685 INFO     [learner.py:606] ====Pushing takes 0.01679706573486328 s
2021-08-18:17:04:41,701 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:41,707 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:41,708 INFO     [param_server.py:381] ====After aggregation in epoch: 445, virtual_clock: 21851.534017473066, top_1: : 64.6983 % (2005.0), top_5: : 100.0 % (3099.0), test loss: 3.7352276996329983, test len: 3099.0
2021-08-18:17:04:41,711 INFO     [param_server.py:410] Lock worker 2 with localStep 446 , while globalStep is 446

2021-08-18:17:04:41,712 INFO     [param_server.py:441] ====Epoch 447 completes 13 clients with loss 5.107292866140081, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:41,712 INFO     [param_server.py:450] ====Start to sample for epoch 447, global virtualClock: 21851.534017473066, round_duration: 80.35344175505469
2021-08-18:17:04:41,713 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:42,68 INFO     [param_server.py:553] For epoch: 447, median_reward: 1034.8207496554444, dev: 5174.103748277222
2021-08-18:17:04:42,679 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.6, Top-1 Accuracy: 630.0/1033 (0.6099), Top-5 Accuracy: 1.0
2021-08-18:17:04:42,680 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5717.8165, eval_time 0.5791, test_loss 4.6, test_accuracy 0.6099, test_5_accuracy 1.0 

2021-08-18:17:04:42,690 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7517, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:04:42,691 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5717.8158, eval_time 0.5898, test_loss 3.7517, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:04:42,730 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8008, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:04:42,731 INFO     [learner.py:656] After aggregation epoch 446, CumulTime 5717.8704, eval_time 0.6298, test_loss 3.8008, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:04:42,754 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:04:42,761 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:42,763 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:04:42,771 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:42,824 INFO     [learner.py:526] ====Start train round 447
2021-08-18:17:04:42,841 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:44,79 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:44,88 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:45,112 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:45,152 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:45,218 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:45,237 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:46,830 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:46,844 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:48,32 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:48,51 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:48,133 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:48,147 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:48,185 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:48,195 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:48,742 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:48,762 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:49,438 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:49,451 INFO     [learner.py:606] ====Pushing takes 0.012143373489379883 s
2021-08-18:17:04:49,468 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:49,474 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:49,475 INFO     [param_server.py:410] Lock worker 1 with localStep 447 , while globalStep is 446

2021-08-18:17:04:49,707 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:04:49,716 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:04:49,868 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:04:49,878 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:04:50,909 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:04:50,929 INFO     [learner.py:606] ====Pushing takes 0.01905536651611328 s
2021-08-18:17:04:50,957 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:50,962 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:04:50,963 INFO     [param_server.py:410] Lock worker 3 with localStep 447 , while globalStep is 446

2021-08-18:17:04:52,151 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:04:52,167 INFO     [learner.py:606] ====Pushing takes 0.01433253288269043 s
2021-08-18:17:04:52,183 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:52,187 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:04:52,187 INFO     [param_server.py:381] ====After aggregation in epoch: 446, virtual_clock: 21931.88745922812, top_1: : 62.6976 % (1943.0), top_5: : 100.0 % (3099.0), test loss: 4.050825503137376, test len: 3099.0
2021-08-18:17:04:52,190 INFO     [param_server.py:410] Lock worker 2 with localStep 447 , while globalStep is 447

2021-08-18:17:04:52,190 INFO     [param_server.py:441] ====Epoch 448 completes 13 clients with loss 4.911249885333877, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:04:52,191 INFO     [param_server.py:450] ====Start to sample for epoch 448, global virtualClock: 21931.88745922812, round_duration: 80.35344175505469
2021-08-18:17:04:52,191 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:04:52,473 INFO     [param_server.py:553] For epoch: 448, median_reward: 1237.868979894212, dev: 6189.344899471061
2021-08-18:17:04:53,205 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1698, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:04:53,210 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5728.3464, eval_time 0.6797, test_loss 4.1698, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:04:53,238 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7921, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:04:53,239 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5728.3638, eval_time 0.7069, test_loss 3.7921, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:04:53,267 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1703, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:17:04:53,267 INFO     [learner.py:656] After aggregation epoch 447, CumulTime 5728.4067, eval_time 0.7387, test_loss 4.1703, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:17:04:53,282 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:53,290 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:04:53,309 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:53,321 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:04:53,345 INFO     [learner.py:526] ====Start train round 448
2021-08-18:17:04:53,363 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:04:54,525 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:04:54,534 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:04:55,331 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:04:55,359 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:04:55,589 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:04:55,607 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:04:57,139 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:04:57,150 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:04:58,434 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:04:58,455 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:04:58,475 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:04:58,487 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:04:58,612 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:04:58,630 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:04:59,179 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:04:59,200 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:04:59,861 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:04:59,874 INFO     [learner.py:606] ====Pushing takes 0.011714696884155273 s
2021-08-18:17:04:59,890 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:04:59,895 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:04:59,896 INFO     [param_server.py:410] Lock worker 1 with localStep 448 , while globalStep is 447

2021-08-18:17:05:00,115 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:00,127 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:00,511 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:00,522 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:01,586 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:01,606 INFO     [learner.py:606] ====Pushing takes 0.01820087432861328 s
2021-08-18:17:05:01,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:01,635 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:01,635 INFO     [param_server.py:410] Lock worker 3 with localStep 448 , while globalStep is 447

2021-08-18:17:05:02,208 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:02,224 INFO     [learner.py:606] ====Pushing takes 0.014053583145141602 s
2021-08-18:17:05:02,239 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:02,243 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:02,244 INFO     [param_server.py:381] ====After aggregation in epoch: 447, virtual_clock: 22012.240900983175, top_1: : 65.6341 % (2034.0), top_5: : 100.0 % (3099.0), test loss: 4.0440684777719005, test len: 3099.0
2021-08-18:17:05:02,247 INFO     [param_server.py:410] Lock worker 2 with localStep 448 , while globalStep is 448

2021-08-18:17:05:02,248 INFO     [param_server.py:441] ====Epoch 449 completes 13 clients with loss 7.087894685764534, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:02,248 INFO     [param_server.py:450] ====Start to sample for epoch 449, global virtualClock: 22012.240900983175, round_duration: 80.35344175505469
2021-08-18:17:05:02,249 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:02,566 INFO     [param_server.py:553] For epoch: 449, median_reward: 1094.342820353051, dev: 5471.714101765255
2021-08-18:17:05:03,277 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.4427, Top-1 Accuracy: 592.0/1033 (0.5731), Top-5 Accuracy: 1.0
2021-08-18:17:05:03,278 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5738.4027, eval_time 0.6554, test_loss 4.4427, test_accuracy 0.5731, test_5_accuracy 1.0 

2021-08-18:17:05:03,311 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.6997, Top-1 Accuracy: 606.0/1033 (0.5866), Top-5 Accuracy: 1.0
2021-08-18:17:05:03,312 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5738.4477, eval_time 0.689, test_loss 4.6997, test_accuracy 0.5866, test_5_accuracy 1.0 

2021-08-18:17:05:03,348 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:05:03,357 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:03,395 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:05:03,410 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:03,417 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.4882, Top-1 Accuracy: 636.0/1033 (0.6157), Top-5 Accuracy: 1.0
2021-08-18:17:05:03,420 INFO     [learner.py:656] After aggregation epoch 448, CumulTime 5738.559, eval_time 0.7983, test_loss 4.4882, test_accuracy 0.6157, test_5_accuracy 1.0 

2021-08-18:17:05:03,490 INFO     [learner.py:526] ====Start train round 449
2021-08-18:17:05:03,523 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:04,571 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:04,585 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:05,647 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:05,666 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:05,670 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:05,694 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:07,363 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:07,374 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:08,333 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:08,360 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:08,360 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:08,375 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:08,573 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:08,583 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:09,346 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:09,380 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:09,974 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:09,987 INFO     [learner.py:606] ====Pushing takes 0.011532068252563477 s
2021-08-18:17:05:10,5 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:10,14 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:10,14 INFO     [param_server.py:410] Lock worker 1 with localStep 449 , while globalStep is 448

2021-08-18:17:05:10,150 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:10,164 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:10,405 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:10,423 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:11,583 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:11,605 INFO     [learner.py:606] ====Pushing takes 0.01987624168395996 s
2021-08-18:17:05:11,634 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:11,640 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:11,641 INFO     [param_server.py:410] Lock worker 3 with localStep 449 , while globalStep is 448

2021-08-18:17:05:12,456 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:12,472 INFO     [learner.py:606] ====Pushing takes 0.014745473861694336 s
2021-08-18:17:05:12,488 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:12,493 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:12,494 INFO     [param_server.py:381] ====After aggregation in epoch: 448, virtual_clock: 22092.59434273823, top_1: : 59.1804 % (1834.0), top_5: : 100.0 % (3099.0), test loss: 4.543542199664645, test len: 3099.0
2021-08-18:17:05:12,496 INFO     [param_server.py:410] Lock worker 2 with localStep 449 , while globalStep is 449

2021-08-18:17:05:12,496 INFO     [param_server.py:441] ====Epoch 450 completes 13 clients with loss 6.804702623855043, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:12,497 INFO     [param_server.py:450] ====Start to sample for epoch 450, global virtualClock: 22092.59434273823, round_duration: 80.35344175505469
2021-08-18:17:05:12,497 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:12,796 INFO     [param_server.py:553] For epoch: 450, median_reward: 1320.67681930758, dev: 6603.3840965379
2021-08-18:17:05:13,584 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7434, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:05:13,584 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5748.7205, eval_time 0.744, test_loss 3.7434, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:05:13,618 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6377, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:05:13,621 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5748.7461, eval_time 0.7809, test_loss 3.6377, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:05:13,691 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:05:13,704 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:13,710 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:05:13,731 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:13,738 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.726, Top-1 Accuracy: 711.0/1033 (0.6883), Top-5 Accuracy: 1.0
2021-08-18:17:05:13,739 INFO     [learner.py:656] After aggregation epoch 449, CumulTime 5748.8784, eval_time 0.8987, test_loss 3.726, test_accuracy 0.6883, test_5_accuracy 1.0 

2021-08-18:17:05:13,807 INFO     [learner.py:526] ====Start train round 450
2021-08-18:17:05:13,834 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:14,729 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:14,739 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:16,195 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:16,213 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:16,235 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:16,263 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:17,605 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:17,616 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:18,902 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:18,914 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:18,912 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:18,921 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:18,933 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:18,933 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:19,786 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:19,813 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:20,432 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:20,445 INFO     [learner.py:606] ====Pushing takes 0.011886358261108398 s
2021-08-18:17:05:20,464 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:20,470 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:20,470 INFO     [param_server.py:410] Lock worker 1 with localStep 450 , while globalStep is 449

2021-08-18:17:05:20,558 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:20,567 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:20,580 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:20,589 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:21,725 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:21,746 INFO     [learner.py:606] ====Pushing takes 0.019303560256958008 s
2021-08-18:17:05:21,768 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:21,773 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:21,774 INFO     [param_server.py:410] Lock worker 3 with localStep 450 , while globalStep is 449

2021-08-18:17:05:22,950 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:22,971 INFO     [learner.py:606] ====Pushing takes 0.019306182861328125 s
2021-08-18:17:05:22,986 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:22,991 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:22,991 INFO     [param_server.py:381] ====After aggregation in epoch: 449, virtual_clock: 22172.947784493284, top_1: : 67.6993 % (2098.0), top_5: : 100.0 % (3099.0), test loss: 3.7024024592505564, test len: 3099.0
2021-08-18:17:05:22,994 INFO     [param_server.py:410] Lock worker 2 with localStep 450 , while globalStep is 450

2021-08-18:17:05:22,994 INFO     [param_server.py:441] ====Epoch 451 completes 13 clients with loss 7.130944457982957, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:22,994 INFO     [param_server.py:450] ====Start to sample for epoch 451, global virtualClock: 22172.947784493284, round_duration: 80.35344175505469
2021-08-18:17:05:22,995 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:23,270 INFO     [param_server.py:553] For epoch: 451, median_reward: 1252.2149907591436, dev: 6261.074953795718
2021-08-18:17:05:23,878 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9422, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:05:23,879 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5759.0149, eval_time 0.5734, test_loss 3.9422, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:05:23,968 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:05:23,972 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3298, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:05:23,973 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5759.0972, eval_time 0.6654, test_loss 3.3298, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:05:23,981 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:24,9 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6936, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:17:05:24,10 INFO     [learner.py:656] After aggregation epoch 450, CumulTime 5759.149, eval_time 0.7056, test_loss 3.6936, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:17:05:24,44 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:05:24,58 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:24,78 INFO     [learner.py:526] ====Start train round 451
2021-08-18:17:05:24,107 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:25,208 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:25,220 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:26,324 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:26,345 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:26,437 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:26,470 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:27,877 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:27,891 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:29,86 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:29,97 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:29,113 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:29,128 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:29,313 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:29,326 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:29,983 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:30,4 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:30,592 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:30,605 INFO     [learner.py:606] ====Pushing takes 0.01218271255493164 s
2021-08-18:17:05:30,631 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:30,638 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:30,639 INFO     [param_server.py:410] Lock worker 1 with localStep 451 , while globalStep is 450

2021-08-18:17:05:30,741 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:30,752 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:31,102 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:31,114 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:32,228 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:32,250 INFO     [learner.py:606] ====Pushing takes 0.020655155181884766 s
2021-08-18:17:05:32,274 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:32,283 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:32,283 INFO     [param_server.py:410] Lock worker 3 with localStep 451 , while globalStep is 450

2021-08-18:17:05:33,165 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:33,185 INFO     [learner.py:606] ====Pushing takes 0.019321441650390625 s
2021-08-18:17:05:33,201 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:33,206 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:33,207 INFO     [param_server.py:381] ====After aggregation in epoch: 450, virtual_clock: 22253.30122624834, top_1: : 64.8596 % (2010.0), top_5: : 100.0 % (3099.0), test loss: 3.6551770987334073, test len: 3099.0
2021-08-18:17:05:33,209 INFO     [param_server.py:410] Lock worker 2 with localStep 451 , while globalStep is 451

2021-08-18:17:05:33,210 INFO     [param_server.py:441] ====Epoch 452 completes 13 clients with loss 5.37102949367124, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:33,210 INFO     [param_server.py:450] ====Start to sample for epoch 452, global virtualClock: 22253.30122624834, round_duration: 80.35344175505469
2021-08-18:17:05:33,211 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:33,491 INFO     [param_server.py:553] For epoch: 452, median_reward: 1109.937858762809, dev: 5549.6892938140445
2021-08-18:17:05:34,119 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7525, Top-1 Accuracy: 663.0/1033 (0.6418), Top-5 Accuracy: 1.0
2021-08-18:17:05:34,120 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5769.2564, eval_time 0.5734, test_loss 3.7525, test_accuracy 0.6418, test_5_accuracy 1.0 

2021-08-18:17:05:34,201 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.2478, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:17:05:34,201 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5769.326, eval_time 0.6499, test_loss 3.2478, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:17:05:34,220 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:05:34,235 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:34,270 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:05:34,281 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0742, Top-1 Accuracy: 710.0/1033 (0.6873), Top-5 Accuracy: 1.0
2021-08-18:17:05:34,282 INFO     [learner.py:656] After aggregation epoch 451, CumulTime 5769.4212, eval_time 0.736, test_loss 4.0742, test_accuracy 0.6873, test_5_accuracy 1.0 

2021-08-18:17:05:34,285 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:34,338 INFO     [learner.py:526] ====Start train round 452
2021-08-18:17:05:34,363 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:35,461 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:35,470 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:36,540 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:36,541 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:36,550 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:36,567 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:38,91 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:38,105 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:39,365 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:39,385 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:39,418 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:39,439 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:39,632 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:39,643 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:40,137 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:40,151 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:40,839 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:40,853 INFO     [learner.py:606] ====Pushing takes 0.011611461639404297 s
2021-08-18:17:05:40,872 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:40,877 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:40,892 INFO     [param_server.py:410] Lock worker 1 with localStep 452 , while globalStep is 451

2021-08-18:17:05:41,126 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:41,138 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:41,404 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:41,413 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:42,544 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:42,564 INFO     [learner.py:606] ====Pushing takes 0.017906665802001953 s
2021-08-18:17:05:42,585 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:42,590 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:42,591 INFO     [param_server.py:410] Lock worker 3 with localStep 452 , while globalStep is 451

2021-08-18:17:05:43,658 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:43,676 INFO     [learner.py:606] ====Pushing takes 0.013590574264526367 s
2021-08-18:17:05:43,693 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:43,697 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:43,698 INFO     [param_server.py:381] ====After aggregation in epoch: 451, virtual_clock: 22333.654668003393, top_1: : 66.5376 % (2062.0), top_5: : 100.0 % (3099.0), test loss: 3.691516876220703, test len: 3099.0
2021-08-18:17:05:43,701 INFO     [param_server.py:410] Lock worker 2 with localStep 452 , while globalStep is 452

2021-08-18:17:05:43,701 INFO     [param_server.py:441] ====Epoch 453 completes 13 clients with loss 4.786840236150406, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:43,702 INFO     [param_server.py:450] ====Start to sample for epoch 453, global virtualClock: 22333.654668003393, round_duration: 80.35344175505469
2021-08-18:17:05:43,703 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:44,39 INFO     [param_server.py:553] For epoch: 453, median_reward: 1288.293227888565, dev: 6441.466139442826
2021-08-18:17:05:44,684 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4688, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:05:44,685 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5779.8096, eval_time 0.5776, test_loss 3.4688, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:05:44,716 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8146, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:05:44,717 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5779.8532, eval_time 0.6116, test_loss 3.8146, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:05:44,749 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:05:44,768 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:44,783 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:05:44,808 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:44,839 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8569, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:17:05:44,839 INFO     [learner.py:656] After aggregation epoch 452, CumulTime 5779.9787, eval_time 0.7343, test_loss 3.8569, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:17:05:44,905 INFO     [learner.py:526] ====Start train round 453
2021-08-18:17:05:44,938 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:46,186 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:46,196 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:46,953 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:47,14 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:47,99 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:47,111 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:48,936 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:48,949 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:05:49,946 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:05:49,970 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:05:49,973 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:05:49,989 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:05:50,422 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:05:50,432 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:05:50,785 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:05:50,805 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:05:51,513 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:05:51,527 INFO     [learner.py:606] ====Pushing takes 0.012737274169921875 s
2021-08-18:17:05:51,551 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:51,558 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:05:51,558 INFO     [param_server.py:410] Lock worker 1 with localStep 453 , while globalStep is 452

2021-08-18:17:05:51,729 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:05:51,738 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:05:52,113 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:05:52,122 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:05:53,189 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:05:53,211 INFO     [learner.py:606] ====Pushing takes 0.020586013793945312 s
2021-08-18:17:05:53,233 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:53,239 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:05:53,240 INFO     [param_server.py:410] Lock worker 3 with localStep 453 , while globalStep is 452

2021-08-18:17:05:54,182 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:05:54,197 INFO     [learner.py:606] ====Pushing takes 0.013699054718017578 s
2021-08-18:17:05:54,213 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:05:54,218 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:05:54,218 INFO     [param_server.py:381] ====After aggregation in epoch: 452, virtual_clock: 22414.008109758448, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 3.713415876582817, test len: 3099.0
2021-08-18:17:05:54,221 INFO     [param_server.py:410] Lock worker 2 with localStep 453 , while globalStep is 453

2021-08-18:17:05:54,221 INFO     [param_server.py:441] ====Epoch 454 completes 13 clients with loss 5.255525181046185, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:05:54,222 INFO     [param_server.py:450] ====Start to sample for epoch 454, global virtualClock: 22414.008109758448, round_duration: 80.35344175505469
2021-08-18:17:05:54,222 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:05:54,497 INFO     [param_server.py:553] For epoch: 454, median_reward: 1292.370040292389, dev: 6461.850201461944
2021-08-18:17:05:55,86 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.3157, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:05:55,87 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5790.2226, eval_time 0.5192, test_loss 3.3157, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:05:55,129 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4569, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:05:55,129 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5790.2539, eval_time 0.5619, test_loss 3.4569, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:05:55,198 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:55,201 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:55,212 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:05:55,221 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:05:55,222 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.4034, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:17:05:55,223 INFO     [learner.py:656] After aggregation epoch 453, CumulTime 5790.3622, eval_time 0.6598, test_loss 3.4034, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:17:05:55,277 INFO     [learner.py:526] ====Start train round 454
2021-08-18:17:05:55,309 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:05:56,571 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:05:56,585 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:05:57,417 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:05:57,437 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:05:57,615 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:05:57,626 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:05:59,420 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:05:59,439 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:00,364 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:00,391 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:00,419 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:00,433 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:00,911 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:00,925 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:01,250 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:01,271 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:01,846 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:01,859 INFO     [learner.py:606] ====Pushing takes 0.011888504028320312 s
2021-08-18:17:06:01,876 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:01,881 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:06:01,882 INFO     [param_server.py:410] Lock worker 1 with localStep 454 , while globalStep is 453

2021-08-18:17:06:02,230 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:02,248 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:06:02,720 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:02,733 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:03,744 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:03,764 INFO     [learner.py:606] ====Pushing takes 0.018179655075073242 s
2021-08-18:17:06:03,785 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:03,790 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:06:03,792 INFO     [param_server.py:410] Lock worker 3 with localStep 454 , while globalStep is 453

2021-08-18:17:06:04,701 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:06:04,716 INFO     [learner.py:606] ====Pushing takes 0.013043403625488281 s
2021-08-18:17:06:04,731 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:04,736 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:06:04,737 INFO     [param_server.py:381] ====After aggregation in epoch: 453, virtual_clock: 22494.361551513502, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 3.392011557119312, test len: 3099.0
2021-08-18:17:06:04,739 INFO     [param_server.py:410] Lock worker 2 with localStep 454 , while globalStep is 454

2021-08-18:17:06:04,739 INFO     [param_server.py:441] ====Epoch 455 completes 13 clients with loss 3.481803763608329, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:04,740 INFO     [param_server.py:450] ====Start to sample for epoch 455, global virtualClock: 22494.361551513502, round_duration: 80.35344175505469
2021-08-18:17:06:04,740 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:06:05,9 INFO     [param_server.py:553] For epoch: 455, median_reward: 1259.2561535679388, dev: 6296.280767839694
2021-08-18:17:06:05,711 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4135, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:06:05,712 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5800.8367, eval_time 0.6465, test_loss 3.4135, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:06:05,724 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.925, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:17:06:05,725 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5800.8605, eval_time 0.659, test_loss 3.925, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:17:06:05,779 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:06:05,793 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:06:05,794 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:05,799 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.5313, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:06:05,800 INFO     [learner.py:656] After aggregation epoch 454, CumulTime 5800.9391, eval_time 0.7348, test_loss 3.5313, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:06:05,815 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:05,856 INFO     [learner.py:526] ====Start train round 455
2021-08-18:17:06:05,877 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:06,955 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:06,977 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:08,1 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:08,21 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:08,70 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:08,85 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:09,649 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:09,662 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:10,826 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:10,847 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:10,886 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:10,895 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:11,65 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:11,79 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:11,572 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:11,592 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:12,320 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:12,332 INFO     [learner.py:606] ====Pushing takes 0.01085352897644043 s
2021-08-18:17:06:12,349 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:12,356 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:06:12,356 INFO     [param_server.py:410] Lock worker 1 with localStep 455 , while globalStep is 454

2021-08-18:17:06:12,752 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:12,766 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:06:12,822 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:12,832 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:13,862 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:13,882 INFO     [learner.py:606] ====Pushing takes 0.017667055130004883 s
2021-08-18:17:06:13,903 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:13,908 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:06:13,909 INFO     [param_server.py:410] Lock worker 3 with localStep 455 , while globalStep is 454

2021-08-18:17:06:15,285 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:06:15,303 INFO     [learner.py:606] ====Pushing takes 0.01649332046508789 s
2021-08-18:17:06:15,324 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:15,328 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:06:15,329 INFO     [param_server.py:381] ====After aggregation in epoch: 454, virtual_clock: 22574.714993268557, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 3.6232827438248525, test len: 3099.0
2021-08-18:17:06:15,331 INFO     [param_server.py:410] Lock worker 2 with localStep 455 , while globalStep is 455

2021-08-18:17:06:15,331 INFO     [param_server.py:441] ====Epoch 456 completes 13 clients with loss 3.396795458407035, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:15,331 INFO     [param_server.py:450] ====Start to sample for epoch 456, global virtualClock: 22574.714993268557, round_duration: 80.35344175505469
2021-08-18:17:06:15,332 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 50, 105, 67]
2021-08-18:17:06:15,619 INFO     [param_server.py:553] For epoch: 456, median_reward: 1179.300962230088, dev: 5896.50481115044
2021-08-18:17:06:16,352 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7631, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:17:06:16,353 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5811.4892, eval_time 0.6717, test_loss 3.7631, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:17:06:16,406 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4869, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:06:16,407 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5811.5317, eval_time 0.7229, test_loss 3.4869, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:06:16,428 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:06:16,435 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6128, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:17:06:16,436 INFO     [learner.py:656] After aggregation epoch 455, CumulTime 5811.5753, eval_time 0.7613, test_loss 3.6128, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:17:06:16,437 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:16,477 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:06:16,488 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:16,505 INFO     [learner.py:526] ====Start train round 456
2021-08-18:17:06:16,524 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:17,622 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:17,631 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:18,609 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:18,611 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:18,625 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:18,636 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:20,349 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:20,361 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:21,482 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:21,503 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:21,509 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:21,517 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:21,651 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:21,669 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:22,442 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:22,469 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:22,994 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:23,8 INFO     [learner.py:606] ====Pushing takes 0.012978076934814453 s
2021-08-18:17:06:23,31 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:23,36 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.07692307692307693, now collected 4 clients
2021-08-18:17:06:23,37 INFO     [param_server.py:410] Lock worker 1 with localStep 456 , while globalStep is 455

2021-08-18:17:06:23,460 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:23,474 INFO     [learner.py:165] Start to run client 50 on rank 2...
2021-08-18:17:06:23,499 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:23,513 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:24,499 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:24,520 INFO     [learner.py:606] ====Pushing takes 0.018819332122802734 s
2021-08-18:17:06:24,550 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:24,556 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.07692307692307693, now collected 9 clients
2021-08-18:17:06:24,557 INFO     [param_server.py:410] Lock worker 3 with localStep 456 , while globalStep is 455

2021-08-18:17:06:25,959 INFO     [learner.py:439] Completed to run client 50
2021-08-18:17:06:25,975 INFO     [learner.py:606] ====Pushing takes 0.014819860458374023 s
2021-08-18:17:06:25,991 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:25,996 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.07692307692307693, now collected 13 clients
2021-08-18:17:06:25,996 INFO     [param_server.py:381] ====After aggregation in epoch: 455, virtual_clock: 22655.06843502361, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 3.62092176190129, test len: 3099.0
2021-08-18:17:06:25,999 INFO     [param_server.py:410] Lock worker 2 with localStep 456 , while globalStep is 456

2021-08-18:17:06:26,0 INFO     [param_server.py:441] ====Epoch 457 completes 13 clients with loss 5.205325370468596, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 50: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:26,0 INFO     [param_server.py:450] ====Start to sample for epoch 457, global virtualClock: 22655.06843502361, round_duration: 80.35344175505469
2021-08-18:17:06:26,1 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:26,347 INFO     [param_server.py:553] For epoch: 457, median_reward: 1348.6504989461173, dev: 6743.2524947305865
2021-08-18:17:06:27,7 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.3112, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:06:27,7 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5822.1321, eval_time 0.6153, test_loss 3.3112, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:06:27,42 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2675, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:06:27,43 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5822.1792, eval_time 0.6511, test_loss 4.2675, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:06:27,76 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:06:27,92 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:27,115 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:06:27,126 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.6088, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:17:06:27,127 INFO     [learner.py:656] After aggregation epoch 456, CumulTime 5822.2658, eval_time 0.7344, test_loss 3.6088, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:17:06:27,129 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:27,198 INFO     [learner.py:526] ====Start train round 457
2021-08-18:17:06:27,228 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:28,248 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:28,262 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:29,115 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:29,136 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:29,340 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:29,350 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:30,855 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:30,866 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:32,91 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:32,110 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:32,158 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:32,221 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:32,225 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:32,232 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:33,160 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:33,193 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:33,857 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:33,872 INFO     [learner.py:606] ====Pushing takes 0.01312875747680664 s
2021-08-18:17:06:33,895 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:33,905 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:33,906 INFO     [param_server.py:410] Lock worker 1 with localStep 457 , while globalStep is 456

2021-08-18:17:06:34,72 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:34,82 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:34,102 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:34,116 INFO     [learner.py:606] ====Pushing takes 0.010378599166870117 s
2021-08-18:17:06:34,129 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:34,134 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:34,134 INFO     [param_server.py:410] Lock worker 2 with localStep 457 , while globalStep is 456

2021-08-18:17:06:35,319 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:35,339 INFO     [learner.py:606] ====Pushing takes 0.019146203994750977 s
2021-08-18:17:06:35,364 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:35,371 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:35,372 INFO     [param_server.py:381] ====After aggregation in epoch: 456, virtual_clock: 22738.665770185125, top_1: : 65.7631 % (2038.0), top_5: : 100.0 % (3099.0), test loss: 3.7291721729216754, test len: 3099.0
2021-08-18:17:06:35,375 INFO     [param_server.py:410] Lock worker 3 with localStep 457 , while globalStep is 457

2021-08-18:17:06:35,375 INFO     [param_server.py:441] ====Epoch 458 completes 12 clients with loss 6.404401951004689, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:35,376 INFO     [param_server.py:450] ====Start to sample for epoch 458, global virtualClock: 22738.665770185125, round_duration: 83.5973351615153
2021-08-18:17:06:35,377 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:35,730 INFO     [param_server.py:553] For epoch: 458, median_reward: 991.3070958403997, dev: 4956.535479201999
2021-08-18:17:06:36,362 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5253, Top-1 Accuracy: 645.0/1033 (0.6244), Top-5 Accuracy: 1.0
2021-08-18:17:06:36,363 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5831.4879, eval_time 0.5967, test_loss 3.5253, test_accuracy 0.6244, test_5_accuracy 1.0 

2021-08-18:17:06:36,367 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9053, Top-1 Accuracy: 625.0/1033 (0.605), Top-5 Accuracy: 1.0
2021-08-18:17:06:36,368 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5831.5041, eval_time 0.6017, test_loss 3.9053, test_accuracy 0.605, test_5_accuracy 1.0 

2021-08-18:17:06:36,434 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:06:36,438 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:06:36,442 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:36,447 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:36,483 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0227, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:06:36,484 INFO     [learner.py:656] After aggregation epoch 457, CumulTime 5831.6233, eval_time 0.7199, test_loss 4.0227, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:06:36,554 INFO     [learner.py:526] ====Start train round 458
2021-08-18:17:06:36,588 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:37,571 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:37,584 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:38,801 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:38,816 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:38,857 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:38,872 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:40,263 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:40,274 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:41,598 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:41,606 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:41,625 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:41,630 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:41,638 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:41,639 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:42,668 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:42,708 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:43,337 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:43,353 INFO     [learner.py:606] ====Pushing takes 0.013899803161621094 s
2021-08-18:17:06:43,378 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:43,387 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:43,388 INFO     [param_server.py:410] Lock worker 1 with localStep 458 , while globalStep is 457

2021-08-18:17:06:43,419 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:43,437 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:43,494 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:43,505 INFO     [learner.py:606] ====Pushing takes 0.010133028030395508 s
2021-08-18:17:06:43,525 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:43,529 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:43,529 INFO     [param_server.py:410] Lock worker 2 with localStep 458 , while globalStep is 457

2021-08-18:17:06:44,637 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:44,658 INFO     [learner.py:606] ====Pushing takes 0.019030094146728516 s
2021-08-18:17:06:44,680 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:44,687 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:44,687 INFO     [param_server.py:381] ====After aggregation in epoch: 457, virtual_clock: 22822.26310534664, top_1: : 62.504 % (1937.0), top_5: : 100.0 % (3099.0), test loss: 3.8177643639070014, test len: 3099.0
2021-08-18:17:06:44,690 INFO     [param_server.py:410] Lock worker 3 with localStep 458 , while globalStep is 458

2021-08-18:17:06:44,690 INFO     [param_server.py:441] ====Epoch 459 completes 12 clients with loss 3.8851977678337937, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:44,691 INFO     [param_server.py:450] ====Start to sample for epoch 459, global virtualClock: 22822.26310534664, round_duration: 83.5973351615153
2021-08-18:17:06:44,691 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:45,29 INFO     [param_server.py:553] For epoch: 459, median_reward: 982.903814997954, dev: 4914.51907498977
2021-08-18:17:06:45,604 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4145, Top-1 Accuracy: 687.0/1033 (0.6651), Top-5 Accuracy: 1.0
2021-08-18:17:06:45,605 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5840.7297, eval_time 0.5522, test_loss 3.4145, test_accuracy 0.6651, test_5_accuracy 1.0 

2021-08-18:17:06:45,607 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6287, Top-1 Accuracy: 665.0/1033 (0.6438), Top-5 Accuracy: 1.0
2021-08-18:17:06:45,607 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5840.7434, eval_time 0.5558, test_loss 3.6287, test_accuracy 0.6438, test_5_accuracy 1.0 

2021-08-18:17:06:45,650 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7465, Top-1 Accuracy: 716.0/1033 (0.6931), Top-5 Accuracy: 1.0
2021-08-18:17:06:45,650 INFO     [learner.py:656] After aggregation epoch 458, CumulTime 5840.7895, eval_time 0.5986, test_loss 3.7465, test_accuracy 0.6931, test_5_accuracy 1.0 

2021-08-18:17:06:45,675 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:06:45,677 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:06:45,683 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:45,684 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:45,722 INFO     [learner.py:526] ====Start train round 459
2021-08-18:17:06:45,737 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:46,881 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:46,890 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:48,7 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:48,17 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:48,46 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:48,79 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:49,847 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:49,859 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:06:50,936 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:06:50,939 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:06:50,955 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:06:50,966 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:06:51,109 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:06:51,119 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:06:51,755 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:06:51,789 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:06:52,565 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:06:52,579 INFO     [learner.py:606] ====Pushing takes 0.013082742691040039 s
2021-08-18:17:06:52,603 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:52,608 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:06:52,608 INFO     [param_server.py:410] Lock worker 1 with localStep 459 , while globalStep is 458

2021-08-18:17:06:52,643 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:06:52,656 INFO     [learner.py:606] ====Pushing takes 0.011218070983886719 s
2021-08-18:17:06:52,667 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:52,671 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:06:52,671 INFO     [param_server.py:410] Lock worker 2 with localStep 459 , while globalStep is 458

2021-08-18:17:06:52,713 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:06:52,722 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:06:53,956 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:06:53,978 INFO     [learner.py:606] ====Pushing takes 0.02045273780822754 s
2021-08-18:17:06:54,4 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:06:54,12 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:06:54,13 INFO     [param_server.py:381] ====After aggregation in epoch: 458, virtual_clock: 22905.860440508153, top_1: : 66.7312 % (2068.0), top_5: : 100.0 % (3099.0), test loss: 3.5965531711225154, test len: 3099.0
2021-08-18:17:06:54,15 INFO     [param_server.py:410] Lock worker 3 with localStep 459 , while globalStep is 459

2021-08-18:17:06:54,16 INFO     [param_server.py:441] ====Epoch 460 completes 12 clients with loss 5.136345290269327, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:06:54,16 INFO     [param_server.py:450] ====Start to sample for epoch 460, global virtualClock: 22905.860440508153, round_duration: 83.5973351615153
2021-08-18:17:06:54,17 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:06:54,302 INFO     [param_server.py:553] For epoch: 460, median_reward: 1063.185008779443, dev: 5315.925043897215
2021-08-18:17:06:54,999 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2649, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:06:55,0 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5850.1248, eval_time 0.6511, test_loss 4.2649, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:06:55,0 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.5039, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:17:06:55,2 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5850.1383, eval_time 0.6553, test_loss 4.5039, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:17:06:55,31 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2818, Top-1 Accuracy: 675.0/1033 (0.6534), Top-5 Accuracy: 1.0
2021-08-18:17:06:55,32 INFO     [learner.py:656] After aggregation epoch 459, CumulTime 5850.1716, eval_time 0.6854, test_loss 4.2818, test_accuracy 0.6534, test_5_accuracy 1.0 

2021-08-18:17:06:55,68 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:55,70 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:55,80 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:06:55,80 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:06:55,99 INFO     [learner.py:526] ====Start train round 460
2021-08-18:17:06:55,113 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:06:56,207 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:06:56,217 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:06:57,4 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:06:57,25 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:06:57,310 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:06:57,321 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:06:58,943 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:06:58,955 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:00,55 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:00,89 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:00,193 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:00,214 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:00,218 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:00,236 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:00,972 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:00,993 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:01,571 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:01,583 INFO     [learner.py:606] ====Pushing takes 0.010229110717773438 s
2021-08-18:17:07:01,600 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:01,605 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:01,606 INFO     [param_server.py:410] Lock worker 1 with localStep 460 , while globalStep is 459

2021-08-18:17:07:01,907 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:01,917 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:01,936 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:01,946 INFO     [learner.py:606] ====Pushing takes 0.00917673110961914 s
2021-08-18:17:07:01,959 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:01,962 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:01,963 INFO     [param_server.py:410] Lock worker 2 with localStep 460 , while globalStep is 459

2021-08-18:17:07:03,178 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:03,198 INFO     [learner.py:606] ====Pushing takes 0.018518447875976562 s
2021-08-18:17:07:03,222 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:03,227 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:03,227 INFO     [param_server.py:381] ====After aggregation in epoch: 459, virtual_clock: 22989.457775669667, top_1: : 63.5689 % (1970.0), top_5: : 100.0 % (3099.0), test loss: 4.35022810653404, test len: 3099.0
2021-08-18:17:07:03,230 INFO     [param_server.py:410] Lock worker 3 with localStep 460 , while globalStep is 460

2021-08-18:17:07:03,230 INFO     [param_server.py:441] ====Epoch 461 completes 12 clients with loss 4.3866936299986214, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:03,246 INFO     [param_server.py:450] ====Start to sample for epoch 461, global virtualClock: 22989.457775669667, round_duration: 83.5973351615153
2021-08-18:17:07:03,246 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:03,545 INFO     [param_server.py:541] Handle Wight 0.026448488235473633 | Send 0.29981327056884766
2021-08-18:17:07:03,546 INFO     [param_server.py:553] For epoch: 461, median_reward: 1206.0413189876642, dev: 6030.206594938321
2021-08-18:17:07:04,231 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5934, Top-1 Accuracy: 643.0/1033 (0.6225), Top-5 Accuracy: 1.0
2021-08-18:17:07:04,232 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5859.3566, eval_time 0.6303, test_loss 3.5934, test_accuracy 0.6225, test_5_accuracy 1.0 

2021-08-18:17:07:04,299 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:07:04,313 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:04,376 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.98, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:17:07:04,377 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5859.5126, eval_time 0.7754, test_loss 3.98, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:17:07:04,383 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5515, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:07:04,384 INFO     [learner.py:656] After aggregation epoch 460, CumulTime 5859.5233, eval_time 0.7831, test_loss 4.5515, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:07:04,439 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:07:04,465 INFO     [learner.py:526] ====Start train round 461
2021-08-18:17:07:04,474 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:04,480 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:05,476 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:05,486 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:06,544 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:06,565 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:06,843 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:06,854 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:08,260 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:08,271 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:09,438 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:09,473 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:09,559 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:09,580 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:09,618 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:09,637 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:10,360 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:10,393 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:10,974 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:10,990 INFO     [learner.py:606] ====Pushing takes 0.014430761337280273 s
2021-08-18:17:07:11,13 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:11,18 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:11,19 INFO     [param_server.py:410] Lock worker 1 with localStep 461 , while globalStep is 460

2021-08-18:17:07:11,508 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:11,516 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:11,519 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:11,527 INFO     [learner.py:606] ====Pushing takes 0.009918451309204102 s
2021-08-18:17:07:11,539 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:11,543 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:11,544 INFO     [param_server.py:410] Lock worker 2 with localStep 461 , while globalStep is 460

2021-08-18:17:07:12,679 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:12,699 INFO     [learner.py:606] ====Pushing takes 0.019092321395874023 s
2021-08-18:17:07:12,722 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:12,728 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:12,728 INFO     [param_server.py:381] ====After aggregation in epoch: 460, virtual_clock: 23073.05511083118, top_1: : 63.2462 % (1960.0), top_5: : 100.0 % (3099.0), test loss: 4.041615868056262, test len: 3099.0
2021-08-18:17:07:12,731 INFO     [param_server.py:410] Lock worker 3 with localStep 461 , while globalStep is 461

2021-08-18:17:07:12,731 INFO     [param_server.py:441] ====Epoch 462 completes 12 clients with loss 4.4647164351134485, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:12,732 INFO     [param_server.py:450] ====Start to sample for epoch 462, global virtualClock: 23073.05511083118, round_duration: 83.5973351615153
2021-08-18:17:07:12,732 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:13,17 INFO     [param_server.py:553] For epoch: 462, median_reward: 1242.969467471812, dev: 6214.8473373590605
2021-08-18:17:07:13,690 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.602, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:17:07:13,693 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4146, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:07:13,694 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5868.8295, eval_time 0.6509, test_loss 3.602, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:17:07:13,706 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5868.8302, eval_time 0.6624, test_loss 3.4146, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:07:13,774 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:07:13,783 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:13,776 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2345, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:07:13,790 INFO     [learner.py:656] After aggregation epoch 461, CumulTime 5868.9291, eval_time 0.7473, test_loss 4.2345, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:07:13,795 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:07:13,804 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:13,860 INFO     [learner.py:526] ====Start train round 462
2021-08-18:17:07:13,878 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:14,938 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:14,951 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:15,888 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:15,915 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:16,69 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:16,78 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:17,596 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:17,608 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:18,658 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:18,685 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:18,743 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:18,761 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:19,26 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:19,38 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:19,697 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:19,724 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:20,302 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:20,315 INFO     [learner.py:606] ====Pushing takes 0.011795520782470703 s
2021-08-18:17:07:20,332 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:20,341 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:20,341 INFO     [param_server.py:410] Lock worker 1 with localStep 462 , while globalStep is 461

2021-08-18:17:07:20,796 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:20,807 INFO     [learner.py:606] ====Pushing takes 0.009272575378417969 s
2021-08-18:17:07:20,819 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:20,822 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:20,823 INFO     [param_server.py:410] Lock worker 2 with localStep 462 , while globalStep is 461

2021-08-18:17:07:20,916 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:20,926 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:22,106 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:22,126 INFO     [learner.py:606] ====Pushing takes 0.018887758255004883 s
2021-08-18:17:07:22,149 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:22,154 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:22,155 INFO     [param_server.py:381] ====After aggregation in epoch: 461, virtual_clock: 23156.652445992695, top_1: : 64.1497 % (1988.0), top_5: : 100.0 % (3099.0), test loss: 3.7503491176499257, test len: 3099.0
2021-08-18:17:07:22,157 INFO     [param_server.py:410] Lock worker 3 with localStep 462 , while globalStep is 462

2021-08-18:17:07:22,158 INFO     [param_server.py:441] ====Epoch 463 completes 12 clients with loss 3.126721962148803, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:22,158 INFO     [param_server.py:450] ====Start to sample for epoch 463, global virtualClock: 23156.652445992695, round_duration: 83.5973351615153
2021-08-18:17:07:22,159 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:22,501 INFO     [param_server.py:553] For epoch: 463, median_reward: 1167.2412547187225, dev: 5836.206273593612
2021-08-18:17:07:23,201 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3411, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:17:07:23,202 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5878.338, eval_time 0.6655, test_loss 4.3411, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:17:07:23,204 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.1708, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:07:23,205 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5878.3291, eval_time 0.6674, test_loss 4.1708, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:07:23,271 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:07:23,271 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:07:23,276 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1748, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:07:23,277 INFO     [learner.py:656] After aggregation epoch 462, CumulTime 5878.4161, eval_time 0.7409, test_loss 4.1748, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:07:23,280 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:23,285 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:23,345 INFO     [learner.py:526] ====Start train round 463
2021-08-18:17:07:23,368 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:24,543 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:24,555 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:25,570 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:25,576 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:25,585 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:25,603 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:27,129 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:27,138 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:28,406 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:28,432 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:28,495 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:28,513 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:28,643 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:28,654 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:29,467 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:29,507 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:30,118 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:30,133 INFO     [learner.py:606] ====Pushing takes 0.012942790985107422 s
2021-08-18:17:07:30,154 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:30,159 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:30,160 INFO     [param_server.py:410] Lock worker 1 with localStep 463 , while globalStep is 462

2021-08-18:17:07:30,260 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:30,272 INFO     [learner.py:606] ====Pushing takes 0.009791851043701172 s
2021-08-18:17:07:30,286 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:30,289 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:30,290 INFO     [param_server.py:410] Lock worker 2 with localStep 463 , while globalStep is 462

2021-08-18:17:07:30,654 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:30,669 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:31,950 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:31,971 INFO     [learner.py:606] ====Pushing takes 0.019011974334716797 s
2021-08-18:17:07:31,995 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:32,0 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:32,1 INFO     [param_server.py:381] ====After aggregation in epoch: 462, virtual_clock: 23240.24978115421, top_1: : 64.0852 % (1986.0), top_5: : 100.0 % (3099.0), test loss: 4.2289214310822665, test len: 3099.0
2021-08-18:17:07:32,3 INFO     [param_server.py:410] Lock worker 3 with localStep 463 , while globalStep is 463

2021-08-18:17:07:32,3 INFO     [param_server.py:441] ====Epoch 464 completes 12 clients with loss 7.7172588791760175, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:32,4 INFO     [param_server.py:450] ====Start to sample for epoch 464, global virtualClock: 23240.24978115421, round_duration: 83.5973351615153
2021-08-18:17:07:32,4 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:32,279 INFO     [param_server.py:553] For epoch: 464, median_reward: 1330.6217541813471, dev: 6653.108770906736
2021-08-18:17:07:32,943 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4011, Top-1 Accuracy: 677.0/1033 (0.6554), Top-5 Accuracy: 1.0
2021-08-18:17:07:32,944 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5888.0687, eval_time 0.6313, test_loss 3.4011, test_accuracy 0.6554, test_5_accuracy 1.0 

2021-08-18:17:07:32,990 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9698, Top-1 Accuracy: 650.0/1033 (0.6292), Top-5 Accuracy: 1.0
2021-08-18:17:07:32,991 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5888.1274, eval_time 0.6787, test_loss 3.9698, test_accuracy 0.6292, test_5_accuracy 1.0 

2021-08-18:17:07:33,14 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:07:33,27 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:33,32 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.68, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:07:33,33 INFO     [learner.py:656] After aggregation epoch 463, CumulTime 5888.172, eval_time 0.7199, test_loss 3.68, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:07:33,59 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:07:33,73 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:33,106 INFO     [learner.py:526] ====Start train round 464
2021-08-18:17:07:33,131 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:34,269 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:34,278 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:35,151 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:35,177 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:35,358 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:35,377 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:37,146 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:37,158 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:37,923 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:37,950 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:38,250 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:38,271 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:38,515 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:38,533 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:38,872 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:38,899 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:39,722 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:39,735 INFO     [learner.py:606] ====Pushing takes 0.011799812316894531 s
2021-08-18:17:07:39,751 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:39,757 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:39,758 INFO     [param_server.py:410] Lock worker 1 with localStep 464 , while globalStep is 463

2021-08-18:17:07:40,236 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:40,246 INFO     [learner.py:606] ====Pushing takes 0.009265661239624023 s
2021-08-18:17:07:40,259 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:40,263 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:40,263 INFO     [param_server.py:410] Lock worker 2 with localStep 464 , while globalStep is 463

2021-08-18:17:07:40,265 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:40,281 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:41,353 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:41,374 INFO     [learner.py:606] ====Pushing takes 0.018529176712036133 s
2021-08-18:17:07:41,401 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:41,408 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:41,409 INFO     [param_server.py:381] ====After aggregation in epoch: 463, virtual_clock: 23323.847116315723, top_1: : 65.4727 % (2029.0), top_5: : 100.0 % (3099.0), test loss: 3.683633159708094, test len: 3099.0
2021-08-18:17:07:41,412 INFO     [param_server.py:410] Lock worker 3 with localStep 464 , while globalStep is 464

2021-08-18:17:07:41,413 INFO     [param_server.py:441] ====Epoch 465 completes 12 clients with loss 4.501444149961656, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:41,413 INFO     [param_server.py:450] ====Start to sample for epoch 465, global virtualClock: 23323.847116315723, round_duration: 83.5973351615153
2021-08-18:17:07:41,414 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:41,710 INFO     [param_server.py:553] For epoch: 465, median_reward: 1156.1756871875643, dev: 5780.878435937821
2021-08-18:17:07:42,365 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.615, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:07:42,366 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8114, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:07:42,367 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5897.5028, eval_time 0.6332, test_loss 3.615, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:07:42,367 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5897.4917, eval_time 0.6334, test_loss 3.8114, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:07:42,438 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:07:42,438 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:07:42,446 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:42,447 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:42,448 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2439, Top-1 Accuracy: 713.0/1033 (0.6902), Top-5 Accuracy: 1.0
2021-08-18:17:07:42,449 INFO     [learner.py:656] After aggregation epoch 464, CumulTime 5897.588, eval_time 0.7152, test_loss 4.2439, test_accuracy 0.6902, test_5_accuracy 1.0 

2021-08-18:17:07:42,545 INFO     [learner.py:526] ====Start train round 465
2021-08-18:17:07:42,562 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:43,506 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:43,518 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:44,484 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:44,502 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:44,673 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:44,685 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:46,115 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:46,125 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:47,532 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:47,551 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:47,559 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:47,586 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:47,639 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:47,648 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:48,634 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:48,668 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:49,224 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:49,238 INFO     [learner.py:606] ====Pushing takes 0.01314997673034668 s
2021-08-18:17:07:49,260 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:49,264 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:07:49,265 INFO     [param_server.py:410] Lock worker 1 with localStep 465 , while globalStep is 464

2021-08-18:17:07:49,442 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:49,458 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:49,519 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:49,530 INFO     [learner.py:606] ====Pushing takes 0.009908437728881836 s
2021-08-18:17:07:49,542 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:49,546 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:49,546 INFO     [param_server.py:410] Lock worker 2 with localStep 465 , while globalStep is 464

2021-08-18:17:07:50,681 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:50,701 INFO     [learner.py:606] ====Pushing takes 0.01854085922241211 s
2021-08-18:17:07:50,723 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:50,729 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:50,729 INFO     [param_server.py:381] ====After aggregation in epoch: 464, virtual_clock: 23407.444451477237, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 3.8901160204852068, test len: 3099.0
2021-08-18:17:07:50,732 INFO     [param_server.py:410] Lock worker 3 with localStep 465 , while globalStep is 465

2021-08-18:17:07:50,733 INFO     [param_server.py:441] ====Epoch 466 completes 12 clients with loss 4.839706848789321, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:50,733 INFO     [param_server.py:450] ====Start to sample for epoch 466, global virtualClock: 23407.444451477237, round_duration: 83.5973351615153
2021-08-18:17:07:50,734 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:07:51,45 INFO     [param_server.py:553] For epoch: 466, median_reward: 1244.8002756816588, dev: 6224.001378408294
2021-08-18:17:07:51,709 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.1921, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:07:51,710 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.851, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:17:07:51,710 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5906.8349, eval_time 0.618, test_loss 4.1921, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:07:51,711 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5906.8469, eval_time 0.6191, test_loss 3.851, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:17:07:51,781 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:51,788 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8155, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:17:07:51,788 INFO     [learner.py:656] After aggregation epoch 465, CumulTime 5906.9277, eval_time 0.6986, test_loss 3.8155, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:17:07:51,795 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:07:51,796 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:51,805 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:07:51,869 INFO     [learner.py:526] ====Start train round 466
2021-08-18:17:07:51,886 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:07:53,14 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:07:53,29 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:07:54,56 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:07:54,69 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:07:54,104 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:07:54,124 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:07:55,601 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:07:55,613 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:07:56,738 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:07:56,759 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:07:56,950 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:07:56,962 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:07:57,180 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:07:57,207 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:07:58,117 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:07:58,143 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:07:58,598 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:07:58,614 INFO     [learner.py:606] ====Pushing takes 0.01207733154296875 s
2021-08-18:17:07:58,631 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:58,638 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:07:58,639 INFO     [param_server.py:410] Lock worker 2 with localStep 466 , while globalStep is 465

2021-08-18:17:07:58,713 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:07:58,716 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:07:58,727 INFO     [learner.py:606] ====Pushing takes 0.012640714645385742 s
2021-08-18:17:07:58,730 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:07:58,747 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:58,754 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:07:58,754 INFO     [param_server.py:410] Lock worker 1 with localStep 466 , while globalStep is 465

2021-08-18:17:07:59,850 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:07:59,871 INFO     [learner.py:606] ====Pushing takes 0.019841909408569336 s
2021-08-18:17:07:59,896 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:07:59,901 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:07:59,902 INFO     [param_server.py:381] ====After aggregation in epoch: 465, virtual_clock: 23491.04178663875, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 3.952887462245093, test len: 3099.0
2021-08-18:17:07:59,905 INFO     [param_server.py:410] Lock worker 3 with localStep 466 , while globalStep is 466

2021-08-18:17:07:59,905 INFO     [param_server.py:441] ====Epoch 467 completes 12 clients with loss 5.162869134405145, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:07:59,905 INFO     [param_server.py:450] ====Start to sample for epoch 467, global virtualClock: 23491.04178663875, round_duration: 83.5973351615153
2021-08-18:17:07:59,906 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:00,202 INFO     [param_server.py:553] For epoch: 467, median_reward: 1021.8709338029909, dev: 5109.354669014954
2021-08-18:17:08:00,935 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6981, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:08:00,936 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5916.0604, eval_time 0.6817, test_loss 3.6981, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:08:00,973 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6205, Top-1 Accuracy: 661.0/1033 (0.6399), Top-5 Accuracy: 1.0
2021-08-18:17:08:00,974 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5916.1098, eval_time 0.7241, test_loss 3.6205, test_accuracy 0.6399, test_5_accuracy 1.0 

2021-08-18:17:08:01,2 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:08:01,18 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:01,47 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:08:01,48 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.775, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:17:08:01,49 INFO     [learner.py:656] After aggregation epoch 466, CumulTime 5916.1878, eval_time 0.7986, test_loss 3.775, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:17:08:01,62 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:01,119 INFO     [learner.py:526] ====Start train round 467
2021-08-18:17:08:01,141 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:02,164 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:02,178 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:03,31 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:03,52 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:03,379 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:03,393 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:04,954 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:04,968 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:06,93 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:06,125 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:06,180 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:06,201 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:06,267 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:06,277 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:07,94 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:07,121 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:07,699 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:07,714 INFO     [learner.py:606] ====Pushing takes 0.013654232025146484 s
2021-08-18:17:08:07,737 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:07,742 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:07,742 INFO     [param_server.py:410] Lock worker 1 with localStep 467 , while globalStep is 466

2021-08-18:17:08:08,55 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:08,68 INFO     [learner.py:606] ====Pushing takes 0.010884284973144531 s
2021-08-18:17:08:08,80 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:08,84 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:08,85 INFO     [param_server.py:410] Lock worker 2 with localStep 467 , while globalStep is 466

2021-08-18:17:08:08,100 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:08,110 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:09,544 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:09,565 INFO     [learner.py:606] ====Pushing takes 0.01927471160888672 s
2021-08-18:17:08:09,588 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:09,594 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:09,595 INFO     [param_server.py:381] ====After aggregation in epoch: 466, virtual_clock: 23574.639121800265, top_1: : 65.989 % (2045.0), top_5: : 100.0 % (3099.0), test loss: 3.697865532504188, test len: 3099.0
2021-08-18:17:08:09,597 INFO     [param_server.py:410] Lock worker 3 with localStep 467 , while globalStep is 467

2021-08-18:17:08:09,598 INFO     [param_server.py:441] ====Epoch 468 completes 12 clients with loss 4.567312672206483, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:09,598 INFO     [param_server.py:450] ====Start to sample for epoch 468, global virtualClock: 23574.639121800265, round_duration: 83.5973351615153
2021-08-18:17:08:09,599 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:09,867 INFO     [param_server.py:553] For epoch: 468, median_reward: 1098.289562109331, dev: 5491.447810546655
2021-08-18:17:08:10,623 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4071, Top-1 Accuracy: 649.0/1033 (0.6283), Top-5 Accuracy: 1.0
2021-08-18:17:08:10,625 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5925.7492, eval_time 0.6965, test_loss 3.4071, test_accuracy 0.6283, test_5_accuracy 1.0 

2021-08-18:17:08:10,633 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6811, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:08:10,634 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5925.7697, eval_time 0.7065, test_loss 3.6811, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:08:10,695 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:08:10,704 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0445, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:08:10,709 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:08:10,708 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:10,713 INFO     [learner.py:656] After aggregation epoch 467, CumulTime 5925.8525, eval_time 0.7904, test_loss 4.0445, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:08:10,725 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:10,812 INFO     [learner.py:526] ====Start train round 468
2021-08-18:17:08:10,839 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:11,831 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:11,841 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:12,833 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:12,854 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:13,128 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:13,137 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:14,771 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:14,787 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:15,596 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:15,629 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:15,771 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:15,790 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:16,78 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:16,92 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:16,607 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:16,640 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:17,226 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:17,242 INFO     [learner.py:606] ====Pushing takes 0.014452934265136719 s
2021-08-18:17:08:17,265 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:17,272 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:17,273 INFO     [param_server.py:410] Lock worker 1 with localStep 468 , while globalStep is 467

2021-08-18:17:08:17,546 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:17,558 INFO     [learner.py:606] ====Pushing takes 0.010072469711303711 s
2021-08-18:17:08:17,571 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:17,575 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:17,575 INFO     [param_server.py:410] Lock worker 2 with localStep 468 , while globalStep is 467

2021-08-18:17:08:17,729 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:17,742 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:18,776 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:18,797 INFO     [learner.py:606] ====Pushing takes 0.018983125686645508 s
2021-08-18:17:08:18,821 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:18,828 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:18,828 INFO     [param_server.py:381] ====After aggregation in epoch: 467, virtual_clock: 23658.23645696178, top_1: : 64.4401 % (1997.0), top_5: : 100.0 % (3099.0), test loss: 3.7108943329917063, test len: 3099.0
2021-08-18:17:08:18,834 INFO     [param_server.py:410] Lock worker 3 with localStep 468 , while globalStep is 468

2021-08-18:17:08:18,834 INFO     [param_server.py:441] ====Epoch 469 completes 12 clients with loss 3.67424801068206, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:18,835 INFO     [param_server.py:450] ====Start to sample for epoch 469, global virtualClock: 23658.23645696178, round_duration: 83.5973351615153
2021-08-18:17:08:18,836 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:19,115 INFO     [param_server.py:553] For epoch: 469, median_reward: 1277.2917637107407, dev: 6386.458818553703
2021-08-18:17:08:19,796 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1427, Top-1 Accuracy: 657.0/1033 (0.636), Top-5 Accuracy: 1.0
2021-08-18:17:08:19,799 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5934.9347, eval_time 0.648, test_loss 4.1427, test_accuracy 0.636, test_5_accuracy 1.0 

2021-08-18:17:08:19,801 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8692, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:08:19,802 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5934.9268, eval_time 0.6509, test_loss 3.8692, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:08:19,860 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0565, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:08:19,861 INFO     [learner.py:656] After aggregation epoch 468, CumulTime 5935.0002, eval_time 0.7119, test_loss 4.0565, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:08:19,869 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:08:19,871 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:08:19,880 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:19,880 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:19,970 INFO     [learner.py:526] ====Start train round 469
2021-08-18:17:08:19,989 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:21,23 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:21,32 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:21,848 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:21,882 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:22,145 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:22,154 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:23,918 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:23,928 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:24,716 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:24,743 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:25,194 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:25,212 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:25,363 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:25,373 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:25,724 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:25,751 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:26,336 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:26,353 INFO     [learner.py:606] ====Pushing takes 0.015533924102783203 s
2021-08-18:17:08:26,375 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:26,381 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:26,382 INFO     [param_server.py:410] Lock worker 1 with localStep 469 , while globalStep is 468

2021-08-18:17:08:26,972 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:26,984 INFO     [learner.py:606] ====Pushing takes 0.010464906692504883 s
2021-08-18:17:08:26,996 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:27,11 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:27,12 INFO     [param_server.py:410] Lock worker 2 with localStep 469 , while globalStep is 468

2021-08-18:17:08:27,351 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:27,371 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:28,579 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:28,610 INFO     [learner.py:606] ====Pushing takes 0.0198671817779541 s
2021-08-18:17:08:28,632 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:28,638 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:28,638 INFO     [param_server.py:381] ====After aggregation in epoch: 468, virtual_clock: 23741.833792123292, top_1: : 66.1504 % (2050.0), top_5: : 100.0 % (3099.0), test loss: 4.022816066388731, test len: 3099.0
2021-08-18:17:08:28,641 INFO     [param_server.py:410] Lock worker 3 with localStep 469 , while globalStep is 469

2021-08-18:17:08:28,641 INFO     [param_server.py:441] ====Epoch 470 completes 12 clients with loss 3.8328975688972813, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:28,642 INFO     [param_server.py:450] ====Start to sample for epoch 470, global virtualClock: 23741.833792123292, round_duration: 83.5973351615153
2021-08-18:17:08:28,643 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:28,981 INFO     [param_server.py:553] For epoch: 470, median_reward: 1096.6647579768498, dev: 5483.323789884249
2021-08-18:17:08:29,720 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.774, Top-1 Accuracy: 683.0/1033 (0.6612), Top-5 Accuracy: 1.0
2021-08-18:17:08:29,721 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5944.8455, eval_time 0.69, test_loss 3.774, test_accuracy 0.6612, test_5_accuracy 1.0 

2021-08-18:17:08:29,730 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7629, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:08:29,731 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5944.8665, eval_time 0.7042, test_loss 3.7629, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:08:29,790 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:08:29,798 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:29,801 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:08:29,810 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:29,811 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7318, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:17:08:29,812 INFO     [learner.py:656] After aggregation epoch 469, CumulTime 5944.9511, eval_time 0.7854, test_loss 3.7318, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:17:08:29,892 INFO     [learner.py:526] ====Start train round 470
2021-08-18:17:08:29,911 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:30,912 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:30,926 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:32,37 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:32,64 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:32,101 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:32,112 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:33,718 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:33,736 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:35,50 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:35,59 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:35,65 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:35,74 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:35,86 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:35,88 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:36,59 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:36,93 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:36,714 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:36,728 INFO     [learner.py:606] ====Pushing takes 0.013090133666992188 s
2021-08-18:17:08:36,752 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:36,760 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:36,761 INFO     [param_server.py:410] Lock worker 1 with localStep 470 , while globalStep is 469

2021-08-18:17:08:36,987 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:36,998 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:37,54 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:37,69 INFO     [learner.py:606] ====Pushing takes 0.010442972183227539 s
2021-08-18:17:08:37,81 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:37,85 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:37,85 INFO     [param_server.py:410] Lock worker 2 with localStep 470 , while globalStep is 469

2021-08-18:17:08:38,196 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:38,216 INFO     [learner.py:606] ====Pushing takes 0.01841282844543457 s
2021-08-18:17:08:38,241 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:38,246 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:38,247 INFO     [param_server.py:381] ====After aggregation in epoch: 469, virtual_clock: 23825.431127284806, top_1: : 66.2149 % (2052.0), top_5: : 100.0 % (3099.0), test loss: 3.7562074407383244, test len: 3099.0
2021-08-18:17:08:38,249 INFO     [param_server.py:410] Lock worker 3 with localStep 470 , while globalStep is 470

2021-08-18:17:08:38,250 INFO     [param_server.py:441] ====Epoch 471 completes 12 clients with loss 5.547089783100107, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:38,250 INFO     [param_server.py:450] ====Start to sample for epoch 471, global virtualClock: 23825.431127284806, round_duration: 83.5973351615153
2021-08-18:17:08:38,251 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:38,588 INFO     [param_server.py:553] For epoch: 471, median_reward: 1331.587769152366, dev: 6657.93884576183
2021-08-18:17:08:39,252 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2294, Top-1 Accuracy: 628.0/1033 (0.6079), Top-5 Accuracy: 1.0
2021-08-18:17:08:39,273 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5954.4085, eval_time 0.6367, test_loss 4.2294, test_accuracy 0.6079, test_5_accuracy 1.0 

2021-08-18:17:08:39,278 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3563, Top-1 Accuracy: 629.0/1033 (0.6089), Top-5 Accuracy: 1.0
2021-08-18:17:08:39,279 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5954.4034, eval_time 0.6428, test_loss 4.3563, test_accuracy 0.6089, test_5_accuracy 1.0 

2021-08-18:17:08:39,341 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:08:39,346 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:08:39,350 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:39,360 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:39,380 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8074, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:08:39,381 INFO     [learner.py:656] After aggregation epoch 470, CumulTime 5954.5206, eval_time 0.7475, test_loss 3.8074, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:08:39,474 INFO     [learner.py:526] ====Start train round 471
2021-08-18:17:08:39,500 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:40,581 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:40,591 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:41,539 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:41,548 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:41,665 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:41,686 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:43,418 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:43,428 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:44,504 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:44,525 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:44,606 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:44,639 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:44,845 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:44,863 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:45,629 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:45,674 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:46,340 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:46,352 INFO     [learner.py:606] ====Pushing takes 0.011022806167602539 s
2021-08-18:17:08:46,369 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:46,373 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:46,374 INFO     [param_server.py:410] Lock worker 1 with localStep 471 , while globalStep is 470

2021-08-18:17:08:46,422 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:46,433 INFO     [learner.py:606] ====Pushing takes 0.009267568588256836 s
2021-08-18:17:08:46,445 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:46,449 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:46,449 INFO     [param_server.py:410] Lock worker 2 with localStep 471 , while globalStep is 470

2021-08-18:17:08:46,501 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:46,512 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:47,522 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:47,543 INFO     [learner.py:606] ====Pushing takes 0.01916646957397461 s
2021-08-18:17:08:47,567 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:47,573 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:47,573 INFO     [param_server.py:381] ====After aggregation in epoch: 470, virtual_clock: 23909.02846244632, top_1: : 62.0523 % (1923.0), top_5: : 100.0 % (3099.0), test loss: 4.131052522471657, test len: 3099.0
2021-08-18:17:08:47,576 INFO     [param_server.py:410] Lock worker 3 with localStep 471 , while globalStep is 471

2021-08-18:17:08:47,576 INFO     [param_server.py:441] ====Epoch 472 completes 12 clients with loss 4.092845886101678, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:47,576 INFO     [param_server.py:450] ====Start to sample for epoch 472, global virtualClock: 23909.02846244632, round_duration: 83.5973351615153
2021-08-18:17:08:47,577 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:47,883 INFO     [param_server.py:553] For epoch: 472, median_reward: 1108.3271531551259, dev: 5541.635765775629
2021-08-18:17:08:48,539 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5222, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:08:48,540 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5963.6649, eval_time 0.6173, test_loss 3.5222, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:08:48,604 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:08:48,617 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:48,662 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7836, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:17:08:48,663 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5963.8021, eval_time 0.744, test_loss 3.7836, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:17:08:48,685 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2851, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:08:48,686 INFO     [learner.py:656] After aggregation epoch 471, CumulTime 5963.8217, eval_time 0.7628, test_loss 4.2851, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:08:48,752 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:08:48,755 INFO     [learner.py:526] ====Start train round 472
2021-08-18:17:08:48,768 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:48,773 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:49,871 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:49,880 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:08:51,23 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:08:51,49 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:08:51,167 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:08:51,187 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:08:52,633 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:08:52,642 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:08:53,763 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:08:53,791 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:08:53,918 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:08:53,944 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:08:53,992 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:08:54,5 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:08:54,791 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:08:54,831 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:08:55,511 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:08:55,525 INFO     [learner.py:606] ====Pushing takes 0.013201475143432617 s
2021-08-18:17:08:55,553 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:55,564 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:08:55,565 INFO     [param_server.py:410] Lock worker 1 with localStep 472 , while globalStep is 471

2021-08-18:17:08:55,809 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:08:55,814 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:08:55,820 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:08:55,826 INFO     [learner.py:606] ====Pushing takes 0.010087251663208008 s
2021-08-18:17:08:55,837 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:55,843 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:08:55,843 INFO     [param_server.py:410] Lock worker 2 with localStep 472 , while globalStep is 471

2021-08-18:17:08:56,959 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:08:56,980 INFO     [learner.py:606] ====Pushing takes 0.019002676010131836 s
2021-08-18:17:08:57,3 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:08:57,9 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:08:57,10 INFO     [param_server.py:381] ====After aggregation in epoch: 471, virtual_clock: 23992.625797607834, top_1: : 65.3759 % (2026.0), top_5: : 100.0 % (3099.0), test loss: 3.863620532883538, test len: 3099.0
2021-08-18:17:08:57,12 INFO     [param_server.py:410] Lock worker 3 with localStep 472 , while globalStep is 472

2021-08-18:17:08:57,13 INFO     [param_server.py:441] ====Epoch 473 completes 12 clients with loss 3.4746293221746383, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:08:57,13 INFO     [param_server.py:450] ====Start to sample for epoch 473, global virtualClock: 23992.625797607834, round_duration: 83.5973351615153
2021-08-18:17:08:57,14 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:08:57,311 INFO     [param_server.py:553] For epoch: 473, median_reward: 1109.3329570888673, dev: 5546.664785444336
2021-08-18:17:08:57,940 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9969, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:17:08:57,941 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9707, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:08:57,941 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5973.0775, eval_time 0.5948, test_loss 3.9969, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:17:08:57,942 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5973.0663, eval_time 0.5937, test_loss 3.9707, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:08:57,983 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.3863, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:08:57,984 INFO     [learner.py:656] After aggregation epoch 472, CumulTime 5973.123, eval_time 0.6371, test_loss 4.3863, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:08:58,9 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:58,17 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:08:58,27 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:58,35 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:08:58,52 INFO     [learner.py:526] ====Start train round 473
2021-08-18:17:08:58,70 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:08:59,380 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:08:59,391 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:00,267 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:00,294 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:00,502 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:00,516 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:02,218 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:02,232 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:03,88 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:03,116 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:03,378 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:03,397 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:03,683 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:03,692 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:04,16 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:04,43 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:04,698 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:04,711 INFO     [learner.py:606] ====Pushing takes 0.012289285659790039 s
2021-08-18:17:09:04,734 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:04,739 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:04,740 INFO     [param_server.py:410] Lock worker 1 with localStep 473 , while globalStep is 472

2021-08-18:17:09:05,238 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:05,249 INFO     [learner.py:606] ====Pushing takes 0.009309530258178711 s
2021-08-18:17:09:05,262 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:05,267 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:05,268 INFO     [param_server.py:410] Lock worker 2 with localStep 473 , while globalStep is 472

2021-08-18:17:09:05,540 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:05,550 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:07,9 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:07,29 INFO     [learner.py:606] ====Pushing takes 0.01846146583557129 s
2021-08-18:17:09:07,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:07,63 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:07,64 INFO     [param_server.py:381] ====After aggregation in epoch: 472, virtual_clock: 24076.223132769348, top_1: : 64.0852 % (1986.0), top_5: : 100.0 % (3099.0), test loss: 4.1179436489387795, test len: 3099.0
2021-08-18:17:09:07,68 INFO     [param_server.py:410] Lock worker 3 with localStep 473 , while globalStep is 473

2021-08-18:17:09:07,69 INFO     [param_server.py:441] ====Epoch 474 completes 12 clients with loss 5.11436601824779, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:07,69 INFO     [param_server.py:450] ====Start to sample for epoch 474, global virtualClock: 24076.223132769348, round_duration: 83.5973351615153
2021-08-18:17:09:07,70 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:07,399 INFO     [param_server.py:553] For epoch: 474, median_reward: 1227.4615911289477, dev: 6137.307955644738
2021-08-18:17:09:08,60 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9664, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:09:08,61 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5983.1973, eval_time 0.6169, test_loss 3.9664, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:09:08,69 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.4783, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:09:08,70 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5983.1949, eval_time 0.6257, test_loss 3.4783, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:09:08,130 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:09:08,143 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:08,160 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.9546, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:09:08,160 INFO     [learner.py:656] After aggregation epoch 473, CumulTime 5983.2994, eval_time 0.7157, test_loss 3.9546, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:09:08,184 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:09:08,206 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:08,229 INFO     [learner.py:526] ====Start train round 474
2021-08-18:17:09:08,257 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:09,487 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:09,522 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:10,257 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:10,279 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:10,409 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:10,419 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:12,194 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:12,213 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:13,174 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:13,208 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:13,264 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:13,292 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:13,497 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:13,514 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:14,292 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:14,325 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:14,936 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:14,950 INFO     [learner.py:606] ====Pushing takes 0.013183355331420898 s
2021-08-18:17:09:14,972 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:14,980 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:14,981 INFO     [param_server.py:410] Lock worker 1 with localStep 474 , while globalStep is 473

2021-08-18:17:09:15,313 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:15,326 INFO     [learner.py:606] ====Pushing takes 0.011553049087524414 s
2021-08-18:17:09:15,339 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:15,343 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:15,344 INFO     [param_server.py:410] Lock worker 2 with localStep 474 , while globalStep is 473

2021-08-18:17:09:15,439 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:15,448 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:16,752 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:16,774 INFO     [learner.py:606] ====Pushing takes 0.02074599266052246 s
2021-08-18:17:09:16,799 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:16,804 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:16,805 INFO     [param_server.py:381] ====After aggregation in epoch: 473, virtual_clock: 24159.820467930862, top_1: : 64.9887 % (2014.0), top_5: : 100.0 % (3099.0), test loss: 3.7997723707446345, test len: 3099.0
2021-08-18:17:09:16,807 INFO     [param_server.py:410] Lock worker 3 with localStep 474 , while globalStep is 474

2021-08-18:17:09:16,807 INFO     [param_server.py:441] ====Epoch 475 completes 12 clients with loss 5.80005803423235, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:16,808 INFO     [param_server.py:450] ====Start to sample for epoch 475, global virtualClock: 24159.820467930862, round_duration: 83.5973351615153
2021-08-18:17:09:16,808 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:17,132 INFO     [param_server.py:553] For epoch: 475, median_reward: 1164.0571726996884, dev: 5820.285863498442
2021-08-18:17:09:17,761 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9733, Top-1 Accuracy: 626.0/1033 (0.606), Top-5 Accuracy: 1.0
2021-08-18:17:09:17,762 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5992.8984, eval_time 0.5854, test_loss 3.9733, test_accuracy 0.606, test_5_accuracy 1.0 

2021-08-18:17:09:17,789 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.5953, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:09:17,790 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5992.915, eval_time 0.6133, test_loss 3.5953, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:09:17,834 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:09:17,844 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:17,881 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1351, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:09:17,882 INFO     [learner.py:656] After aggregation epoch 474, CumulTime 5993.021, eval_time 0.7048, test_loss 4.1351, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:09:17,885 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:09:17,899 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:17,938 INFO     [learner.py:526] ====Start train round 475
2021-08-18:17:09:17,962 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:19,148 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:19,163 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:20,198 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:20,219 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:20,436 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:20,448 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:22,19 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:22,30 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:22,976 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:23,10 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:23,72 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:23,90 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:23,391 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:23,410 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:24,29 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:24,69 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:24,641 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:24,654 INFO     [learner.py:606] ====Pushing takes 0.011580467224121094 s
2021-08-18:17:09:24,670 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:24,674 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:24,675 INFO     [param_server.py:410] Lock worker 1 with localStep 475 , while globalStep is 474

2021-08-18:17:09:25,52 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:25,62 INFO     [learner.py:606] ====Pushing takes 0.008978843688964844 s
2021-08-18:17:09:25,74 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:25,78 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:25,78 INFO     [param_server.py:410] Lock worker 2 with localStep 475 , while globalStep is 474

2021-08-18:17:09:25,105 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:25,126 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:26,275 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:26,295 INFO     [learner.py:606] ====Pushing takes 0.018437623977661133 s
2021-08-18:17:09:26,317 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:26,322 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:26,323 INFO     [param_server.py:381] ====After aggregation in epoch: 474, virtual_clock: 24243.417803092376, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 3.9012301895353527, test len: 3099.0
2021-08-18:17:09:26,326 INFO     [param_server.py:410] Lock worker 3 with localStep 475 , while globalStep is 475

2021-08-18:17:09:26,327 INFO     [param_server.py:441] ====Epoch 476 completes 12 clients with loss 4.524611927598855, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:26,327 INFO     [param_server.py:450] ====Start to sample for epoch 476, global virtualClock: 24243.417803092376, round_duration: 83.5973351615153
2021-08-18:17:09:26,328 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:26,607 INFO     [param_server.py:553] For epoch: 476, median_reward: 1240.7690144850571, dev: 6203.845072425285
2021-08-18:17:09:27,249 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6091, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:09:27,250 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 6002.3744, eval_time 0.6189, test_loss 3.6091, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:09:27,257 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9926, Top-1 Accuracy: 666.0/1033 (0.6447), Top-5 Accuracy: 1.0
2021-08-18:17:09:27,258 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 6002.3938, eval_time 0.627, test_loss 3.9926, test_accuracy 0.6447, test_5_accuracy 1.0 

2021-08-18:17:09:27,330 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7209, Top-1 Accuracy: 705.0/1033 (0.6825), Top-5 Accuracy: 1.0
2021-08-18:17:09:27,331 INFO     [learner.py:656] After aggregation epoch 475, CumulTime 6002.4701, eval_time 0.7001, test_loss 3.7209, test_accuracy 0.6825, test_5_accuracy 1.0 

2021-08-18:17:09:27,332 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:09:27,341 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:27,345 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:09:27,352 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:27,401 INFO     [learner.py:526] ====Start train round 476
2021-08-18:17:09:27,420 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:28,564 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:28,578 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:29,642 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:29,656 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:29,778 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:29,805 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:31,320 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:31,341 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:32,513 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:32,527 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:32,585 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:32,612 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:32,700 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:32,712 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:33,561 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:33,595 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:34,275 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:34,284 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:34,289 INFO     [learner.py:606] ====Pushing takes 0.012371063232421875 s
2021-08-18:17:09:34,296 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:34,310 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:34,316 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:34,317 INFO     [param_server.py:410] Lock worker 1 with localStep 476 , while globalStep is 475

2021-08-18:17:09:34,317 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:34,329 INFO     [learner.py:606] ====Pushing takes 0.010020732879638672 s
2021-08-18:17:09:34,341 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:34,344 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:34,345 INFO     [param_server.py:410] Lock worker 2 with localStep 476 , while globalStep is 475

2021-08-18:17:09:35,460 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:35,481 INFO     [learner.py:606] ====Pushing takes 0.019562721252441406 s
2021-08-18:17:09:35,510 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:35,515 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:35,516 INFO     [param_server.py:381] ====After aggregation in epoch: 475, virtual_clock: 24327.01513825389, top_1: : 65.9245 % (2043.0), top_5: : 100.0 % (3099.0), test loss: 3.774206444069191, test len: 3099.0
2021-08-18:17:09:35,518 INFO     [param_server.py:410] Lock worker 3 with localStep 476 , while globalStep is 476

2021-08-18:17:09:35,519 INFO     [param_server.py:441] ====Epoch 477 completes 12 clients with loss 4.472034421844507, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:35,519 INFO     [param_server.py:450] ====Start to sample for epoch 477, global virtualClock: 24327.01513825389, round_duration: 83.5973351615153
2021-08-18:17:09:35,520 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:35,796 INFO     [param_server.py:553] For epoch: 477, median_reward: 1054.7265015570426, dev: 5273.632507785213
2021-08-18:17:09:36,462 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.946, Top-1 Accuracy: 620.0/1033 (0.6002), Top-5 Accuracy: 1.0
2021-08-18:17:09:36,463 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 6011.5987, eval_time 0.6325, test_loss 4.946, test_accuracy 0.6002, test_5_accuracy 1.0 

2021-08-18:17:09:36,465 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9199, Top-1 Accuracy: 651.0/1033 (0.6302), Top-5 Accuracy: 1.0
2021-08-18:17:09:36,466 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 6011.5903, eval_time 0.633, test_loss 3.9199, test_accuracy 0.6302, test_5_accuracy 1.0 

2021-08-18:17:09:36,533 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:09:36,543 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:09:36,550 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:36,555 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2282, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:09:36,556 INFO     [learner.py:656] After aggregation epoch 476, CumulTime 6011.6956, eval_time 0.727, test_loss 4.2282, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:09:36,558 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:36,615 INFO     [learner.py:526] ====Start train round 477
2021-08-18:17:09:36,639 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:37,912 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:37,926 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:38,693 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:38,713 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:38,746 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:38,758 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:40,713 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:40,724 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:41,261 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:41,271 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:41,520 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:41,553 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:42,40 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:42,53 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:42,475 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:42,515 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:43,156 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:43,172 INFO     [learner.py:606] ====Pushing takes 0.01277923583984375 s
2021-08-18:17:09:43,197 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:43,202 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:43,203 INFO     [param_server.py:410] Lock worker 1 with localStep 477 , while globalStep is 476

2021-08-18:17:09:43,322 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:43,336 INFO     [learner.py:606] ====Pushing takes 0.009614706039428711 s
2021-08-18:17:09:43,348 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:43,352 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:43,353 INFO     [param_server.py:410] Lock worker 2 with localStep 477 , while globalStep is 476

2021-08-18:17:09:43,960 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:43,972 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:45,183 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:45,204 INFO     [learner.py:606] ====Pushing takes 0.019484758377075195 s
2021-08-18:17:09:45,235 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:45,240 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:45,241 INFO     [param_server.py:381] ====After aggregation in epoch: 476, virtual_clock: 24410.612473415404, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 4.364734526033755, test len: 3099.0
2021-08-18:17:09:45,243 INFO     [param_server.py:410] Lock worker 3 with localStep 477 , while globalStep is 477

2021-08-18:17:09:45,243 INFO     [param_server.py:441] ====Epoch 478 completes 12 clients with loss 5.411281220969821, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:45,244 INFO     [param_server.py:450] ====Start to sample for epoch 478, global virtualClock: 24410.612473415404, round_duration: 83.5973351615153
2021-08-18:17:09:45,244 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:45,564 INFO     [param_server.py:553] For epoch: 478, median_reward: 1219.7604669378202, dev: 6098.8023346891005
2021-08-18:17:09:46,279 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6193, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:09:46,279 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8422, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:09:46,280 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 6021.4161, eval_time 0.6804, test_loss 3.6193, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:09:46,280 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 6021.4048, eval_time 0.6788, test_loss 3.8422, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:09:46,350 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:09:46,350 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:09:46,359 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:46,359 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:46,392 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0091, Top-1 Accuracy: 703.0/1033 (0.6805), Top-5 Accuracy: 1.0
2021-08-18:17:09:46,393 INFO     [learner.py:656] After aggregation epoch 477, CumulTime 6021.532, eval_time 0.7946, test_loss 4.0091, test_accuracy 0.6805, test_5_accuracy 1.0 

2021-08-18:17:09:46,488 INFO     [learner.py:526] ====Start train round 478
2021-08-18:17:09:46,512 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:47,655 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:47,665 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:48,694 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:48,722 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:09:48,742 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:48,760 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:50,456 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:09:50,468 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:09:51,440 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:09:51,476 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:09:51,512 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:09:51,530 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:09:51,802 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:09:51,813 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:09:52,543 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:09:52,582 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:09:53,251 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:09:53,266 INFO     [learner.py:606] ====Pushing takes 0.01274251937866211 s
2021-08-18:17:09:53,288 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:53,296 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:09:53,297 INFO     [param_server.py:410] Lock worker 1 with localStep 478 , while globalStep is 477

2021-08-18:17:09:53,592 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:09:53,595 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:09:53,606 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:09:53,608 INFO     [learner.py:606] ====Pushing takes 0.011313676834106445 s
2021-08-18:17:09:53,619 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:53,623 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:09:53,624 INFO     [param_server.py:410] Lock worker 2 with localStep 478 , while globalStep is 477

2021-08-18:17:09:54,989 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:09:55,11 INFO     [learner.py:606] ====Pushing takes 0.019593000411987305 s
2021-08-18:17:09:55,42 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:09:55,51 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:09:55,52 INFO     [param_server.py:381] ====After aggregation in epoch: 477, virtual_clock: 24494.209808576918, top_1: : 66.0213 % (2046.0), top_5: : 100.0 % (3099.0), test loss: 3.8235291330902665, test len: 3099.0
2021-08-18:17:09:55,55 INFO     [param_server.py:410] Lock worker 3 with localStep 478 , while globalStep is 478

2021-08-18:17:09:55,56 INFO     [param_server.py:441] ====Epoch 479 completes 12 clients with loss 5.934563164380945, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:09:55,56 INFO     [param_server.py:450] ====Start to sample for epoch 479, global virtualClock: 24494.209808576918, round_duration: 83.5973351615153
2021-08-18:17:09:55,57 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:09:55,387 INFO     [param_server.py:553] For epoch: 479, median_reward: 1091.3876490002024, dev: 5456.938245001012
2021-08-18:17:09:56,91 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8407, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:09:56,92 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6031.2282, eval_time 0.6765, test_loss 3.8407, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:09:56,93 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.7933, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:09:56,94 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6031.2183, eval_time 0.6775, test_loss 3.7933, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:09:56,162 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:56,163 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:56,171 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:09:56,173 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8058, Top-1 Accuracy: 717.0/1033 (0.6941), Top-5 Accuracy: 1.0
2021-08-18:17:09:56,173 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:09:56,174 INFO     [learner.py:656] After aggregation epoch 478, CumulTime 6031.313, eval_time 0.758, test_loss 3.8058, test_accuracy 0.6941, test_5_accuracy 1.0 

2021-08-18:17:09:56,250 INFO     [learner.py:526] ====Start train round 479
2021-08-18:17:09:56,269 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:09:57,306 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:09:57,315 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:09:58,375 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:09:58,389 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:09:58,424 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:09:58,451 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:00,198 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:00,216 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:01,83 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:01,103 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:01,224 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:01,238 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:01,469 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:01,478 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:01,950 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:01,983 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:02,638 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:02,652 INFO     [learner.py:606] ====Pushing takes 0.013075590133666992 s
2021-08-18:17:10:02,674 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:02,679 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:02,679 INFO     [param_server.py:410] Lock worker 1 with localStep 479 , while globalStep is 478

2021-08-18:17:10:03,140 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:03,151 INFO     [learner.py:606] ====Pushing takes 0.009812116622924805 s
2021-08-18:17:10:03,165 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:03,169 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:03,169 INFO     [param_server.py:410] Lock worker 2 with localStep 479 , while globalStep is 478

2021-08-18:17:10:03,170 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:03,188 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:04,435 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:04,457 INFO     [learner.py:606] ====Pushing takes 0.0204007625579834 s
2021-08-18:17:10:04,480 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:04,485 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:04,486 INFO     [param_server.py:381] ====After aggregation in epoch: 478, virtual_clock: 24577.80714373843, top_1: : 66.6021 % (2064.0), top_5: : 100.0 % (3099.0), test loss: 3.8132604669641563, test len: 3099.0
2021-08-18:17:10:04,488 INFO     [param_server.py:410] Lock worker 3 with localStep 479 , while globalStep is 479

2021-08-18:17:10:04,489 INFO     [param_server.py:441] ====Epoch 480 completes 12 clients with loss 5.39048234844679, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:04,489 INFO     [param_server.py:450] ====Start to sample for epoch 480, global virtualClock: 24577.80714373843, round_duration: 83.5973351615153
2021-08-18:17:10:04,490 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:04,759 INFO     [param_server.py:553] For epoch: 480, median_reward: 1190.466196054276, dev: 5952.33098027138
2021-08-18:17:10:05,482 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.7695, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:17:10:05,485 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6040.6213, eval_time 0.6693, test_loss 3.7695, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:17:10:05,532 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6136, Top-1 Accuracy: 647.0/1033 (0.6263), Top-5 Accuracy: 1.0
2021-08-18:17:10:05,533 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6040.6574, eval_time 0.7106, test_loss 3.6136, test_accuracy 0.6263, test_5_accuracy 1.0 

2021-08-18:17:10:05,543 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:10:05,552 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:05,570 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2396, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:10:05,571 INFO     [learner.py:656] After aggregation epoch 479, CumulTime 6040.7103, eval_time 0.7571, test_loss 4.2396, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:10:05,624 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:10:05,636 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:05,643 INFO     [learner.py:526] ====Start train round 480
2021-08-18:17:10:05,661 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:06,781 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:06,790 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:07,501 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:07,521 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:07,707 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:07,719 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:09,519 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:09,529 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:10,415 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:10,438 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:10,525 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:10,565 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:10,917 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:10,935 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:11,524 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:11,557 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:12,206 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:12,219 INFO     [learner.py:606] ====Pushing takes 0.012247562408447266 s
2021-08-18:17:10:12,239 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:12,250 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:12,251 INFO     [param_server.py:410] Lock worker 1 with localStep 480 , while globalStep is 479

2021-08-18:17:10:12,337 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:12,348 INFO     [learner.py:606] ====Pushing takes 0.009177684783935547 s
2021-08-18:17:10:12,360 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:12,364 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:12,365 INFO     [param_server.py:410] Lock worker 2 with localStep 480 , while globalStep is 479

2021-08-18:17:10:12,565 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:12,574 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:13,769 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:13,793 INFO     [learner.py:606] ====Pushing takes 0.019791841506958008 s
2021-08-18:17:10:13,822 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:13,827 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:13,828 INFO     [param_server.py:381] ====After aggregation in epoch: 479, virtual_clock: 24661.404478899945, top_1: : 63.698 % (1974.0), top_5: : 100.0 % (3099.0), test loss: 3.874248720981457, test len: 3099.0
2021-08-18:17:10:13,830 INFO     [param_server.py:410] Lock worker 3 with localStep 480 , while globalStep is 480

2021-08-18:17:10:13,830 INFO     [param_server.py:441] ====Epoch 481 completes 12 clients with loss 4.382068269144894, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:13,831 INFO     [param_server.py:450] ====Start to sample for epoch 481, global virtualClock: 24661.404478899945, round_duration: 83.5973351615153
2021-08-18:17:10:13,832 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:14,96 INFO     [param_server.py:541] Handle Wight 0.02829122543334961 | Send 0.2646474838256836
2021-08-18:17:10:14,96 INFO     [param_server.py:553] For epoch: 481, median_reward: 1441.3749193796905, dev: 7206.874596898452
2021-08-18:17:10:14,698 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.6517, Top-1 Accuracy: 667.0/1033 (0.6457), Top-5 Accuracy: 1.0
2021-08-18:17:10:14,698 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6049.8344, eval_time 0.5584, test_loss 3.6517, test_accuracy 0.6457, test_5_accuracy 1.0 

2021-08-18:17:10:14,710 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6536, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:10:14,710 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6049.8351, eval_time 0.5696, test_loss 3.6536, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:10:14,768 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:10:14,775 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:14,793 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:10:14,801 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:14,836 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.1642, Top-1 Accuracy: 708.0/1033 (0.6854), Top-5 Accuracy: 1.0
2021-08-18:17:10:14,840 INFO     [learner.py:656] After aggregation epoch 480, CumulTime 6049.979, eval_time 0.6998, test_loss 5.1642, test_accuracy 0.6854, test_5_accuracy 1.0 

2021-08-18:17:10:14,911 INFO     [learner.py:526] ====Start train round 481
2021-08-18:17:10:14,938 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:15,872 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:15,893 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:16,898 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:16,907 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:17,143 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:17,164 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:18,840 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:18,852 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:19,689 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:19,699 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:19,749 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:19,782 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:20,192 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:20,201 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:20,717 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:20,750 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:21,432 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:21,443 INFO     [learner.py:606] ====Pushing takes 0.008837223052978516 s
2021-08-18:17:10:21,455 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:21,458 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:10:21,459 INFO     [param_server.py:410] Lock worker 2 with localStep 481 , while globalStep is 480

2021-08-18:17:10:21,522 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:21,535 INFO     [learner.py:606] ====Pushing takes 0.011282205581665039 s
2021-08-18:17:10:21,550 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:21,558 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:21,558 INFO     [param_server.py:410] Lock worker 1 with localStep 481 , while globalStep is 480

2021-08-18:17:10:22,110 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:22,131 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:23,439 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:23,460 INFO     [learner.py:606] ====Pushing takes 0.019271373748779297 s
2021-08-18:17:10:23,484 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:23,489 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:23,490 INFO     [param_server.py:381] ====After aggregation in epoch: 480, virtual_clock: 24745.00181406146, top_1: : 66.344 % (2056.0), top_5: : 100.0 % (3099.0), test loss: 4.156505408110442, test len: 3099.0
2021-08-18:17:10:23,492 INFO     [param_server.py:410] Lock worker 3 with localStep 481 , while globalStep is 481

2021-08-18:17:10:23,493 INFO     [param_server.py:441] ====Epoch 482 completes 12 clients with loss 4.681738941615843, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:23,493 INFO     [param_server.py:450] ====Start to sample for epoch 482, global virtualClock: 24745.00181406146, round_duration: 83.5973351615153
2021-08-18:17:10:23,494 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:23,767 INFO     [param_server.py:553] For epoch: 482, median_reward: 1121.7043910811085, dev: 5608.521955405542
2021-08-18:17:10:24,490 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.0574, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:10:24,492 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6059.6161, eval_time 0.6858, test_loss 4.0574, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:10:24,503 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9574, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:10:24,507 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6059.6429, eval_time 0.7022, test_loss 3.9574, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:10:24,538 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.7203, Top-1 Accuracy: 702.0/1033 (0.6796), Top-5 Accuracy: 1.0
2021-08-18:17:10:24,539 INFO     [learner.py:656] After aggregation epoch 481, CumulTime 6059.6783, eval_time 0.7386, test_loss 3.7203, test_accuracy 0.6796, test_5_accuracy 1.0 

2021-08-18:17:10:24,562 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:10:24,567 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:10:24,571 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:24,575 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:24,597 INFO     [learner.py:526] ====Start train round 482
2021-08-18:17:10:24,618 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:25,714 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:25,724 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:26,749 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:26,760 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:26,808 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:26,835 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:28,539 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:28,553 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:29,520 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:29,548 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:29,587 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:29,600 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:30,14 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:30,28 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:30,413 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:30,447 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:31,123 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:31,136 INFO     [learner.py:606] ====Pushing takes 0.011158466339111328 s
2021-08-18:17:10:31,153 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:31,160 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:31,161 INFO     [param_server.py:410] Lock worker 1 with localStep 482 , while globalStep is 481

2021-08-18:17:10:31,466 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:31,478 INFO     [learner.py:606] ====Pushing takes 0.01063084602355957 s
2021-08-18:17:10:31,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:31,494 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:31,495 INFO     [param_server.py:410] Lock worker 2 with localStep 482 , while globalStep is 481

2021-08-18:17:10:31,824 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:31,836 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:33,124 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:33,144 INFO     [learner.py:606] ====Pushing takes 0.018400192260742188 s
2021-08-18:17:10:33,168 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:33,173 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:33,173 INFO     [param_server.py:381] ====After aggregation in epoch: 481, virtual_clock: 24828.599149222973, top_1: : 65.6663 % (2035.0), top_5: : 100.0 % (3099.0), test loss: 3.911732107400894, test len: 3099.0
2021-08-18:17:10:33,176 INFO     [param_server.py:410] Lock worker 3 with localStep 482 , while globalStep is 482

2021-08-18:17:10:33,176 INFO     [param_server.py:441] ====Epoch 483 completes 12 clients with loss 2.6424482662240254, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:33,176 INFO     [param_server.py:450] ====Start to sample for epoch 483, global virtualClock: 24828.599149222973, round_duration: 83.5973351615153
2021-08-18:17:10:33,177 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:33,453 INFO     [param_server.py:553] For epoch: 483, median_reward: 1302.9279326412209, dev: 6514.639663206104
2021-08-18:17:10:34,119 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.8439, Top-1 Accuracy: 638.0/1033 (0.6176), Top-5 Accuracy: 1.0
2021-08-18:17:10:34,120 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6069.2557, eval_time 0.6333, test_loss 4.8439, test_accuracy 0.6176, test_5_accuracy 1.0 

2021-08-18:17:10:34,156 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2762, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:17:10:34,157 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6069.2815, eval_time 0.6664, test_loss 4.2762, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:17:10:34,190 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:10:34,205 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:34,206 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.3928, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:10:34,209 INFO     [learner.py:656] After aggregation epoch 482, CumulTime 6069.3482, eval_time 0.7225, test_loss 5.3928, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:10:34,228 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:10:34,245 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:34,279 INFO     [learner.py:526] ====Start train round 483
2021-08-18:17:10:34,296 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:35,490 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:35,503 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:36,285 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:36,305 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:36,406 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:36,430 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:38,347 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:38,364 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:39,101 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:39,127 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:39,253 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:39,272 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:39,757 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:39,775 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:40,31 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:40,64 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:40,805 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:40,819 INFO     [learner.py:606] ====Pushing takes 0.01275324821472168 s
2021-08-18:17:10:40,841 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:40,846 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:40,847 INFO     [param_server.py:410] Lock worker 1 with localStep 483 , while globalStep is 482

2021-08-18:17:10:41,188 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:41,198 INFO     [learner.py:606] ====Pushing takes 0.008627891540527344 s
2021-08-18:17:10:41,212 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:41,216 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:41,217 INFO     [param_server.py:410] Lock worker 2 with localStep 483 , while globalStep is 482

2021-08-18:17:10:41,615 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:41,625 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:42,718 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:42,739 INFO     [learner.py:606] ====Pushing takes 0.01980113983154297 s
2021-08-18:17:10:42,761 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:42,766 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:42,767 INFO     [param_server.py:381] ====After aggregation in epoch: 482, virtual_clock: 24912.196484384487, top_1: : 62.9881 % (1952.0), top_5: : 100.0 % (3099.0), test loss: 4.837639384799533, test len: 3099.0
2021-08-18:17:10:42,769 INFO     [param_server.py:410] Lock worker 3 with localStep 483 , while globalStep is 483

2021-08-18:17:10:42,770 INFO     [param_server.py:441] ====Epoch 484 completes 12 clients with loss 4.252938208132613, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:42,770 INFO     [param_server.py:450] ====Start to sample for epoch 484, global virtualClock: 24912.196484384487, round_duration: 83.5973351615153
2021-08-18:17:10:42,771 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:43,88 INFO     [param_server.py:553] For epoch: 484, median_reward: 1035.1552047512102, dev: 5175.7760237560515
2021-08-18:17:10:43,709 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.213, Top-1 Accuracy: 679.0/1033 (0.6573), Top-5 Accuracy: 1.0
2021-08-18:17:10:43,713 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6078.8488, eval_time 0.5803, test_loss 4.213, test_accuracy 0.6573, test_5_accuracy 1.0 

2021-08-18:17:10:43,753 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.5531, Top-1 Accuracy: 692.0/1033 (0.6699), Top-5 Accuracy: 1.0
2021-08-18:17:10:43,754 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6078.8787, eval_time 0.6215, test_loss 4.5531, test_accuracy 0.6699, test_5_accuracy 1.0 

2021-08-18:17:10:43,768 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:10:43,784 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:43,836 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1841, Top-1 Accuracy: 716.0/1033 (0.6931), Top-5 Accuracy: 1.0
2021-08-18:17:10:43,837 INFO     [learner.py:656] After aggregation epoch 483, CumulTime 6078.9767, eval_time 0.7049, test_loss 4.1841, test_accuracy 0.6931, test_5_accuracy 1.0 

2021-08-18:17:10:43,843 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:10:43,855 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:43,910 INFO     [learner.py:526] ====Start train round 484
2021-08-18:17:10:43,929 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:45,47 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:45,60 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:46,71 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:46,77 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:46,86 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:46,92 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:47,951 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:47,960 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:48,552 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:48,565 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:48,695 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:48,716 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:49,400 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:49,412 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:49,726 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:49,760 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:10:50,412 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:10:50,425 INFO     [learner.py:606] ====Pushing takes 0.01147007942199707 s
2021-08-18:17:10:50,442 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:50,450 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:10:50,451 INFO     [param_server.py:410] Lock worker 1 with localStep 484 , while globalStep is 483

2021-08-18:17:10:50,624 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:10:50,635 INFO     [learner.py:606] ====Pushing takes 0.009289979934692383 s
2021-08-18:17:10:50,647 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:50,651 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:10:50,652 INFO     [param_server.py:410] Lock worker 2 with localStep 484 , while globalStep is 483

2021-08-18:17:10:51,346 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:10:51,372 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:10:52,597 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:10:52,617 INFO     [learner.py:606] ====Pushing takes 0.018712282180786133 s
2021-08-18:17:10:52,641 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:10:52,646 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:10:52,647 INFO     [param_server.py:381] ====After aggregation in epoch: 483, virtual_clock: 24995.793819546, top_1: : 67.3443 % (2087.0), top_5: : 100.0 % (3099.0), test loss: 4.316751533084445, test len: 3099.0
2021-08-18:17:10:52,650 INFO     [param_server.py:410] Lock worker 3 with localStep 484 , while globalStep is 484

2021-08-18:17:10:52,650 INFO     [param_server.py:441] ====Epoch 485 completes 12 clients with loss 4.186382931524474, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:10:52,651 INFO     [param_server.py:450] ====Start to sample for epoch 485, global virtualClock: 24995.793819546, round_duration: 83.5973351615153
2021-08-18:17:10:52,651 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:10:52,950 INFO     [param_server.py:553] For epoch: 485, median_reward: 1014.537885029246, dev: 5072.68942514623
2021-08-18:17:10:53,609 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.5331, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:10:53,610 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6088.7456, eval_time 0.6179, test_loss 4.5331, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:10:53,618 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.3114, Top-1 Accuracy: 652.0/1033 (0.6312), Top-5 Accuracy: 1.0
2021-08-18:17:10:53,622 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6088.7469, eval_time 0.6305, test_loss 4.3114, test_accuracy 0.6312, test_5_accuracy 1.0 

2021-08-18:17:10:53,669 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:53,678 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:10:53,700 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.0406, Top-1 Accuracy: 685.0/1033 (0.6631), Top-5 Accuracy: 1.0
2021-08-18:17:10:53,703 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:53,703 INFO     [learner.py:656] After aggregation epoch 484, CumulTime 6088.8426, eval_time 0.7116, test_loss 4.0406, test_accuracy 0.6631, test_5_accuracy 1.0 

2021-08-18:17:10:53,712 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:10:53,775 INFO     [learner.py:526] ====Start train round 485
2021-08-18:17:10:53,796 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:10:54,870 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:10:54,879 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:10:55,737 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:10:55,758 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:10:55,976 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:10:55,987 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:10:57,830 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:10:57,844 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:10:58,622 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:10:58,655 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:10:58,905 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:10:58,923 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:10:59,430 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:10:59,443 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:10:59,772 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:10:59,806 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:00,575 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:00,586 INFO     [learner.py:606] ====Pushing takes 0.01065373420715332 s
2021-08-18:17:11:00,603 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:00,608 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:00,608 INFO     [param_server.py:410] Lock worker 1 with localStep 485 , while globalStep is 484

2021-08-18:17:11:00,853 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:00,862 INFO     [learner.py:606] ====Pushing takes 0.007871150970458984 s
2021-08-18:17:11:00,874 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:00,879 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:00,880 INFO     [param_server.py:410] Lock worker 2 with localStep 485 , while globalStep is 484

2021-08-18:17:11:01,457 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:01,466 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:02,700 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:02,719 INFO     [learner.py:606] ====Pushing takes 0.01754450798034668 s
2021-08-18:17:11:02,741 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:02,746 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:02,747 INFO     [param_server.py:381] ====After aggregation in epoch: 484, virtual_clock: 25079.391154707515, top_1: : 63.9238 % (1981.0), top_5: : 100.0 % (3099.0), test loss: 4.295015096664429, test len: 3099.0
2021-08-18:17:11:02,749 INFO     [param_server.py:410] Lock worker 3 with localStep 485 , while globalStep is 485

2021-08-18:17:11:02,750 INFO     [param_server.py:441] ====Epoch 486 completes 12 clients with loss 3.839500052698089, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:02,750 INFO     [param_server.py:450] ====Start to sample for epoch 486, global virtualClock: 25079.391154707515, round_duration: 83.5973351615153
2021-08-18:17:11:02,750 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:03,21 INFO     [param_server.py:553] For epoch: 486, median_reward: 1138.2668004612387, dev: 5691.334002306194
2021-08-18:17:11:03,729 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.8304, Top-1 Accuracy: 672.0/1033 (0.6505), Top-5 Accuracy: 1.0
2021-08-18:17:11:03,733 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6098.8689, eval_time 0.6552, test_loss 3.8304, test_accuracy 0.6505, test_5_accuracy 1.0 

2021-08-18:17:11:03,772 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8201, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:11:03,772 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6098.8968, eval_time 0.692, test_loss 3.8201, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:11:03,801 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:11:03,809 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:03,839 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:11:03,854 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5497, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:17:11:03,854 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:03,855 INFO     [learner.py:656] After aggregation epoch 485, CumulTime 6098.994, eval_time 0.777, test_loss 4.5497, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:17:11:03,945 INFO     [learner.py:526] ====Start train round 486
2021-08-18:17:11:03,969 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:05,96 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:05,115 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:06,77 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:06,86 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:06,117 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:06,131 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:07,815 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:07,829 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:08,801 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:08,821 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:09,120 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:09,160 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:09,347 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:09,365 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:10,218 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:10,271 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:10,630 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:10,642 INFO     [learner.py:606] ====Pushing takes 0.010636091232299805 s
2021-08-18:17:11:10,661 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:10,668 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 3 clients
2021-08-18:17:11:10,668 INFO     [param_server.py:410] Lock worker 2 with localStep 486 , while globalStep is 485

2021-08-18:17:11:10,916 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:10,929 INFO     [learner.py:606] ====Pushing takes 0.011092424392700195 s
2021-08-18:17:11:10,946 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:10,951 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:10,975 INFO     [param_server.py:410] Lock worker 1 with localStep 486 , while globalStep is 485

2021-08-18:17:11:11,204 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:11,214 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:12,322 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:12,343 INFO     [learner.py:606] ====Pushing takes 0.01973247528076172 s
2021-08-18:17:11:12,367 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:12,373 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:12,374 INFO     [param_server.py:381] ====After aggregation in epoch: 485, virtual_clock: 25162.98848986903, top_1: : 66.5053 % (2061.0), top_5: : 100.0 % (3099.0), test loss: 4.066743221547869, test len: 3099.0
2021-08-18:17:11:12,376 INFO     [param_server.py:410] Lock worker 3 with localStep 486 , while globalStep is 486

2021-08-18:17:11:12,377 INFO     [param_server.py:441] ====Epoch 487 completes 12 clients with loss 4.777139957132329, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:12,377 INFO     [param_server.py:450] ====Start to sample for epoch 487, global virtualClock: 25162.98848986903, round_duration: 83.5973351615153
2021-08-18:17:11:12,378 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:12,647 INFO     [param_server.py:553] For epoch: 487, median_reward: 1052.0019069646678, dev: 5260.009534823339
2021-08-18:17:11:13,291 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 5.0281, Top-1 Accuracy: 633.0/1033 (0.6128), Top-5 Accuracy: 1.0
2021-08-18:17:11:13,292 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6108.4283, eval_time 0.6112, test_loss 5.0281, test_accuracy 0.6128, test_5_accuracy 1.0 

2021-08-18:17:11:13,330 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2318, Top-1 Accuracy: 640.0/1033 (0.6196), Top-5 Accuracy: 1.0
2021-08-18:17:11:13,331 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6108.4553, eval_time 0.6495, test_loss 4.2318, test_accuracy 0.6196, test_5_accuracy 1.0 

2021-08-18:17:11:13,350 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:11:13,358 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:13,369 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.1696, Top-1 Accuracy: 676.0/1033 (0.6544), Top-5 Accuracy: 1.0
2021-08-18:17:11:13,371 INFO     [learner.py:656] After aggregation epoch 486, CumulTime 6108.5098, eval_time 0.6896, test_loss 4.1696, test_accuracy 0.6544, test_5_accuracy 1.0 

2021-08-18:17:11:13,401 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:11:13,413 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:13,448 INFO     [learner.py:526] ====Start train round 487
2021-08-18:17:11:13,470 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:14,738 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:14,752 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:15,481 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:15,490 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:15,681 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:15,708 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:17,684 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:17,693 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:18,256 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:18,283 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:18,374 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:18,407 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:19,7 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:19,26 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:19,298 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:19,332 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:20,26 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:20,39 INFO     [learner.py:606] ====Pushing takes 0.011844158172607422 s
2021-08-18:17:11:20,56 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:20,60 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:20,61 INFO     [param_server.py:410] Lock worker 1 with localStep 487 , while globalStep is 486

2021-08-18:17:11:20,143 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:20,152 INFO     [learner.py:606] ====Pushing takes 0.008014202117919922 s
2021-08-18:17:11:20,164 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:20,167 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:20,168 INFO     [param_server.py:410] Lock worker 2 with localStep 487 , while globalStep is 486

2021-08-18:17:11:20,758 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:20,776 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:21,865 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:21,885 INFO     [learner.py:606] ====Pushing takes 0.019244670867919922 s
2021-08-18:17:11:21,907 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:21,913 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:21,913 INFO     [param_server.py:381] ====After aggregation in epoch: 486, virtual_clock: 25246.585825030543, top_1: : 62.8913 % (1949.0), top_5: : 100.0 % (3099.0), test loss: 4.476509526923851, test len: 3099.0
2021-08-18:17:11:21,916 INFO     [param_server.py:410] Lock worker 3 with localStep 487 , while globalStep is 487

2021-08-18:17:11:21,916 INFO     [param_server.py:441] ====Epoch 488 completes 12 clients with loss 4.568969198151949, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:21,916 INFO     [param_server.py:450] ====Start to sample for epoch 488, global virtualClock: 25246.585825030543, round_duration: 83.5973351615153
2021-08-18:17:11:21,917 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:22,194 INFO     [param_server.py:553] For epoch: 488, median_reward: 984.0061020829683, dev: 4920.030510414841
2021-08-18:17:11:22,894 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.6717, Top-1 Accuracy: 682.0/1033 (0.6602), Top-5 Accuracy: 1.0
2021-08-18:17:11:22,895 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6118.0347, eval_time 0.6787, test_loss 4.6717, test_accuracy 0.6602, test_5_accuracy 1.0 

2021-08-18:17:11:22,912 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8382, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:11:22,912 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2672, Top-1 Accuracy: 656.0/1033 (0.635), Top-5 Accuracy: 1.0
2021-08-18:17:11:22,913 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6118.0378, eval_time 0.6964, test_loss 3.8382, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:11:22,913 INFO     [learner.py:656] After aggregation epoch 487, CumulTime 6118.0492, eval_time 0.6966, test_loss 4.2672, test_accuracy 0.635, test_5_accuracy 1.0 

2021-08-18:17:11:22,973 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:11:22,973 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:11:22,980 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:22,985 INFO     [learner.py:526] ====Start train round 488
2021-08-18:17:11:22,991 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:22,995 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:24,180 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:24,194 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:24,999 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:25,26 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:25,249 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:25,261 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:27,77 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:27,98 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:27,900 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:27,932 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:28,81 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:28,102 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:28,491 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:28,502 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:28,746 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:28,773 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:29,299 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:29,311 INFO     [learner.py:606] ====Pushing takes 0.011516094207763672 s
2021-08-18:17:11:29,334 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:29,341 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:29,342 INFO     [param_server.py:410] Lock worker 1 with localStep 488 , while globalStep is 487

2021-08-18:17:11:29,915 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:29,926 INFO     [learner.py:606] ====Pushing takes 0.00992584228515625 s
2021-08-18:17:11:29,938 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:29,941 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:29,942 INFO     [param_server.py:410] Lock worker 2 with localStep 488 , while globalStep is 487

2021-08-18:17:11:30,426 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:30,447 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:31,819 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:31,840 INFO     [learner.py:606] ====Pushing takes 0.01890087127685547 s
2021-08-18:17:11:31,868 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:31,874 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:31,875 INFO     [param_server.py:381] ====After aggregation in epoch: 487, virtual_clock: 25330.183160192057, top_1: : 64.4079 % (1996.0), top_5: : 100.0 % (3099.0), test loss: 4.259051360465862, test len: 3099.0
2021-08-18:17:11:31,877 INFO     [param_server.py:410] Lock worker 3 with localStep 488 , while globalStep is 488

2021-08-18:17:11:31,878 INFO     [param_server.py:441] ====Epoch 489 completes 12 clients with loss 7.877945977141717, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:31,878 INFO     [param_server.py:450] ====Start to sample for epoch 489, global virtualClock: 25330.183160192057, round_duration: 83.5973351615153
2021-08-18:17:11:31,879 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:32,155 INFO     [param_server.py:553] For epoch: 489, median_reward: 1151.1945686970546, dev: 5755.972843485273
2021-08-18:17:11:32,829 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.2475, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:11:32,831 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6127.9672, eval_time 0.6314, test_loss 4.2475, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:11:32,889 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:11:32,898 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:32,921 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8239, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:11:32,922 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6128.0465, eval_time 0.722, test_loss 3.8239, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:11:32,955 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8912, Top-1 Accuracy: 689.0/1033 (0.667), Top-5 Accuracy: 1.0
2021-08-18:17:11:32,956 INFO     [learner.py:656] After aggregation epoch 488, CumulTime 6128.0952, eval_time 0.7561, test_loss 3.8912, test_accuracy 0.667, test_5_accuracy 1.0 

2021-08-18:17:11:32,993 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:11:33,12 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:33,26 INFO     [learner.py:526] ====Start train round 489
2021-08-18:17:11:33,55 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:34,259 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:34,272 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:34,957 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:34,971 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:35,148 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:35,161 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:37,65 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:37,79 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:37,931 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:37,972 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:38,104 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:38,125 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:38,502 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:38,523 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:39,104 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:39,132 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:39,746 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:39,760 INFO     [learner.py:606] ====Pushing takes 0.012610912322998047 s
2021-08-18:17:11:39,781 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:39,787 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:39,788 INFO     [param_server.py:410] Lock worker 1 with localStep 489 , while globalStep is 488

2021-08-18:17:11:40,119 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:40,129 INFO     [learner.py:606] ====Pushing takes 0.008591890335083008 s
2021-08-18:17:11:40,141 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:40,145 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:40,145 INFO     [param_server.py:410] Lock worker 2 with localStep 489 , while globalStep is 488

2021-08-18:17:11:40,374 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:40,385 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:41,586 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:41,607 INFO     [learner.py:606] ====Pushing takes 0.01941680908203125 s
2021-08-18:17:11:41,629 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:41,635 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:41,635 INFO     [param_server.py:381] ====After aggregation in epoch: 488, virtual_clock: 25413.78049535357, top_1: : 64.5369 % (2000.0), top_5: : 100.0 % (3099.0), test loss: 3.987531157003508, test len: 3099.0
2021-08-18:17:11:41,637 INFO     [param_server.py:410] Lock worker 3 with localStep 489 , while globalStep is 489

2021-08-18:17:11:41,638 INFO     [param_server.py:441] ====Epoch 490 completes 12 clients with loss 4.822831558040888, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:41,638 INFO     [param_server.py:450] ====Start to sample for epoch 490, global virtualClock: 25413.78049535357, round_duration: 83.5973351615153
2021-08-18:17:11:41,639 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:41,907 INFO     [param_server.py:553] For epoch: 490, median_reward: 1045.4920732042478, dev: 5227.46036602124
2021-08-18:17:11:42,608 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.0242, Top-1 Accuracy: 669.0/1033 (0.6476), Top-5 Accuracy: 1.0
2021-08-18:17:11:42,609 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6137.7453, eval_time 0.6687, test_loss 4.0242, test_accuracy 0.6476, test_5_accuracy 1.0 

2021-08-18:17:11:42,656 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9014, Top-1 Accuracy: 674.0/1033 (0.6525), Top-5 Accuracy: 1.0
2021-08-18:17:11:42,657 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6137.7821, eval_time 0.7155, test_loss 3.9014, test_accuracy 0.6525, test_5_accuracy 1.0 

2021-08-18:17:11:42,678 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:11:42,687 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:42,729 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:11:42,734 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8711, Top-1 Accuracy: 704.0/1033 (0.6815), Top-5 Accuracy: 1.0
2021-08-18:17:11:42,735 INFO     [learner.py:656] After aggregation epoch 489, CumulTime 6137.874, eval_time 0.7941, test_loss 3.8711, test_accuracy 0.6815, test_5_accuracy 1.0 

2021-08-18:17:11:42,742 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:42,804 INFO     [learner.py:526] ====Start train round 490
2021-08-18:17:11:42,834 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:43,805 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:43,825 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:44,876 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:44,887 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:44,966 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:44,985 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:46,369 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:46,379 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:47,742 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:47,756 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:47,821 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:47,828 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:47,849 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:47,867 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:48,924 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:48,964 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:49,499 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:49,512 INFO     [learner.py:606] ====Pushing takes 0.012180328369140625 s
2021-08-18:17:11:49,536 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:49,544 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:49,545 INFO     [param_server.py:410] Lock worker 1 with localStep 490 , while globalStep is 489

2021-08-18:17:11:49,612 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:49,633 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:11:49,923 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:49,935 INFO     [learner.py:606] ====Pushing takes 0.011079788208007812 s
2021-08-18:17:11:49,949 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:49,953 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:49,954 INFO     [param_server.py:410] Lock worker 2 with localStep 490 , while globalStep is 489

2021-08-18:17:11:50,743 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:11:50,767 INFO     [learner.py:606] ====Pushing takes 0.021376848220825195 s
2021-08-18:17:11:50,791 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:50,796 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:11:50,797 INFO     [param_server.py:381] ====After aggregation in epoch: 489, virtual_clock: 25497.377830515084, top_1: : 66.0536 % (2047.0), top_5: : 100.0 % (3099.0), test loss: 3.9322584359734143, test len: 3099.0
2021-08-18:17:11:50,800 INFO     [param_server.py:410] Lock worker 3 with localStep 490 , while globalStep is 490

2021-08-18:17:11:50,800 INFO     [param_server.py:441] ====Epoch 491 completes 12 clients with loss 4.029672707561069, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:11:50,801 INFO     [param_server.py:450] ====Start to sample for epoch 491, global virtualClock: 25497.377830515084, round_duration: 83.5973351615153
2021-08-18:17:11:50,802 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:11:51,78 INFO     [param_server.py:553] For epoch: 491, median_reward: 1128.8420416426795, dev: 5644.210208213398
2021-08-18:17:11:51,625 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9041, Top-1 Accuracy: 653.0/1033 (0.6321), Top-5 Accuracy: 1.0
2021-08-18:17:11:51,626 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6146.7617, eval_time 0.523, test_loss 3.9041, test_accuracy 0.6321, test_5_accuracy 1.0 

2021-08-18:17:11:51,627 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.436, Top-1 Accuracy: 671.0/1033 (0.6496), Top-5 Accuracy: 1.0
2021-08-18:17:11:51,628 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6146.7524, eval_time 0.5248, test_loss 3.436, test_accuracy 0.6496, test_5_accuracy 1.0 

2021-08-18:17:11:51,668 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 3.8928, Top-1 Accuracy: 693.0/1033 (0.6709), Top-5 Accuracy: 1.0
2021-08-18:17:11:51,669 INFO     [learner.py:656] After aggregation epoch 490, CumulTime 6146.8078, eval_time 0.5681, test_loss 3.8928, test_accuracy 0.6709, test_5_accuracy 1.0 

2021-08-18:17:11:51,697 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:51,701 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:51,706 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:11:51,709 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:11:51,726 INFO     [learner.py:526] ====Start train round 491
2021-08-18:17:11:51,739 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:11:52,848 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:11:52,857 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:11:53,849 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:11:53,883 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:11:53,995 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:11:54,9 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:11:55,949 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:11:55,958 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:11:56,473 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:11:56,494 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:11:56,685 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:11:56,696 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:11:57,229 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:11:57,229 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:11:57,240 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:11:57,256 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:11:57,846 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:11:57,860 INFO     [learner.py:606] ====Pushing takes 0.012735843658447266 s
2021-08-18:17:11:57,882 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:57,887 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:11:57,888 INFO     [param_server.py:410] Lock worker 1 with localStep 491 , while globalStep is 490

2021-08-18:17:11:58,525 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:11:58,537 INFO     [learner.py:606] ====Pushing takes 0.009682178497314453 s
2021-08-18:17:11:58,552 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:11:58,556 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:11:58,557 INFO     [param_server.py:410] Lock worker 2 with localStep 491 , while globalStep is 490

2021-08-18:17:11:59,96 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:11:59,117 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:00,275 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:00,299 INFO     [learner.py:606] ====Pushing takes 0.02317023277282715 s
2021-08-18:17:12:00,324 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:00,330 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:00,330 INFO     [param_server.py:381] ====After aggregation in epoch: 490, virtual_clock: 25580.9751656766, top_1: : 65.0855 % (2017.0), top_5: : 100.0 % (3099.0), test loss: 3.7442940782617637, test len: 3099.0
2021-08-18:17:12:00,333 INFO     [param_server.py:410] Lock worker 3 with localStep 491 , while globalStep is 491

2021-08-18:17:12:00,333 INFO     [param_server.py:441] ====Epoch 492 completes 12 clients with loss 5.948407171505642, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:00,333 INFO     [param_server.py:450] ====Start to sample for epoch 492, global virtualClock: 25580.9751656766, round_duration: 83.5973351615153
2021-08-18:17:12:00,334 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:00,607 INFO     [param_server.py:553] For epoch: 492, median_reward: 1208.298494448939, dev: 6041.492472244695
2021-08-18:17:12:01,251 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.2502, Top-1 Accuracy: 654.0/1033 (0.6331), Top-5 Accuracy: 1.0
2021-08-18:17:12:01,252 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6156.377, eval_time 0.611, test_loss 4.2502, test_accuracy 0.6331, test_5_accuracy 1.0 

2021-08-18:17:12:01,258 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1553, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:17:12:01,259 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6156.3954, eval_time 0.6202, test_loss 4.1553, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:17:12:01,286 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 6.4226, Top-1 Accuracy: 691.0/1033 (0.6689), Top-5 Accuracy: 1.0
2021-08-18:17:12:01,287 INFO     [learner.py:656] After aggregation epoch 491, CumulTime 6156.4263, eval_time 0.6522, test_loss 6.4226, test_accuracy 0.6689, test_5_accuracy 1.0 

2021-08-18:17:12:01,326 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:12:01,332 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:12:01,335 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:01,340 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:01,359 INFO     [learner.py:526] ====Start train round 492
2021-08-18:17:12:01,373 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:02,484 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:02,494 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:03,310 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:03,331 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:03,596 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:03,605 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:05,390 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:05,411 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:06,204 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:06,225 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:06,227 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:06,239 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:06,939 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:06,949 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:07,53 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:07,80 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:07,900 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:07,917 INFO     [learner.py:606] ====Pushing takes 0.016077518463134766 s
2021-08-18:17:12:07,939 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:07,943 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:07,944 INFO     [param_server.py:410] Lock worker 1 with localStep 492 , while globalStep is 491

2021-08-18:17:12:08,156 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:08,168 INFO     [learner.py:606] ====Pushing takes 0.010107278823852539 s
2021-08-18:17:12:08,179 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:08,185 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:08,186 INFO     [param_server.py:410] Lock worker 2 with localStep 492 , while globalStep is 491

2021-08-18:17:12:08,646 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:08,660 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:09,862 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:09,884 INFO     [learner.py:606] ====Pushing takes 0.020303964614868164 s
2021-08-18:17:12:09,907 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:09,914 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:09,915 INFO     [param_server.py:381] ====After aggregation in epoch: 491, virtual_clock: 25664.572500838112, top_1: : 64.2465 % (1991.0), top_5: : 100.0 % (3099.0), test loss: 4.942693913424457, test len: 3099.0
2021-08-18:17:12:09,918 INFO     [param_server.py:410] Lock worker 3 with localStep 492 , while globalStep is 492

2021-08-18:17:12:09,918 INFO     [param_server.py:441] ====Epoch 493 completes 12 clients with loss 6.346155183230883, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:09,919 INFO     [param_server.py:450] ====Start to sample for epoch 493, global virtualClock: 25664.572500838112, round_duration: 83.5973351615153
2021-08-18:17:12:09,920 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:10,254 INFO     [param_server.py:553] For epoch: 493, median_reward: 1144.6429635460659, dev: 5723.21481773033
2021-08-18:17:12:10,930 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.205, Top-1 Accuracy: 658.0/1033 (0.637), Top-5 Accuracy: 1.0
2021-08-18:17:12:10,931 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6166.0667, eval_time 0.6316, test_loss 4.205, test_accuracy 0.637, test_5_accuracy 1.0 

2021-08-18:17:12:10,999 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:12:11,8 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:11,15 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6671, Top-1 Accuracy: 678.0/1033 (0.6563), Top-5 Accuracy: 1.0
2021-08-18:17:12:11,16 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6166.1408, eval_time 0.717, test_loss 3.6671, test_accuracy 0.6563, test_5_accuracy 1.0 

2021-08-18:17:12:11,63 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2393, Top-1 Accuracy: 700.0/1033 (0.6776), Top-5 Accuracy: 1.0
2021-08-18:17:12:11,65 INFO     [learner.py:656] After aggregation epoch 492, CumulTime 6166.2039, eval_time 0.7659, test_loss 4.2393, test_accuracy 0.6776, test_5_accuracy 1.0 

2021-08-18:17:12:11,84 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:12:11,105 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:11,131 INFO     [learner.py:526] ====Start train round 493
2021-08-18:17:12:11,154 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:12,385 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:12,395 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:13,81 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:13,95 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:13,284 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:13,299 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:15,173 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:15,182 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:15,821 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:15,848 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:16,108 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:16,120 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:16,706 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:16,726 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:16,821 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:16,854 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:17,581 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:17,593 INFO     [learner.py:606] ====Pushing takes 0.011168479919433594 s
2021-08-18:17:12:17,611 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:17,617 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:17,617 INFO     [param_server.py:410] Lock worker 1 with localStep 493 , while globalStep is 492

2021-08-18:17:12:17,991 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:18,2 INFO     [learner.py:606] ====Pushing takes 0.009102106094360352 s
2021-08-18:17:12:18,13 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:18,18 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:18,19 INFO     [param_server.py:410] Lock worker 2 with localStep 493 , while globalStep is 492

2021-08-18:17:12:18,755 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:18,769 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:19,935 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:19,956 INFO     [learner.py:606] ====Pushing takes 0.01855635643005371 s
2021-08-18:17:12:19,978 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:19,984 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:19,984 INFO     [param_server.py:381] ====After aggregation in epoch: 492, virtual_clock: 25748.169835999626, top_1: : 65.6986 % (2036.0), top_5: : 100.0 % (3099.0), test loss: 4.037131512606585, test len: 3099.0
2021-08-18:17:12:19,987 INFO     [param_server.py:410] Lock worker 3 with localStep 493 , while globalStep is 493

2021-08-18:17:12:19,987 INFO     [param_server.py:441] ====Epoch 494 completes 12 clients with loss 5.620080694863474, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:19,988 INFO     [param_server.py:450] ====Start to sample for epoch 494, global virtualClock: 25748.169835999626, round_duration: 83.5973351615153
2021-08-18:17:12:19,989 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:20,327 INFO     [param_server.py:553] For epoch: 494, median_reward: 1125.5376636053743, dev: 5627.6883180268715
2021-08-18:17:12:20,966 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.7206, Top-1 Accuracy: 655.0/1033 (0.6341), Top-5 Accuracy: 1.0
2021-08-18:17:12:20,967 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6176.0912, eval_time 0.6187, test_loss 4.7206, test_accuracy 0.6341, test_5_accuracy 1.0 

2021-08-18:17:12:20,971 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.5155, Top-1 Accuracy: 646.0/1033 (0.6254), Top-5 Accuracy: 1.0
2021-08-18:17:12:20,972 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6176.1079, eval_time 0.6243, test_loss 4.5155, test_accuracy 0.6254, test_5_accuracy 1.0 

2021-08-18:17:12:21,46 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:12:21,48 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:12:21,61 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:21,53 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.7803, Top-1 Accuracy: 680.0/1033 (0.6583), Top-5 Accuracy: 1.0
2021-08-18:17:12:21,67 INFO     [learner.py:656] After aggregation epoch 493, CumulTime 6176.2061, eval_time 0.7191, test_loss 5.7803, test_accuracy 0.6583, test_5_accuracy 1.0 

2021-08-18:17:12:21,74 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:21,140 INFO     [learner.py:526] ====Start train round 494
2021-08-18:17:12:21,157 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:22,219 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:22,240 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:23,170 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:23,179 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:23,258 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:23,278 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:24,959 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:24,978 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:25,926 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:25,943 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:25,952 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:25,953 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:26,328 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:26,337 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:26,839 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:26,867 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:27,558 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:27,572 INFO     [learner.py:606] ====Pushing takes 0.012651443481445312 s
2021-08-18:17:12:27,598 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:27,605 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:27,606 INFO     [param_server.py:410] Lock worker 1 with localStep 494 , while globalStep is 493

2021-08-18:17:12:27,699 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:27,711 INFO     [learner.py:606] ====Pushing takes 0.010889768600463867 s
2021-08-18:17:12:27,723 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:27,727 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:27,727 INFO     [param_server.py:410] Lock worker 2 with localStep 494 , while globalStep is 493

2021-08-18:17:12:28,217 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:28,236 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:29,445 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:29,465 INFO     [learner.py:606] ====Pushing takes 0.019026517868041992 s
2021-08-18:17:12:29,490 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:29,500 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:29,501 INFO     [param_server.py:381] ====After aggregation in epoch: 493, virtual_clock: 25831.76717116114, top_1: : 63.9238 % (1981.0), top_5: : 100.0 % (3099.0), test loss: 5.005475697694002, test len: 3099.0
2021-08-18:17:12:29,503 INFO     [param_server.py:410] Lock worker 3 with localStep 494 , while globalStep is 494

2021-08-18:17:12:29,504 INFO     [param_server.py:441] ====Epoch 495 completes 12 clients with loss 5.559155897248531, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:29,504 INFO     [param_server.py:450] ====Start to sample for epoch 495, global virtualClock: 25831.76717116114, round_duration: 83.5973351615153
2021-08-18:17:12:29,505 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:29,851 INFO     [param_server.py:553] For epoch: 495, median_reward: 1020.0674221201656, dev: 5100.337110600828
2021-08-18:17:12:30,529 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9371, Top-1 Accuracy: 670.0/1033 (0.6486), Top-5 Accuracy: 1.0
2021-08-18:17:12:30,529 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6185.654, eval_time 0.6439, test_loss 3.9371, test_accuracy 0.6486, test_5_accuracy 1.0 

2021-08-18:17:12:30,527 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 3.9702, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:12:30,531 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6185.6667, eval_time 0.6453, test_loss 3.9702, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:12:30,561 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.5037, Top-1 Accuracy: 698.0/1033 (0.6757), Top-5 Accuracy: 1.0
2021-08-18:17:12:30,563 INFO     [learner.py:656] After aggregation epoch 494, CumulTime 6185.7019, eval_time 0.6781, test_loss 4.5037, test_accuracy 0.6757, test_5_accuracy 1.0 

2021-08-18:17:12:30,605 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:12:30,613 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:30,618 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:12:30,627 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:30,637 INFO     [learner.py:526] ====Start train round 495
2021-08-18:17:12:30,653 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:31,730 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:31,740 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:32,578 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:32,599 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:32,817 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:32,827 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:34,694 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:34,714 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:35,502 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:35,523 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:35,837 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:35,848 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:36,194 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:36,203 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:36,356 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:36,377 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:37,18 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:37,31 INFO     [learner.py:606] ====Pushing takes 0.011984825134277344 s
2021-08-18:17:12:37,53 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:37,57 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:37,58 INFO     [param_server.py:410] Lock worker 1 with localStep 495 , while globalStep is 494

2021-08-18:17:12:37,794 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:37,817 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:37,822 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:37,823 INFO     [param_server.py:410] Lock worker 2 with localStep 495 , while globalStep is 494

2021-08-18:17:12:37,804 INFO     [learner.py:606] ====Pushing takes 0.009357690811157227 s
2021-08-18:17:12:37,996 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:38,16 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:39,429 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:39,452 INFO     [learner.py:606] ====Pushing takes 0.021379709243774414 s
2021-08-18:17:12:39,480 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:39,486 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:39,487 INFO     [param_server.py:381] ====After aggregation in epoch: 494, virtual_clock: 25915.364506322654, top_1: : 65.505 % (2030.0), top_5: : 100.0 % (3099.0), test loss: 4.136982008262916, test len: 3099.0
2021-08-18:17:12:39,489 INFO     [param_server.py:410] Lock worker 3 with localStep 495 , while globalStep is 495

2021-08-18:17:12:39,490 INFO     [param_server.py:441] ====Epoch 496 completes 12 clients with loss 4.961603236101001, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:39,490 INFO     [param_server.py:450] ====Start to sample for epoch 496, global virtualClock: 25915.364506322654, round_duration: 83.5973351615153
2021-08-18:17:12:39,491 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:39,815 INFO     [param_server.py:553] For epoch: 496, median_reward: 1181.7421817999943, dev: 5908.710908999972
2021-08-18:17:12:40,359 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1525, Top-1 Accuracy: 644.0/1033 (0.6234), Top-5 Accuracy: 1.0
2021-08-18:17:12:40,360 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6195.4958, eval_time 0.5107, test_loss 4.1525, test_accuracy 0.6234, test_5_accuracy 1.0 

2021-08-18:17:12:40,400 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.679, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:12:40,401 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6195.5259, eval_time 0.5474, test_loss 4.679, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:12:40,420 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:12:40,428 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:40,437 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.2607, Top-1 Accuracy: 688.0/1033 (0.666), Top-5 Accuracy: 1.0
2021-08-18:17:12:40,441 INFO     [learner.py:656] After aggregation epoch 495, CumulTime 6195.5803, eval_time 0.5923, test_loss 5.2607, test_accuracy 0.666, test_5_accuracy 1.0 

2021-08-18:17:12:40,493 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:12:40,508 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:40,511 INFO     [learner.py:526] ====Start train round 496
2021-08-18:17:12:40,534 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:41,823 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:41,832 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:42,474 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:42,495 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:42,652 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:42,661 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:44,689 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:44,704 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:45,238 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:45,259 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:45,576 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:45,588 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:45,979 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:45,993 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:46,107 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:46,134 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:46,817 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:46,829 INFO     [learner.py:606] ====Pushing takes 0.011624813079833984 s
2021-08-18:17:12:46,845 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:46,851 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:46,852 INFO     [param_server.py:410] Lock worker 1 with localStep 496 , while globalStep is 495

2021-08-18:17:12:47,492 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:47,503 INFO     [learner.py:606] ====Pushing takes 0.009722232818603516 s
2021-08-18:17:12:47,515 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:47,519 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:47,520 INFO     [param_server.py:410] Lock worker 2 with localStep 496 , while globalStep is 495

2021-08-18:17:12:47,938 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:47,947 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:49,388 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:49,413 INFO     [learner.py:606] ====Pushing takes 0.023188352584838867 s
2021-08-18:17:12:49,435 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:49,441 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:49,442 INFO     [param_server.py:381] ====After aggregation in epoch: 495, virtual_clock: 25998.961841484168, top_1: : 63.8916 % (1980.0), top_5: : 100.0 % (3099.0), test loss: 4.697397770705046, test len: 3099.0
2021-08-18:17:12:49,445 INFO     [param_server.py:410] Lock worker 3 with localStep 496 , while globalStep is 496

2021-08-18:17:12:49,446 INFO     [param_server.py:441] ====Epoch 497 completes 12 clients with loss 4.558172477362422, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:49,446 INFO     [param_server.py:450] ====Start to sample for epoch 497, global virtualClock: 25998.961841484168, round_duration: 83.5973351615153
2021-08-18:17:12:49,447 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:49,736 INFO     [param_server.py:553] For epoch: 497, median_reward: 1186.3294268504947, dev: 5931.647134252473
2021-08-18:17:12:50,378 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.5067, Top-1 Accuracy: 659.0/1033 (0.6379), Top-5 Accuracy: 1.0
2021-08-18:17:12:50,381 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6205.517, eval_time 0.6117, test_loss 4.5067, test_accuracy 0.6379, test_5_accuracy 1.0 

2021-08-18:17:12:50,383 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.6991, Top-1 Accuracy: 662.0/1033 (0.6409), Top-5 Accuracy: 1.0
2021-08-18:17:12:50,383 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6205.5081, eval_time 0.6141, test_loss 3.6991, test_accuracy 0.6409, test_5_accuracy 1.0 

2021-08-18:17:12:50,429 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.8051, Top-1 Accuracy: 696.0/1033 (0.6738), Top-5 Accuracy: 1.0
2021-08-18:17:12:50,430 INFO     [learner.py:656] After aggregation epoch 496, CumulTime 6205.5693, eval_time 0.6608, test_loss 4.8051, test_accuracy 0.6738, test_5_accuracy 1.0 

2021-08-18:17:12:50,462 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:50,470 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:50,481 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:50,490 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:50,500 INFO     [learner.py:526] ====Start train round 497
2021-08-18:17:12:50,521 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:12:51,612 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:12:51,626 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:12:52,547 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:12:52,574 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:12:52,752 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:12:52,763 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:12:54,485 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:12:54,499 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:12:55,266 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:12:55,287 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:12:55,547 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:12:55,565 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:12:55,924 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:12:55,933 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:12:56,108 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:12:56,129 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:12:56,852 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:12:56,863 INFO     [learner.py:606] ====Pushing takes 0.009812116622924805 s
2021-08-18:17:12:56,880 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:56,885 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:12:56,886 INFO     [param_server.py:410] Lock worker 1 with localStep 497 , while globalStep is 496

2021-08-18:17:12:57,587 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:12:57,597 INFO     [learner.py:606] ====Pushing takes 0.008524656295776367 s
2021-08-18:17:12:57,609 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:57,613 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:12:57,614 INFO     [param_server.py:410] Lock worker 2 with localStep 497 , while globalStep is 496

2021-08-18:17:12:57,705 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:12:57,725 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:12:58,723 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:12:58,741 INFO     [learner.py:606] ====Pushing takes 0.017014026641845703 s
2021-08-18:17:12:58,764 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:12:58,769 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:12:58,770 INFO     [param_server.py:381] ====After aggregation in epoch: 496, virtual_clock: 26082.559176645682, top_1: : 65.0855 % (2017.0), top_5: : 100.0 % (3099.0), test loss: 4.336958046312685, test len: 3099.0
2021-08-18:17:12:58,773 INFO     [param_server.py:410] Lock worker 3 with localStep 497 , while globalStep is 497

2021-08-18:17:12:58,773 INFO     [param_server.py:441] ====Epoch 498 completes 12 clients with loss 7.093097780440002, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:12:58,774 INFO     [param_server.py:450] ====Start to sample for epoch 498, global virtualClock: 26082.559176645682, round_duration: 83.5973351615153
2021-08-18:17:12:58,775 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:12:59,87 INFO     [param_server.py:553] For epoch: 498, median_reward: 1164.9519362377546, dev: 5824.759681188772
2021-08-18:17:12:59,751 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1261, Top-1 Accuracy: 635.0/1033 (0.6147), Top-5 Accuracy: 1.0
2021-08-18:17:12:59,753 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6214.8891, eval_time 0.6324, test_loss 4.1261, test_accuracy 0.6147, test_5_accuracy 1.0 

2021-08-18:17:12:59,798 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 4.4317, Top-1 Accuracy: 631.0/1033 (0.6108), Top-5 Accuracy: 1.0
2021-08-18:17:12:59,799 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6214.9233, eval_time 0.6779, test_loss 4.4317, test_accuracy 0.6108, test_5_accuracy 1.0 

2021-08-18:17:12:59,834 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:59,842 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:12:59,839 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 5.7597, Top-1 Accuracy: 664.0/1033 (0.6428), Top-5 Accuracy: 1.0
2021-08-18:17:12:59,843 INFO     [learner.py:656] After aggregation epoch 497, CumulTime 6214.982, eval_time 0.7227, test_loss 5.7597, test_accuracy 0.6428, test_5_accuracy 1.0 

2021-08-18:17:12:59,869 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:59,884 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:12:59,911 INFO     [learner.py:526] ====Start train round 498
2021-08-18:17:12:59,929 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:13:01,154 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:13:01,163 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:13:01,835 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:13:01,855 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:13:02,145 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:13:02,159 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:13:04,178 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:13:04,201 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:13:04,660 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:13:04,688 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:13:04,959 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:13:04,970 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:13:05,574 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:13:05,592 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:13:05,632 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:13:05,659 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:13:06,217 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:13:06,230 INFO     [learner.py:606] ====Pushing takes 0.01209568977355957 s
2021-08-18:17:13:06,253 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:06,260 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:13:06,261 INFO     [param_server.py:410] Lock worker 1 with localStep 498 , while globalStep is 497

2021-08-18:17:13:06,764 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:13:06,776 INFO     [learner.py:606] ====Pushing takes 0.010063648223876953 s
2021-08-18:17:13:06,788 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:06,794 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:13:06,795 INFO     [param_server.py:410] Lock worker 2 with localStep 498 , while globalStep is 497

2021-08-18:17:13:07,363 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:13:07,375 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:13:08,638 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:13:08,673 INFO     [learner.py:606] ====Pushing takes 0.032866716384887695 s
2021-08-18:17:13:08,697 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:08,704 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:13:08,704 INFO     [param_server.py:381] ====After aggregation in epoch: 497, virtual_clock: 26166.156511807196, top_1: : 62.2782 % (1930.0), top_5: : 100.0 % (3099.0), test loss: 4.772499833945875, test len: 3099.0
2021-08-18:17:13:08,707 INFO     [param_server.py:410] Lock worker 3 with localStep 498 , while globalStep is 498

2021-08-18:17:13:08,708 INFO     [param_server.py:441] ====Epoch 499 completes 12 clients with loss 6.229869789337419, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:13:08,708 INFO     [param_server.py:450] ====Start to sample for epoch 499, global virtualClock: 26166.156511807196, round_duration: 83.5973351615153
2021-08-18:17:13:08,709 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:13:09,7 INFO     [param_server.py:553] For epoch: 499, median_reward: 1203.7402515364763, dev: 6018.701257682382
2021-08-18:17:13:09,639 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.1896, Top-1 Accuracy: 660.0/1033 (0.6389), Top-5 Accuracy: 1.0
2021-08-18:17:13:09,643 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6224.7789, eval_time 0.601, test_loss 4.1896, test_accuracy 0.6389, test_5_accuracy 1.0 

2021-08-18:17:13:09,676 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.8936, Top-1 Accuracy: 673.0/1033 (0.6515), Top-5 Accuracy: 1.0
2021-08-18:17:13:09,677 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6224.8014, eval_time 0.632, test_loss 3.8936, test_accuracy 0.6515, test_5_accuracy 1.0 

2021-08-18:17:13:09,727 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.2286, Top-1 Accuracy: 709.0/1033 (0.6864), Top-5 Accuracy: 1.0
2021-08-18:17:13:09,728 INFO     [learner.py:656] After aggregation epoch 498, CumulTime 6224.8674, eval_time 0.6881, test_loss 4.2286, test_accuracy 0.6864, test_5_accuracy 1.0 

2021-08-18:17:13:09,735 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:13:09,744 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:13:09,771 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:13:09,784 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:13:09,818 INFO     [learner.py:526] ====Start train round 499
2021-08-18:17:13:09,835 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:13:10,843 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:13:10,862 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:13:12,30 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:13:12,43 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:13:12,81 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:13:12,95 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:13:13,751 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:13:13,761 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:13:14,748 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:13:14,769 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:13:14,855 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:13:14,867 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:13:15,307 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:13:15,325 INFO     [learner.py:165] Start to run client 12 on rank 3...
2021-08-18:17:13:15,546 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:13:15,579 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:13:16,206 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:13:16,220 INFO     [learner.py:606] ====Pushing takes 0.012780904769897461 s
2021-08-18:17:13:16,239 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:16,246 INFO     [param_server.py:356] ====Done handling rank 1, with ratio 0.08333333333333333, now collected 4 clients
2021-08-18:17:13:16,247 INFO     [param_server.py:410] Lock worker 1 with localStep 499 , while globalStep is 498

2021-08-18:17:13:16,508 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:13:16,522 INFO     [learner.py:606] ====Pushing takes 0.0126953125 s
2021-08-18:17:13:16,535 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:16,540 INFO     [param_server.py:356] ====Done handling rank 2, with ratio 0.08333333333333333, now collected 7 clients
2021-08-18:17:13:16,541 INFO     [param_server.py:410] Lock worker 2 with localStep 499 , while globalStep is 498

2021-08-18:17:13:17,179 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:13:17,198 INFO     [learner.py:165] Start to run client 105 on rank 3...
2021-08-18:17:13:18,384 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:13:18,405 INFO     [learner.py:606] ====Pushing takes 0.018994808197021484 s
2021-08-18:17:13:18,433 INFO     [param_server.py:290] ====Start to merge models
2021-08-18:17:13:18,438 INFO     [param_server.py:356] ====Done handling rank 3, with ratio 0.08333333333333333, now collected 12 clients
2021-08-18:17:13:18,439 INFO     [param_server.py:381] ====After aggregation in epoch: 498, virtual_clock: 26249.75384696871, top_1: : 65.8922 % (2042.0), top_5: : 100.0 % (3099.0), test loss: 4.103965216212802, test len: 3099.0
2021-08-18:17:13:18,441 INFO     [param_server.py:410] Lock worker 3 with localStep 499 , while globalStep is 499

2021-08-18:17:13:18,442 INFO     [param_server.py:441] ====Epoch 500 completes 12 clients with loss 9.193583344091003, sampled rewards are: 
 {5: 0, 11: 0, 12: 0, 40: 0, 67: 0, 79: 0, 81: 0, 87: 0, 93: 0, 97: 0, 105: 0, 113: 0} 
==========
2021-08-18:17:13:18,442 INFO     [param_server.py:450] ====Start to sample for epoch 500, global virtualClock: 26249.75384696871, round_duration: 83.5973351615153
2021-08-18:17:13:18,443 INFO     [param_server.py:467] ====Try to resample clients, final takes: 
 [113, 40, 97, 81, 93, 11, 87, 5, 12, 79, 105, 67]
2021-08-18:17:13:18,796 INFO     [param_server.py:553] For epoch: 500, median_reward: 1141.3563594687284, dev: 5706.781797343642
2021-08-18:17:13:18,968 INFO     [param_server.py:560] Epoch is done: 500
====Error: argument of type 'NoneType' is not iterable

2021-08-18:17:13:19,371 INFO     [utils_model.py:294] Rank 3: Test set: Average loss: 3.9839, Top-1 Accuracy: 641.0/1033 (0.6205), Top-5 Accuracy: 1.0
2021-08-18:17:13:19,372 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6234.497, eval_time 0.5503, test_loss 3.9839, test_accuracy 0.6205, test_5_accuracy 1.0 

2021-08-18:17:13:19,407 INFO     [utils_model.py:294] Rank 1: Test set: Average loss: 4.4186, Top-1 Accuracy: 681.0/1033 (0.6592), Top-5 Accuracy: 1.0
2021-08-18:17:13:19,411 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6234.5499, eval_time 0.5911, test_loss 4.4186, test_accuracy 0.6592, test_5_accuracy 1.0 

2021-08-18:17:13:19,448 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:13:19,457 INFO     [learner.py:165] Start to run client 81 on rank 3...
2021-08-18:17:13:19,484 INFO     [learner.py:667] ====Dump model successfully
2021-08-18:17:13:19,514 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:13:19,529 INFO     [learner.py:165] Start to run client 40 on rank 1...
2021-08-18:17:13:20,308 INFO     [utils_model.py:294] Rank 2: Test set: Average loss: 4.3117, Top-1 Accuracy: 648.0/1033 (0.6273), Top-5 Accuracy: 1.0
2021-08-18:17:13:20,309 INFO     [learner.py:656] After aggregation epoch 499, CumulTime 6235.4449, eval_time 1.489, test_loss 4.3117, test_accuracy 0.6273, test_5_accuracy 1.0 

2021-08-18:17:13:20,387 INFO     [learner.py:526] ====Start train round 500
2021-08-18:17:13:20,403 INFO     [learner.py:165] Start to run client 113 on rank 2...
2021-08-18:17:13:21,293 INFO     [learner.py:439] Completed to run client 81
2021-08-18:17:13:21,313 INFO     [learner.py:165] Start to run client 93 on rank 3...
2021-08-18:17:13:23,750 INFO     [learner.py:439] Completed to run client 40
2021-08-18:17:13:23,769 INFO     [learner.py:165] Start to run client 97 on rank 1...
2021-08-18:17:13:26,485 INFO     [learner.py:439] Completed to run client 113
2021-08-18:17:13:26,497 INFO     [learner.py:165] Start to run client 11 on rank 2...
2021-08-18:17:13:30,717 INFO     [learner.py:439] Completed to run client 93
2021-08-18:17:13:30,730 INFO     [learner.py:165] Start to run client 87 on rank 3...
2021-08-18:17:13:32,449 INFO     [learner.py:439] Completed to run client 97
2021-08-18:17:13:32,475 INFO     [learner.py:165] Start to run client 79 on rank 1...
2021-08-18:17:13:33,81 INFO     [learner.py:439] Completed to run client 79
2021-08-18:17:13:33,107 INFO     [learner.py:165] Start to run client 67 on rank 1...
2021-08-18:17:13:33,714 INFO     [learner.py:439] Completed to run client 11
2021-08-18:17:13:33,737 INFO     [learner.py:165] Start to run client 5 on rank 2...
2021-08-18:17:13:34,427 INFO     [learner.py:439] Completed to run client 67
2021-08-18:17:13:34,439 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
2021-08-18:17:13:34,775 INFO     [learner.py:439] Completed to run client 87
2021-08-18:17:13:34,794 INFO     [learner.py:165] Start to run client 12 on rank 3...
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
2021-08-18:17:13:36,716 INFO     [learner.py:439] Completed to run client 5
2021-08-18:17:13:36,724 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
2021-08-18:17:13:36,786 INFO     [learner.py:439] Completed to run client 12
2021-08-18:17:13:36,798 INFO     [learner.py:165] Start to run client 105 on rank 3...
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
2021-08-18:17:13:40,437 INFO     [learner.py:439] Completed to run client 105
2021-08-18:17:13:40,459 INFO     [learner.py:673] ====Error: [Errno 32] Broken pipe, <class 'BrokenPipeError'>, learner.py, 602
Traceback (most recent call last):
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 769, in <module>
    run, args.backend, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 107, in init_myprocesses
    fn(rank, model, q, param_q, stop_flag, client_cfg)
  File "/mnt/home/lichenni/projects/Oort/training/learner.py", line 679, in run
    queue.put({rank: [None, None, None, True, -1, -1]})
  File "<string>", line 2, in put
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/managers.py", line 756, in _callmethod
    conn.send((self._id, methodname, args, kwds))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 404, in _send_bytes
    self._send(header + buf)
  File "/mnt/home/lichenni/anaconda3/envs/oort/lib/python3.6/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
